<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[RSS Feed of dal.log]]></title><description><![CDATA[우아한테크코스 4기 달록팀 기술 블로그입니다.]]></description><link>https://dallog.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Mon, 22 Aug 2022 08:02:00 GMT</lastBuildDate><item><title><![CDATA[Google은 Refresh Token을 쉽게 내주지 않는다.]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 매트가 작성했습니다. Google은 Refresh Token…]]></description><link>https://dallog.github.io/google-refresh-token/</link><guid isPermaLink="false">https://dallog.github.io/google-refresh-token/</guid><pubDate>Mon, 22 Aug 2022 16:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Google은 Refresh Token을 쉽게 내주지 않는다.&lt;/h2&gt;
&lt;p&gt;우리 &lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;달록&lt;/a&gt;은 캘린더를 손쉽게 공유할 수 &lt;code class=&quot;language-text&quot;&gt;구독형 캘린더 공유 서비스&lt;/code&gt;이다. 현재에는 우리 서비스 내에서만 일정이 등록 가능한 상태이다. 추후 확장성을 고려하여 &lt;code class=&quot;language-text&quot;&gt;Google Calendar API&lt;/code&gt;와 연동하기 위해 Google에서 제공하는 token 정보를 관리해야 하는 요구사항이 추가 되었다.&lt;/p&gt;
&lt;h2&gt;code를 활용한 AccessToken 및 IdToken 발급&lt;/h2&gt;
&lt;p&gt;Google은 OAuth 2.0 요청 때 적절한 &lt;code class=&quot;language-text&quot;&gt;scope(e.g. openid)&lt;/code&gt;를 추가하면 &lt;code class=&quot;language-text&quot;&gt;OpenID Connect&lt;/code&gt;를 통해 Google 리소스에 접근 가능한 &lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt;, AccessToken을 재발급 받기 위한 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;, 회원의 정보가 담긴 &lt;code class=&quot;language-text&quot;&gt;IdToken&lt;/code&gt;을 발급해준다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt;의 경우 짧은 만료 시간을 가지고 있기 때문에 google &lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt; 재발급을 위한 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;을 저장하고 관리해야 한다. &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt;보다 긴 만료 시간을 가지고 있기 때문에 보안에 유의해야 한다. 그렇기 때문에 프론트 측에서 관리하는 것 보다 달록 DB에 저장한 뒤 관리하기로 결정 하였다. 참고로 Google은 보통 아래와 같은 이유가 발생할 때 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;을 만료시킨다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.google.com/identity/protocols/oauth2#expiration&quot;&gt;Refresh Token 만료&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;사용자가 앱의 액세스 권한을 취소한 경우&lt;/li&gt;
&lt;li&gt;Refresh Token이 6개월 동안 사용되지 않은 경우&lt;/li&gt;
&lt;li&gt;사용자가 비밀번호를 변경했으며 Gmail scope가 포함된 경우&lt;/li&gt;
&lt;li&gt;사용자가 계정에 부여된 Refresh Token 한도를 초과한 경우&lt;/li&gt;
&lt;li&gt;세션 제어 정책이 적용되는 Google Cloud Platform 조직에 사용자가 속해있는 경우&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;정리하면 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;은 만료 기간이 비교적 길기 때문에 서버 측에서 안전하게 보관하며 필요할 때 리소스 접근을 위한 &lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt;을 발급 받는 형태를 구상하게 되었다.&lt;/p&gt;
&lt;p&gt;우리 &lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;달록&lt;/a&gt;은 아래와 같은 형태로 인증이 이루어진다. &lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/4c02b6ded86cbf0190013659f8371f6c/c7a69/oauth-flow.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz22S646CMBCFef+3MuGvBONGA5QFNdDFIKCrXIWznGZLgDhJM3Q6fHM1jscjTNPEZrOBZVk4nU7I8xyUvu/xer1AH9d11be2U4ZhmLS2GY/HA4fDAUmSYC7n8xlBECCWMayvPbbbLS6Xi9KEz2G+72O32+F+v8No2xbX6xVZlilDHMdgEN6ZKW3MmnDepZR4Pp8TkMJ7mqYgy9BRWA4feG63mwKEYYgoilCWpXqv6xrv93sCzaFaFLBpGvVT13XKiUD2ja0QnkD1/1ZV1SI7rdk/ZjcBGZUQ9sZxHNi2rfrFEgUzlRFc4cHzPAX9BGTABZAlsTz2iANS5Y1OSZ5BpD/Yew7CIEQ9VrMGUi+A+jIXDkYIgW4M1qBH2TbKj6XN10avzKJkOtKoHPrRYdTyt8B3IlEUxSKQ7vOngUxADfs0vQHDBNDZ6HduAneQlVBzDsYaNO/LOpN17zg07isPYdyAP6NNT/9Z3XF+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;oauth flow&apos; title=&apos;oauth flow&apos; src=&apos;/static/4c02b6ded86cbf0190013659f8371f6c/ca1dc/oauth-flow.png&apos; srcset=&apos;/static/4c02b6ded86cbf0190013659f8371f6c/e7570/oauth-flow.png 170w,
/static/4c02b6ded86cbf0190013659f8371f6c/f46e7/oauth-flow.png 340w,
/static/4c02b6ded86cbf0190013659f8371f6c/ca1dc/oauth-flow.png 680w,
/static/4c02b6ded86cbf0190013659f8371f6c/02d09/oauth-flow.png 1020w,
/static/4c02b6ded86cbf0190013659f8371f6c/9d567/oauth-flow.png 1360w,
/static/4c02b6ded86cbf0190013659f8371f6c/c7a69/oauth-flow.png 2560w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;달록팀 후디 고마워요!&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;프론트 측에서 &lt;code class=&quot;language-text&quot;&gt;OAuth 인증&lt;/code&gt;을 위해서는 달록 서버에서 제공하는 &lt;code class=&quot;language-text&quot;&gt;OAuth 인증을 위한 페이지 uri&lt;/code&gt;을 활용해야 한다. 달록 서버는 해당 uri를 생성하여 전달한다. 로직은 아래 코드로 구현되어 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthUri&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthEndPoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;?&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;client_id=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClientId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;redirect_uri=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getRedirectUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;response_type=code&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;scope=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getScopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 브라우저에서 해당 uri에 접속하면 아래와 같은 페이지를 확인할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7b4590a4b46a14708d45e7589d075bf7/b2dbf/google-oauth-uri.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 111.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4klEQVQ4y61U226bQBD1/yu/0cf8QtRKfYn8YMmV2sqxkwBezB1jYzCwcDKz1K6hCyVRRhp2WHYPczkzs7qWKLMM+blAluVI0xOOx5TsTL1LKdE0Deq6nqQzKUvskwjxPoHjuPA8H47rIowiRFGMsiwnA/LPZ5KMBiztsy+Xg5MB2SAXrpDsza2+R1TI/OiD3IItl0vM53OsVissFgt1CQM/7gDqDlV0N4wT2I4H3w/gUm7T06lz9mJ3AXlT0trz9smp8EM02LglDNOCZW1hGMY/QIMe3kq7d6u679CHzBJ/XSL5bUL4LoIg0AIMFaoLKFtA4+4e/sMCIvJhUXi7nQPX8xCGIfI81+Z4uCiXspPm1CFFUeB8PpMWZJctD0fJrfEw//IN6eMvrIUFsRUEUqsuqapK6RgntR6W33+iWNsIjwcERBFuPQ7bp3zG+73yYnLILAWDEvSJeMaDIU1TFfrfLmgGtO4Cyj8huzQY4jiGELbi28urQQWJrgfHvBvtFF1//k9Hif2RwaDNIc9BwzSxeX6hnvXwSiELuw2flTlp0sopWW+esXMcVbitEEiSRGFw+q6ADMJ544tboo1t7+iwrYCVTXv8zqtJxE8Oh+vgndTL/RR8yjzs53as/TqAn6lvZjy7C+YOEiIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;google oauth uri&apos; title=&apos;google oauth uri&apos; src=&apos;/static/7b4590a4b46a14708d45e7589d075bf7/ca1dc/google-oauth-uri.png&apos; srcset=&apos;/static/7b4590a4b46a14708d45e7589d075bf7/e7570/google-oauth-uri.png 170w,
/static/7b4590a4b46a14708d45e7589d075bf7/f46e7/google-oauth-uri.png 340w,
/static/7b4590a4b46a14708d45e7589d075bf7/ca1dc/google-oauth-uri.png 680w,
/static/7b4590a4b46a14708d45e7589d075bf7/b2dbf/google-oauth-uri.png 946w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;계정을 선택하면 &lt;code class=&quot;language-text&quot;&gt;redirect uri&lt;/code&gt;와 함께 &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; 값이 전달되고, google의 token을 발급 받기 위해 백엔드 서버로 &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; 정보를 전달하게 된다. 아래는 실제 code 정보를 기반으로 google token을 생성한 뒤 &lt;code class=&quot;language-text&quot;&gt;id token&lt;/code&gt;에 명시된 정보를 기반으로 회원을 생성 or 조회한 뒤 &lt;code class=&quot;language-text&quot;&gt;달록 리소스에 접근하기 위한 access token&lt;/code&gt;을 발급해주는 API이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/auth&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthController&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; authService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; authService&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;authService &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; authService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@PostMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/{oauthProvider}/token&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@PathVariable&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; oauthProvider&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                                       &lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestBody&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TokenRequest&lt;/span&gt; tokenRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt; tokenResponse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; authService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tokenRequest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ok&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tokenResponse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;authService.generateToken(tokenRequest.getCode())&lt;/code&gt;: code 정보를 기반으로 google 토큰 정보를 조회한다. 메서드 내부에서 &lt;a href=&quot;https://developers.google.com/identity/protocols/oauth2/openid-connect#exchangecode&quot;&gt;code을 액세스 토큰 및 ID 토큰으로 교환&lt;/a&gt;에서 제공된 형식에 맞춰 google에게 code 정보를 전달하고 토큰 정보를 교환한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;실제 Google에서 토큰 정보를 교환 받는 클라이언트를 담당하는 &lt;code class=&quot;language-text&quot;&gt;GoogleOAuthClient&lt;/code&gt;이다. 핵심은 인가 코드를 기반으로 &lt;code class=&quot;language-text&quot;&gt;GoogleTokenResponse&lt;/code&gt;를 발급 받는 다는 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; JWT_DELIMITER &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\\.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplate&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplateBuilder&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restTemplate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objectMapper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// code을 액세스 토큰 및 ID 토큰으로 교환&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt; googleTokenResponse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;requestGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; payload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;googleTokenResponse&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getIdToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;UserInfo&lt;/span&gt; userInfo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseUserInfo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; refreshToken &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleTokenResponse&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getRefreshToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getPicture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; refreshToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;requestGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;HttpHeaders&lt;/span&gt; headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpHeaders&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        headers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setContentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_FORM_URLENCODED&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateTokenParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;HttpEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; request &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetchGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBody&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateTokenParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LinkedMultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;client_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClientId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;client_secret&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClientSecret&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;grant_type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;authorization_code&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;redirect_uri&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getRedirectUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetchGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;postForEntity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getTokenUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;RestClientException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; jwt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; jwt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;JWT_DELIMITER&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UserInfo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseUserInfo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; decodedPayload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;decodeJwtPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;readValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;decodedPayload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UserInfo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonProcessingException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;id 토큰을 읽을 수 없습니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;decodeJwtPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Base64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getUrlDecoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UTF_8&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 Google에게 제공 받은 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;을 저장해보자.&lt;/p&gt;
&lt;h2&gt;Refresh Token에 채워진 null&lt;/h2&gt;
&lt;p&gt;이게 무슨 일인가, 분명 요청 형식에 맞춰 헤더를 채워 디버깅을 해보면 계속해서 &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; 값으로 전달되고 있는 것이다. 즉, Google 측에서 Refresh Token을 보내주지 않고 있다는 것을 의미한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/40821173b75b8bc6f832d00faa388a42/7c559/google-refresh-token-null.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 18.823529411764707%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiklEQVQI11VOWwrDMAzrwZom8SOxmz7G2NjPPsbuf4jZpYEOhJAtIXv4rPt32Z/zUrRSE5oFVVBqaRqZAkIgcL6CYCIYAYZHW+9VSCWKRfPEENg9TzDGgpHBeCqHNsGdGYdXW7eiUdHLsiPkU4w5d1w2qY92+b3tN9XUKFWvt8sn6MLs+0B/lv3/A4PePxg8B29TAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;google refresh token null&apos; title=&apos;google refresh token null&apos; src=&apos;/static/40821173b75b8bc6f832d00faa388a42/ca1dc/google-refresh-token-null.png&apos; srcset=&apos;/static/40821173b75b8bc6f832d00faa388a42/e7570/google-refresh-token-null.png 170w,
/static/40821173b75b8bc6f832d00faa388a42/f46e7/google-refresh-token-null.png 340w,
/static/40821173b75b8bc6f832d00faa388a42/ca1dc/google-refresh-token-null.png 680w,
/static/40821173b75b8bc6f832d00faa388a42/02d09/google-refresh-token-null.png 1020w,
/static/40821173b75b8bc6f832d00faa388a42/9d567/google-refresh-token-null.png 1360w,
/static/40821173b75b8bc6f832d00faa388a42/7c559/google-refresh-token-null.png 1540w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;다시 한번 &lt;a href=&quot;https://developers.google.com/identity/protocols/oauth2/web-server#offline&quot;&gt;액세스 토큰 새로고침 (오프라인 액세스)&lt;/a&gt;를 살펴보았다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fd2dd90efd7002666575df63734befc8/dff2b/google-refresh-token-docs.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 61.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8klEQVQoz41T29qaQAz0/V+v1VZQzgoLLLCAgNi/00xWe9WL+n1jDizZTDIcrLVI0hR1XSPPC6Rphvv9jtvthizLxS/VOufwP7/DsqyY51kxTRMmscPgMEgBtYK+72Fth3EcFSxOO03+HX9u0BqHqqrw/XhEeLngfA4QhCFOpxOSJNUu4zhBlueI4lhtURSCd/dlqXEu+VieW9visO87mqaBbRtUVYm2bQUWy7Lg+Xxi2za1r9cv8Z9Y11Vzj8cDDznDWHNy5uu3UCbvYVqRVQ632r3n9plh5iEzJoyphKoTygP6rhOaPZxQZTy4Cev+5Qv2w4iqtmg7h8oYDxkFOydMN6PqNrTjC+MKzE9g2YFxE4jfuQX7/vRL4V9tBxwvN5yvic6CczwHAcLwIr7M9priZxjj2ynEJc4VUZwhSnL8CK565io5N+++oJtXpGWPrCiRC8U4SZRyWXrJpGmi+UKGvyyPv9hWKmR6x4vMWQpy/U1To62NLoTyoCbpfyiTPvVqTK2W4IaNMbrAzzMu61CWFYIgRC7rp0SiKH53lXm5RJEIP8NV8hyBv9R6ZXS8vNFcLTG3rR1yq6RHmryVL1Bfn06NWIKxc6OKmbKhwOmTLq12SIWnIgl+dlzI51OjXJjzn6OIXMTMiyl4MqH/r4J/AJuUheYYjXkhAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;google refresh token docs&apos; title=&apos;google refresh token docs&apos; src=&apos;/static/fd2dd90efd7002666575df63734befc8/ca1dc/google-refresh-token-docs.png&apos; srcset=&apos;/static/fd2dd90efd7002666575df63734befc8/e7570/google-refresh-token-docs.png 170w,
/static/fd2dd90efd7002666575df63734befc8/f46e7/google-refresh-token-docs.png 340w,
/static/fd2dd90efd7002666575df63734befc8/ca1dc/google-refresh-token-docs.png 680w,
/static/fd2dd90efd7002666575df63734befc8/dff2b/google-refresh-token-docs.png 767w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;정리하면 &lt;a href=&quot;https://developers.google.com/identity/protocols/oauth2/web-server#redirecting&quot;&gt;Google OAuth 2.0 서버로 리디렉션&lt;/a&gt;할 때 query parameter에 &lt;code class=&quot;language-text&quot;&gt;access_type&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;offline&lt;/code&gt;으로 설정해야 한다는 것이다. 다시 되돌아 가서 Google 인증 요청을 위한 uri를 생성하는 메서드를 아래와 같이 수정하였다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthUri&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthEndPoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;?&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;client_id=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClientId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;redirect_uri=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getRedirectUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;response_type=code&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;scope=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getScopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;access_type=offline&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 추가된 부분&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 다시 요청을 진행해보자! 분명 &lt;code class=&quot;language-text&quot;&gt;refresh token&lt;/code&gt;이 정상적으로 교환될 것이다.&lt;/p&gt;
&lt;h2&gt;또 다시 Refresh Token에 채워진 null&lt;/h2&gt;
&lt;p&gt;분명 문서에 명시한 대로 설정을 진행했지만 아직도 동일하게 &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; 값이 채워져 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f0a948c22b5527c308e2c44e13f5f8d7/5b400/google-refresh-token-null-2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAABYlAAAWJQFJUiTwAAABIElEQVQY01WP627CMAyF+1xAL7nYjuOkLbBx2wRMY2jb+z/AHFp+TDr6dI4V23H1SuEU07vkPYuaA8sxyJbEYEAWCIKcPEUIUenmYgySjadqvH1exs055o803PJ4kByZOKFLCJlwCGqUPiP2ShU5QZ/IClTwfd/k4Y1Fl18l98hOEiRZdmZpjHKltA8+4lSZVNH966UfLjHvOAkxBIDEqgZsg1bZomvBNeBatC3NxRLJleZp8z6mxkPL1ibflEeufarD8rR9cp4YSvP9MKz15qv0Q5CWQJtraxeNWdTdop7Y/fezqfj3Zzeu9dqj5K2ICajNNkHt7cqa2imtzlKjnP1TlT+fR8knFkJegjXRl7+RM+I7LtKKeh1XYnAlqrjoD3uKhTQS4OGGAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;google refresh token null 2&apos; title=&apos;google refresh token null 2&apos; src=&apos;/static/f0a948c22b5527c308e2c44e13f5f8d7/ca1dc/google-refresh-token-null-2.png&apos; srcset=&apos;/static/f0a948c22b5527c308e2c44e13f5f8d7/e7570/google-refresh-token-null-2.png 170w,
/static/f0a948c22b5527c308e2c44e13f5f8d7/f46e7/google-refresh-token-null-2.png 340w,
/static/f0a948c22b5527c308e2c44e13f5f8d7/ca1dc/google-refresh-token-null-2.png 680w,
/static/f0a948c22b5527c308e2c44e13f5f8d7/5b400/google-refresh-token-null-2.png 770w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;해달라는 데로 다해줬는데...&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;엄격한 Google&lt;/h2&gt;
&lt;p&gt;Google은 OAuth 2.0을 통해 인증을 받을 때 Refresh Token을 굉장히 엄격하게 다룬다. 사용자가 로그인을 진행할 때 마다 Refresh Token 정보를 주는 것이 아니라, Google에 등록된 App에 최초 로그인 할 때만 제공해준다. 즉, 재로그인을 진행해도 Refresh Token은 발급해주지 않는다. &lt;/p&gt;
&lt;p&gt;Google의 의도대로 동작하려면 내가 우리 서비스에 최초로 로그인을 진행하는 시점에만 Refresh Token을 발급받고 서버 내부에 저장한 뒤 필요할 때 꺼내 사용해야 한다.&lt;/p&gt;
&lt;p&gt;하지만 우리 서버는 모종의 이유로 최초에 받아온 Refresh Token을 저장하지 못할 수 있다. 이때 &lt;a href=&quot;https://developers.google.com/identity/protocols/oauth2/web-server#redirecting&quot;&gt;Google OAuth 2.0 서버로 리디렉션&lt;/a&gt;할 때 &lt;code class=&quot;language-text&quot;&gt;prompt&lt;/code&gt;를 &lt;code class=&quot;language-text&quot;&gt;consent&lt;/code&gt;로 설정하게 되면 매 로그인 마다 사용자에게 동의를 요청하기 때문에 강제로 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;을 받도록 지정할 수 있다.&lt;/p&gt;
&lt;p&gt;이제 진짜 마지막이다. 아래와 같이 수정한 뒤 다시 디버깅을 진행하였다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthUri&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;properties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthEndPoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;?&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;client_id=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClientId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;redirect_uri=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getRedirectUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;response_type=code&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;scope=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getScopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;access_type=offline&quot;&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;prompt=consent&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 추가된 부분&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ac7268ed5711abec2e8ce73110f7c556/e4da8/google-refresh-token-success.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQY03VP7W7DIBDLeyVrOD6PO0hItymdlKZrk73/KwxINe3HJlmWOfDZNGjtZUj3OC4UbzxkXjheOSZiid56Rg6ZLbEjPsTPsRHK4Nc+p2nxvIbhMwzkfI9aBg2+sAwGSMlospCsn8i3rBtQxmyPeZxWCjlz5UiOTq7aqPpZC6+h6mw4ICs30lizb5d0vlN89QGcFV6VF5Q9SpAqtt/wZZfAPDeN0NZuj/dxWpBnz8aiIK2ieZGy66ED6MTfaAU0oEvyRzpffbhxHJB6V6s61fbQnqDwP6jJ+/Y2pmwOSNKbo97RTRw9UfVOCawfwafIk28VW3VhwS0y3wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;google refresh token success&apos; title=&apos;google refresh token success&apos; src=&apos;/static/ac7268ed5711abec2e8ce73110f7c556/ca1dc/google-refresh-token-success.png&apos; srcset=&apos;/static/ac7268ed5711abec2e8ce73110f7c556/e7570/google-refresh-token-success.png 170w,
/static/ac7268ed5711abec2e8ce73110f7c556/f46e7/google-refresh-token-success.png 340w,
/static/ac7268ed5711abec2e8ce73110f7c556/ca1dc/google-refresh-token-success.png 680w,
/static/ac7268ed5711abec2e8ce73110f7c556/e4da8/google-refresh-token-success.png 766w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;정상적으로 발급 되는 것을 확인할 수 있다!&lt;/p&gt;
&lt;h2&gt;문제점&lt;/h2&gt;
&lt;p&gt;하지만 여기서 문제가 하나 있다. 단순히 &lt;code class=&quot;language-text&quot;&gt;prompt&lt;/code&gt;를 &lt;code class=&quot;language-text&quot;&gt;consent&lt;/code&gt;로 설정할 경우 우리 서비스에 가입된 사용자는 Google OAuth 2.0 인증을 진행할 때 매번 재로그인을 진행해야 한다. 이것은 사용자에게 매우 &lt;code class=&quot;language-text&quot;&gt;불쾌한 경험&lt;/code&gt;으로 다가올 수 있다. 즉 우리는 매번 &lt;code class=&quot;language-text&quot;&gt;재로그인&lt;/code&gt;을 통해 Refresh Token을 발급 받는 것이 아닌, 최초 로그인 시 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;을 발급 받은 뒤 적절한 저장소에 저장하고 관리해야 한다.&lt;/p&gt;
&lt;p&gt;그렇다면 실제 운영 환경이 아닌 테스트 환경에서는 어떻게 해야 할까? 운영 환경과 동일한 &lt;code class=&quot;language-text&quot;&gt;Google Cloud Project&lt;/code&gt;를 사용할 경우 최초 로그인을 진행할 때 &lt;code class=&quot;language-text&quot;&gt;내 권한 정보가 등록&lt;/code&gt;된다. 즉 Refresh Token을 재발급 받을 수 없다는 것을 의미한다. &lt;/p&gt;
&lt;p&gt;우리 달록은 운영 환경과 테스트 환경에서 서로 다른 &lt;code class=&quot;language-text&quot;&gt;Google Cloud Project&lt;/code&gt;를 생성하여 관리하는 방향에 대해 고민하고 있다. 이미 Spring Profile 기능을 통해 각 실행 환경에 대한 설정을 분리해두었기 때문에 쉽게 적용이 가능할 것이라 기대한다. 정리하면 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;운영 환경&lt;/code&gt;: Refresh Token 발급을 위해 &lt;code class=&quot;language-text&quot;&gt;accept_type&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;offline&lt;/code&gt;으로 설정한다. 단 최초 로그인에만 Refresh Token을 발급 받기 위해 &lt;code class=&quot;language-text&quot;&gt;prompt&lt;/code&gt;는 명시하지 않는다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;개발 환경&lt;/code&gt;: 개발 환경에서는 매번 DataBase가 초기화 되기 때문에 Refresh Token을 유지하여 관리할 수 없다. 테스트를 위한 추가적인 &lt;code class=&quot;language-text&quot;&gt;Google Cloud Project&lt;/code&gt;를 생성한 뒤, &lt;code class=&quot;language-text&quot;&gt;accept_type&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;offline&lt;/code&gt;으로, &lt;code class=&quot;language-text&quot;&gt;prompt&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;consent&lt;/code&gt;로 설정하여 매번 새롭게 Refresh Token을 받도록 세팅한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;p&gt;영어를 번역기로 해석한 수준의 문장으로 인해 많은 시간을 삽질하게 되었다. 덕분에 Google에서 의도하는 Refresh Token에 대한 사용 방식과 어디에서 저장하고 관리해야 하는지에 대해 좀 더 깊은 고민을 할 수 있게 되었다. 만약 나와 같은 상황에 직면한 사람이 있다면 이 글이 도움이 되길 바란다!&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;dallog repository&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://github.com/devHudi&quot;&gt;https://github.com/devHudi&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://m.blog.naver.com/dldbdgml99/222013891067&quot;&gt;passport.js에서 구글 OAuth 진행 시 Refresh Token을 못 받아오는 문제 해결&lt;/a&gt;&lt;br&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[달록의 Jacoco 적용기 (feat. Gradle)]]></title><description><![CDATA[…]]></description><link>https://dallog.github.io/dallog-jacoco/</link><guid isPermaLink="false">https://dallog.github.io/dallog-jacoco/</guid><pubDate>Tue, 16 Aug 2022 02:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;코드 커버리지란?&lt;/h2&gt;
&lt;p&gt;코드 커버리지란, 테스트 코드가 프로덕션 코드를 얼마나 실행했는지를 백분율로 나타내는 지표입니다. 즉, 테스트 코드가 실제로 프로덕션 코드를 얼마나 몇 퍼센트 검증하고 있는지를 나타냅니다. 코드 커버리지를 통해 현재 작성된 테스트 코드의 수가 충분한것인지 논의할 수 있습니다.&lt;/p&gt;
&lt;p&gt;더 자세한 내용은 제가 작성한 &lt;a href=&quot;https://hudi.blog/code-coverage/&quot;&gt;코드 커버리지(Code Coverage)란?&lt;/a&gt; 포스팅을 참고해주세요! 😊&lt;/p&gt;
&lt;h2&gt;Jacoco란?&lt;/h2&gt;
&lt;p&gt;Jacoco는 자바 진영에서 프로젝트의 코드 커버리지를 분석하고, 보고서를 만들어주는 역할을 하는 코드 커버리지 프레임워크입니다. 달록팀은 이번에 Jacoco를 도입하여 코드 커버리지를 분석하고, 코드 커버리지가 일정 수준 이하라면 빌드가 실패하도록 설정하였습니다. 이 과정을 여러분께 공유드립니다.&lt;/p&gt;
&lt;h2&gt;프로젝트에 Jacoco 적용하기&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;plugins &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    id &lt;span class=&quot;token string&quot;&gt;&apos;jacoco&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;

jacoco &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    toolVersion &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;0.8.7&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 &lt;code class=&quot;language-text&quot;&gt;build.gradle&lt;/code&gt; 파일에서 Jacoco를 플러그인으로 가져오고, 버전을 설정해줍니다.&lt;/p&gt;
&lt;h2&gt;커버리지 보고서 생성하기&lt;/h2&gt;
&lt;h3&gt;바이너리 보고서 생성&lt;/h3&gt;
&lt;p&gt;Jacoco 플러그인을 불러왔다면, 프로젝트의 테스트 코드를 한번 실행해봅시다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 586px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/89e4b0b85a807df03c7c5d25a3d7cdc0/52581/test.exec.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABxElEQVQoz5WS22oTURSG5wWEGuydoSJ4IxQpJJkMTeMkTXOY2aeZHKYWq7YkrSGtIVKaG30G30G8TyhKrrzW0AOUPtDv2jNpwNbU9OJnbfbs+fj22stQooCmyqLLk6h7aTT8FDyWhXRsKPfltCrXniuGYOvYFRkcsgSkHwE1QFRyN6BzApWTBXPz2FQFHDGyFKuoKQJ7Jnxa39eUgPpQDq+EjQOeQkNaqPsmAjL1eSY0vQbNYxoCJQFfqzx61MeGskLDGtUGgXWNgH9nlvEUGIgcOtzEJplpw+sHqkq6NlmKSaRzd28jIIsMP/JEaKhhdbLUtaZboCJ4UE1NjWcaSt2biWGbp6l35sTQCgEhVEXroJacAPU//w4ZZmjubGxLG0d8BYE0yZJ+png0AZ5+tArNZYWsytFaOWu0fzt6YgzGSmC8TFcroSNo07PBadCZXEPZ2UCxXITjFsH1uf9EuAUYC/uXWGz9Qqw1xoPmKRK9n0j0z2F9usKL4wusfr7E0w9neNgc41FrVn4jtneBZ2++wni8O8LSuwFliCc7Q5jtb0h3T2Afj2D1fiDfH+H5+xPE3w6xRN/1udsZIL7zHctbX/AHSCnOveAjvgAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;test exec&apos; title=&apos;test exec&apos; src=&apos;/static/89e4b0b85a807df03c7c5d25a3d7cdc0/52581/test.exec.png&apos; srcset=&apos;/static/89e4b0b85a807df03c7c5d25a3d7cdc0/e7570/test.exec.png 170w,
/static/89e4b0b85a807df03c7c5d25a3d7cdc0/f46e7/test.exec.png 340w,
/static/89e4b0b85a807df03c7c5d25a3d7cdc0/52581/test.exec.png 586w&apos; sizes=&apos;(max-width: 586px) 100vw, 586px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그럼 위와 같이 &lt;strong&gt;build → jacoco&lt;/strong&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;test.exec&lt;/code&gt; 파일이 생성된 것을 확인할 수 있습니다. 해당 파일은 Jacoco가 테스트 코드를 실행하고, 코드 커버리지를 분석하여 만들어준 보고서 파일입니다.&lt;/p&gt;
&lt;p&gt;이 파일은 바이너리 파일이라서 일반적인 방법으로 우리가 읽을 수 없습니다.&lt;/p&gt;
&lt;h3&gt;XML, CSV, HTML 파일로 보고서 생성&lt;/h3&gt;
&lt;p&gt;하지만 Jacoco는 위에서 생성한 바이너리 커버리지 (&lt;code class=&quot;language-text&quot;&gt;test.exec&lt;/code&gt;) 파일을 사람이 읽을 수 있는 XML, CSV, HTML 파일로도 생성하는 기능을 제공합니다.&lt;/p&gt;
&lt;p&gt;Jacoco Gradle 플러그인은 &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 라는 태스크가 있습니다. 이 태스크는 바이너리 보고서를 사람이 읽기 좋은 형태로 출력해주는 역할을 합니다. 아래와 같이 XML 파일을 생성하도록 태스크를 작성합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;jacocoTestReport &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    reports &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enabled &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
        csv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enabled &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
        html&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;enabled &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

        xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;destination &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token expression&quot;&gt;buildDir&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/jacoco/index.xml&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        csv&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;destination &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token expression&quot;&gt;buildDir&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/jacoco/index.csv&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        html&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;destination &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token expression&quot;&gt;buildDir&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/jacoco/index.html&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;위에서 &lt;code class=&quot;language-text&quot;&gt;${buildDir}&lt;/code&gt; 은 빌드 디렉토리 경로를 의미합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;테스트가 이미 실행되어 &lt;code class=&quot;language-text&quot;&gt;test.exec&lt;/code&gt; 파일이 생성되었다고 가정하고, 아래 명령을 통해 &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 태스크를 실행하고 XML, CSV, HTML 파일을 얻어봅니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ ./gradlew jacocoTestReport&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 582px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/73488bc1ed6d7818f082c2e00d5d5f59/0b5a5/report-files.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 47.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB5UlEQVQoz4WSS28SURiG5x+YVEEQgiamxrAhlIsiAq1pabkOg1WIRByY6cWkpkJoWuJC/4RxYYwrNyYuqgaKUtoaSmtiG+MfejwzLKyX4uLJd5Lzfu/3noukJG6Sy07zMBemmfVwR/FTVAIUlCD5VEQQRRFVSUbIjWC4H0VKp2dJZRLcy86wJEeZm58hI2oqI9aJOPG5OLOiGrr/kU1NI40tHmHRB5zRv+LSe+QrrwisfyP27Ae+jSNiT78TaB5jWzrkrH6AZeGQc39gWRgwtnjM5fIbJLvWxVlp4ahuMV7d5Fb5Jd5HHUJrPbyrn/E97uIVuLQtHJU2TqFzVNu/YfTbtW3cpRdIVr2PTesJdrHpu0zU2kw0+oSbAzy1vrm+tLyHtbojNP/GLvqt+j5X7r8+kVBMd2kt/Cvv8Ne6xDZ6BOtdbqxtM77c4YKZ7hROJrQIZ2PKeW0Pp7jDKWHorX8huH6Ae7WPp75vVmt1eALzJH+xY76DmdCYcFHdFAk/clV9i1pqMln7QPxJj0ijQ7TxCe9KC+eD97gqp2D0Cx936TmS8XeGiH+UmqSoquTlEHLaRy59DSXrR06G+aUbRQRJFiaGkZyMoaSnUMsFCrdDFPJB7irXKc4HyGciYt/QxTD0o/gJh6ykSyVUQeEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;report files&apos; title=&apos;report files&apos; src=&apos;/static/73488bc1ed6d7818f082c2e00d5d5f59/0b5a5/report-files.png&apos; srcset=&apos;/static/73488bc1ed6d7818f082c2e00d5d5f59/e7570/report-files.png 170w,
/static/73488bc1ed6d7818f082c2e00d5d5f59/f46e7/report-files.png 340w,
/static/73488bc1ed6d7818f082c2e00d5d5f59/0b5a5/report-files.png 582w&apos; sizes=&apos;(max-width: 582px) 100vw, 582px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;build → jacoco 에서 &lt;code class=&quot;language-text&quot;&gt;index.xml&lt;/code&gt; &lt;code class=&quot;language-text&quot;&gt;index.csv&lt;/code&gt; 파일, 그리고 &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; 디렉토리가 생성된 것을 확인할 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;html&lt;/code&gt; 파일은 &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; 디렉토리 내부 존재합니다.&lt;/p&gt;
&lt;p&gt;XML과 CSV파일은 소나큐브등과 연동할 때 주로 사용되며, HTML 파일은 사람이 직접 커버리지를 확인할 때 사용됩니다. HTML 파일을 열어보면 아래 사진과 같이 보고서를 눈으로 확인할 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ecb04d6d63572fdea859ac014f0840fa/fac4b/report.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABI0lEQVQY001RbU/DIBjc//9LJn4zMa7turVWM2384rLMAaO8FVraE6jbDCH38IQ77jlW2+2AurJoXh0OhxHOjfjqWrSqxfF8hFEa8zyHvoOUIqExBtb2AXU6931/26sy19gVAu+NgRAemCdUdIe93IMRiotgmMOy4TLnPAhZaK0T+YrLAzbUBqt15rHZOJSlQ7Z2ID8THk8PqLsaikm05BN2CiRtQClNJCllEosYxa6Ok8MsG2+CES/M45k8gViCjnGc+Al+HpODruM3Z4ug+Bv1n+DL2qMoHPLcoaoG9HZAQfMg4kHPBAf2jQkeWikQQhJJqbvDKHbPMIy8KUdUO4e6dnhrBnBh0YoPTCFLxhhYyDDWkRAdLp+xjKm1StnG3tXhL3zfx4vGUt3/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;report&apos; title=&apos;report&apos; src=&apos;/static/ecb04d6d63572fdea859ac014f0840fa/ca1dc/report.png&apos; srcset=&apos;/static/ecb04d6d63572fdea859ac014f0840fa/e7570/report.png 170w,
/static/ecb04d6d63572fdea859ac014f0840fa/f46e7/report.png 340w,
/static/ecb04d6d63572fdea859ac014f0840fa/ca1dc/report.png 680w,
/static/ecb04d6d63572fdea859ac014f0840fa/02d09/report.png 1020w,
/static/ecb04d6d63572fdea859ac014f0840fa/9d567/report.png 1360w,
/static/ecb04d6d63572fdea859ac014f0840fa/fac4b/report.png 2276w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;jacocoTestReport에 대한 자세한 내용은 &lt;a href=&quot;https://docs.gradle.org/current/dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html&quot;&gt;https://docs.gradle.org/current/dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html&lt;/a&gt; 를 참고해주세요.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;테스트가 끝난뒤 바로 jacocoTestReport 실행하기&lt;/h3&gt;
&lt;p&gt;test 태스크가 끝난 다음에 jacocoTestReport 를 실행하는 2번의 과정은 조금 번거롭습니다. 아래와 같이 설정하면, 테스트가 끝나면 곧바로 jacocoTestReport가 실행되게 만들수 있습니다. 아래와 같이 test 태스크에 추가합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;test &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    finalizedBy &lt;span class=&quot;token string&quot;&gt;&apos;jacocoTestReport&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Gradle에서 &lt;code class=&quot;language-text&quot;&gt;finalizedBy&lt;/code&gt; 를 사용하면, 해당 태스크가 끝나고 성공 여부와 관계없이 명시한 태스크를 이어 실행하도록 설정할 수 있습니다.&lt;/p&gt;
&lt;h2&gt;빌드가 성공하는 커버리지 기준 설정&lt;/h2&gt;
&lt;p&gt;Jacoco Gradle 플러그인에서는 &lt;code class=&quot;language-text&quot;&gt;jacocoTestCoverageVerification&lt;/code&gt; 이라는 태스크가 존재합니다. 이 태스크에서 규칙을 설정하여 프로젝트의 코드 커버리지가 규칙을 통과하지 않으면 빌드가 실패하도록 만들 수 있습니다. 아래는 달록팀의 설정입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;jacocoTestCoverageVerification &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    violationRules &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        rule &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            enabled &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
            element &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;CLASS&apos;&lt;/span&gt;

            limit &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                counter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;LINE&apos;&lt;/span&gt;
                value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;COVEREDRATIO&apos;&lt;/span&gt;
                minimum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.75&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;

        rule &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 규칙을 여러개 추가할 수 있습니다.&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;rule&lt;/code&gt; 블럭 내부에서 아래와 같은 속성으로 규칙을 정의할 수 있습니다.&lt;/p&gt;
&lt;h3&gt;enabled&lt;/h3&gt;
&lt;p&gt;규칙의 활성화 여부를 나타냅니다. 기본 값은 &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;h3&gt;element&lt;/h3&gt;
&lt;p&gt;커버리지를 체크할 단위를 설정합니다. 아래와 같은 옵션이 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BUNDLE&lt;/code&gt; : 패키지 번들 (전체 프로젝트)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CLASS&lt;/code&gt; : 클래스&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GROUP&lt;/code&gt; : 논리적 번들 그룹&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;METHOD&lt;/code&gt; : 메소드&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;PACKAGE&lt;/code&gt; : 패키지&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;SOURCEFILE&lt;/code&gt; : 소스파일&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;기본값은 &lt;code class=&quot;language-text&quot;&gt;BUNDLE&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;h3&gt;counter&lt;/h3&gt;
&lt;p&gt;코드 커버리지를 측정할 때 사용되는 지표입니다. 아래와 같은 옵션이 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;LINE&lt;/code&gt; : 빈 줄을 제외한 실제 코드의 라인 수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BRANCH&lt;/code&gt; : 조건문등의 분기 수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CLASS&lt;/code&gt; : 클래스 수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;METHOD&lt;/code&gt; : 메소드 수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;INSTRUCTION&lt;/code&gt; : 자바 바이트코드 명령 수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;COMPLEXITY&lt;/code&gt; : 복잡도&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;기본값은 &lt;code class=&quot;language-text&quot;&gt;INSTRUCTION&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;h2&gt;보고서 생성 후 커버리지 만족 검사&lt;/h2&gt;
&lt;p&gt;조금 전, &lt;code class=&quot;language-text&quot;&gt;finalizedBy&lt;/code&gt; 속성으로 &lt;code class=&quot;language-text&quot;&gt;test&lt;/code&gt; 태스크가 실행되고 &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 가 실행되도록 설정했습니다.&lt;/p&gt;
&lt;p&gt;이어서 &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 태스크가 실행된 이후 &lt;code class=&quot;language-text&quot;&gt;jacocoTestCoverageVerification&lt;/code&gt; 가 바로 실행되어 테스트가 실행되고, 커버리지가 기준 미달이면 빌드가 실패되도록 흐름을 만들어봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;jacocoTestReport &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;

    finalizedBy &lt;span class=&quot;token string&quot;&gt;&apos;jacocoTestCoverageVerification&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;간단히 위처럼 &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 에 추가해주면 끝입니다.&lt;/p&gt;
&lt;h2&gt;코드 커버리지 분석 대상 제외&lt;/h2&gt;
&lt;p&gt;예외 클래스, DTO 클래스 등 굳이 테스트를 하지 않아도 되는 클래스들이 있습니다. 이런 클래스까지 포함하여 코드 커버리지를 계산하면 코드 커버리지가 낮게 나올 것 입니다. 이런 클래스를 분석 대상에서 제외할 수 있습니다.&lt;/p&gt;
&lt;h3&gt;jacocoTestReport&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 태스크에서는 보고서에 표시되는 클래스 중 일부를 제외할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;jacocoTestReport &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
    afterEvaluate &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        classDirectories&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setFrom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token function&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;classDirectories&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;files&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token function&quot;&gt;fileTree&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dir&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; it&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; excludes&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                            &lt;span class=&quot;token string&quot;&gt;&apos;**/*Application*&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token string&quot;&gt;&apos;**/*Exception*&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token string&quot;&gt;&apos;**/dto/**&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;제외 대상 파일의 경로를 &lt;a href=&quot;https://ant.apache.org/manual/dirtasks.html&quot;&gt;Ant 스타일&lt;/a&gt;로 작성합니다.&lt;/p&gt;
&lt;h3&gt;jacocoTestCoverageVerification&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;jacocoTestCoverageVerification&lt;/code&gt; 에서는 코드 커버리지를 만족하는지 확인할 대상 중 일부를 제외할 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;jacocoTestReport&lt;/code&gt; 에서 작성한 것과 다르게 파일의 경로가 아닌 패키지 + 클래스명을 적어주어야 합니다. 와일드 카드로 &lt;code class=&quot;language-text&quot;&gt;*&lt;/code&gt; (여러 글자) 와 &lt;code class=&quot;language-text&quot;&gt;?&lt;/code&gt; (한 글자) 를 사용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;jacocoTestCoverageVerification &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    violationRules &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        rule &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;

            excludes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&apos;*.*Application&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&apos;*.*Exception&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&apos;*.dto.*&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;참고&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://techblog.woowahan.com/2661/&quot;&gt;https://techblog.woowahan.com/2661&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bottom-to-top.tistory.com/36&quot;&gt;https://bottom-to-top.tistory.com/36&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[젠킨스 빌드 최적화를 향한 여정]]></title><description><![CDATA[…]]></description><link>https://dallog.github.io/jenkins-build-optimization/</link><guid isPermaLink="false">https://dallog.github.io/jenkins-build-optimization/</guid><pubDate>Tue, 09 Aug 2022 01:50:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;문제 상황&lt;/h2&gt;
&lt;p&gt;현재 달록팀 젠킨스 설정상 프론트엔드와 백엔드 배포를 한 인스턴스에서 진행합니다. &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt; 브랜치에 소스코드가 병합되면, 이것이 트리거가 되어 프론트엔드와 백엔드 배포 파이프라인 스크립트가 실행됩니다. 아직 별도로 분기처리는 하지 않아 프론트엔드와 백엔드 배포가 동시에 시작됩니다.&lt;/p&gt;
&lt;p&gt;하지만, 달록팀이 젠킨스를 실행하기 위해 사용하고 있는 EC2 인스턴스는 &lt;strong&gt;t4g.micro&lt;/strong&gt; 입니다. 이 인스턴스는 기본 제공되는 &lt;strong&gt;물리 메모리(RAM)가 1GB&lt;/strong&gt; 가량입니다. 사실 프론트엔드와 백엔드 배포를 동시에 진행하기에는 턱없이 모자란 사양입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d1e2946808d9647938826b197c9ec5cf/f7121/build-9m.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfElEQVQI1yXMTQ6CMBBAYe9/KHZyA/9qhHaUyEzbtEBg+0zq4u1evtMwJXwI9P2ZmCLrsiEp8NArT73jy0BYBmTxyBRwziFvodRCzplSCmrKrDMWjdNxHIgIXdeRcmLf9j9oF5zdGMuLsI4Nnb6f9nrvG1RrxcxQ1VaMkR9u4ZNUmSwhkwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;스프링부트 애플리케이션 빌드에 9분 가량 소요된다&apos; title=&apos;스프링부트 애플리케이션 빌드에 9분 가량 소요된다&apos; src=&apos;/static/d1e2946808d9647938826b197c9ec5cf/ca1dc/build-9m.png&apos; srcset=&apos;/static/d1e2946808d9647938826b197c9ec5cf/e7570/build-9m.png 170w,
/static/d1e2946808d9647938826b197c9ec5cf/f46e7/build-9m.png 340w,
/static/d1e2946808d9647938826b197c9ec5cf/ca1dc/build-9m.png 680w,
/static/d1e2946808d9647938826b197c9ec5cf/f7121/build-9m.png 899w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;스프링부트 애플리케이션 빌드에 9분 가량 소요된다&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;이런 상황에서 프론트엔드와 백엔드 빌드가 각각 10분 가까이 걸리는 경우도 존재하고, 빌드 도중에 아예 서버에 간헐적으로 접속할 수 없게되는 경우도 심심치 않게 목격했습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1fea4fc6515e45e4a1095e351637634c/bb3e3/dead-server.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 64.11764705882354%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABIklEQVQ4y5VTW3KDMAzkIICBAAZj8yykeZUeJX85Q/97k96gF9zaLmYIU5L6Q0ijkda7knBIsEMQxtpMvMzZmqM+PolwvrxDlLWO10U2DzimoW17UMrgugSeH2pg5W1Zz4BxkiEvSjBeQVQtaM7BRQOjwNQ9A54ll1WHYX9Cvz/icBrRdIP0b2DykV1M7RkWEzNeNtpyJpDKEbCi0t4aMJFNXf+Kuh0k2C8rxVwZCSwlmyJeS8B+BG/PyMWAv07q0eZVbgakWaGXksllsMmvG8mTc7oD1LaMF/K22Cnvk1CbyU2AEdJMgDcHRKuNbs1MgcRU4PrxhdvntxzTBZ7n388wjNJ/H7GuiRI9b/EySiKZJuYs6T+SuSXZc335d3nzJfwA9Q1x1PK/4ZsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;서버: 살... 려줘...&apos; title=&apos;서버: 살... 려줘...&apos; src=&apos;/static/1fea4fc6515e45e4a1095e351637634c/ca1dc/dead-server.png&apos; srcset=&apos;/static/1fea4fc6515e45e4a1095e351637634c/e7570/dead-server.png 170w,
/static/1fea4fc6515e45e4a1095e351637634c/f46e7/dead-server.png 340w,
/static/1fea4fc6515e45e4a1095e351637634c/ca1dc/dead-server.png 680w,
/static/1fea4fc6515e45e4a1095e351637634c/02d09/dead-server.png 1020w,
/static/1fea4fc6515e45e4a1095e351637634c/9d567/dead-server.png 1360w,
/static/1fea4fc6515e45e4a1095e351637634c/bb3e3/dead-server.png 1544w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;서버: 살... 려줘...&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;굳이, 서버가 죽지 않더라도 빌드가 트리거되고 끝나기까지는 젠킨스 웹페이지 이동도 어려울 정도로 성능 저하가 극심했습니다.&lt;/p&gt;
&lt;h2&gt;문제 원인 추정&lt;/h2&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/cea48b6b6374d7626ea3b4452810856a/a2e74/cpu-utilization.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtElEQVQoz6WRWQ7DIAxEuf9FWzVfIezYTO00kKh7VaSBwRqeAJvT+YzLNKHWilwKyhNpPcQI5z1CCPAxIco+hIiYEhbnMFsLaxcYZoaO1tpP4hd1k3OGQr8FyQSSfCz0P7DfqlQSMSo9njP6Rwpkboe1+72eBZLvQLrn7daaG0ANlHeqPA6oX58ug1ihe24Ae2Btzvr8TXwTH6T14beVaPfGp4x5tnDSeiut739KREP14D/pCrcEd8O9lH8RAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;빌드 중의 젠킨스 인스턴스 CPU 이용률&apos; title=&apos;빌드 중의 젠킨스 인스턴스 CPU 이용률&apos; src=&apos;/static/cea48b6b6374d7626ea3b4452810856a/ca1dc/cpu-utilization.png&apos; srcset=&apos;/static/cea48b6b6374d7626ea3b4452810856a/e7570/cpu-utilization.png 170w,
/static/cea48b6b6374d7626ea3b4452810856a/f46e7/cpu-utilization.png 340w,
/static/cea48b6b6374d7626ea3b4452810856a/ca1dc/cpu-utilization.png 680w,
/static/cea48b6b6374d7626ea3b4452810856a/02d09/cpu-utilization.png 1020w,
/static/cea48b6b6374d7626ea3b4452810856a/9d567/cpu-utilization.png 1360w,
/static/cea48b6b6374d7626ea3b4452810856a/a2e74/cpu-utilization.png 3026w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;빌드 중의 젠킨스 인스턴스 CPU 이용률&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;일단 먼저 EC2 모니터링 탭에서 CPU 사용량을 살펴보았습니다. 예상은 했지만, CPU 사용량이 문제의 원인은 아니었습니다. 그렇다면 메모리는 어떨까요?&lt;/p&gt;
&lt;p&gt;현재 달록 젠킨스 서버는 물리 메모리 1gb와 스왑 영역으로 확보해둔 가상 메모리 2gb, 더해서 총 &lt;strong&gt;3gb의 메모리로 운용&lt;/strong&gt;되고 있습니다. 이 환경에서 백엔드와 프론트엔드 빌드가 동시에 시작되면 여유 메모리는 어느정도 수준까지 낮아질까요? &lt;code class=&quot;language-text&quot;&gt;free&lt;/code&gt; 명령을 통해 알아 보았습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8592fe8fe170fd39a6d01f18366840dc/80132/lack-of-memory.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZ0lEQVQI1xWLWw6EIAxFG6AUlDI8EhKigoZ/97+8qT83576AR+QnhhHi/B3vGUrct9B7N8YAADOLOudyzt57sSklRBSotcI4BhqUBSHd162Vlm7OqfUHay2lFBGVUiSx1spHEoHW2h+PTQYNg65VhwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;백엔드, 프론트엔드 동시 빌드 중 여유 메모리&apos; title=&apos;백엔드, 프론트엔드 동시 빌드 중 여유 메모리&apos; src=&apos;/static/8592fe8fe170fd39a6d01f18366840dc/ca1dc/lack-of-memory.png&apos; srcset=&apos;/static/8592fe8fe170fd39a6d01f18366840dc/e7570/lack-of-memory.png 170w,
/static/8592fe8fe170fd39a6d01f18366840dc/f46e7/lack-of-memory.png 340w,
/static/8592fe8fe170fd39a6d01f18366840dc/ca1dc/lack-of-memory.png 680w,
/static/8592fe8fe170fd39a6d01f18366840dc/02d09/lack-of-memory.png 1020w,
/static/8592fe8fe170fd39a6d01f18366840dc/80132/lack-of-memory.png 1294w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;백엔드, 프론트엔드 동시 빌드 중 여유 메모리&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;물리 메모리의 여유 공간이 &lt;strong&gt;고작 30~40mb&lt;/strong&gt; 정도의 메모리만 남았습니다. 가상 메모리도 약 &lt;strong&gt;400mb가량&lt;/strong&gt; 남아있는 상황입니다. 상황에 따라 다르겠지만, 메모리가 상당히 부족한 것을 보아 역시 메모리의 문제였던 것 같습니다.&lt;/p&gt;
&lt;p&gt;메모리가 부족한 것이 정확히 어떤 문제를 일으키게 된건지 확실하지는 않지만 &lt;strong&gt;CPU 스레싱&lt;/strong&gt;이 가장 큰 원인이 아닐까 추정됩니다.&lt;/p&gt;
&lt;h3&gt;CPU 스레싱&lt;/h3&gt;
&lt;p&gt;리눅스에서 프로세스가 동작할 때 프로세스 전부를 물리 메모리에 띄우지 않고 &lt;strong&gt;가상 메모리&lt;/strong&gt;라는 곳에 보관합니다. 젠킨스 서버도 스왑 영역을 2gb로 지정해서 이 영역만큼을 가상 메모리로 활용하고 있습니다. 스왑 영역은 하드디스크와 같은 저장장치에 위치합니다.&lt;/p&gt;
&lt;p&gt;CPU가 작업 처리를 위해 특정 데이터를 메모리에 요청을 했는데, CPU가 원하는 데이터가 물리 메모리가 아니라 가상 메모리에 저장되어 있을 수 있습니다. 이런 상황을 &lt;strong&gt;페이지 부재(page fault)&lt;/strong&gt;라고 합니다. 페이지 부재가 발생하면, 스왑 영역에서 물리 메모리로 데이터를 옮겨야 하는 상황, 즉 페이지를 교체해야하는 상황이 발생합니다.&lt;/p&gt;
&lt;p&gt;알다시피 하드디스크와 같은 장비는 I/O 속도가 굉장히 느립니다. 그런데 만약 물리 메모리가 매우 한정되어 있어 페이지 부재가 자주 발생하게 되고, 이런 상황이 반복되어 &lt;strong&gt;CPU가 작업을 처리하는 속도보다 페이지를 교체하는 시간이 훨씬 많이 들것&lt;/strong&gt;입니다. 이런 현상을 &lt;strong&gt;CPU 스레싱(thrashing)&lt;/strong&gt;이라고 합니다.&lt;/p&gt;
&lt;p&gt;달록의 젠킨스 서버도 스레싱 현상이 발생해서 빌드 처리 속도가 극도로 낮아진 것이 아닐까 추정됩니다.&lt;/p&gt;
&lt;h2&gt;문제 해결&lt;/h2&gt;
&lt;p&gt;결국 서버 스펙상 프론트엔드 빌드와 백엔드 빌드가 동시에 실행되어 메모리가 부족해지는 것이 문제라면, 둘을 동시에 실행되지 않게 만들면 손쉽게 문제를 해결할 수 있을것 입니다.&lt;/p&gt;
&lt;h3&gt;젠킨스 노드&lt;/h3&gt;
&lt;p&gt;젠킨스의 &lt;strong&gt;노드(node)&lt;/strong&gt;는 파이프라인 등을 실행할 수 있는 머신을 의미합니다. 노드는 다수의 &lt;strong&gt;실행기(executor)&lt;/strong&gt;를 갖습니다. 노드는 실행기의 수 만큼 동시에 빌드를 실행할 수 있습니다.&lt;/p&gt;
&lt;p&gt;확인해보니 젠킨스에는 기본 노드 1개가 존재했고, 해당 노드에는 실행기가 2개로 설정되어 있었습니다. 이를 1로 변경하여 더이상 병렬적으로 백엔드, 프론트엔드 빌드가 실행되지 않도록 해줍시다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 458px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/9ff0948c5a6d9e5f0c208982f6f68c30/e5e51/number-of-executors.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAx0lEQVQoz6WSzQqEIBSFff9Ha9Emgv6TogYaqMaYMrXOpDPFFLTywKfcxT2eq5J1XWGjaz/RyzAMcBwHURTBdV2EYYiyLBEEAdI0NXscx/B9H57noW1b1PUDRVEcpjvGUAhhmijNTWOSJHg2DaqqQp5lpqaUGnNN3/dgjKHbjK8idyMv+sSbMdWyQEgJKRX4LE78Ekp0L4ZxnDBO3DDxL3v9z8TnAz6fMYZKLWi7bjN8w1ZHwp4NRyobyP5K+k60sS3E9h9e9QFZOb1Dkd18uAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;number of executors&apos; title=&apos;number of executors&apos; src=&apos;/static/9ff0948c5a6d9e5f0c208982f6f68c30/e5e51/number-of-executors.png&apos; srcset=&apos;/static/9ff0948c5a6d9e5f0c208982f6f68c30/e7570/number-of-executors.png 170w,
/static/9ff0948c5a6d9e5f0c208982f6f68c30/f46e7/number-of-executors.png 340w,
/static/9ff0948c5a6d9e5f0c208982f6f68c30/e5e51/number-of-executors.png 458w&apos; sizes=&apos;(max-width: 458px) 100vw, 458px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jenkins 관리 &gt; 노드 관리 &gt; 노드 이름 &gt; 설정 &gt; Number of executors&lt;/strong&gt; 를 1로 설정해줍니다. 이제 병렬적으로 빌드가 트리거되어도 하나의 빌드만 진행되고, 나머지 빌드는 빌드 대기 목록에서 자신의 차례를 기다리게 될 것 입니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/6dbd8030254f5929e4ce3191c0e5b44e/dc057/waiting.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABa0lEQVQoz5VSy27CMBDM/39NT+WCqLiiQBIiEKgqj5YDhOZB3s1rmtliK0JcutLIu2t7vLtjI4oirFYrbDYbbLdb8S3LwvF4RBiGiOMYt9tNQP8ZyOF5nvgGg/V6jf1+j8PhgN1uB9d1ZeVelmVI01SgiIfQhNfvP8KqquRSkiS6ojzPdUwEQQDf99G2LZqmeY40QVPXMPiy4zjS6mKxgGmaEs/nc4mXy6VUzA5oXdfh0bquRfHxjo6E+Ic9I+uTGGaNoiikxbIsQV/FCipH8MwjVP7n7huczWQywWw2w2g0wng8xnQ6lVlyfhz4EGquKqYw5DidTuLLDM/nM669SpfLpYcnIiixhuBZVRn94R5F5GpwLnVdIQoDIVIv+v63qPo4Pz7OaoY5ioH7WRHlGsR4eX2D3X9ox3H79k1YtoM0y/VFdZl/1bZtqUZZ+fWJui9AE5ZVgySvlWja+L8UmSJku5whBdOPcb37vxj/SGZJoBe5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;waiting&apos; title=&apos;waiting&apos; src=&apos;/static/6dbd8030254f5929e4ce3191c0e5b44e/dc057/waiting.png&apos; srcset=&apos;/static/6dbd8030254f5929e4ce3191c0e5b44e/e7570/waiting.png 170w,
/static/6dbd8030254f5929e4ce3191c0e5b44e/f46e7/waiting.png 340w,
/static/6dbd8030254f5929e4ce3191c0e5b44e/dc057/waiting.png 678w&apos; sizes=&apos;(max-width: 678px) 100vw, 678px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;최적화 결과&lt;/h2&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/72bf72b93a500f18d060fef15793ec4b/663f3/super-strong-jenkins.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 61.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC+UlEQVQoz22T/U9TZxTH77/ijzPObIk/bEumyfbTJIYlS5YtjOzFuLhp1DhmiEIEFKW2iAhS+ya9hZaCQMul0NLC3S2DZeBrrfQN3CqUVtEtakVFKR9vr7Is0ZOc5zznnOecnOd7zhHW1tZ4G6+TooTR1x9FvngeSWymxynyYnVV8xUKBdZU1uTrOKF4rDvWjUW9SJ1OFwf3/sic4iI73Q+5PwiKOkxGI28jLeH/DQXN+OqeyWT4YdduTI21ZP7sIxp0cD/i42F0CI/9LPknz7iVjJG4PkV2IU0+/1iLE1bVav6eSzFzKcwV2cP0pKI5ZlNJvijdQVNthZp9gsuDVq4Ot6vSQp+tiTtL93G0GQjZGwg5DIx4uijWIixms7hajnN10ITjVAVndXVawtjMTYzHDzIbdrOcCJKPBXgQ9ROw6wn2XtDejP8mY2w24LXqmJTsLN37ByE+E+WSZKatoYquTgfRGzf+g6BLtHHTb2MlNcriVD/N1Qew1FfQdvokE7+HmZ+f5/K1CCmli8iIqOoLCGMBH/moD6XXzO1MjmQiwfCgl4XbaazdEhfMzURkJ9FQBxOShXNNtQy2G0iMtjPmbsXRcoKV2RCzipNxRUbwuqw8iEj8qwJu1Neg9LQSD7UjO5vYWdXA/l+PUfPpVmoqD3F+3098t3kLA24TLE7yaMZPuKcF5se5PmxjyCchdJjPkJvuZWVOJtjRyHJ8hNX0OIWkn8M6HZXlP5PduIHKze9RsXETlo8+plpvgJSfZ8kgS1e8kJYZVrGNxRMIos1Mbuqi1ski6E/iAa1i0qOc0p9gzxEDRz/4kE9KvuadkjK+/OUYdfZe5E49kk2H2HKSkW4zQ/0uVp6/QEjEY/Rb9epXz9Fnqic+KqoJBwiIerZ+9jmHHH7KdRY2lZTzfun3lFU1ctgu0e12aw0sjk9++Snru6UN9q2/0sQTScZkBdFmwtx6Gq/HQ+k3u/i2rhXdwCTbvtrNu9vLKK9u5IjoI3f33htbUuSX1VwEcBK3ww0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;super strong jenkins&apos; title=&apos;super strong jenkins&apos; src=&apos;/static/72bf72b93a500f18d060fef15793ec4b/663f3/super-strong-jenkins.png&apos; srcset=&apos;/static/72bf72b93a500f18d060fef15793ec4b/e7570/super-strong-jenkins.png 170w,
/static/72bf72b93a500f18d060fef15793ec4b/f46e7/super-strong-jenkins.png 340w,
/static/72bf72b93a500f18d060fef15793ec4b/663f3/super-strong-jenkins.png 650w&apos; sizes=&apos;(max-width: 650px) 100vw, 650px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/9a468224ba0b71aa7f03dc62167574e4/892f1/optimized.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjUlEQVQoz1VRSW4bMRCc/7/F0CVX+5CjjcBIDBkWJGs0CznN5k4OZ1+clnNKgSDIQlezuph9/Y9xHLXWMcZ93+m8bds8z23bLoR1uTP75r5BfPZPs36DBMQej8eiKOhqraWKlBI0zdD3pAwhUJM8z08fp67rsq4f6B3SAAAiKq14w4UAOggU2ujPgr2drreKO2e1McSDAMaZ8z4DE8uqenl5psb7uqtO1m3JU60mVBPoCZuOlbGAjusZackRWFtRjRtsNkwLDUlWyQ/5N6PiQwUDM6vUG+pVQs+4u4qxMZsyu9QLNsQMlR9tplwizzQeDXwXT7pKRdPXVKQWYXYlf/9ij0/qcjRf2lC7u7hmQ3kXh9RTmJQEZbMuq+xElW4slXICuYCcBbIL/HmVeDOLtuRyREi8SbUn26D9+XI5HA4oMfiQq893fDvJ96s7n83HLebVj5/Fw5N4fLYhGGWMsYISA+F9yNZl9t6XZdn3/TROMiDzlGwtImAS2KKructrVdQxtTHEu9pa2ukL/wIxnPO4wdso3AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;optimized&apos; title=&apos;optimized&apos; src=&apos;/static/9a468224ba0b71aa7f03dc62167574e4/ca1dc/optimized.png&apos; srcset=&apos;/static/9a468224ba0b71aa7f03dc62167574e4/e7570/optimized.png 170w,
/static/9a468224ba0b71aa7f03dc62167574e4/f46e7/optimized.png 340w,
/static/9a468224ba0b71aa7f03dc62167574e4/ca1dc/optimized.png 680w,
/static/9a468224ba0b71aa7f03dc62167574e4/02d09/optimized.png 1020w,
/static/9a468224ba0b71aa7f03dc62167574e4/9d567/optimized.png 1360w,
/static/9a468224ba0b71aa7f03dc62167574e4/892f1/optimized.png 1834w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;빌드를 동시에 실행하지 않도록 설정하였을 뿐인데, 빌드 성능이 &lt;strong&gt;10배 가까이 상승&lt;/strong&gt;했습니다. 아주 간단한 설정만 해주었는데 드라마틱하게 성능이 개선되다니 놀랍네요!&lt;/p&gt;
&lt;p&gt;코드가 병합되고 나서 10분은 지나야 빌드가 완료되었다는 알림을 받았었는데, 이제 코드가 병합되고 몇 분내로 프론트엔드와 백엔드 빌드 완료 알림을 받게 되었습니다. 한번에 하나의 빌드만 실행되니 빌드중에도 젠킨스 웹페이지를 접속하는데도 큰 문제가 없게 되었습니다.&lt;/p&gt;
&lt;p&gt;많은 삽질을 했지만 그만큼 재밌던 경험이었습니다. 이만 글 줄이겠습니다!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[테스트 격리]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '매트'가 작성했습니다. 테스트는 독립적이어야 하며 공유 자원을 사용하면 안된다. 격리되지 못한 테스트는 테스트에서 Entity…]]></description><link>https://dallog.github.io/test-isolation/</link><guid isPermaLink="false">https://dallog.github.io/test-isolation/</guid><pubDate>Tue, 09 Aug 2022 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;테스트는 독립적이어야 하며 공유 자원을 사용하면 안된다. 격리되지 못한 테스트는 &lt;a href=&quot;https://dallog.github.io/test-fixture-constant/&quot;&gt;테스트에서 Entity 객체를 상수로 두면 안 되는 이유&lt;/a&gt; 같이 많은 문제를 야기할 수 있다.&lt;/p&gt;
&lt;p&gt;테스트를 격리하는 방법에는 여러가지가 있다. 우리 &lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;달록&lt;/a&gt;에서는 크게 두 가지 방식을 적용해봤고, 각 방식에 대한 장단점을 확인해보려 한다.&lt;/p&gt;
&lt;h2&gt;TRUNCATE&lt;/h2&gt;
&lt;p&gt;테스트 격리에 대한 방식에 대해 알아보기 전에 간단한 SQL 쿼리의 특성에 대해 알아보려 한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt;는  테이블의 모든 행을 삭제하는 &lt;code class=&quot;language-text&quot;&gt;데이터 정의 언어 (Data Definition Language)&lt;/code&gt;이다. &lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;DELETE&lt;/code&gt;와 거의 유사하지만 부분 삭제가 불가능하다. 또한 &lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt;는 테이블 구조를 유지하기 때문에 &lt;code class=&quot;language-text&quot;&gt;모든 행을 삭제하는데 가장 빠르고 효율적인 방법&lt;/code&gt;이 될 수 있다.&lt;/p&gt;
&lt;p&gt;우리는 이러한 특성을 활용하여 테스트 간의 격리를 위해 활용 하였다. 각각의 테스트 이전에 직접 작성한 SQL 스크립트를 통해 매번 테이블을 초기화 하는 방식으로 말이다.&lt;/p&gt;
&lt;p&gt;아래는 테스트 격리를 위한 &lt;code class=&quot;language-text&quot;&gt;truncate.sql&lt;/code&gt;이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;SET&lt;/span&gt; foreign_key_checks &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;TRUNCATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; subscriptions&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;TRUNCATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; categories&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;TRUNCATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; members&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;SET&lt;/span&gt; foreign_key_checks &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;foreign_key_checks&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;MySQL&lt;/code&gt;에서 외래키 제약 조건을 키고 끄기 위한 설정이다. &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;으로 설정하면 제약 조건을 해제하고, &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;로 설정하면 제약 조건을 설정한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;TRUNCATE 테이블명&lt;/code&gt;: 앞서 언급한 것 처럼 테이블 구조를 유지하고 테이블에 모든 행을 삭제한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;방법 1: @Sql(”truncate.sql”)&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Target&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ElementType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TYPE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ElementType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;METHOD&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Retention&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;RetentionPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RUNTIME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Inherited&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Repeatable&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SqlGroup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Sql&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;token annotation punctuation&quot;&gt;@AliasFor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token annotation punctuation&quot;&gt;@AliasFor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scripts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;테스트 클래스&lt;/code&gt;나 &lt;code class=&quot;language-text&quot;&gt;테스트 메서드&lt;/code&gt;에 작성할 수 있는 애노테이션이다. 해당 애노테이션에 SQL 스크립트를 명시하면 메서드 실행 시점에 해당 스크립트가 수행된다.&lt;/p&gt;
&lt;p&gt;아래와 같이 손쉽게 적용할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@SpringBootTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;webEnvironment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SpringBootTest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WebEnvironment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RANDOM_PORT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Sql&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;truncate.sql&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TestConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AcceptanceTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LocalServerPort&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@BeforeEach&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;RestAssured&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;port &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만 이 방식은 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;가 추가될 경우 직접 &lt;code class=&quot;language-text&quot;&gt;truncate.sql&lt;/code&gt; 파일에 접근하여 테이블을 추가해줘야 하는 불편함이 있다.&lt;/p&gt;
&lt;h3&gt;방법 2: EntityManager를 통한 TRUNCATE&lt;/h3&gt;
&lt;p&gt;앞서 언급한 단점을 해결하기 위한 방법이다. &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;를 통해 동적으로 현재 등록된 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;를 조회한 뒤 각각의 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;의 클래스 정보를 활용하여 테이블 이름을 획득한 뒤 쿼리문을 실행하도록 할 수 있다. &lt;/p&gt;
&lt;p&gt;하지만 단순히 Entity의 이름을 가져올 경우 아래와 같이 클래스 이름을 가져올 뿐이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@DataJpaTest&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DatabaseCleanerTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;entities&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMetamodel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEntities&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;EntityType&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;Member
Category
Subscription
Schedule&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만 우리 &lt;code class=&quot;language-text&quot;&gt;달록&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;MySQL&lt;/code&gt;에 &lt;code class=&quot;language-text&quot;&gt;schedule 예약어&lt;/code&gt;로 인해 &lt;code class=&quot;language-text&quot;&gt;schedules&lt;/code&gt;와 같이 복수형으로 표현하기로 통일하였다. 하지만 클래스 이름을 활용하여 다양한 조건을 가진 복수 형태를 만드는 것은 한계가 있었다. 예를 들면 &lt;code class=&quot;language-text&quot;&gt;Member&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;members&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Category&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;categories&lt;/code&gt;와 같이 표현하고 있다.&lt;/p&gt;
&lt;p&gt;우리는 이러한 테이블명은 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt; 클래스에 &lt;code class=&quot;language-text&quot;&gt;@Table&lt;/code&gt; 애노테이션을 통해 명시하기로 약속하였고, 이것을 활용하는 방안을 고민하였다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Table&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;categories&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Entity&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Category&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseEntity&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; MAX_NAME_LENGTH &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Id&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@GeneratedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strategy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GenerationType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IDENTITY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nullable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@ManyToOne&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fetch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FetchType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;LAZY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@JoinColumn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;members_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nullable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해답은 바로 Java의 &lt;code class=&quot;language-text&quot;&gt;Reflection API&lt;/code&gt;를 활용한 방법이다. 아래는 Java의 Reflection을 활용하여 Table 애노테이션에 명시한 name 값을 추출하여 &lt;code class=&quot;language-text&quot;&gt;tableNames&lt;/code&gt;로 활용한 예시이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DatabaseCleaner&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; tableNames&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DatabaseCleaner&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;entityManager &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tableNames &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getMetamodel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEntities&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getJavaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;javaType &lt;span class=&quot;token operator&quot;&gt;-&gt;&lt;/span&gt; javaType&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAnnotation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Table&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Table&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Collectors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createNativeQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SET foreign_key_checks = 0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;executeUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; tableName &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; tableNames&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createNativeQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;TRUNCATE TABLE &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; tableName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;executeUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        entityManager&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createNativeQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SET foreign_key_checks = 1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;executeUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;getMetamodel()&lt;/code&gt;: persistence unit의 메타 모델에 접근하기 위한 &lt;code class=&quot;language-text&quot;&gt;Metamodel&lt;/code&gt; 인터페이스를 반환한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;getEntities()&lt;/code&gt;: metamodel에 Entity Type을 반환한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;getJavaType()&lt;/code&gt;: Java Type을 반환한다. 반환 타입은 &lt;code class=&quot;language-text&quot;&gt;Class&amp;lt;T&gt;&lt;/code&gt;이다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;getAnnotation(Table.class)&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;@Table&lt;/code&gt; 애노테이션을 가져온다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Table::name&lt;/code&gt;: 해당 애노테이션에 명시한 이름 정보를 가져온다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;우리는 이제 작성한 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;의 모든 테이블명을 가지게 되었다. 이제 앞서 작성한 &lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt; 관련 쿼리를 &lt;code class=&quot;language-text&quot;&gt;entityManager&lt;/code&gt;가 실행할 수 있도록 작성 해준다.&lt;/p&gt;
&lt;p&gt;자 이제 우리가 만든 &lt;code class=&quot;language-text&quot;&gt;DatabaseCleaner&lt;/code&gt; 객체를 주입 받아 각각의 메서드 실행 이전에 호출할 수 있도록 개선하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@SpringBootTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;webEnvironment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SpringBootTest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WebEnvironment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RANDOM_PORT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TestConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AcceptanceTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LocalServerPort&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DatabaseCleaner&lt;/span&gt; databaseCleaner&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@BeforeEach&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;RestAssured&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;port &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        databaseCleaner&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@Autowired private DatabaseCleaner databaseCleaner&lt;/code&gt;: 앞서 작성한 &lt;code class=&quot;language-text&quot;&gt;DatabaseCleaner&lt;/code&gt;을 주입 받는다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;databaseCleaner.execute()&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;@BeforeEach&lt;/code&gt;를 통해 각 테스트 메서드가 실행되기 이전에 DB 테이블의 행을 모두 비워준다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이제 우리는 직접 파일을 수정하지 않아도 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;의 추가에 유동적으로 대응할 수 있게 되었다.&lt;/p&gt;
&lt;h2&gt;테스트 격리 방식 비교&lt;/h2&gt;
&lt;p&gt;가장 간편하게 테스트를 격리하는 방법은 각각의 분리된 테스트 마다 Spring Context를 새롭게 로드하는 것이다. &lt;code class=&quot;language-text&quot;&gt;@DirtiesContext&lt;/code&gt;를 활용하면 아래와 같이 적용이 가능하다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@DirtiesContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;classMode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ClassMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BEFORE_EACH_TEST_METHOD&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@SpringBootTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;webEnvironment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SpringBootTest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WebEnvironment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RANDOM_PORT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TestConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AcceptanceTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LocalServerPort&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@BeforeEach&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;RestAssured&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;port &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@DirtiesContext(classMode = ClassMode.BEFORE_EACH_TEST_METHOD)&lt;/code&gt;: 테스트 메서드를 실행하기 전에 context를 새롭게 로드한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;하지만 이 방식은 테스트하는데 매우 오랜 시간이 걸린다. 아래는 &lt;code class=&quot;language-text&quot;&gt;@DirtiesContext&lt;/code&gt;를 적용한 뒤 달록에 있는 테스트를 실행한 것이다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/32176766376fc8ef08ced6942fd06538/8e749/dirties-context.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 8.823529411764705%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAc0lEQVQI1yWOaw7CMAyDdzDEaEmT9KF1pRsw7n8PLys/PsWxIzlTzAs4FZAmcCwQ00EzYqlQy2ZPcCSDxzMYjNvs4YN5xt2RaR1c+dT6jtf2HuzfA5/jh1IbautY+wZnRySKINGK/lwlZLukPHy2Z4h1zBMtM0nxLD6jDwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;dirties context&apos; title=&apos;dirties context&apos; src=&apos;/static/32176766376fc8ef08ced6942fd06538/8e749/dirties-context.png&apos; srcset=&apos;/static/32176766376fc8ef08ced6942fd06538/e7570/dirties-context.png 170w,
/static/32176766376fc8ef08ced6942fd06538/8e749/dirties-context.png 313w&apos; sizes=&apos;(max-width: 313px) 100vw, 313px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이제 위에서 작성한 &lt;code class=&quot;language-text&quot;&gt;DatabaseCleaner&lt;/code&gt;를 활용해보자.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 312px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/29a04ce3a09d476ef117045d2a4a5429/f00bc/database-cleaner.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 8.823529411764705%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcklEQVQI1x2NWRaFIAxDXZkPGQpFRcFp/yvJC3zkpM1pb6baHuStQNcdWzmxHxXKvdQ2ZKyHjwleEhYvcCFiNhaWc8+72yCQpMOndr98vHBeN9rzUS9WgntJ98UFHsYBcoSGlPFjiWEeohKUx+wkskDxB23pSh083bdLAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;database cleaner&apos; title=&apos;database cleaner&apos; src=&apos;/static/29a04ce3a09d476ef117045d2a4a5429/f00bc/database-cleaner.png&apos; srcset=&apos;/static/29a04ce3a09d476ef117045d2a4a5429/e7570/database-cleaner.png 170w,
/static/29a04ce3a09d476ef117045d2a4a5429/f00bc/database-cleaner.png 312w&apos; sizes=&apos;(max-width: 312px) 100vw, 312px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;33 sec&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;10 sec&lt;/code&gt;의 성능 개선을 확인할 수 있었다.&lt;/p&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@DirtiesContext&lt;/code&gt;를 활용한 테스트 격리는 테스트 마다 context를 새롭게 로드하기 때문에 매우 오랜 시간이 걸린다.&lt;/p&gt;
&lt;p&gt;그렇기 때문에 &lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt;를 통해 테스트 격리를 진행하는 것이 더욱 빠른 테스트 피드백을 확인할 수 있다. &lt;code class=&quot;language-text&quot;&gt;@Sql&lt;/code&gt;을 통해 적용할 경우 간편하게 적용이 가능하다. 하지만 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;가 추가될 경우 직접 스크립트 파일에 접근하여 수정해야 하는 단점이 있다. 또한 문자열로 작성되기 때문에 최악의 경우 오타로 인하여 테이블을 찾지 못할 수도 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;를 통해 &lt;code class=&quot;language-text&quot;&gt;TRUNCATE&lt;/code&gt;를 적용할 경우 현재 작성된 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;를 기반으로 명시한 테이블명을 가져온다. 즉 우리가 의도한 테이블명을 그대로 활용할 수 있기 때문에 직접 수정하지 않아도 편리하게 활용할 수 있다.&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://ko.wikipedia.org/wiki/TRUNCATE_(SQL)&quot;&gt;TRUNCATE (SQL)&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/context/jdbc/Sql.html&quot;&gt;Annotation Type Sql&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://www.baeldung.com/java-reflection&quot;&gt;Guide to Java Reflection&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://www.martinfowler.com/eaaCatalog/separatedInterface.htmlhttps://www.martinfowler.com/eaaCatalog/separatedInterface.html&quot;&gt;Separated Interface&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[달록 배포 총🔫정리 3 - SSL 인증서 발급과 NGINX 설정]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. NGINX 설치 NGINX란? 달록 기술블로그 - 리버의 NGINX 란? 설치 SSL 인증서 발급 (with Certbot) Let’s Encrypt 9…]]></description><link>https://dallog.github.io/deploy-full-course3/</link><guid isPermaLink="false">https://dallog.github.io/deploy-full-course3/</guid><pubDate>Mon, 08 Aug 2022 19:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;NGINX 설치&lt;/h2&gt;
&lt;h3&gt;NGINX란?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://dallog.github.io/what_is_nginx/&quot;&gt;달록 기술블로그 - 리버의 NGINX 란?&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;설치&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update &lt;span class=&quot;token comment&quot;&gt;# 운영체제에서 사용 가능한 패키지들과 그 버전에 대한 정보(리스트) 업데이트 &lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; nginx -y &lt;span class=&quot;token comment&quot;&gt;# nginx 설치&lt;/span&gt;
$ nginx -v &lt;span class=&quot;token comment&quot;&gt;# 설치한 nginx 버전 확인&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; nginx status &lt;span class=&quot;token comment&quot;&gt;# nginx 상태 확인&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;SSL 인증서 발급 (with Certbot)&lt;/h2&gt;
&lt;h3&gt;Let’s Encrypt&lt;/h3&gt;
&lt;p&gt;90일짜리 단기 인증서를 무료로 발급해주는 곳입니다. 주기적으로 재발급 해줘야 합니다.&lt;/p&gt;
&lt;h3&gt;Snapd 설치&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://snapcraft.io/docs/installing-snap-on-ubuntu&quot;&gt;snapcraft 공식문서 - Installing snap on Ubuntu&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;certbot은 snapd로 certbot을 설치하는 것을 권장하고 있습니다. 리눅스 통합 패키지 관리 툴인 snapd를 먼저 설치해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; snapd&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Certbot 설치&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://certbot.eff.org/instructions?ws=apache&amp;#x26;os=centosrhel7&quot;&gt;certbot 공식 문서 - certbot 설치&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; snap &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; core&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; snap &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; --classic certbot &lt;span class=&quot;token comment&quot;&gt;# certbot 설치&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ln&lt;/span&gt; -s /snap/bin/certbot /usr/bin/certbot &lt;span class=&quot;token comment&quot;&gt;# certbot 명령어를 사용하기 위해 심볼릭링크 걸기&lt;/span&gt;
$ certbot --version &lt;span class=&quot;token comment&quot;&gt;# 버전 확인&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;SSL 인증서 발급 방법&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://eff-certbot.readthedocs.io/en/stable/using.html#apache&quot;&gt;certbot 공식 문서 - 인증서 발급 방법&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Certbot을 통해 SSL 인증서를 발급받는 방법은 여러가지가 있습니다. 그 중 몇 가지를 간단하게 살펴볼게요. 달록은 Nginx 방법을 사용했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Nginx&lt;/code&gt;&lt;/strong&gt; (우리가 사용한 방법)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인증 및 설치를 위해 nginx 플러그인을 사용한다. nginx에 대한 인증서 취득 및 설치가 자동적으로 이루어진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Webroot&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기능이 동작하고 있는 로컬 웹 서버를 실행 중이라면 웹 서버를 중지하면 안 되는 경우가 있다. 그런 경우 webroot 방식을 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;웹의 디렉토리 내에 인증서의 유효성을 확인할 수 있는 임시 파일을 만들어 인증을 진행한다.&lt;/li&gt;
&lt;li&gt;한 번에 하나의 도메인만 발급 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Standalone&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인증서 발급을 위해 기존의 웹 서버를 중지해야 한다.&lt;/li&gt;
&lt;li&gt;인증을 위해 80 포트로 가상의 standalone 웹서버를 띄워 인증서를 발급한다.&lt;/li&gt;
&lt;li&gt;한 번에 여러 도메인을 발급할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Manual&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;도메인의 유효성 검증을 직접 수행하는 경우 사용한다.&lt;/li&gt;
&lt;li&gt;디렉토리에 특정 이름과 특정 내용을 가진 임시 파일을 만들어야 한다. webroot 방식과 비슷하지만 자동으로 진행되지 않는다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;도메인에 &lt;code class=&quot;language-text&quot;&gt;_acme-challenge&lt;/code&gt; 를 붙인 TXT DNS 레코드를 설정해주어야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 예시&lt;/span&gt;
_acme-challenge.example.com. &lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt; IN TXT &lt;span class=&quot;token string&quot;&gt;&quot;gfj9Xq...Rg85nM&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;인증서 발급하기&lt;/h3&gt;
&lt;p&gt;그럼 이제 Nginx 방법을 사용해서 인증서를 발급받아 보겠습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; certbot certonly --nginx -d &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;도메인 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;certonly&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;자동으로 nginx 설정을 수정하지 않고 인증서만 발급받는 옵셥입니다. 자동으로 어떻게 설정되는지 확실히 알지 못하는 경우엔 certonly로 받는 것이 나을 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;—-nginx&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nginx 방식을 활용하겠다는 의미입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Nginx 설정&lt;/h3&gt;
&lt;p&gt;이제 nginx 설정을 위해서 설정 파일을 생성합니다. &lt;code class=&quot;language-text&quot;&gt;/etc/nginx/conf.d&lt;/code&gt; 디렉토리로 이동하여 &lt;code class=&quot;language-text&quot;&gt;default.conf&lt;/code&gt; 파일을 생성합니다. 꼭 sudo로 명령어를 입력해야 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; /etc/nginx/conf.d
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;vim&lt;/span&gt; default.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;⚠️ 주의: &lt;code class=&quot;language-text&quot;&gt;sites-available&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;sites-enabled&lt;/code&gt; 는 더 이상 사용되지 않는 nginx 설정 방법입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;sites-available&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;sites-enabled&lt;/code&gt; 두 디렉토리는 sym link로 연결되어 있습니다. 기존 방식은 &lt;code class=&quot;language-text&quot;&gt;sites-available&lt;/code&gt;에 여러 설정파일들을 때려 박은 다음에 &lt;code class=&quot;language-text&quot;&gt;sites-enabled&lt;/code&gt;에 원하는 설정을 선택적으로 동기화하는 방식입니다. 이는 비효율적인 방법이므로 더 이상 사용되지 않는다고 합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;따라서 &lt;code class=&quot;language-text&quot;&gt;sites-available&lt;/code&gt; 에 기본 설정 파일이 있다면 제거해줍시다.&lt;/strong&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;default.conf&lt;/code&gt; 파일을 생성했다면 아래와 같이 내용을 적어줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# dallog-frontend /etc/nginx/conf.d/default.conf&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 80 포트로 요청이 오는 경우 https가 적용된 url로 redirect 한다.&lt;/span&gt;
server &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  listen &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  server_name dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token builtin class-name&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;301&lt;/span&gt; https://dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 443 포트로 요청이 오는 경우&lt;/span&gt;
server &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  listen &lt;span class=&quot;token number&quot;&gt;443&lt;/span&gt; ssl http2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  server_name dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token comment&quot;&gt;# SSL 인증을 위한 pem key 위치를 설정한다.&lt;/span&gt;
  ssl_certificate /etc/letsencrypt/live/dallog.me/fullchain.pem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  ssl_certificate_key /etc/letsencrypt/live/dallog.me/privkey.pem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token comment&quot;&gt;# front의 경우 정적 페이지를 보여주기 위해 index.html 위치를 설정한다.&lt;/span&gt;
  location / &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    root /usr/share/nginx/html&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    index index.html&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    try_files &lt;span class=&quot;token variable&quot;&gt;$uri&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$uri&lt;/span&gt;/ /index.html&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# dallog-ws /etc/nginx/conf.d/default.conf&lt;/span&gt;

server &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  listen &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  server_name api.dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token builtin class-name&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;301&lt;/span&gt; https://api.dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

server &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  listen &lt;span class=&quot;token number&quot;&gt;443&lt;/span&gt; ssl http2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  server_name api.dallog.me&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  ssl_certificate /etc/letsencrypt/live/api.dallog.me/fullchain.pem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  ssl_certificate_key /etc/letsencrypt/live/api.dallog.me/privkey.pem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token comment&quot;&gt;# web server의 경우 리버스 프록시를 위한 proxy 설정이 들어간다.&lt;/span&gt;
  location / &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    proxy_pass http://&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;backend-prod server ip&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# backend-prod server ip&lt;/span&gt;
    proxy_set_header Host &lt;span class=&quot;token variable&quot;&gt;$http_host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    proxy_set_header X-Real-IP &lt;span class=&quot;token variable&quot;&gt;$remote_addr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    proxy_set_header X-Forwarded-For &lt;span class=&quot;token variable&quot;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    proxy_set_header X-Forwarded-Proto &lt;span class=&quot;token variable&quot;&gt;$scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;proxy_pass&lt;/code&gt; : 프록시 주소, 백엔드 운영 서버 ip를 넣어준다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;proxy_set_header Host $http_host&lt;/code&gt; : HTTP Request의 Host 헤더 값, 클라이언트가 요청한 원래 호스트 주소&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;X-Real-IP $remote_addr&lt;/code&gt;: 실제 방문자의 원격 ip 주소&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;X-Forwarded-For $proxy_add_x_forwared_for&lt;/code&gt; : 클라이언트가 프록시 처리한 모든 서버의 IP 주소를 포함하는 목록&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;X-forwarded-Proto $scheme&lt;/code&gt; : HTTP의 구조로 http or https를 의미한다. HTTPS 서버 블록 내에서 사용할 경우 프록시 서버의 HTTP 응답이 HTTPS로 변환된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Nginx 설정 이후 재시작&lt;/h3&gt;
&lt;p&gt;설정을 끝냈다면 적용을 위해 Nginx를 재시작 해주어야 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# nginx 재시작, 둘 중 하나 선택&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; nginx reload
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; nginx restart&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;인증서 발급 시 발생할 수 있는 에러&lt;/h2&gt;
&lt;p&gt;인증서 발급 시 발생할 수 있는 에러들을 알아봅시다. 아래 두 가지 에러는 실제로 달록이 SSL 인증서를 발급받는 과정에서 겪은 에러입니다.&lt;/p&gt;
&lt;h3&gt;1. too many failed authorizations recently&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://letsencrypt.org/docs/failed-validation-limit/&quot;&gt;Let&apos;s encrypt 공식 문서 - failed validation limit&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; certbot certonly --nginx -d api.dallog.me

Saving debug log to /var/log/letsencrypt/letsencrypt.log
Requesting a certificate &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; api.dallog.me
An unexpected error occurred:
Error creating new order :: too many failed authorizations recently: see https://letsencrypt.org/docs/failed-validation-limit/
Ask &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;help&lt;/span&gt; or search &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; solutions at https://community.letsencrypt.org. See the logfile /var/log/letsencrypt/letsencrypt.log or re-run Certbot with -v &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;more&lt;/span&gt; details.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 오류는 계정, 호스트 네임, 시간당 5번의 유효성 검사 실패시 발생합니다. 몇 시간(3-4시간 정도) 기다리면 제한이 풀립니다. 그 때 다시 시도하면 됩니다.&lt;/p&gt;
&lt;h3&gt;2. too many certificates&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://letsencrypt.org/docs/duplicate-certificate-limit/&quot;&gt;Let&apos;s encrypt 공식 문서 - duplicate certificate limit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/35e6869a39f68ee5c9daceb01252b1b0/f28c3/error.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 19.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAz0lEQVQY01WQW26DMBBFWUaoQiUamgqKbWzzKgQoLeSpdP+7ublY5KMfR2fsGY899vLrDdl8hpqOSMcZyXCD+PmDGO9I+zNEf4TsT4ibX0RFh9C0eMsPjn014DWrsfm08NMcPu3ZeoSuvqHKAZKoskdM9mWHQBSOLYsX/MT8YxNr5xc2CtYaT+sapWlg9JdD8UZJSzqjNXO5bZ0LesGsWL7SEM1YMB/xjKc4juRYah1NHCak7eS87IludvFzbccLPjjqjk0iNnvnNyxxyDikH7GZgDUmjHZuAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;error&apos; title=&apos;error&apos; src=&apos;/static/35e6869a39f68ee5c9daceb01252b1b0/ca1dc/error.png&apos; srcset=&apos;/static/35e6869a39f68ee5c9daceb01252b1b0/e7570/error.png 170w,
/static/35e6869a39f68ee5c9daceb01252b1b0/f46e7/error.png 340w,
/static/35e6869a39f68ee5c9daceb01252b1b0/ca1dc/error.png 680w,
/static/35e6869a39f68ee5c9daceb01252b1b0/02d09/error.png 1020w,
/static/35e6869a39f68ee5c9daceb01252b1b0/9d567/error.png 1360w,
/static/35e6869a39f68ee5c9daceb01252b1b0/f28c3/error.png 1424w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;문제는 이 두 번째 에러입니다. 이 오류는 주당 5번이라는 인증서 발급 횟수 제한을 넘긴 경우 발생합니다. 이 경우 일주인간 인증서 발급이 제한됩니다(…🥲). 이 오류를 피하기 위해서는 인증서를 재발급 받는 대신 pem key를 복사해서 사용해야 합니다. &lt;strong&gt;재발급은 신중히 받도록 합시다.&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;기타 인증서 관련 명령어&lt;/h2&gt;
&lt;h3&gt;인증서 자동 갱신&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; certbot renew --dry-run&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;인증서 삭제&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ certbot delete --cert-name &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;인증서 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;br&gt;
 
#### reference
&lt;p&gt;&lt;a href=&quot;https://hudi.blog/https-with-nginx-and-lets-encrypt/&quot;&gt;후디 블로그 - Nginx와 Let&apos;s Encrypt로 HTTPS 웹 서비스 배포하기 (feat. Certbot)&lt;/a&gt;
&lt;a href=&quot;https://velog.io/@jihyunhillpark/2.-spring-boot-%EA%B8%B0%EB%B0%98-%EC%95%B1-%EB%B0%B0%ED%8F%AC-Cerbot-%EC%9D%B8%EC%A6%9D%EC%84%9C-%EB%B0%9C%EA%B8%89%EA%B3%BC-SSL-%EC%A0%81%EC%9A%A9&quot;&gt;2. Nginx 설치 부터 spring boot 기반 앱 배포 - Cerbot 인증서 발급과 SSL 적용&lt;/a&gt;
&lt;a href=&quot;https://blog.naver.com/PostView.naver?blogId=kangdydtjs&amp;#x26;logNo=222546308110&amp;#x26;from=search&amp;#x26;redirect=Log&amp;#x26;widgetTypeCall=true&amp;#x26;directAccess=false&quot;&gt;4. SSL 인증서(letsencrypt) 발급&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Special Thanks To &lt;code class=&quot;language-text&quot;&gt;승팡&lt;/code&gt;&lt;/h4&gt;</content:encoded></item><item><title><![CDATA[달록 배포 총🔫정리 2 - EC2와 DNS 설정하기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. 실제 배포 설정 그럼 이제 실제로 어떤 과정을 통해 배포를 진행했는지 자세히 살펴보겠습니다. EC2 생성 EC2 → 인스턴스 → 인스턴스 시작 이름 및 태그 이름: ec2-dallog-XXXX…]]></description><link>https://dallog.github.io/deploy-full-course2/</link><guid isPermaLink="false">https://dallog.github.io/deploy-full-course2/</guid><pubDate>Sun, 07 Aug 2022 23:50:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;실제 배포 설정&lt;/h2&gt;
&lt;p&gt;그럼 이제 실제로 어떤 과정을 통해 배포를 진행했는지 자세히 살펴보겠습니다.&lt;/p&gt;
&lt;h2&gt;EC2 생성&lt;/h2&gt;
&lt;p&gt;EC2 → 인스턴스 → 인스턴스 시작&lt;/p&gt;
&lt;h3&gt;이름 및 태그&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;이름: ec2-dallog-XXXX&lt;/li&gt;
&lt;li&gt;태그: &lt;code class=&quot;language-text&quot;&gt;Role&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;student&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;애플리케이션 및 OS 이미지&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Ubuntu&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;아키텍처: &lt;code class=&quot;language-text&quot;&gt;64비트(Arm)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;인스턴스 유형&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;t4g.micro&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;키 페어&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;key-dallog&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;네트워크 설정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;VPC&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PROJECT&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;보안 그룹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기존 보안 그룹 선택: &lt;code class=&quot;language-text&quot;&gt;SG-PROJECT-DEFAULT&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;탄력적 IP(Elastic IP) 설정&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html&quot;&gt;AWS 공식 문서&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;탄력적 IP란?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;동적 클라우드 컴퓨팅을 위해 고안된 정적 IPv4 주소 (IPv6는 지원X)&lt;/li&gt;
&lt;li&gt;탄력적 IP 주소는 AWS 계정에 할당되며 릴리스할 때까지 할당된 상태로 유지된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;원래 EC2 인스턴스를 생성하면 동적 IP를 할당받습니다. 따라서 인스턴스를 중지했다가 다시 시작하면 IP가 바뀝니다. IP가 계속 바뀌면 배포 설정을 계속해서 바꿔줘야 하겠죠? 탄력적 IP는 고정 IP 주소이기 때문에 인스턴스를 중지했다 재시작해도 IP 주소가 바뀌지 않습니다.&lt;/p&gt;
&lt;h3&gt;설정&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;EC2 → 네트워크 및 보안 → 탄력적 IP → 탄력적 IP 주소 할당&lt;/li&gt;
&lt;li&gt;태그: &lt;code class=&quot;language-text&quot;&gt;Role&lt;/code&gt; - &lt;code class=&quot;language-text&quot;&gt;student&lt;/code&gt; → 할당&lt;/li&gt;
&lt;li&gt;작업 → 탄력적 IP 주소 연결 → 원하는 인스턴스 선택 → 프라이빗 주소 선택 → 연결&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c2f0506d789260103c3cf8ef6984e89d/a82f2/ec2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 48.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVQoz31SCW7CMBDM/z9VDpWqQFFb0hQqyEGEczeXyGXiqZ2EEFTBSiNL1u7M7s5KuqbD0HVYlo1TlqM6M1S05m8LKkApVM3AbrfHXlURxwlEMMZ6XEJayT+YzN/xuZZhEBdeWsGJiwZeUiJIctR1DY0LK4oCWZa5uNUUi/+etFWAlJc1koziUYhCSs94HIKYd7gnGyRp1KjcKA5GKasK8peC8WSC0XiC+XyO9XoN1/VxJDbCKLl2SFl5X7MjFDskfExdN2AYB6iqBtM0QRxO6Cc4eCmysp1AIlyhSRLmHEzYjgvfD3oyNiB+OHCXIy2Xb5hOp3gajbDdbuEHAQixUBTl1cl+S3yfAqwTGuCSIZ1OGT+XDFVF76qe0xiFZ6FOQiBLgZwjDQf4BYv81pTdXkUYRv/PYGBKEbhQ+Lk8z16wXCzwvdnAjXM4UQubn1jmu50plN4c6bCzntBzoHOXldcZtI8V0qOBkhMIFN1Lid4Q/gFxkAEgDTA/8gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;ec2&apos; title=&apos;ec2&apos; src=&apos;/static/c2f0506d789260103c3cf8ef6984e89d/ca1dc/ec2.png&apos; srcset=&apos;/static/c2f0506d789260103c3cf8ef6984e89d/e7570/ec2.png 170w,
/static/c2f0506d789260103c3cf8ef6984e89d/f46e7/ec2.png 340w,
/static/c2f0506d789260103c3cf8ef6984e89d/ca1dc/ec2.png 680w,
/static/c2f0506d789260103c3cf8ef6984e89d/02d09/ec2.png 1020w,
/static/c2f0506d789260103c3cf8ef6984e89d/a82f2/ec2.png 1358w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;도메인(DNS) 설정&lt;/h2&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f6b2c455c49f07417c1fed4552d2352c/650fc/dns.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 23.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVQY02WQWaqFQAxE3f9yVBBB/BL9cQ0KzooDOM91qUALjxcIhKRyujpa13WY5xlt20LF+74oigJZlkn9PI8k6+u6RN/3PeI4xnmespumKe77hnYcB6ZpQl3XaJpGxFwMggC2bcN1XREzCCVgGAbs+y5a9qqqkge4p1G4LAvyPJfctk0Gvu/DsiwYhoEoij4gHRJIjQoaWddV6g9IF2VZygLFnufBNE3ouv4PSDfqBApIhgDZpH3egdY5YC8MQ/mu4zhIkuQPcBzHD8jkA+pnPyMfex5QtHoyAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;dns&apos; title=&apos;dns&apos; src=&apos;/static/f6b2c455c49f07417c1fed4552d2352c/ca1dc/dns.png&apos; srcset=&apos;/static/f6b2c455c49f07417c1fed4552d2352c/e7570/dns.png 170w,
/static/f6b2c455c49f07417c1fed4552d2352c/f46e7/dns.png 340w,
/static/f6b2c455c49f07417c1fed4552d2352c/ca1dc/dns.png 680w,
/static/f6b2c455c49f07417c1fed4552d2352c/02d09/dns.png 1020w,
/static/f6b2c455c49f07417c1fed4552d2352c/9d567/dns.png 1360w,
/static/f6b2c455c49f07417c1fed4552d2352c/650fc/dns.png 1690w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;jenkins.dallog.me&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;달록의 젠킨스 서버&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;allog.dallog.me&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;달록의 프론트 서버 (현재 ssl 인증서 발급 문제로 해당 서브 도메인 사용 중. 추후 dallog.me로 변경 예정)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;api.dallog.me&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;달록의 백엔드 WS 운영 서버&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dev-api.dallog.me&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;달록의 백엔드 개발 서버&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;여기서 잠깐, &lt;code class=&quot;language-text&quot;&gt;TTL&lt;/code&gt;이란?&lt;/h4&gt;
&lt;p&gt;Time To Live. DNS 변경 사항이 적용되기까지 걸리는 시간. 단위는 초.&lt;/p&gt;
&lt;h4&gt;여기서 잠깐, &lt;code class=&quot;language-text&quot;&gt;레코드 타입&lt;/code&gt; 어떻게 다를까?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;A&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;정규화된 도메인 이름/호스트명을 IPv4에 연결한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HOST&lt;/code&gt;: 도메인에 접두사 부여   ex) api.dallog.me&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ANSWER&lt;/code&gt;: IP   ex) 123.456.123.456&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;CNAME&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;실제 호스프명(A 레코드)와 연결되는 별칭 도메인을 정의한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HOST&lt;/code&gt;: 도메인에 접두사 부여   ex) api.dallog.me&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ANSWER&lt;/code&gt;: 연결할 별칭 도메인 정의&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;TXT&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;임의의 문자열로 구성된 값. 소유한 도메인에 TXT 레코드를 추가하여 유효한 도메인인지 판단할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[달록 배포 총🔫정리 1 - 전체적인 구조 살펴보기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. 전체적인 구조 배포 과정을 다루기 전에 전체적인 구조부터 살펴볼게요.  총 5개의 EC2를 사용하고 있습니다. 하나하나 살펴보겠습니다. 1. Jenkins…]]></description><link>https://dallog.github.io/deploy-full-course1/</link><guid isPermaLink="false">https://dallog.github.io/deploy-full-course1/</guid><pubDate>Sun, 07 Aug 2022 23:30:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;전체적인 구조&lt;/h2&gt;
&lt;p&gt;배포 과정을 다루기 전에 전체적인 구조부터 살펴볼게요.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8032293ed234f57ca5e6eed05803ca7e/52c6a/structure.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 64.70588235294117%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQ4y31Si47TMBDM/38CP8A/gEAcx+NUoT7Qcb2emsAJ7lravJw4TuLXsHbSkDaIlSxLs+vZnVkHOIW1sPgbxphRapSx3TH2HzmKYAzqMsHvDy/AWAyWp5B1ScmOuP65QjJ/iefDI3b7CHWVD4Rj0oHQQ0pgfvMKs/UWZZagEhxGS18o02ck4RXWhxW28Tdo2TWzF1MGI8XDNOvlCvPrd1BGQyk5KHWRVzF4w0izpnI9kX0+IREKzvAQPeL2/gFpcqRc7yU91kQUxUtExwWsrCYTursnNP2xMFLQYzeVhmk5vVF+epc3kiwgW3RbdrnevzPCYQJcLNJM8f/FiTToNrhARYazkoNlR1LX+qT4fgMeXSMvCuTJnhZRd3j4Hln4CayoUNDyZNucS+bRDGLzpmslSSJJclFsrtCEHztcKS/T43evIX7MkImEPI/JTzGVHDcpFrvP2CS31LEcNrgTeywJ36b3NCEffoLLrp7eIuVP5LkalhN45SSxJRLW5OC98f6hqlG3RY9XHrc9/iu9Qxh/xfbwBU2TXWyZOrgi14nGgPUPaXvOS92c466ecP9t3GR0W1WPJZ9WbrxMf0Yf1Vo9wf3d13slwz+2+ANsuPR1MeF4qQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;structure&apos; title=&apos;structure&apos; src=&apos;/static/8032293ed234f57ca5e6eed05803ca7e/ca1dc/structure.png&apos; srcset=&apos;/static/8032293ed234f57ca5e6eed05803ca7e/e7570/structure.png 170w,
/static/8032293ed234f57ca5e6eed05803ca7e/f46e7/structure.png 340w,
/static/8032293ed234f57ca5e6eed05803ca7e/ca1dc/structure.png 680w,
/static/8032293ed234f57ca5e6eed05803ca7e/02d09/structure.png 1020w,
/static/8032293ed234f57ca5e6eed05803ca7e/9d567/structure.png 1360w,
/static/8032293ed234f57ca5e6eed05803ca7e/52c6a/structure.png 1452w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;총 5개의 EC2를 사용하고 있습니다. 하나하나 살펴보겠습니다.&lt;/p&gt;
&lt;h3&gt;1. Jenkins&lt;/h3&gt;
&lt;p&gt;젠킨스를 위한 인스턴스입니다. 젠킨스는 설정이 필요한 부분이 많아 도커 위에 젠킨스를 띄워놓았습니다.&lt;/p&gt;
&lt;h3&gt;2. FrontEnd&lt;/h3&gt;
&lt;p&gt;프론트엔드 배포를 위한 인스턴스입니다. 여기선 Nginx가 정적 파일을 처리하는 역할을 합니다.&lt;/p&gt;
&lt;h3&gt;3. BackEnd Dev&lt;/h3&gt;
&lt;p&gt;실제 배포 전 테스트를 위한 백엔드 개발 서버입니다. 한 인스턴스 안에 Nginx와 Spring 함께 넣어두었습니다.&lt;/p&gt;
&lt;h3&gt;4. Web Server&lt;/h3&gt;
&lt;p&gt;리버스 프록시 역할을 하는 Nginx가 있습니다. 프론트엔드에서 받은 요청을 백엔드 서버로 전달합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;리버스 프록시란? &lt;a href=&quot;https://hudi.blog/forward-proxy-reverse-proxy/&quot;&gt;https://hudi.blog/forward-proxy-reverse-proxy/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5. BackEnd Prod&lt;/h3&gt;
&lt;p&gt;운영를 위한 백엔드 서버입니다. WS에서 받은 요청을 실제로 처리하여 응답을 전달합니다.&lt;/p&gt;
&lt;h2&gt;CD 흐름&lt;/h2&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f1cfc5bba6abb2415f50f950868c1293/2637b/cd.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 61.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACHElEQVQoz21TTY/TMBDtf+fMkSsnbkjckPgQEmIPXbUqVYFtl9LS7m6Tpm0Sx4kTJ/7IY+xku1RgyXFmxvPem5lkAFpta90BefgFtf4I1Uiw5ASraxf1MVOmEIu3yOMIPGXIsxTWGnT53R23Bp3RO45LfHjzAovggLoSKMscUnCcEoY02CAdvsTN3WdMH65wYL+JpfaZF4DuUVUVgiAESxOwusV0NMJq9hWKhBdZgs1mizhJYIyGbg2S4tgp09X/Aeu6Bs9zX0ZRcEynMwyH12A8R1MVGI0nRLiDkQJxGeJHeIVal4CW/wL+bXhwShKVRC7oFETCYiIRfdSAl3sw8YBKJgT4VPIjjlfYWkv9Kn2iU3mIQuphAVgFawyklKQwwM/FHLUokKcpMhrauffdZLx1Vtg0ClG0B+cc630GYy+EI6eWzOe3OB6P2N7dQ2pLU7bQWvuz7UEHrW0Rf3qO8u4aOYElhx2xRx6ETV6DT14RSQZ2CmGbwvvT9QT7d8+QkY+TUk73rVF9D92Ud9+gRexZLH2TrSq7fp62tFddRS6mJL0YWFlAhXNIVSDKNxcTH/QNwCqZY7z7gmV8Q4nlucmR2Hn/LBpDuEE8fsw0oE38HZP79xB1SoDyCbBVAoYmpkxDvdPe9n5n07vzKyrJOhV9aaIICHCGgC0RpItLhR7dlel+NReg3U2/B/f+7k5LJXv17j7F/SZCR+7WHwQGmxfHAA+rAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;cd&apos; title=&apos;cd&apos; src=&apos;/static/f1cfc5bba6abb2415f50f950868c1293/ca1dc/cd.png&apos; srcset=&apos;/static/f1cfc5bba6abb2415f50f950868c1293/e7570/cd.png 170w,
/static/f1cfc5bba6abb2415f50f950868c1293/f46e7/cd.png 340w,
/static/f1cfc5bba6abb2415f50f950868c1293/ca1dc/cd.png 680w,
/static/f1cfc5bba6abb2415f50f950868c1293/02d09/cd.png 1020w,
/static/f1cfc5bba6abb2415f50f950868c1293/2637b/cd.png 1356w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CD 흐름은 위와 같습니다. github의 webhook이 merge를 감지하면 젠킨스에 알려줍니다. 흐름은 두 가지 케이스로 나뉩니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;dev 브랜치가 머지된 경우&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;프론트엔드 서버와 백엔드 dev 서버로 빌드된 파일을 보냅니다.&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;main 브랜치가 머지된 경우&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;프론트엔드 서버와 백엔드 prod 서버로 빌드된 파일을 보냅니다.&lt;/p&gt;
&lt;h2&gt;도커를 제거한 이유&lt;/h2&gt;
&lt;p&gt;배포 구조를 개편하면서 젠킨스를 제외한 모든 EC2 인스턴스에서 도커를 제거하였습니다. 도커를 제거한 이유는 크게 두 가지입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;depth가 깊어지면서 관리 포인트가 늘어나고 설정을 수정하기가 과하게 복잡하고 힘들어진다.&lt;/li&gt;
&lt;li&gt;도커 안에 Nginx를 띄우니 EC2가 무거워진다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;도커를 통해 얻을 수 있는 장점보다 단점이 훨씬 뚜렷하여 도커를 제거하였습니다. 필요성을 느껴서 기술을 도입한 것이 아니라 남들 다 하니까, 별 생각 없이 기술을 도입했을 때의 문제점을 절실히 깨달은 순간이었습니다.😅 그래도 이번 기회로 도커를 직접 다뤄보고 장점과 단점을 몸소 느낄 수 있어서 좋았습니다.&lt;/p&gt;
&lt;p&gt;젠킨스의 경우 설정이 복잡하여 도커를 사용하는 것이 오히려 장점이 더 크다고 느껴 도커를 빼지 않았습니다. 추후에 여력이 된다면 백엔드 배포 서버를 여러 개 띄우고 도커 이미지를 통해 동일한 설정으로 관리해보는 것도 좋을 것 같다는 생각이 들었습니다.&lt;/p&gt;
&lt;h2&gt;백엔드 서버와 Web Server를 나눈 이유&lt;/h2&gt;
&lt;p&gt;기존의 백엔드 서버를 개발 서버로 전환하고, 운영 서버를 새로 만들면서 백엔드 서버와 web server를 분리했습니다. 그 이유는 아래와 같습니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 379px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d02189da957e4ec219b29ba3a8254383/0839d/ws.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 128.23529411764707%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAD2ElEQVRIx5VVW3PbVBDOKz+Bf9AZhl/Ab+Cdf8EMwyu88EAfmKEPUBjaZrh0OnTahAIJhU4ntCYlvZDiJEpiObYl2bJ8kWVZtu46Rx97jmQ3lEsczeysjnTO7re73+5ZwRJPnueFZgmQTBHHIcIoQRQLSaWOkxRi28pSBlkm9aRyBe7HF9D97TJaDRX68TNYmoJuU8g+WBqez6BTuQnj/deRqj+9tIH+sxAI7eUMilhk0CwGYhe8/PzI2MBO+26xhVPI4ehsgyJ/8xyyxEc4seS7Fzm4q34J1d594fQshIti8AKT1dGg16sI8wAj3yJ0m9jWv4cb2QjjCUBOVuYI/k/Ew0lpjZoM+VdtDT8Tuoq2jq3mTfxw/AUOrAeSAQuDKA+ewleEUX63bQd2v0NxzxBRvsLMX+z0kgmCRCAcvwhZHEsyhozlYLxANHfBGYOm66LchNABj33w0EMWusiCMX0TaypWSCG7G+/Bv/EmskEVrboCs7FP3DqE2TyAP+5Kg/2eBTcgVM9vYXrlDZiVT9A4+gOa8hCm+pjkCXRlG1kcYMX66h10P3gNbLAnsIBTHng6A88iIOgTU3xorZY0PLq/Cv3dVxErawV6Pu+gmM7NCtqw6RDMbv57mSlffVPH2J0Uy2BCkdQpBalcK4PH2O8/KpnASh7ymFrGg5N40LwmOrM2BoRslLhUtD7arfopBzFy2lvwcIT1w09RtR4WhVsYpNC8qYF17Q4uPv8Qnyuf4drRVdzS12C2VRwd7GEwGKLXH6BRU2Cbqgw3IAC73S1pMGYRmEiRNJgGyIlbuUwJk9648EbrdDZAs35IlefIiAFpNCUUDrZat2WX/HLyDTZr17BRuwqlVyl5mBKfEu+fXVLmcNhrwxm7xTexl7rBjccYBT2kxEch3RnlObAk6SnkEHkwoIFBmqq7EFqDDgmt6QahLkdCnpTkpMJkNCxEqCKHpIscigVBhejFUvKFLpA7IxtDd4akdg/h7bdg/r6KE+UpWgcVdIiDndoTet9GKnj4n4Ph9ICgnLaHE/R+vATj7VcQ/vk1MsHBiFKQpWARdU0wQi5bb97HL0me/72XPT+AcbiLrEkdERa8NKctaO5x6ZmfPWAX46vUht6AP3Pk+5R4+O3eR9gxNokdXOZ0qQF72qAztGDQPBRPTMWqElXEgC3akC0/sRdXAHUV0gkeaN/hfuMGcXAVd44u497JddT6O+TFOx/CnG41ccjyTRgTFVOagR61qDqqokdtK5ix9CW16GUa/TSKxAUDwWHJQ7EW3A2G57v1pF3qlrzkap4UwufcpcL8Bdglw3pbfyEUAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;ws&apos; title=&apos;ws&apos; src=&apos;/static/d02189da957e4ec219b29ba3a8254383/0839d/ws.png&apos; srcset=&apos;/static/d02189da957e4ec219b29ba3a8254383/e7570/ws.png 170w,
/static/d02189da957e4ec219b29ba3a8254383/f46e7/ws.png 340w,
/static/d02189da957e4ec219b29ba3a8254383/0839d/ws.png 379w&apos; sizes=&apos;(max-width: 379px) 100vw, 379px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Nginx 서버를 따로 두면서 리버스 프록시의 장점을 누릴 수 있다.&lt;/li&gt;
&lt;li&gt;추후 백엔드 서버 확장에 유리하다.&lt;/li&gt;
&lt;li&gt;여러 개의 백엔드 서버를 두더라도 https를 위한 ssl 인증서 발급 절차를 web server에서 한 번만 진행해도 된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;현재는 두 개를 나눈 장점을 100% 느낄 수 없지만 앞으로 백엔드 서버를 추가할 경우에 매우 편할 것으로 예상하고 있습니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[젠킨스 파이프라인 스크립트 형상 관리]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 후디가 작성했습니다. 배경 최근 달록팀의 젠킨스 EC…]]></description><link>https://dallog.github.io/jenkins-pipeline-from-scm/</link><guid isPermaLink="false">https://dallog.github.io/jenkins-pipeline-from-scm/</guid><pubDate>Sun, 07 Aug 2022 16:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;배경&lt;/h2&gt;
&lt;p&gt;최근 달록팀의 젠킨스 EC2 인스턴스가 문제가 생겼습니다. 여러 문제가 얽혀서 문제의 원인을 추적하고 해결하는 것 보다 인스턴스를 제거하고 새로 띄워 젠킨스를 다시 설치하는 것이 빠를 것 같았습니다. 다행히 젠킨스 설치 및 초기 세팅에 대한 문서화는 잘 되어 있어서 초기에 젠킨스를 설치한 제가 아니더라도 다른 크루가 쉽게 젠킨스를 셋업할 수 있었습니다.&lt;/p&gt;
&lt;p&gt;하지만, 파이프라인 스크립트에 대한 문서는 꾸준히 갱신되지 않아 파이프라인 스크립트를 다시 작성해야하는 문제가 발생했습니다. 이런 배경에서 젠킨스 파이프라인 스크립트의 형상 관리를 고민하게 되었습니다.&lt;/p&gt;
&lt;h2&gt;젠킨스에서의 형상관리&lt;/h2&gt;
&lt;p&gt;흔히 SCM이라고 불리는 소프트웨어 형상 관리(Software Configuration Management)란 무엇일까요? 형상 관리는 소프트웨어의 변경 사항을 체계적으로 추적하고 통제하는 것을 의미합니다. 현재 가장 많이 사용되는 형상 관리 도구는 Git 입니다. 달록팀의 백엔드, 프론트엔드 코드도 모두 Git으로 형상 관리되고 있습니다.&lt;/p&gt;
&lt;p&gt;그런데, 젠킨스 파이프라인을 형상관리하는 방법은 없을까요? 다행히도 젠킨스는 파이프라인 스크립트의 형상관리를 지원합니다. 형상관리를 함으로써 젠킨스 서버와 독립적으로 파이프라인 스크립트를 관리할 수 있습니다. 또한 젠킨스 파이프라인 스크립트도 버전관리 대상이 됨으로서 문제 발생 시 쉬운 롤백 등의 여러 이점을 가져갈 수 있습니다.&lt;/p&gt;
&lt;p&gt;달록팀이 젠킨스 파이프라인 스크립트를 형상 관리한 방법에 대해 소개드리겠습니다.&lt;/p&gt;
&lt;h3&gt;레포지토리에 파이프라인 스크립트 추가&lt;/h3&gt;
&lt;p&gt;파이프라인 스크립트를 별도의 레포지토리에서 관리할 수도 있겠지만, 달록팀은 프로젝트와 같은 레포지토리에서 관리하도록 결정 하였습니다. 레포지토리의 제일 상위에 &lt;code class=&quot;language-text&quot;&gt;jenkins&lt;/code&gt; 라는 디렉토리를 만들고, 그 하위에 젠킨스 잡(job)별로 파일을 생성하고 파이프라인 스크립트를 작성합니다.&lt;/p&gt;
&lt;p&gt;파일명은 &lt;code class=&quot;language-text&quot;&gt;OOO.jenkinsfile&lt;/code&gt; 으로 통일하였습니다. 예를 들어 백엔드 개발 서버에 대한 파이프라인 스크립트는 &lt;code class=&quot;language-text&quot;&gt;backend-dev.jenkinsfile&lt;/code&gt; 로 명명하였습니다. 파일에는 원래 젠킨스에서 돌아가고 있던 파이프라인 스크립트를 그대로 가져오면 됩니다.&lt;/p&gt;
&lt;h3&gt;환경변수 설정&lt;/h3&gt;
&lt;p&gt;그런데, 원래라면 젠킨스 파이프라인 스크립트가 외부에 노출되지 않았기 때문에 민감한 정보(서버의 IP정보 등)가 그대로 파이프라인 스크립트에 작성되어 있었습니다. 이런 민감한 정보가 외부로 노출되지 않도록 젠킨스의 환경변수로 분리하고, 파이프라인 스크립트에서는 민감한 정보를 젠킨스의 환경 변수에서 가져오도록 해야합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jenkins 관리 &gt; 시스템 설정 &gt; Global properties &gt; Enviroment variables&lt;/strong&gt; 에 민감한 정보를 환경변수로 등록합니다. 그리고 파이프라인 스크립트에서는 아래와 같이 환경변수의 이름을 명시하여 사용합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;stage(&apos;Deploy&apos;) {
    steps {
        dir(&apos;backend/build/libs&apos;) {
            sshagent(credentials: [&apos;key-dallog&apos;]) {
                sh &quot;scp -o StrictHostKeyChecking=no backend-0.0.1-SNAPSHOT.jar ubuntu@${env.BACKEND_DEV_IP}:/home/ubuntu&quot;
                sh &quot;ssh -o StrictHostKeyChecking=no ubuntu@${env.BACKEND_DEV_IP} &apos;sh run.sh&apos; &amp;amp;&quot;
            }
        }
    }
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Pipeline script from SCM&lt;/h3&gt;
&lt;p&gt;형상 관리를 진행할 파이프라인의 &lt;strong&gt;구성&lt;/strong&gt; 메뉴에 진입하고, &lt;strong&gt;Advanced Project Options &gt; Pipeline &gt; Definition&lt;/strong&gt; 에서 &lt;strong&gt;Pipeline script from SCM&lt;/strong&gt;을 선택합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SCM&lt;/strong&gt;에서 &lt;strong&gt;Git&lt;/strong&gt;을 선택하고, &lt;strong&gt;Repositories&lt;/strong&gt; 메뉴에 레포지토리 URL과 자격 증명(Credential), 브랜치 관련 설정을 해줍니다. 달록팀은 레포지토리를 퍼블릭으로 열어두었으므로 별도의 자격 증명 설정은 하지 않았습니다. &lt;strong&gt;Repository browser&lt;/strong&gt;는 자동으로 설정합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Script Path&lt;/strong&gt; 에는 파이프라인 스크립트가 위치한 레포지토리의 경로를 명시하면 됩니다. 백엔드 개발 서버라면 &lt;code class=&quot;language-text&quot;&gt;jenkins/backend-dev.jenkinsfile&lt;/code&gt; 로 입력해두면 됩니다.&lt;/p&gt;
&lt;p&gt;모든 세팅이 끝났습니다. 지금 빌드를 클릭해보면 정상적으로 Git에서 파이프라인 스크립트를 가져와 실행되는 모습을 확인할 수 있을 것 입니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[컴포넌트 분리 기준]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 나인이 작성했습니다. UI가 비슷하면 재사용 초반에 개발을 진행할 때 은 대부분 UI였습니다. "UI…]]></description><link>https://dallog.github.io/seperate-components/</link><guid isPermaLink="false">https://dallog.github.io/seperate-components/</guid><pubDate>Mon, 01 Aug 2022 11:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/jhy979&quot;&gt;나인&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;UI가 비슷하면 재사용&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;초반에 개발을 진행할 때 &lt;code class=&quot;language-text&quot;&gt;재사용의 기준, 컴포넌트의 분리 기준&lt;/code&gt;은 대부분 UI였습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&quot;UI가 비슷하면 분명 재사용될 것이니 이 부분들을 묶어서 컴포넌트화하자!&quot;&lt;/p&gt;
&lt;p&gt;다음은 달록의 카테고리 목록을 조회하는 페이지입니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/efeb82b3-fc46-4acc-b9d3-2df795c0fe51/image.png&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;BE 공식일정 카테고리&lt;/li&gt;
&lt;li&gt;알록달록 팀 회의 카테고리&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;두 카테고리가 매우 흡사하게 생겼죠? 비슷하게 생겼으니 하나의 컴포넌트로 취급하여 사용했습니다. (CategoryItem)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;CategoryItem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; category&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; subscriptionId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; CategoryItemProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ... 생략&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독을 위한 react query&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; mutate&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; postSubscription &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token generic-function&quot;&gt;&lt;span class=&quot;token function&quot;&gt;useMutation&lt;/span&gt;&lt;span class=&quot;token generic class-name&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;
    AxiosResponse&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Pick&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;SubscriptionType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;color&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    AxiosError&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Pick&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;SubscriptionType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;color&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;unknown&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; subscriptionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function-variable function&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CACHE_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SUBSCRIPTIONS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독 해제를 위한 react query&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; mutate&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; deleteSubscription &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useMutation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; subscriptionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; subscriptionId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function-variable function&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CACHE_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SUBSCRIPTIONS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독 해제 로직 &lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;unsubscribe&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;confirm&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CONFIRM_MESSAGE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;UNSUBSCRIBE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;deleteSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독 버튼을 눌렀을 때 구독 여부에 따라 수행해야할 로직 변경&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleClickSubscribeButton&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    subscriptionId &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;unsubscribe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;postSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;categoryItem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;createdAt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        // ⚠️구독 여부에 따른 버튼 스타일링 변경
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SubscribeButton&lt;/span&gt;&lt;/span&gt;
          &lt;span class=&quot;token attr-name&quot;&gt;isSubscribing&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;subscriptionId &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
          &lt;span class=&quot;token attr-name&quot;&gt;handleClickSubscribeButton&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleClickSubscribeButton&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SubscribeButton&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; CategoryItem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;구독 여부에 따라 버튼 스타일링만 다르게 하였고 실제로 큰 문제없이 의도한대로 렌더링되었습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;하지만.. 문제 발생&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;문제는 API를 연동했을 때 발생했습니다. (부끄럽게도 컴포넌트에 많은 고민과 설계 없이 구현한 대가를 치룬 것이죠.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/ebd07538-e6d0-48cf-a43c-e04562ba3b65/image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;BE 공식일정은 이미 구독중인 상태여서 버튼을 누르면 &lt;code class=&quot;language-text&quot;&gt;구독해제&lt;/code&gt; api가 실행되어야합니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/236b2064-2dba-4e75-8130-f4074fe20732/image.png&quot;&gt;
알록달록 팀 회의는 버튼을 누르면 &lt;code class=&quot;language-text&quot;&gt;구독&lt;/code&gt; api가 실행되어야합니다.&lt;/p&gt;
&lt;p&gt;😢 문제는 바로 두 카테고리의 &lt;code class=&quot;language-text&quot;&gt;데이터 스키마가 다르다는 점&lt;/code&gt;이였습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;구독 api&lt;/code&gt;는 구독을 위한 &lt;code class=&quot;language-text&quot;&gt;카테고리 id&lt;/code&gt;가 필요합니다. (애초에 구독을 안했기 때문에 구독 id가 존재할 수 없습니다.)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;구독 해제 api&lt;/code&gt;에서는 카테고리 id가 아닌 구독으로 새롭게 발급된 &lt;code class=&quot;language-text&quot;&gt;구독 id&lt;/code&gt;가 필요합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;구독 여부와 관계없이 하나의 컴포넌트로(CategoryItem) 묶었을 때에는 위 2가지 케이스로 인해 &lt;code class=&quot;language-text&quot;&gt;구독 id&lt;/code&gt;에서 문제가 발생합니다. &lt;/p&gt;
&lt;p&gt;하나의 컴포넌트로 묶었기 때문에 구독id가 존재하든 존재하지 않든 subscriptionId라는 필드가 반드시 존재해야합니다.&lt;/p&gt;
&lt;p&gt;😱 요리조리 머리를 굴려 &lt;code class=&quot;language-text&quot;&gt;구독하지 않았을 때에는 구독 id를 -1로 할당했습니다.&lt;/code&gt;
(아마 위의 코드를 읽으시면서 subscriptionId &gt; 0인 경우 구독 중이라고 판단하는 로직을 어색하게 느끼셨을 겁니다.)&lt;/p&gt;
&lt;p&gt;물론 실제 DB에서 구독 id에 -1이 할당되는 경우는 없기 때문에 큰 문제는 아닐 수 있습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;새로운 컴포넌트의 분리기준: 데이터 스키마, 모델&lt;/h2&gt;
&lt;p&gt;하지만 태초에 &quot;이런 컴포넌트 설계가 맞을까?&quot; 라는 생각이 들었고 팀 회의를 통해 컴포넌트의 분리 기준을 &lt;code class=&quot;language-text&quot;&gt;✨데이터 스키마와 모델✨&lt;/code&gt;에 초점을 맞추는 방향으로 바꾸었습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;즉, 구독 중인 카테고리와 구독하지 않은 카테고리는 구독id의 존재 여부가 다르기 때문에 데이터 스키마가 다르다고 말할 수 있겠습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;따라서, 구독 중인 카테고리 컴포넌트와 구독하지 않은 카테고리 컴포넌트 2가지 컴포넌트로 분리하였습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;실제 코드를 볼까요?&lt;/p&gt;
&lt;h3&gt;👇 구독하지 않은 컴포넌트 (UnsubscribedCategoryItem)&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/236b2064-2dba-4e75-8130-f4074fe20732/image.png&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;구독 id가 없습니다.&lt;/li&gt;
&lt;li&gt;구독 react query가 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// ⚠️subscriptionId를 아예 받지 않음&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;UnsubscribedCategoryItem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; category &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; UnsubscribedCategoryItemProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ... 생략&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독을 위한 react query&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; mutate &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token generic-function&quot;&gt;&lt;span class=&quot;token function&quot;&gt;useMutation&lt;/span&gt;&lt;span class=&quot;token generic class-name&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;
    AxiosResponse&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Pick&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;SubscriptionType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;color&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    AxiosError&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Pick&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;SubscriptionType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;color&apos;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;unknown&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; subscriptionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function-variable function&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CACHE_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SUBSCRIPTIONS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️오직 한 가지 일만 담당하는 핸들러 함수&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleClickSubscribeButton&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;mutate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;categoryItem&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;createdAt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Button&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;cssProp&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;subscribeButton&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleClickSubscribeButton&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
          구독
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Button&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h3&gt;👇 구독중인 컴포넌트 (SubscribedCategoryItem)&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/ebd07538-e6d0-48cf-a43c-e04562ba3b65/image.png&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;구독 id가 있습니다.&lt;/li&gt;
&lt;li&gt;구독 해제 react query가 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;SubscribedCategoryItem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; category&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; subscriptionId &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; SubscribedCategoryItemProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ... 생략&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// ⚠️구독 해제를 위한 react query&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; mutate &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useMutation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; subscriptionApi&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; subscriptionId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function-variable function&quot;&gt;onSuccess&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CACHE_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SUBSCRIPTIONS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ⚠️오직 한 가지 일만하는 핸들러 함수&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleClickUnsubscribeButton&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;confirm&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CONFIRM_MESSAGE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;UNSUBSCRIBE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;mutate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;categoryItem&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;createdAt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Button&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;cssProp&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;unsubscribeButton&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleClickUnsubscribeButton&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
          구독중
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Button&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h3&gt;마무리&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;어떤가요?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;💪 subscriptionId가 필요하지 않은 경우에는 애초에 props로 들어가지 않기 때문에 &lt;code class=&quot;language-text&quot;&gt;subscriotionId가 -1이 되는 경우가 없습니다.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;또한 react query와 관련된 로직들은 어떠한가요? &lt;/p&gt;
&lt;p&gt;💪 관심사 분리가 적절히 이루어져 각 컴포넌트에서 알맞게 호출되고 있습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;UI를 기준으로 컴포넌트를 나누는 것도 좋지만 먼저 데이터 스키마에 따라 컴포넌트를 분리하는 것을 먼저 고려해보면 더 좋을 것이라고 이번 리팩토링을 통해 느끼게 되었습니다.&lt;/p&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[React-Query에서의 데이터 최신화 (Query Invalidation)]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 나인이 작성했습니다. React-Query의 캐싱개념은 stale과 cacheTime을 통해 이루어집니다. Stale 사전적 의미로 '신선하지 않은' 입니다. react query는 기본적으로 캐싱된 데이터를 stale…]]></description><link>https://dallog.github.io/query-invalidation/</link><guid isPermaLink="false">https://dallog.github.io/query-invalidation/</guid><pubDate>Mon, 01 Aug 2022 10:15:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/jhy979&quot;&gt;나인&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;React-Query의 캐싱개념은 stale과 cacheTime을 통해 이루어집니다.&lt;/p&gt;
&lt;h2&gt;Stale&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;사전적 의미로 &apos;신선하지 않은&apos; 입니다. react query는 기본적으로 캐싱된 데이터를 stale하다고 생각합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;react query에서는 stale time의 default이 0입니다. (즉, 캐싱이 되지 않는다고 볼 수 있겠죠?)&lt;/p&gt;
&lt;h3&gt;staleTime&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;데이터가 fresh한 상태에서 stale한 상태로 변하는 시간입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;fresh 상태일때는 쿼리 인스턴스가 새롭게 mount 되어도 fetch가 일어나지 않습니다. &lt;/li&gt;
&lt;li&gt;데이터가 fetch 되고 나서 staleTime이 지나지 않았다면 unmount 후 mount 되어도 fetch가 일어나지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;cacheTime&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;데이터가 inactive 상태일 때 캐싱된 상태로 남아있는 시간입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;쿼리 인스턴스가 unmount 되면 데이터는 inactive 상태로 변경되며, 캐시는 cacheTime만큼 유지됩니다.&lt;/li&gt;
&lt;li&gt;cacheTime은 staleTime과 관계없이, 무조건 &lt;code class=&quot;language-text&quot;&gt;inactive된 시점&lt;/code&gt;을 기준으로 캐싱을 결정합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2&gt;달록에서의 데이터 최신화&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;달록은 일정, 카테고리, 구독 등의 작업으로 인해 데이터의 변화가 잦은 어플리케이션입니다. 따라서 저희 팀은 staleTime을 지정해주지 않았습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇다면 stale한 데이터는 늘 최신화가 필요할 것입니다.&lt;/p&gt;
&lt;p&gt;그래서 저는 매번 새로운 데이터가 필요할 때마다 &lt;code class=&quot;language-text&quot;&gt;useQuery의 refetch&lt;/code&gt;를 강제적으로 실행시켜주는 방식을 생각했었습니다.&lt;/p&gt;
&lt;p&gt;예를 들면 일정을 추가(post)한 후에 일정을 다시 조회(get)하는 경우가 있을겁니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/287f66a2-8b7e-49c8-b623-c05a491db600/image.png&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// refetch 함수를 부모로 부터 주입 받아야 합니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ScheduleAddModal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; closeModal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; refetch &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ScheduleAddModalProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;onSuccessPostSchedule&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;refetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;😢 하지만 이 방식이 우아하지는 않더라구요. &lt;/p&gt;
&lt;p&gt;만약 부모와 자식 간의 props전달이 아니라 조부모와 자식 간의 props 전달이라면 어떨까요? 벌써 머리가 아파옵니다. (props hell)&lt;/p&gt;
&lt;h2&gt;Query Invalidation 도입&lt;/h2&gt;
&lt;p&gt;🤔 다른 방법이 있을텐데.. 어떤 방법이 있을까? 고민하며 공식문서를 읽던 도중 &lt;code class=&quot;language-text&quot;&gt;Query Invalidation&lt;/code&gt;을 발견하게 되었습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Invalidate every query in the cache&lt;/span&gt;
queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Invalidate every query with a key that starts with `todos`&lt;/span&gt;
queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;todos&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;The QueryClient has an invalidateQueries method that lets you intelligently mark queries as stale and potentially refetch them too!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;❗ 캐싱키로 관련된 stale 쿼리들을 체크하고 refetch할 수 있는 메서드가 존재했습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ScheduleAddModal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; closeModal &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ScheduleAddModalProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; queryClient &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useQueryClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;onSuccessPostSchedule&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 일정 post 성공 시 데이터 최신화를 invalidateQueries메서드를 통해 수행합니다.&lt;/span&gt;
    queryClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;invalidateQueries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CACHE_KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SCHEDULES&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;💪 이로써 useQuery의 refetch함수를 넘겨줄 필요없이 어디서든 캐싱키로 fresh한 데이터를 보장할 수 있게 되었습니다.&lt;/p&gt;
&lt;h4&gt;참고자료&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://tanstack.com/query/v4/docs/guides/query-invalidation&quot;&gt;https://tanstack.com/query/v4/docs/guides/query-invalidation&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[통합 테스트와 슬라이스 테스트]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '매트'가 작성했습니다. @SpringBootTest…]]></description><link>https://dallog.github.io/integration-test-slice-test/</link><guid isPermaLink="false">https://dallog.github.io/integration-test-slice-test/</guid><pubDate>Mon, 01 Aug 2022 09:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;@SpringBootTest&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@SpringBootTest&lt;/code&gt; 애노테이션을 사용하면 우리 애플리케이션에서 사용하고 있는 모든 빈을 등록한 뒤 간편하게 테스트를 진행한다. 하지만 모든 빈을 등록하기 때문에 아래와 같은 단점을 가질 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모든 빈들을 등록하기 때문에 비교적 오랜 시간이 걸린다.&lt;/li&gt;
&lt;li&gt;모든 빈들을 등록하기 때문에 의존성을 고려하지 않고 테스트를 진행할 수 있다. 즉 테스트 하고자 하는 객체의 의존성을 무시한채 테스트하게 된다.&lt;/li&gt;
&lt;li&gt;도메인 혹은 영속 계층의 경우 application 계층, presentation 계층에 대해 의존하지 않기 때문에 필요 없는 리소스에 대한 소모가 늘어난다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이러한 &lt;code class=&quot;language-text&quot;&gt;@SpringBootTest&lt;/code&gt;는 모든 빈을 등록한 채 테스트를 진행하는 &lt;code class=&quot;language-text&quot;&gt;통합 테스트&lt;/code&gt;에 적합한 애노테이션이다.&lt;/p&gt;
&lt;p&gt;아래는 실제 프로젝트에 작성한 테스트 중 일부를 가져온 것이다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@SpringBootTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;webEnvironment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SpringBootTest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WebEnvironment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RANDOM_PORT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TestConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AcceptanceTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LocalServerPort&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DatabaseCleaner&lt;/span&gt; databaseCleaner&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@BeforeEach&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setUp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;RestAssured&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;port &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; port&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        databaseCleaner&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;구독 관련 기능&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;TestConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SubscriptionAcceptanceTest&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AcceptanceTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;인증된 회원이 카테고리를 구독하면 201을 반환한다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; 인증된_회원이_카테고리를_구독하면_201을_반환한다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; accessToken &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 자체_토큰을_생성하고_토큰을_반환한다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;GOOGLE_PROVIDER&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 인증_코드&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;CategoryResponse&lt;/span&gt; 공통_일정 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 새로운_카테고리를_등록한다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 공통_일정_생성_요청&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// when&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;ExtractableResponse&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestAssured&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;oauth2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;contentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON_VALUE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;빨간색_구독_생성_요청&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;when&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/members/me/categories/{categoryId}/subscriptions&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 공통_일정&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;statusCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;HttpStatus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CREATED&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// then&lt;/span&gt;
        상태코드_201이_반환된다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;인수 테스트의 경우 사용자의 시나리오에 맞춰 수행하는 테스트이기 때문에 실제 운영 환경과 유사하게 테스트를 진행해야 한다. 그렇기 때문에 슬라이스 테스트를 진행하는 것 보다 모든 빈들을 등록하여 시나리오를 적절히 수행하는지 집중해야 하기 때문에 &lt;code class=&quot;language-text&quot;&gt;@SpringBootTest&lt;/code&gt;를 활용한 통합 테스트를 진행해야 한다.&lt;/p&gt;
&lt;h2&gt;슬라이스 테스트&lt;/h2&gt;
&lt;p&gt;앞서 언급한 것 처럼 특정 계층은 다른 계층에 의존하지 않기 때문에 필요한 빈들만 주입받아 독립적으로 테스트할 수 있다. 이렇게 계층별로 필요한 빈들만 주입받기 위해서 Spring은 슬라이스 테스트관련 애노테이션을 제공한다.&lt;/p&gt;
&lt;p&gt;슬라이스 테스트란? 레이어를 독립적으로 테스트하기 위해 필요한 빈들만 주입 받아 테스트를 진행하는 것을 의미한다.. 슬라이스 테스트를 적절히 활용하면 모든 빈들을 ApplicationContext에 등록하지 않기 때문에 보다 더 호율적으로 테스트가 가능하다.&lt;/p&gt;
&lt;h3&gt;@WebMvcTest&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@WebMvcTest&lt;/code&gt;는 웹 계층 테스트를 위해 필요한 빈들이 주입된다. 주입 되는 빈의 항목은 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@Controller&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@ControllerAdvice&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@JsonComponent&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Converter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Filter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;WebMvcConfigurer&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HandlerMethodArgumentResolver&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MockMvc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;등&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래는 실제 프로젝트에 작성한 테스트 중 일부를 가져온 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureRestDocs&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@WebMvcTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SubscriptionController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SubscriptionControllerTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; AUTHORIZATION_HEADER_NAME &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Authorization&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; AUTHORIZATION_HEADER_VALUE &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Bearer aaaaa.bbbbb.ccccc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MockMvc&lt;/span&gt; mockMvc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@MockBean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; authService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@MockBean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SubscriptionService&lt;/span&gt; subscriptionService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;회원과 카테고리 정보를 기반으로 구독한다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; 회원과_카테고리_정보를_기반으로_구독한다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;CategoryResponse&lt;/span&gt; 공통_일정_응답 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 공통_일정_응답&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;관리자_응답&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;SubscriptionResponse&lt;/span&gt; 빨간색_구독_응답 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 빨간색_구독_응답&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;공통_일정_응답&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token function&quot;&gt;given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;authService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;extractMemberId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;willReturn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;매트_응답&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;subscriptionService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;willReturn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;빨간색_구독_응답&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// when &amp;amp; then&lt;/span&gt;
        mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/members/me/categories/{categoryId}/subscriptions&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 빨간색_구독_응답&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AUTHORIZATION_HEADER_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; AUTHORIZATION_HEADER_VALUE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;contentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;objectMapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;빨간색_구독_생성_요청&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;subscription/save&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;preprocessRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;prettyPrint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;preprocessResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;prettyPrint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;pathParameters&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;parameterWithName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;categoryId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;카테고리 id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;requestHeaders&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;headerWithName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Authorization&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;JWT 토큰&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;requestFields&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;fieldWithPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;color&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonFieldType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;STRING&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;구독 색 정보&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isCreated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;컨트롤러 테스트의 경우 실제 동작하는 로직을 활용하는 것 보다 API의 문서화에 집중했기 때문에 웹 계층에 대한 의존성만 추가한 뒤 의존하는 객체는 Mocking을 통해 진행하였다.&lt;/p&gt;
&lt;h3&gt;@DataJpaTest&lt;/h3&gt;
&lt;p&gt;Spring Data JPA를 사용하고 있다면 테스트하기 위해 간단히 &lt;code class=&quot;language-text&quot;&gt;@DataJpaTest&lt;/code&gt;를 활용할 수 있다. &lt;code class=&quot;language-text&quot;&gt;@Entity&lt;/code&gt; 객체, &lt;code class=&quot;language-text&quot;&gt;JpaRepository&lt;/code&gt; 등 JPA 사용에 필요한 빈들을 등록하여 테스트할 때 사용한다. 아래는 실제 &lt;code class=&quot;language-text&quot;&gt;@DataJpaTest&lt;/code&gt;의 코드를 가져온 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Target&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ElementType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TYPE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Retention&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;RetentionPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RUNTIME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Inherited&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@BootstrapWith&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DataJpaTestContextBootstrapper&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@ExtendWith&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SpringExtension&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@OverrideAutoConfiguration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;enabled &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@TypeExcludeFilters&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DataJpaTypeExcludeFilter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureCache&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureDataJpa&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureTestDatabase&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureTestEntityManager&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@ImportAutoConfiguration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataJpaTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;주의 깊게 봐야할 애노테이션들이 많다. 몇 가지 예시로 &lt;code class=&quot;language-text&quot;&gt;@AutoConfigureTestDatabase&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;@Transactional&lt;/code&gt;에 대해 간단히 살펴보자.&lt;/p&gt;
&lt;h4&gt;@AutoConfigureTestDatabase&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureTestDatabase&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataJpaTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;애플리케이션에 정의되어 있거나 자동으로 설정된 DataSoruce를 대신하여 테스트용 DB를 정의할 때 사용된다. 아래 실제 코드를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Target&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ElementType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TYPE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ElementType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;METHOD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Retention&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;RetentionPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RUNTIME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Inherited&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@ImportAutoConfiguration&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@PropertyMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;spring.test.database&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AutoConfigureTestDatabase&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;token annotation punctuation&quot;&gt;@PropertyMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;skip &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SkipPropertyMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ON_DEFAULT_VALUE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token class-name&quot;&gt;Replace&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ANY&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token class-name&quot;&gt;EmbeddedDatabaseConnection&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EmbeddedDatabaseConnection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NONE&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Replace&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
		ANY&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		AUTO_CONFIGURED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
		NONE
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;replace()&lt;/code&gt;:  대체할 수 있는 기존 DataSource 빈의 유형을 결정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Replace.ANY&lt;/code&gt;: 자동 구성 또는 수동 정의의 여부에 상관 없이 DataSource를 교체한다. default 설정 이기 때문에 &lt;code class=&quot;language-text&quot;&gt;@DataJpaTest&lt;/code&gt;를 사용하면 기본적으로 &lt;code class=&quot;language-text&quot;&gt;in-memory embedded database&lt;/code&gt;를 활용한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Replace.AUTO_CONFIGURED&lt;/code&gt;: 자동 설정된 경우에만 DataSource를 교체한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Replace.NONE&lt;/code&gt;: 기본 DataSource를 교체하지 않는다. 즉 우리가 직접 빈으로 등록하거나 명시한 DataSource를 사용한다. 만약 &lt;code class=&quot;language-text&quot;&gt;in-memory embedded database&lt;/code&gt;가 아닌 외부 DB나 테스트 용 DB를 사용하고 싶다면 &lt;code class=&quot;language-text&quot;&gt;@AutoConfigureTestDatabase(replace = Replace.NONE)&lt;/code&gt;으로 설정을 덮어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;@Transactional&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataJpaTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;앞서 언급한 것 처럼 &lt;code class=&quot;language-text&quot;&gt;@DataJpaTest&lt;/code&gt;는 기본적으로 &lt;code class=&quot;language-text&quot;&gt;@Transactional&lt;/code&gt; 애노테이션을 들고 있기 때문에 테스트가 완료되면 자동으로 롤백된다.&lt;/p&gt;
&lt;p&gt;아래는 실제 프로젝트를 진행하며 작성한 테스트 코드의 일부를 가져온 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@DataJpaTest&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JpaConfig&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ScheduleRepositoryTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ScheduleRepository&lt;/span&gt; scheduleRepository&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;시작일시와 종료일시를 전달하면 그 사이에 해당하는 일정을 조회한다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; 시작일시와_종료일시를_전달하면_그_사이에_해당하는_일정을_조회한다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;Schedule&lt;/span&gt; schedule1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Schedule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TITLE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MEMO&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;Schedule&lt;/span&gt; schedule2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Schedule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TITLE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; MEMO&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        scheduleRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;schedule1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        scheduleRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;schedule2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// when&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Schedule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; schedules &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; scheduleRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findByBetween&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;START_DAY_OF_MONTH&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; END_DAY_OF_MONTH&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// then&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;schedules&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hasSize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;p&gt;이 밖에도 &lt;code class=&quot;language-text&quot;&gt;@JdbcTest&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;@DataMongoTest&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;@RestClientTest&lt;/code&gt; 등 다양한 슬라이스 테스트를 위한 애노테이션이 제공된다. 어떠한 애노테이션을 사용하는 것에 집중하기 보다 &lt;code class=&quot;language-text&quot;&gt;테스트의 목적&lt;/code&gt;에 대해 고민해야 한다. 테스트하고자 하는 것에 집중하여 의존하거나 필요한 빈들에 대해 고민한 뒤 적절한 애노테이션을 적용하면 불필요한 리소스를 줄일 수 있으며 보다 더 빠른 테스트 피드백을 확인할 수 있을 것이라 판단한다.&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://meetup.toast.com/posts/124&quot;&gt;Spring Boot Test&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing&quot;&gt;8. Testing&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://tecoble.techcourse.co.kr/post/2021-05-18-slice-test/&quot;&gt;Spring Boot 슬라이스 테스트&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[SSL을 통한 HTTPS통신 과정]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '리버'가 작성했습니다. 글을 쓰게 된 계기 우아한테크코스 레벨3 프로젝트를 진행하면서 클라이언트와 서버의 통신에 SSL 인증서를 적용하여 HTTPS 통신을 하도록 하였다.
HTTPS…]]></description><link>https://dallog.github.io/ssl_protocol/</link><guid isPermaLink="false">https://dallog.github.io/ssl_protocol/</guid><pubDate>Sun, 31 Jul 2022 16:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/gudonghee2000&quot;&gt;리버&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;글을 쓰게 된 계기&lt;/h2&gt;
&lt;p&gt;우아한테크코스 레벨3 프로젝트를 진행하면서 클라이언트와 서버의 통신에 SSL 인증서를 적용하여 HTTPS 통신을 하도록 하였다.
HTTPS의 통신과정에 대한 이해를 공유하기 위해 글을 작성하고자 한다.&lt;/p&gt;
&lt;h2&gt;HTTPS&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;HTTPS&lt;/code&gt;는 SSL(Secure Sokect Layer) 위에 &lt;code class=&quot;language-text&quot;&gt;HTTP&lt;/code&gt;를 얹어서 보안이 보장된 통신을 하고자하는 프로토콜이다.&lt;/p&gt;
&lt;h2&gt;SSL 인증서&lt;/h2&gt;
&lt;p&gt;클라이언트와 웹 서버간의 통신을 제3자가 보증해주는 전자문서이다.
클라이언트가 서버에 접속한 직후에 서버는 클라이언트에게 &lt;code class=&quot;language-text&quot;&gt;SLL 인증서&lt;/code&gt;를 전달한다.
클라이언트는 신뢰 할 수 있는 인증서인지 검증한 후 서버와 통신을 진행한다.
(밑에서 자세히 설명)&lt;/p&gt;
&lt;h2&gt;SSL 인증서 사용이유&lt;/h2&gt;
&lt;p&gt;왜 HTTP 통신에 굳이 SSL 인증 과정을 붙혓을까? 이유는 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;통신 내용이 악의적인 목적을 가진 사람에게 노출되는 것 을 막을 수 있다.&lt;/li&gt;
&lt;li&gt;클라이언트가 접속하는 서버가 신뢰할 수 있는 서버인지 판단 할 수 있다.&lt;/li&gt;
&lt;li&gt;통신 내용의 악의적인 변경을 방지 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;SSL 통신과정은 꽤나 복잡하다.
그래서 SSL 프로토콜을 이해하려면 우선 &lt;code class=&quot;language-text&quot;&gt;암호화/복호화&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;키(대칭키, 공개키)&lt;/code&gt;에 대해 이해할 필요가 있다.&lt;/p&gt;
&lt;h2&gt;암호화, 복호화, 키&lt;/h2&gt;
&lt;p&gt;어떤 정보를 외부에 노출시키지 않기 위해 변형하는 것을 &lt;code class=&quot;language-text&quot;&gt;암호화&lt;/code&gt; 라고한다.
반대로 암호화된 데이터를 원본으로 복원하는것을 &lt;code class=&quot;language-text&quot;&gt;복호화&lt;/code&gt;라고 한다.
암호화와 복호화에서 데이터 변형을 위해 사용하는것을 &lt;code class=&quot;language-text&quot;&gt;키&lt;/code&gt;라고 한다.&lt;/p&gt;
&lt;p&gt;이렇게 키를 사용하여 &lt;code class=&quot;language-text&quot;&gt;암호화/복호화&lt;/code&gt; 하는 방식에는 &lt;code class=&quot;language-text&quot;&gt;대칭키 방식&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;이 있다.
두 방식 모두 &lt;code class=&quot;language-text&quot;&gt;SSL 통신&lt;/code&gt;에 사용되기 때문에 이해할 필요가 있다.&lt;/p&gt;
&lt;h2&gt;대칭키 방식&lt;/h2&gt;
&lt;p&gt;대칭키는 동일한 키로 &lt;code class=&quot;language-text&quot;&gt;암호화&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;복호화&lt;/code&gt;를 같이 할 수 잇는 방식의 암호화 기법을 의미한다.
&lt;code class=&quot;language-text&quot;&gt;암호화&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;복호화&lt;/code&gt;를 위해 양쪽이 같은 키를 가져야 한다는 점에서 이 키를 &lt;code class=&quot;language-text&quot;&gt;대칭키&lt;/code&gt;라고 한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/01b1f9b4-66ed-46d6-87d4-b18948611b80/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;전쟁상황을 가정해서 살펴보자. &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;이 전쟁 중일 때, 적군에게 정보를 노출하지 않으려면 &lt;code class=&quot;language-text&quot;&gt;서로 같은 키(대칭키)&lt;/code&gt;를 가지고 정보를 암호화 해서 전달 할 수 있을 것이다.&lt;/p&gt;
&lt;p&gt;그런데, &lt;code class=&quot;language-text&quot;&gt;대칭키&lt;/code&gt;는 하나의 큰 단점을 가진다. 바로 &lt;code class=&quot;language-text&quot;&gt;대칭키&lt;/code&gt;를 &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;으로 전달 할 때,
&lt;code class=&quot;language-text&quot;&gt;대칭키&lt;/code&gt;가 탈취 된다면 적군도 정보를 복호화 할 수 있다는 것이다.&lt;/p&gt;
&lt;p&gt;이런 배경에서 나온 암호화 방식이 &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;이다.&lt;/p&gt;
&lt;h2&gt;공개키 방식&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;는 키가 두개가 있다.
A키로 암호화 하면 B키로 복호화 할 수 있고 B키로 암호화 하면 A키로 복호화 하는 방식이다.&lt;/p&gt;
&lt;p&gt;이 방식에 착안해서 두개의 키 중 하나를 공개키, 하나를 비공개 키로 지정한다. &lt;/p&gt;
&lt;p&gt;그림을 통해 자세히 살펴보자.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/58d5be37-7ee5-4d8f-aacb-8ea66c23ecda/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;를 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;에게 전달한다.
그리고 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;를 통해 정보를 암호화 한 후 &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;에 전달한다.
&lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;비공개키&lt;/code&gt;를 통해 전달 받은 정보를 복호화한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;의 공개키가 탈취되거나 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;이 전달한 정보가 탈취되어도 &lt;code class=&quot;language-text&quot;&gt;비공개키&lt;/code&gt;가 없으면 복호화가 불가능 하기 때문에 &lt;code class=&quot;language-text&quot;&gt;대칭키 방식&lt;/code&gt;의 단점을 극복 할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;은 이렇게 응용 할 수 있다.
&lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;이 &lt;code class=&quot;language-text&quot;&gt;비공개키&lt;/code&gt;를 이용해서 정보를 암호화 한 후에 공개키와 함께 암호화된 정보를 &lt;code class=&quot;language-text&quot;&gt;B진영&lt;/code&gt;에 전달한다.&lt;/p&gt;
&lt;p&gt;그런데, 이런 응용방식은 중간에 &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;암호화된 정보&lt;/code&gt;를 탈취 당하면 적군에게 정보를 노출 당할 수 있는 문제를 가져온다.&lt;/p&gt;
&lt;p&gt;그런데 &lt;code class=&quot;language-text&quot;&gt;SSL 통신&lt;/code&gt;에서는 이런 응용방식을 사용한다. 그 이유가 무엇일까?&lt;/p&gt;
&lt;h2&gt;SSL 통신이 공개키 응용방식을 사용하는 이유&lt;/h2&gt;
&lt;p&gt;그 이유는 &lt;code class=&quot;language-text&quot;&gt;공개키 응용방식&lt;/code&gt;이 데이터 보호 목적이 아니기 때문이다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/bdfe5ab8-c202-4d3a-bd6a-34b1e46b37c3/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;이 전달한 정보를 &lt;code class=&quot;language-text&quot;&gt;A진영의 공개키&lt;/code&gt;로 복호화 할 수 있다면, 정보가 &lt;code class=&quot;language-text&quot;&gt;A진영&lt;/code&gt;이 전달한 정보임을 신뢰 할 수 있다.&lt;/p&gt;
&lt;p&gt;즉, 공개키가 정보를 전달한 사람의 신원을 보장해주는 것이다. 이것을 전자 서명이라고 하고 &lt;code class=&quot;language-text&quot;&gt;SSL 통신&lt;/code&gt;에서 서버의 신원 확인을 위해 사용한다.&lt;/p&gt;
&lt;h2&gt;SSL 용어 정리&lt;/h2&gt;
&lt;p&gt;이제 SSL 통신에 사용되는 &lt;code class=&quot;language-text&quot;&gt;대칭키 방식&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;공개키 응용방식&lt;/code&gt;을 살펴보았으니 SSL을 통한 통신에 대해 자세히 살펴보자.
우선, SSL과 관련된 용어를 정리해보자.&lt;/p&gt;
&lt;h3&gt;CA&lt;/h3&gt;
&lt;p&gt;SSL 인증서의 역할은 클라이언트가 접속한 서버가 클라이언트가 의도한 서버가 맞는지를 보장하는 역할을 한다.
이 역할을 하는 민간기업들이 있는데 이런 기업들을 &lt;code class=&quot;language-text&quot;&gt;CA(Certificate authority)&lt;/code&gt; 라고한다.&lt;/p&gt;
&lt;h3&gt;SSL 인증서 내용&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;SSL 인증서&lt;/code&gt;에는 다음과 같은 정보가 포함되어 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서비스의 정보 (인증서를 발급한 CA, 서비스의 도메인 등등)&lt;/li&gt;
&lt;li&gt;서버 측 공개키 (공개키의 내용, 공개키의 암호화 방법)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SSL 통신 과정&lt;/h2&gt;
&lt;p&gt;이제 &lt;code class=&quot;language-text&quot;&gt;키를 사용한 3가지 통신 방법&lt;/code&gt;을 살펴보았으니 SSL 통신과정을 이해해보자.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;SSL 통신과정&lt;/code&gt;에서 가장 이상적인 방법은 &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;이다.(공개키 응용방식 아님)
&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/b528a5c7-9515-4a8b-a4d8-f1341abf57d2/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;는 각각의 &lt;code class=&quot;language-text&quot;&gt;비공개키, 공개키&lt;/code&gt;를 가지고
자신의 &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;를 서로에게 전달한다. 이때, &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;는 탈취되어도 &lt;code class=&quot;language-text&quot;&gt;비공개키&lt;/code&gt;가 없으면 복호화가 불가능하기 때문에 보안에 취약점이 없다.&lt;/p&gt;
&lt;p&gt;그리고, &lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;공개키&lt;/code&gt;로 정보를 암호화 해서 전달하고 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;는 전달 받은 정보를 자신의 &lt;code class=&quot;language-text&quot;&gt;비공개키(서버 비공개키)&lt;/code&gt;로 복호화한 뒤 정보를 처리한다.&lt;/p&gt;
&lt;p&gt;마지막으로 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;클라이언트의 공개키&lt;/code&gt;로 응답해줄 정보를 암호화해서 다시 클라이언트에게 전달한다.&lt;/p&gt;
&lt;p&gt;그런데, &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;은 컴퓨팅 파워를 많이 쓴다고한다.(컴퓨팅 파워를 많이쓰는 정확한 이유는 모름) 그래서 성능측면에서 비효율적이다.&lt;/p&gt;
&lt;p&gt;결론적으로, &lt;code class=&quot;language-text&quot;&gt;SSL 통신&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;공개키 방식 + 대칭키 방식&lt;/code&gt;을 사용하여 보안과성능 두가지 측면을 보장한다.&lt;/p&gt;
&lt;p&gt;이제 SSL 통신과정을 천천히 자세하게 살펴보자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HandShake -&gt; 통신 -&gt; 통신종료&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;간단하게, SSL 통신은 위 세가지 과정으로 이루어진다.
순서대로 하나씩 살펴보자.&lt;/p&gt;
&lt;h3&gt;HandShake(악수)&lt;/h3&gt;
&lt;p&gt;SSL 통신은 데이터를 주고 받기전에 &lt;code class=&quot;language-text&quot;&gt;어떻게 데이터를 암호화 할지&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;믿을 만한 서버인지&lt;/code&gt; 등에 대해 이 과정에서 확인한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;클라이언트가 서버에 접속한다. 이 단계를 &lt;code class=&quot;language-text&quot;&gt;Client Hello&lt;/code&gt;라고 한다. 이 단계에서 주고 받는 정보는 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트 측에서 생성한 &lt;code class=&quot;language-text&quot;&gt;랜덤 데이터&lt;/code&gt; (밑에서 설명)&lt;/li&gt;
&lt;li&gt;클라이언트가 지원하는 암호화 방식들 =&gt; 클라이언트가 가능한 암호화 방식을 서버에 알려주기 위함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서버는 &lt;code class=&quot;language-text&quot;&gt;Client Hello&lt;/code&gt;에 대한 응답으로 &lt;code class=&quot;language-text&quot;&gt;Server Hello&lt;/code&gt;를 하게 된다. 이 단계에서 주고 받는 정보는 아래와 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버 측에서 생성한 랜덤 데이터 (밑에서 설명)&lt;/li&gt;
&lt;li&gt;서버가 선택한 클라이언트의 암호화 방식 =&gt; 선택한 암호화 방식을 클라이언트에게 알려주기 위함&lt;/li&gt;
&lt;li&gt;인증서&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;서버의 인증서&lt;/code&gt;가 &lt;code class=&quot;language-text&quot;&gt;CA&lt;/code&gt;에 의해 발급된 것인지 확인한다.
이때, &lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;에 내장된 &lt;code class=&quot;language-text&quot;&gt;CA리스트와 CA의 공개키&lt;/code&gt;를 사용해서 인증서를 복호화 한다. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  💡 참고
위에서 말한 공개키 응용방식의 활용
그리고, 클라이언트(브라우저)는 CA 종류와 CA의 공개키가 내장되있음&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;  성공적으로 인증서가 복호화 됬다면, &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;가 전달한 인증서가 &lt;code class=&quot;language-text&quot;&gt;CA의 개인키&lt;/code&gt;로 암호화된 문서임이 보증된 것이다.
**  즉, 올바른 서버임을 신뢰 할수 있게된다.**&lt;/p&gt;
&lt;p&gt;  서버를 신뢰할수 있으므로 클라이언트는 &lt;code class=&quot;language-text&quot;&gt;서버가 생성한 랜덤 데이터&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;클라이언트가 생성한 랜덤 데이터&lt;/code&gt;를 조합하여 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;이라는 키를 생성한다. &lt;/p&gt;
&lt;p&gt; 이때, &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;키는 대칭키 방식으로 사용 할 것이다.
클라이언트와 서버가 동일하게 가지고 데이터를 암호화/복호화 하는데 사용한다는 것이다.&lt;/p&gt;
&lt;p&gt; 그런데 대칭키 방식의 단점에서 살펴봤듯이 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;를 그대로 서버에 전달하면 중간에 탈취당해 악용될수 있다.&lt;/p&gt;
&lt;p&gt; 이때, 사용하는 방법이 &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;이다.
&lt;code class=&quot;language-text&quot;&gt;서버의 공개키(서버가 전달해준 인증서 내부에 들어있었음)&lt;/code&gt;로 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;를 암호화해서 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;로 전송한다.&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;는 자신의 비공개키를 통해 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;를 복호화한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt; 이를 통해, 클라이언트와 서버는 안전하게 같은 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;를 가진다.
서버와 클라이언트는 일련의 과정을 통해 &lt;code class=&quot;language-text&quot;&gt;pre master secret&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;master secret&lt;/code&gt;라는 &lt;code class=&quot;language-text&quot;&gt;session key&lt;/code&gt;를 생성한다.
&lt;code class=&quot;language-text&quot;&gt;master secret&lt;/code&gt;은 실제로 클라이언트와 서버가 주고받는 데이터를 &lt;code class=&quot;language-text&quot;&gt;암호화/복호화&lt;/code&gt; 하는데 사용한다.&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;클라이언트와 서버는 &lt;code class=&quot;language-text&quot;&gt;HandShake&lt;/code&gt;가 종료됬음을 서로에게 알린다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;통신&lt;/h3&gt;
&lt;p&gt;이제 &lt;code class=&quot;language-text&quot;&gt;master secret&lt;/code&gt;을 통해 &lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;는 데이터를 &lt;code class=&quot;language-text&quot;&gt;암호화/복호화&lt;/code&gt;하면서 주고 받는다. &lt;/p&gt;
&lt;h3&gt;통신종료&lt;/h3&gt;
&lt;p&gt;데이터의 전송이 끝나면 SSL 통신이 끝났음을 서로에게 알려준다.
그리고 사용한 대칭키인 &lt;code class=&quot;language-text&quot;&gt;master secret&lt;/code&gt;은 폐기한다.&lt;/p&gt;
&lt;h2&gt;마치면서&lt;/h2&gt;
&lt;p&gt;이상 SSL통신에 대해서 자세하게 살펴보았다.
SSL 통신은 &lt;code class=&quot;language-text&quot;&gt;공개키 방식&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;대칭키 방식&lt;/code&gt;을 합쳐서 사용하는 만큼 꽤나 복잡하다.
작성한 글이 많은 크루들에게 HTTPS와 SSL 통신에 대한 이해에 도움이 되었으면 좋겠다.&lt;/p&gt;
&lt;h2&gt;참조&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://opentutorials.org/course/228/4894&quot;&gt;https://opentutorials.org/course/228/4894&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[NGINX 란?]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '리버'가 작성했습니다. 글을 쓰게 된 계기 우테코 레벨3 프로젝트를 진행하면서, HTTPS 통신을 적용하기 위해 NGINX에 대한 이해가 필요했다.
그래서 NGINX…]]></description><link>https://dallog.github.io/what_is_nginx/</link><guid isPermaLink="false">https://dallog.github.io/what_is_nginx/</guid><pubDate>Sat, 30 Jul 2022 16:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/gudonghee2000&quot;&gt;리버&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;글을 쓰게 된 계기&lt;/h2&gt;
&lt;p&gt;우테코 레벨3 프로젝트를 진행하면서, HTTPS 통신을 적용하기 위해 NGINX에 대한 이해가 필요했다.
그래서 NGINX에 대한 이해를 돕기위해 글을 작성하고자 한다.&lt;/p&gt;
&lt;br&gt;
&lt;h2&gt;NGINX란?&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Nginx는 WS(Web Server)의 일종이다. 주로 정적 컨텐츠를 제공하거나 ReverseProxy, LoadBalancer의 역할을 한다.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;h2&gt;NGINX의 등장 배경&lt;/h2&gt;
&lt;p&gt;NGINX를 살펴보기전에, 무슨 이유로 NGINX가 등장했는지를 먼저 살펴볼 필요가 있다. 우선 NGINX의 등장배경을 살펴보자.&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;NGINX 등장이전 Apache가 웹서버로써의 높은 인기를 가졌다.
잘 사용되던 Apache 웹서버는 어느순간 어떠한 문제를 가져왔다. Apache의 요청처리 메커니즘과 함께 어떠한 문제를 가져왔는지 살펴보자.
&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/4c31d7af-155b-4998-9ef3-93559914949e/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;초기의 Apache는 그림과 같이 요청(Request)이 들어올 떄 마다 새로운 Process를 생성하여 네트워크 연결을 하고 요청을 처리했다.(이러한 처리방식을 &lt;code class=&quot;language-text&quot;&gt;prefork&lt;/code&gt;라고 함)&lt;/p&gt;
&lt;p&gt;그런데, 2000년에 접어 들고 인터넷 트래픽이 증가하면서 아파치의 요청 처리방식은 &lt;code class=&quot;language-text&quot;&gt;C10K&lt;/code&gt; 문제를 가져왔다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;C10K 문제란 Connection 10000 Problem의 줄임말로 웹서버가 1만개의 동시 Connection을 처리하기 어렵다는 의미이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;일단 동시 Connection을 자세히 살펴보자.
&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/954a297f-e564-43b1-acfa-0f2452854647/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;웹서버&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;로 부터 요청이 들어오면 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 생성하고 유지한다.
그리고 그림과 같이 &lt;code class=&quot;language-text&quot;&gt;클라이언트&lt;/code&gt;는 생성된 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 통해 또다른 요청을 &lt;code class=&quot;language-text&quot;&gt;서버&lt;/code&gt;에게 전달한다. &lt;/p&gt;
&lt;p&gt;이렇게 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt; 하나로 여러 요청을 처리하는 이유는 다음과 같다. 클라이언트와 서버는 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 생성하는데 여러가지 절차가 필요하다.
그래서 매 요청마다 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 생성하는것은 비효율적이고 느렸다. &lt;/p&gt;
&lt;p&gt;비효율성을 해결하기 위해 사람들은 이미 만들어진 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;이 있다면 이를 활용하여 요청을 보내고자 하였다.&lt;/p&gt;
&lt;p&gt;이렇게 유지되는 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;들을 &lt;code class=&quot;language-text&quot;&gt;동시 Connection&lt;/code&gt;이라고 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;💡 여담으로 HTTP 프로토콜 &lt;code class=&quot;language-text&quot;&gt;Header&lt;/code&gt;부분의 &lt;code class=&quot;language-text&quot;&gt;Keep-Alive&lt;/code&gt;가 바로 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 얼마나 유지할 것인지에 대한 통신 규약이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이때, Apache 서버는 C10K문제를 가져왔다.
&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/fa69475a-0326-4652-b1da-616e60164dea/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;그림과 같이 &lt;code class=&quot;language-text&quot;&gt;Apache&lt;/code&gt;서버는 요청이 들어올 때 마다, &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;를 생성했는데 요청이 만단위를 넘어가면서 어느순간 부터 요청에 대한 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 생성하지 못한것이다. &lt;/p&gt;
&lt;p&gt;이러한 문제를 가져온 원인은 다음과 같았다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;메모리 부족
Apache서버는 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;이 생성될 때마다 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;를 생성해야했는데 동시에 유지해야할 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;이 많아지면서 유지해야할 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;가 증가했고 메모리 부족을 발생시켰다.&lt;/li&gt;
&lt;li&gt;CPU 과부하
또한, 실행중인 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;가 많아지면서 CPU는 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;를 처리 할 때, &lt;code class=&quot;language-text&quot;&gt;컨텍스트 스위칭&lt;/code&gt;을 굉장히 많이해야했다. 그래서 CPU의 부하가 증가했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;결국, 수많은 동시 커넥션을 처리하기엔 Apache의 요청 처리구조는 부적합했다.&lt;/p&gt;
&lt;p&gt;그래서 Apache의 단점을 보완하기 위해 2004년 NGINX가 등장했다.&lt;/p&gt;
&lt;br&gt;
&lt;h2&gt;NGINX 자세히 알아보기&lt;/h2&gt;
&lt;p&gt;우선, NGINX의 요청 처리 방식을 살펴보자.&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/93b0890b-c015-46d0-9165-5cf6a7b4d9f6/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;NGINX는 &lt;code class=&quot;language-text&quot;&gt;MasterProcess&lt;/code&gt;를 통해 설정 파일을 읽고 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt;와 같은 자식 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt; 3종류를 생성한다. (&lt;code class=&quot;language-text&quot;&gt;cache loader&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;cache manager&lt;/code&gt;가 있음)&lt;/p&gt;
&lt;p&gt;그리고 생성된 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt;는 요청이 들어오면 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;을 형성하고 요청을 처리한다.
요청에 따라서 매번 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;를 생성하던 Apache와 달리, NGINX는 &lt;code class=&quot;language-text&quot;&gt;MasterProcess&lt;/code&gt;에 따라 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt;를 생성하고 고정된 개수의 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt; 들이 요청을 처리한다.&lt;/p&gt;
&lt;p&gt;이렇게 고정된 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;의 개수로 요청을 처리하기 위해 NGINX는 &lt;code class=&quot;language-text&quot;&gt;Event-Driven&lt;/code&gt; 방식으로 요청을 처리한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;💡 Event-Driven이란?
NGINX는 형성된 Connection에 아무런 요청이 없으면 새로운 요청에 대한 Connection을 형성하여 요청을 처리한다.
또는 이미 만들어진 다른 Connection으로부터 요청을 처리한다.
Nginx에서의 Conneciton 형성, Connection 제거, 새로운 요청 처리를 Event라고 부른다.
또한, Event를 비동기 방식으로 처리하는 것을 Event-Driven이라고 한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/f1b98399-de8f-4f10-bbba-050ca377c4be/image.JPG&quot;&gt;&lt;/p&gt;
&lt;p&gt;NGINX는 그림과 같이 큐형태의 저장소에 Event들을 담아 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt;가 순차적으로 작업을 처리한다.&lt;/p&gt;
&lt;br&gt;
&lt;h2&gt;NGINX의 Apache의 차이점&lt;/h2&gt;
&lt;p&gt;Apache는 동기방식으로 하나의 &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt;이 끝날 때 까지 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;를 유지했다. &lt;/p&gt;
&lt;p&gt;반면, NGINX는 고정된 &lt;code class=&quot;language-text&quot;&gt;WokerProcess&lt;/code&gt;를 생성하고 &lt;code class=&quot;language-text&quot;&gt;Event&lt;/code&gt;가 발생 할 때마다 요청을 처리하는 비동기 &lt;code class=&quot;language-text&quot;&gt;Event-Driven&lt;/code&gt; 방식을 사용한다는 것이 차이점이다.&lt;/p&gt;
&lt;p&gt;보통 &lt;code class=&quot;language-text&quot;&gt;WorkerProcess&lt;/code&gt;는 CPU의 코어 개수만큼 생성하는것이 일반적이라고 한다. &lt;strong&gt;(이유: 컨텍스트 스위칭 회수를 최소하 하기 위함.)&lt;/strong&gt;&lt;/p&gt;
&lt;br&gt;
&lt;h2&gt;NGINX의 장점&lt;/h2&gt;
&lt;p&gt;NGINX는 Apache에 비해 성능 측면에서 두가지 장점이있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;처리할수 있는 동시 커넥션 개수가 훨씬 많다.&lt;/li&gt;
&lt;li&gt;동일한 개수의 커넥션 처리 속도가 더 빠르다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러한 장점을 가지고 오는 이유를 마지막으로 정리해보자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;고정된 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt; 개수 만을 사용하기에 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt; 생성 비용이 없다.&lt;/li&gt;
&lt;li&gt;또한, &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt; 개수가 제한되어 CPU의 부담이 줄어든다. (컨텍스트 스위칭이 적어지기 때문)&lt;/li&gt;
&lt;li&gt;비동기 방식이기에 &lt;code class=&quot;language-text&quot;&gt;Process&lt;/code&gt;가 쉬지않고 일을 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;h2&gt;NGINX 활용 방법&lt;/h2&gt;
&lt;p&gt;도입부에서 이야기햇듯이 NGINX는 정적파일처리, 리버스 프록시, 로드밸런서의 역할로써 WAS의 부담을 줄여주는 역할로 다양하게 활용 할 수 있다.&lt;/p&gt;
&lt;br&gt;
&lt;h2&gt;마치면서&lt;/h2&gt;
&lt;p&gt;이상 NGINX의 등장 배경과 작동 방식을 살펴보았다.
많은 크루들이 우아한테크코스 프로젝트를 진행하면서 사용하는 NGINX에 대한 이해에 도움이 되었으면 좋겠다.&lt;/p&gt;
&lt;br&gt;
&lt;h3&gt;참조&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://livlikwav.github.io/study/NGINX-inside/&quot;&gt;https://livlikwav.github.io/study/NGINX-inside/&lt;/a&gt;
&lt;a href=&quot;https://jizard.tistory.com/306&quot;&gt;https://jizard.tistory.com/306&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[테스트에서 Entity 객체를 상수로 두면 안 되는 이유]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. 문제 에서 카테고리 수정 기능에 대한 테스트가 터졌다.  시 다른 회원의 id…]]></description><link>https://dallog.github.io/test-fixture-constant/</link><guid isPermaLink="false">https://dallog.github.io/test-fixture-constant/</guid><pubDate>Wed, 27 Jul 2022 16:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;문제&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// MemberFixtures&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; MEMBER 
		&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;example@email.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/image.png&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;example&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SocialType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GOOGLE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; CREATOR 
		&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;creator@email.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/image.png&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;creator&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SocialType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GOOGLE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// CategoryServiceTest&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;자신이 만들지 않은 카테고리를 수정할 경우 예외를 던진다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; 자신이_만들지_않은_카테고리를_수정할_경우_예외를_던진다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MEMBER&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; creator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CREATOR&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;CategoryResponse&lt;/span&gt; savedCategory &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; categoryService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;creator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CategoryCreateRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CATEGORY_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;CategoryUpdateRequest&lt;/span&gt; categoryUpdateRequest &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CategoryUpdateRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MODIFIED_CATEGORY_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// when &amp;amp; then&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;assertThatThrownBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&gt;&lt;/span&gt; categoryService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; savedCategory&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; categoryUpdateRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isInstanceOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;NoPermissionException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;CategoryServiceTest&lt;/code&gt;에서 카테고리 수정 기능에 대한 테스트가 터졌다. &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; 시 다른 회원의 id를 넣으면 &lt;code class=&quot;language-text&quot;&gt;NoPermissionException&lt;/code&gt;이 발생해야 하는데 아무런 예외도 발생하지 않았다. 더 이상한 점은 단독으로 돌렸을 때는 잘 돌아가지만 전체 테스트를 돌리면 터진다는 것이다. 테스트 격리에 문제가 있어 보였다. 디버깅을 해보았다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/dcb6e569607bb8e161a8d5b0fc9a001f/08990/debug1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 31.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY04WR2WrDMBBF81nZZG3WbsuyjZsUp+v//8PtWIW0lEIeDkJoOPcy2p2FwpwEbp1HchHGR9iQ4EKH1gUIbXBqJCFw4o/Z7ZlCJuF7UehdB+0ddHQwFCC9AWslmFY0LP/wQPhZWqwh4ylEXBI1dQY8aMikwb3GkYYPjFeOta38l5+Gg8YaMz66jNEncGugk4EkcSM1GCFbW2G0pgNr7gEb+/P3/S58GxRuJHxJPe0xwFBTF9MvOqRcMC0XBApV1tcdK+vqaeldUFgV9lHglRpuwpUeDA20JN1E2ydtcl+DIoZpRl9GYkKZl3rmccZyfa6BX2nO2UiOOLyaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;member 객체&apos; title=&apos;member 객체&apos; src=&apos;/static/dcb6e569607bb8e161a8d5b0fc9a001f/ca1dc/debug1.png&apos; srcset=&apos;/static/dcb6e569607bb8e161a8d5b0fc9a001f/e7570/debug1.png 170w,
/static/dcb6e569607bb8e161a8d5b0fc9a001f/f46e7/debug1.png 340w,
/static/dcb6e569607bb8e161a8d5b0fc9a001f/ca1dc/debug1.png 680w,
/static/dcb6e569607bb8e161a8d5b0fc9a001f/08990/debug1.png 1010w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;member 객체&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;MEMBER까지 저장했을 때는 분명 값들이 잘 들어가있는 걸 볼 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/2fb95a1ec531ee3668aeec9ea95f76b0/1263b/debug2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 65.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQ4y41TWXbiMBD0rSYQsGwt1mZZXoCQkMwk9z9ETatNeGTebB/11BJSubqqqRolcYgtLj4iWwftAjoX0dHeUC07i0fREpr/QvWwJ8LU4Jw71HaAdB7Ke3QxoDUddk27EtbNlbj9B2EtMfcCx6lHH46YncEYOmhv0ESFNmoIp/jytl7xlfwrmHBhQmqxv8ANr4jxQOoUmqBRG4m9lHx5d/fwk/xXVJurwnN2yP0T5nSgtiN5SW2HAOMJNkBbj5Ay8nzgs11DH2rVDbXUfFZ9Iw+XVGMYIzbpAyJd6LHjQGzob6uNK5bTE9I0I40zxuWIPk8YpoXPXZ9QCakoZUHKJqj0DNGfOOlC5GJipY3uCIZVKFIqO8fpr7WFNJZUR7LJonoUa8pvvYGli8Y7/rGoUbQvbdx7tNkLbK/gul7xWfPYTOThe9aU8EAzaKlFSjl2aD0lbMkfo/6Y6m9TnpPARzZ48QkX8utMCpWhsfGKRkZy0luxqluV/GVsSsojKfxBCt9Cxns/oCf/ms6QSsvD3ajVw+Jr+QcJpfGwqxnlA/f1TeH3QeE1DKywmF0ecroEF9e1jM1yOiPm8bYvXnsSUc7KaLHCIVIoSTPhM13UFIa+kpbVXFMvIZVxCUNGHEYeF66JbDqceCp+AuCa1l08A/3mAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;필드가 변경된 member 객체&apos; title=&apos;필드가 변경된 member 객체&apos; src=&apos;/static/2fb95a1ec531ee3668aeec9ea95f76b0/ca1dc/debug2.png&apos; srcset=&apos;/static/2fb95a1ec531ee3668aeec9ea95f76b0/e7570/debug2.png 170w,
/static/2fb95a1ec531ee3668aeec9ea95f76b0/f46e7/debug2.png 340w,
/static/2fb95a1ec531ee3668aeec9ea95f76b0/ca1dc/debug2.png 680w,
/static/2fb95a1ec531ee3668aeec9ea95f76b0/1263b/debug2.png 1000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;필드가 변경된 member 객체&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;근데 CREATOR를 저장하는 순간!? member의 값이 갑자기 CREATOR의 값으로 전부 변경되었다. 왜 이런 걸까.&lt;/p&gt;
&lt;h2&gt;원인&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;가변객체인 회원의 Entity를 상수로 등록하여 사용하고 있는 것이 문제였다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;아래 그림을 통해 알아보자.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1e3d82342c6106de7875c7eccdba5905/1b198/img1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 52.352941176470594%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABO0lEQVQoz62S24rCQBBEExNNvGFuRlFRfBBzhyRolPyDzwr+/2/UUg0ji4YFYR+GycykD9VVrQVBgMPhgPl8DsMwYJomHMeBbdvo9XoYDAbQNE3uLpcLmqb5WOfzGdfrFVmWQSNgOp0KiIWErlYrjEYjOf8Gsvh0OnUuvqVpCi0MQyETkuc5qqpCURRIkkTul8tlJ5CqOoFUt9vtMBwOpdD3fURRJHe6rv+pkFAFfgEXi4Uo2W630jZbnc1mLxuUFQpY1zVutxuezycejwfu9zvathWwABnK8XjEZrNBv9+XIMbjsXzTT+7vCpWyToUqFIL+JRSOC1umd3EcoyzLVyj8wXXd74D0a7/fYzKZSCGVcS49z/tQyDlUbb7PId9kDukXR4NAts/zer2WYHi2LEuAfGf69Ltrqcn4Ae1rE0eDI7LDAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;img1&apos; title=&apos;img1&apos; src=&apos;/static/1e3d82342c6106de7875c7eccdba5905/ca1dc/img1.png&apos; srcset=&apos;/static/1e3d82342c6106de7875c7eccdba5905/e7570/img1.png 170w,
/static/1e3d82342c6106de7875c7eccdba5905/f46e7/img1.png 340w,
/static/1e3d82342c6106de7875c7eccdba5905/ca1dc/img1.png 680w,
/static/1e3d82342c6106de7875c7eccdba5905/02d09/img1.png 1020w,
/static/1e3d82342c6106de7875c7eccdba5905/1b198/img1.png 1120w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;테스트 실행 전 MEMBER와 CREATOR는 id를 가지지 않은 상태이다. 영속성 컨텍스트도 비어있다.&lt;/p&gt;
&lt;p&gt;전체 테스트를 실행하면 MEMBER와 CREATOR는 상수이므로 온갖 테스트에서 두 개의 상수를 가져다 쓰게 된다. 그 과정에서 MEMBER가 저장되는 상황이 발생한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/426794044d48de3123daaa8a0ab7439b/65dc2/img2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 52.352941176470594%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVQoz01SZ6siQRCcZ866hhPMERVUPF0jBsS0ngFBn4Lh//+Muq2+p9yHoqd7t2u6q0aFw2Fks1lEo1FYbTZYLF+w2p2wWq3m2QK73Q6lFLw+H/r9PqbTKV6vFy6XC263G+73O47Ho3wjlNvtRiQSAaPX64XH40EwFDbPPqkxJyFju90WLBYLrFYricvlErPZDN1uV6BisRhqtRoSiQSazaag0+mgWq2iXq8jmUrBFS3Br/2CsdngdDphPp+j1WrJf+32b4kfQr/fj0wmI9NxkmAwiEqlgnw+L7nlS8GlpaAlK9j9MXD5/sZ6vZb1hsOhiZGJAQaDf1CcjDeQxOl0ypqhUAiBQED0s5m6kjicLGM0GmIymcgk7OnoXei9IXSeTfACpWka0uk04vH4xwDqxfP/pnjcTuz3ezHjcDjg8XiIIc/nE9frVUBNFZupI6PL5RIUi0VxnWRvU2iSYRhCRg1pBC84n8/Ybrcy+Xg8hqLDpVIJnJREFLtcLkuNMnD999R0drfbmauPoOs6Nj8m0WnmoiEJ6TLfI98eTWo0GkiZ7nJlh8PxM6EXvV7v00i8tWSd+gkhTSAZG7gic65LYuY0ioQkLhQK4j6Ry+Ukvmvv/C8XKR0sehv9NwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;img2&apos; title=&apos;img2&apos; src=&apos;/static/426794044d48de3123daaa8a0ab7439b/ca1dc/img2.png&apos; srcset=&apos;/static/426794044d48de3123daaa8a0ab7439b/e7570/img2.png 170w,
/static/426794044d48de3123daaa8a0ab7439b/f46e7/img2.png 340w,
/static/426794044d48de3123daaa8a0ab7439b/ca1dc/img2.png 680w,
/static/426794044d48de3123daaa8a0ab7439b/65dc2/img2.png 954w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그럼 상수 MEMBER의 id 값이 1로 바뀌게 된다. 이후 다른 테스트에서는 CREATOR가 저장된다. 이 때 각각의 테스트는 격리되어 있으므로 영속성 컨텍스트는 빈 상태이다. 따라서 CREATOR의 id도 1로 저장된다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fe0781b8ad1359d3e25de8952645dc16/ef0cc/img3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 52.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+klEQVQoz2WSV4siURCFO5kdA6YG44pZW0xrQhzBwDyIOmNCQf//vzjbp3oVln049L0X+qtTdUrpdDpoNpswDAOqqv4nRVFEmUwG5XIZhUIB+Xxevi8Vi0VUKhXEYjEo2WwWyWTyDdQNNzTdgKap8qbrugDb7TYmkwnO5zMejwdOpxOezyculwuWyyWm06kUUhKJBAKBgCO/H5FoDB+hEPz2mXK5XAKs1+vo9XqYz+dYr9dYrVaiF2w0GoHmFNpNpVKo1Wryk2W1xD7Fim63W4CDwQDb7VYgw+EQ3W5XClD9fl/cC5Bzicfj0m4kEkHDnmer1RLHbNnj8QpwbDu4Xq/Y7XbicjweY2I7I4jn2WyGXC4HhYGUSiX4fD5xE41GBMyzYTjtekImrE4fn58OiG7F2WCI/u+Rfe4KmAEphNEqHWmaZgeiQ7W/dGcYOryhFPxmw25zhPv9hq+vL3F5v99xu90kHGq/3zuhhMNhcUcY3bg8fjtpl5O4puAj+QtGII5ep43v7x+Z4WKxwGazweFwEDiDoQRIh1wbXrgaVssJhSGZqSS84RQUVUffbpErQyBbZjDH41GgDOW9NtVqFVwdrghnxzuDCgaD8sbW6bxpFyKEegVBEOH/hJJOpwWk/Z0b76Zpvu8vINfLsiw0Go23GCjlrJsl6/cHmTM3eUS/47oAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;img3&apos; title=&apos;img3&apos; src=&apos;/static/fe0781b8ad1359d3e25de8952645dc16/ca1dc/img3.png&apos; srcset=&apos;/static/fe0781b8ad1359d3e25de8952645dc16/e7570/img3.png 170w,
/static/fe0781b8ad1359d3e25de8952645dc16/f46e7/img3.png 340w,
/static/fe0781b8ad1359d3e25de8952645dc16/ca1dc/img3.png 680w,
/static/fe0781b8ad1359d3e25de8952645dc16/ef0cc/img3.png 962w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이렇게 상수 MEMBER와 CREATOR의 id가 모두 1로 바뀌었다. 디버깅을 해보니 실제로 상수의 id 값이 모두 1로 바뀐 것을 볼 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 491px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/3ff3d4f78422a9ad12390ae2d13ddceb/ca2ce/debug3.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 65.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1klEQVQ4y5VT2XKcMBDcX/PGC4sOkEAgiWNvO+vj/187MwJTcVxOKg9Tw6Wenu5mkyuDwTu8RY+p9ahqB9O01Nt0LbTB417gR16k/q/aPGQCYyhwixWMcVC1hWosKldDmgqZFNiJr4DfDdhsc0kMBV56i+cuEkuHoa1RNQbSaei2hLAqAfxe3zJkwDHMgE8E+BYiRlpZmBLKlSiMJoYSu0IiEwoZdT64zfZfigetDJ+jSQxvPkCZGmXdJC2Nm7Xk6uKA4XBCaRvsFQ3TVep7qSFKkwaShjJp+LM3ePU9bp1PgAxgFzDrOtRtl/p4OsP3I+J0wOF8SQP66YjpdEFNZze5qpLLr7HD3Uf0BMLsPoCYIU8vmBGVJnY8UFY2MdW2TjU/M9g8FpoYVrgFYmXoA46Nm1flj3gN1ibpRP1hl6+a8fVay7N15TutPDaeplUoG2JCJWqNghzOtVpd3C2m/N1lLwlwjs17jLhSwDVlkGMjEqD8xOi/YnMPAZY1saQRBZx1EeQml0nm+OTsn3HZLvlcAZ/oT7mTy9dPLnerwwzEsTlernBkXtMFtHTPnd+x88rYGTC0gkyZc3imw2pxkEE/HOfSNIhB29AvmTwiDFO65+hYAv4F4sn084OChegAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;debug3&apos; title=&apos;debug3&apos; src=&apos;/static/3ff3d4f78422a9ad12390ae2d13ddceb/ca2ce/debug3.png&apos; srcset=&apos;/static/3ff3d4f78422a9ad12390ae2d13ddceb/e7570/debug3.png 170w,
/static/3ff3d4f78422a9ad12390ae2d13ddceb/f46e7/debug3.png 340w,
/static/3ff3d4f78422a9ad12390ae2d13ddceb/ca2ce/debug3.png 491w&apos; sizes=&apos;(max-width: 491px) 100vw, 491px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이 상태에서 처음 봤던 테스트 코드로 돌아가보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// CategoryServiceTest&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@DisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;자신이 만들지 않은 카테고리를 수정할 경우 예외를 던진다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; 자신이_만들지_않은_카테고리를_수정할_경우_예외를_던진다&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MEMBER&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; creator &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CREATOR&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 문제 발생 !!!&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;CategoryResponse&lt;/span&gt; savedCategory &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; categoryService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;creator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CategoryCreateRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CATEGORY_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;CategoryUpdateRequest&lt;/span&gt; categoryUpdateRequest &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CategoryUpdateRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MODIFIED_CATEGORY_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// when &amp;amp; then&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;assertThatThrownBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&gt;&lt;/span&gt; categoryService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; savedCategory&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; categoryUpdateRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isInstanceOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;NoPermissionException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트를 보면 처음으로 MEMBER를 저장한다. 이까지는 아무 문제가 없다. 문제는 두 번째로 CREATOR를 저장할 때 발생한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/d7258/img4.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 53.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACOklEQVQozzVTa3OaQBRFUdGoREkz9ZnR+IhaJSgGUWIV4iPW2FAwnYzm//+N0703zYczy12Ys+exSLquo9frIZFIQJIkRCJfiDBoj1AqldBoNHBzc4NKpcJrtVpl1Go1NJtN5PN5SDTQB0RIBHIsAVmOIRqNIhaLMYiw3+9jOp0iDEOcTicEQYDz+Yy3tzd4nsfviFzSNA2ZTAapVAqpZBLqZR6ZrIqkeKa9L+WdTgej0QjL5RLb7RabzQbr9Zoxm81gWRbK5TKk29tbFAoFltzpdqHrA9zd3aHdbqNer0NRFCY0DAOHwwGr1Qrj8RjD4ZAPINBs2/YnIeVSLBbZYjabZSWDwQCqqrLd5H/CB+uBrZLl+XzOBFOhjKzSs+M4HJ1E2ZAask0EuVwOmgiXrHJ+oiBNvoDxQ8fCXWIymcA0TZhCmTm2MH6wWSWRUlESWaUwSR2pjIpCImKVZRnxeJz3SvIlLPNT4X6/Z5Xv7+/4+PjgUo7HI3zf/yyFiNLptCCS2VpcueCmo3RtYlF8v8hBjSjQjXuEQYjNegPXdbHb7cQcwH/1sRa5UtNMSAqpFAqUgqf8qJSuKKhYLiGXSPNBRBgcQ7hPHozREM6jgz9hgN/+K9slMGGr1eJLS9eEcqSZCEm1Iva0tIpvior5vYVfMw8vzhP28xV2jofV5Ce29hJze8YFVakUUnd1dcUFUG40U+s8C6jJNLqXFTz3pjiY4g4aj/BHLg7DBf6O13gZLdgN/W3X19f4B6GvOfybXg1jAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;img4&apos; title=&apos;img4&apos; src=&apos;/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/ca1dc/img4.png&apos; srcset=&apos;/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/e7570/img4.png 170w,
/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/f46e7/img4.png 340w,
/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/ca1dc/img4.png 680w,
/static/9f2e3b2b9edcf5bcdccdfa2d633f28df/d7258/img4.png 966w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CREATOR를 저장하려고 하는데 저장된 MEMBER의 id도 1이고, CREATOR의 id도 1이다. CREATOR를 저장할 때 영속성 컨텍스트에 같은 id를 가진 entity가 있으므로 CREATOR를 새롭게 저장하지 않고, 기존의 id가 1번인 entity를 수정하게 된다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/0fc51556a4deff29f98d6be398f1bef4/ed282/img5.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 47.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvUlEQVQoz42R227aUBBFD7EhFDvYQBxIQxOBiil3VHEz+FKuCYmJKpEi9YWq7f9/w6o5bp+ahzxszRnpaM2ePUIIwVuk6zqNTw3qdp1arYZdsyPV4rdt02g0KJfLp79vA5q5HOPJhPlizs/fv9h/e+H448jxeGS32+E4Ds1m83WgIs54p6Q4P0uSVpIkhUKxYOGOHXxnxsN8zX2wxHc9PM+TsNFoJJ2KXDS53+/Lpt1qyRWMtMaHCwsrY1LUclynTezSHTt3xYMzZ+ME7GYrZtGAwXAgYdMIWq/XEaqqYhgG6XQacZaIXapJRCJ2q6aScYbGhXTjRhpNxnweDRiMxwydKYPRkMnUkTmKTCYj3RUKBa40kzujyK1R4iZrca0XyOkGWiJFOV9k+7glDEMC12c9+8K9t2DjLVlMfVb+nNYpQ03TqFarEmj9BVYi4G32ipKex9SzZESSGwl85Cl8YuEGPLtrvnobWcPZkq2/jI9yAp4cWpeX8UEUhY/me0paXvap85SsWdPgZb/ncDjgBwHjaMUw2PB98SyP4/oe7XY7iiqRkJB/Ul95S2A2S7fbpdPp/K92h16vR6VS4Q+zYPZhTr53xgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;img5&apos; title=&apos;img5&apos; src=&apos;/static/0fc51556a4deff29f98d6be398f1bef4/ca1dc/img5.png&apos; srcset=&apos;/static/0fc51556a4deff29f98d6be398f1bef4/e7570/img5.png 170w,
/static/0fc51556a4deff29f98d6be398f1bef4/f46e7/img5.png 340w,
/static/0fc51556a4deff29f98d6be398f1bef4/ca1dc/img5.png 680w,
/static/0fc51556a4deff29f98d6be398f1bef4/ed282/img5.png 964w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;기존의 값이 수정되니 id가 1번인, MEMBER를 저장한 member instance의 값까지 변경되는 것이다.&lt;/p&gt;
&lt;h2&gt;해결&lt;/h2&gt;
&lt;p&gt;Entity 객체에 대한 fixture가 필요한 경우 객체를 생성하는 메서드를 통해 호출할 때마다 새로운 객체를 생성해서 반환하도록 했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; 파랑&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;파랑_이메일&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 파랑_프로필&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 파랑_이름&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SocialType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GOOGLE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;p&gt;상수란 변하지 않고 고정된 값을 담는 변수를 의미한다. 하지만 우리는 필드가 변하는 객체인 Member Entity를 상수로 선언했다. 테스트 격리를 아무리 잘 해도 상수까지 계속 리프레쉬 해주진 않기 때문에 이런 문제가 발생한 것이다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;변하지 않는 불변 객체만 상수로 지정하자!!&lt;/strong&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[properties 객체로 다루기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '매트'가 작성했습니다. properties 객체로 다루기 Spring…]]></description><link>https://dallog.github.io/properties-to-object/</link><guid isPermaLink="false">https://dallog.github.io/properties-to-object/</guid><pubDate>Wed, 27 Jul 2022 01:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;properties 객체로 다루기&lt;/h2&gt;
&lt;p&gt;Spring에서 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt;이나 &lt;code class=&quot;language-text&quot;&gt;application.properties&lt;/code&gt;에 존재하는 값을 불러오는 방법에는 대표적으로 &lt;code class=&quot;language-text&quot;&gt;@Value&lt;/code&gt; 애노테이션을 사용한 방법과 &lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt;를 사용한 방법이 존재한다. 두 방식을 직접 적용해 본 뒤 차이와 이점에 대해 알아보려 한다.&lt;/p&gt;
&lt;h2&gt;@Value 사용하기&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@Value&lt;/code&gt;는 기본적으로 설정 정보를 단일값으로 주입 받기 위해 사용된다. 아래는 실제 달록 프로젝트에서 적용한 예시이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; JWT_DELIMITER &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\\.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplate&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.client-id}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.client-secret}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.grant-type}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.redirect-uri}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.token-uri}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplateBuilder&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clientId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clientSecret &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grantType &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;redirectUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tokenUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restTemplate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objectMapper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;간단하게 적용이 가능하지만 공통으로 묶인 프로퍼티가 많아질 경우 코드가 지저분해진다. 이러한 프로퍼티 값들을 객체로 매핑하여 사용하기 위한 애노테이션으로 &lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt;가 존재한다.&lt;/p&gt;
&lt;h2&gt;@ConfigurationProperties&lt;/h2&gt;
&lt;p&gt;우리는 때때로 DB 설정을 작성하기 위해 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt;을 통해 관련 정보를 작성하곤 한다. 아래는 간단한 h2 DB를 연결하기 위한 설정을 적은 예시이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;spring&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;datasource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; jdbc&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;h2&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;~/dallog;MODE=MYSQL;DB_CLOSE_DELAY=&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;1;DB_CLOSE_ON_EXIT=FALSE
    &lt;span class=&quot;token key atrule&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sa&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러한 설정들은 어디서 어떻게 활용되고 있을까? 실제 바인딩 되고 있는 객체를 따라가보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@ConfigurationProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prefix &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;spring.datasource&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSourceProperties&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BeanClassLoaderAware&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;InitializingBean&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ClassLoader&lt;/span&gt; classLoader&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; generateUniqueName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; type&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; driverClassName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 &lt;code class=&quot;language-text&quot;&gt;DataSourceProperties&lt;/code&gt;는 우리가 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt;에 작성한 설정 정보를 기반으로 객체로 추출하고 있다. 이것은 Spring Boot의 자동설정으로 &lt;code class=&quot;language-text&quot;&gt;DataSource&lt;/code&gt;가 빈으로 주입되는 시점에 설정 정보를 활용하여 생성된다. &lt;/p&gt;
&lt;p&gt;간단히 디버깅을 진행해보면 Bean이 주입되는 시점에 아래와 같이 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt;에 명시한 값들을 추출한 &lt;code class=&quot;language-text&quot;&gt;DataSourceProperties&lt;/code&gt;를 기반으로 생성하고 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/dba28d9d177e6ad40d96eb7c5dd3623d/8bee4/debug-1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVQoz33R2U7CQBQG4L6KthRm60o7LV0tgYSgXEmiJETx/d/h93Q6gCbGiy9nm046OU5T+6hWDE27Qt09oSw0ioSD8wljDHzE+Z+EEMY1d5p6gbZh6FqOutbItIZeKoShhAokkiRFHCdQSiIIFZGTSJnerwuJk6cBirJCkhUIlALjDExIcDmRKjAE5YLmYrxE2dyeEVKB22+cJn/EMvDIA7LQQ0p/FYk5InnlI2AehO9B+i7kfEa8O9Nzae6a3Kl2ZwyHC9aHM7aHE/rnT7T7C/qXL4ofRrl5J6fJcIQm+fqEfHjDsjsi6ydp9wpHxrSEboOi30GTcqDYblENe2TdFoLmIi4gEyvOb72pX1pUEyddzKDlAjoMkbI5YnqS4Y/RR0RPjWbu3Vjf/KjNjJ48bkgadmN2W3fif3bL17PfMmv7pWFHJLUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;debug 1&apos; title=&apos;debug 1&apos; src=&apos;/static/dba28d9d177e6ad40d96eb7c5dd3623d/ca1dc/debug-1.png&apos; srcset=&apos;/static/dba28d9d177e6ad40d96eb7c5dd3623d/e7570/debug-1.png 170w,
/static/dba28d9d177e6ad40d96eb7c5dd3623d/f46e7/debug-1.png 340w,
/static/dba28d9d177e6ad40d96eb7c5dd3623d/ca1dc/debug-1.png 680w,
/static/dba28d9d177e6ad40d96eb7c5dd3623d/02d09/debug-1.png 1020w,
/static/dba28d9d177e6ad40d96eb7c5dd3623d/8bee4/debug-1.png 1130w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 582px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/3206413c52066864f6bf338e4a3e2fd6/0b5a5/debug-2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 7.647058823529412%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQklEQVQI13WKxxEAIAgELcwEOIb+C0IwfdTHzkUDmVihlhjrVCg0/Eb3k2ULCWe/fqrDC6a0ylGMB2CnxBv7ya++A2Z3RsV3NtINAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;debug 2&apos; title=&apos;debug 2&apos; src=&apos;/static/3206413c52066864f6bf338e4a3e2fd6/0b5a5/debug-2.png&apos; srcset=&apos;/static/3206413c52066864f6bf338e4a3e2fd6/e7570/debug-2.png 170w,
/static/3206413c52066864f6bf338e4a3e2fd6/f46e7/debug-2.png 340w,
/static/3206413c52066864f6bf338e4a3e2fd6/0b5a5/debug-2.png 582w&apos; sizes=&apos;(max-width: 582px) 100vw, 582px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;정리하면 우리는 Spring Boot를 사용하며 자연스럽게 &lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt;를 활용하여 만든 객체를 사용하고 있는 것이다.&lt;/p&gt;
&lt;p&gt;이제 우리가 작성한 설정 값을 기반으로 객체를 생성해서 활용해보자. 아래는 실제 프로젝트에서 사용하고 있는 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt;의 일부를 가져온 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;oauth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;google&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;client-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;GOOGLE_CLIENT_ID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;client-secret&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;GOOGLE_CLIENT_SECRET&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;redirect-uri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;GOOGLE_REDIRECT_URI&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;oauth-end-point&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//accounts.google.com/o/oauth2/v2/auth
    &lt;span class=&quot;token key atrule&quot;&gt;response-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; code
    &lt;span class=&quot;token key atrule&quot;&gt;scopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//www.googleapis.com/auth/userinfo.profile
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//www.googleapis.com/auth/userinfo.email
    &lt;span class=&quot;token key atrule&quot;&gt;token-uri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;GOOGLE_TOKEN_URI&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;grant-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; authorization_code
&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이것을 객체로 추출하기 위해서는 아래와 같이 작성해야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@ConfigurationProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;oauth.google&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@ConstructorBinding&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; oAuthEndPoint&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; responseType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; scopes&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; oAuthEndPoint&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; responseType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; scopes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clientId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clientSecret &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;redirectUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;oAuthEndPoint &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthEndPoint&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;responseType &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; responseType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scopes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; scopes&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tokenUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grantType &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getClientId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; clientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getClientSecret&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; clientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getRedirectUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; redirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getoAuthEndPoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; oAuthEndPoint&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getResponseType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; responseType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getScopes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; scopes&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getTokenUri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; tokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getGrantType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; grantType&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt;: 프로퍼티에 있는 값을 클래스로 바인딩하기 위해 사용하는 애노테이션이다. &lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt;는 값을 바인딩하기 위해 기본적으로 &lt;code class=&quot;language-text&quot;&gt;Setter&lt;/code&gt;가 필요하다. 하지만 &lt;code class=&quot;language-text&quot;&gt;Setter&lt;/code&gt;를 열어둘 경우 불변성을 보장할 수 없다. 이때 생성자를 통해 바인딩 하기 위해서는 &lt;code class=&quot;language-text&quot;&gt;@ConstructorBinding&lt;/code&gt;을 활용할 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@ConstructorBinding&lt;/code&gt;: 앞서 언급한 것 처럼 생성자를 통해 바인딩하기 위한 목적의 애노테이션이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EnableConfigurationProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PropertiesConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@EnableConfigurationProperties&lt;/code&gt;: 클래스를 지정하여 스캐닝 대상에 포함시킨다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;개선하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; JWT_DELIMITER &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\\.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; googleProperties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplate&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleProperties&lt;/span&gt; googleProperties&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplateBuilder&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;googleProperties &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleProperties&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restTemplate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; restTemplateBuilder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objectMapper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이전 보다 적은 수의 필드를 활용하여 설정 정보를 다룰 수 있도록 개선되었다.&lt;/p&gt;
&lt;h3&gt;정리&lt;/h3&gt;
&lt;p&gt; 우리는 &lt;code class=&quot;language-text&quot;&gt;application.yml&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;application.properties&lt;/code&gt;에 작성하여 메타 정보를 관리할 수 있다. 클래스 내부에서 관리할 경우 수정하기 위해서는 해당 클래스에 직접 접근해야 한다. 하지만 설정 파일로 분리할 경우 우리는 환경에 따라 유연하게 값을 설정할 수 있다. 또한 &lt;code class=&quot;language-text&quot;&gt;@ConfigurationProperties&lt;/code&gt; 애노테이션을 사용할 경우 클래스로 값을 바인딩하기 때문에 연관된 값을 한 번에 바인딩할 수 있다.&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;달록 repository&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://mangkyu.tistory.com/207&quot;&gt;[Spring] @Value와 @ConfigurationProperties의 사용법 및 차이 - (2/2)&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://docs.spring.io/spring-boot/docs/2.7.1/reference/html/configuration-metadata.html#appendix.configuration-metadata.annotation-processor&quot;&gt;appendix.configuration-metadata.annotation-processor&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[MockMvc를 사용한 Spring RestDocs]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '리버'가 작성했습니다. Rest Docs Spring Rest Docs는 테스트 코드 기반으로 자동으로 Rest API 문서를 작성 할 수 있도록 도와주는 프레임 워크이다. Rest Docs와 Swagger…]]></description><link>https://dallog.github.io/apply-rest-docs/</link><guid isPermaLink="false">https://dallog.github.io/apply-rest-docs/</guid><pubDate>Tue, 26 Jul 2022 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/gudonghee2000&quot;&gt;리버&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Rest Docs&lt;/h2&gt;
&lt;p&gt;Spring Rest Docs는 테스트 코드 기반으로 자동으로 Rest API 문서를 작성 할 수 있도록 도와주는 프레임 워크이다.&lt;/p&gt;
&lt;h2&gt;Rest Docs와 Swagger&lt;/h2&gt;
&lt;p&gt;자바 문서 자동화에는 주로 Rest Docs와 Swagger가 사용된다.
각 자동화 프레임 워크의 장단점을 살펴보자.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/90694/compare.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABJ0AAASdAHeZh94AAABTUlEQVQY03XLy07CQBQG4D6hEcWVC9mb+AAqsDCRnYmP4kKRKIpCi+20BVpboFw6M73fbKFa484jbjX5Mjn/mfMz5Rq/U+UrDXR4gQ7O+e0TrrRRrvPlmrB/xh9dipWGsHXMlU65nWp/t8rv1QVoAUbSIlmPWZFetQatJ+32UW22R80HhRWJrEUvQ+e6rbY6Oixv7gd3z3qnP0eKL71GUGTitEiyTy/MTOITK1yYLgw/Lw3COAeEBsSOMPHnBl6aDnxRO0rXX0laMNhZEzdf0jdtYmtTZ2x4Y8MdzzyIuuGaVgrz5Nfcn4JFMF2EcLm0MkZSQyAqPitgDhFOpByiLCIswpxERSXo8kuIPQF3ebMH4EykPcFEI5/B9po4+cyMBNkYqljRLaDqFpJn0miBrYy6+Z+gyIRJAYL43fFSN1h5wcrdsCH6qzD5+F/xDaT1WJ5R4sEDAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;compare&apos; title=&apos;compare&apos; src=&apos;/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/ca1dc/compare.png&apos; srcset=&apos;/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/e7570/compare.png 170w,
/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/f46e7/compare.png 340w,
/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/ca1dc/compare.png 680w,
/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/02d09/compare.png 1020w,
/static/d2b4c0c198f8d46b6e00d12cfb0f88eb/90694/compare.png 1318w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Swagger는 API 문서의 작성을 위해 프로덕션 코드에 추가적인 코드를 작성해야한다.
그래서 Swagger의 사용은 프로덕션 코드의 가독성을 떨어트린다고 생각한다.&lt;/p&gt;
&lt;p&gt;반대로, Spring Rest Docs는 테스트 코드에 의존적이기 때문에 Spring Rest Docs를 사용하는것이 좋다고 생각한다.&lt;/p&gt;
&lt;h2&gt;MockMvc vs Rest Assured&lt;/h2&gt;
&lt;p&gt;Spring Rest Docs를 사용하여 문서를 작성 하려면 테스트 코드가 필요하다.
테스트 코드를 작성 할 때, 대표적으로 MockMvc와 Rest Assured를 사용한다.&lt;/p&gt;
&lt;p&gt;MockMvc를 사용하면  &lt;code class=&quot;language-text&quot;&gt;@WebMvcTest&lt;/code&gt;로 테스트 할 수 있다.
그래서 Controller Layer만으로 테스트 하기 때문에 테스트 속도가 빠르다.&lt;/p&gt;
&lt;p&gt;반면, RestAssured는 &lt;code class=&quot;language-text&quot;&gt;@SpringBootTest&lt;/code&gt;로 수행해야한다. 그러면 전체 어플리케이션 컨텍스트를 로드하여 빈을 주입하기에 테스트 속도가 느리다.
하지만, 실제 객체를 통한 테스트가 가능하기 때문에 테스트의 신뢰성이 높다.&lt;/p&gt;
&lt;p&gt;통합 테스트, 인수 테스트의 경우 RestAssuerd가 좋을 수 있지만, 문서를 작성하기 위한 테스트에는 MockMvc가 더 적절하다고 생각한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;💡 @WebMvcTest와 @SpringBootTest&lt;/em&gt;&lt;/strong&gt;
@WebMvcTest는 Application Context를 완전하게 Start하지 않고 Present Layer 관련 컴포넌트만 스캔하여 빈 등록한다.
반면, @SpringBootTest의 경우 모든 빈을 로드하여 등록한다.&lt;/p&gt;
&lt;h2&gt;AsciiDoc&lt;/h2&gt;
&lt;p&gt;Spring Boot Rest Docs는 Asciidoc를 문서 번역을 위한 텍스트 프로세서로 사용한다.&lt;/p&gt;
&lt;h2&gt;Rest Docs API 문서 생성 매커니즘&lt;/h2&gt;
&lt;p&gt;우선, Rest Docs의 문서 생성 매커니즘을 살펴보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;MockMvc로 작성한 테스트 코드를 실행한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;테스트가 통과하면 아래와 같이 &lt;code class=&quot;language-text&quot;&gt;build/generated-snippets&lt;/code&gt; 하위에 스니펫(문서조각)들이 생성된다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 311px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f94923887173d0bfee01596d1d760923/fedc7/first.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 99.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y41Te2/aMBDnO3WQ2EkIAUp5JPbd2U7KQ4D2UFtoh9iq/dd99p1TdV3V0SBdTnGkn3+Py7X0rEc42UL6RKGByKC0OtLTjL83VosfKAYLlR0xXqKoUBid6ElfT88Dq2lKepTrq98Q7lGQCeeu7TBSTfwv4KJPangA+RkkYeR0gnl6LrPRA9TDXxDeMpiE1bGaZOcyG33Jyhl8g8zMzmVFojIBFt0GsJ6lWPRRDY8gv3LaKEuISoy4myLFvMdFeQ9OelYDgtETdvYmVDaoDNOGXBwb90XVnrvO+xRar4dpCjD+AvEjCVDSgrC1CofCkYT/5fcKZlWoL7cqfQRZ2rSykQNRMhL9LWyNJw8nmWtyNctGV8nPw2GzIlO0vXkSXJzftTci4CTY82fFOHm4+7ZeFkYHRiWuFm+BK+II/nXeeucky8fxj91uu1IlXpQQe1oTlhTW5AHm3QbwYb/brLSFtoWYmUsfm2fm+bEE+BCcfN/drpeKwQZiW4Ofb3HEKcb4MfNx72U7uuCErE5KL5uTl6UJSiMawPf7m/VCk+o4vySRq6dtdMQqOEKYNjDfbZbs+RMzOx47/2f1tCqSvHDwsjBvwIp7Xqd9/7BdaYcMrjeEV8U8Zy6vbUBF+hacZ5BnVd71Y5ym67kpaURKko5JJVQkyJ3f/TH++6v+AeD8X7vWRAwgAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;first&apos; title=&apos;first&apos; src=&apos;/static/f94923887173d0bfee01596d1d760923/fedc7/first.png&apos; srcset=&apos;/static/f94923887173d0bfee01596d1d760923/e7570/first.png 170w,
/static/f94923887173d0bfee01596d1d760923/fedc7/first.png 311w&apos; sizes=&apos;(max-width: 311px) 100vw, 311px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;❗❗ gradle은 build/generated-snippets에 스니펫이 생성된다.&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;build/generated-snippets&lt;/code&gt; 하위에 생성된 스니펫들을 묶어서 HTML 문서를 만들기 위해서는, gradle의 경우 아래와 같이&lt;code class=&quot;language-text&quot;&gt;src/docs/asciidoc&lt;/code&gt; 하위에 스니펫들을 묶은 adoc문서를 만든다.&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 339px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 41.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABIUlEQVQY042OS0vDQBSFs7TWtQvBx6a0SGla+zDznjszSSbpNI1NSYVWxQeoG///0qEFUcEifKt7zse5gQBNhASTFNVq8/KWueKmqrNZgbmgEv6CScCUBxQMEYqrOJsv67vnNHc6zYSO/XE/ERUBIn5BMzD5vFrdP8V2SqXxwf9kzL2MOXgfYvv4/uHKZV6U/qNrKhCDfTKhjPllqTygk8S61fqhXNbKpNnUmcTuol9wqRATwRjxPobBliHVI2bSxcYu1totIC9ZOguR/Cr8IOLBeYgP2vyow5sdfthmjRYJTkdn4zyuXy8ucasve0N90pWNNmtuOzsaHX7cJcEwYj0EYSQHRE+kVfNbpKaxq7QtR0RNqJ5QdYXB74e+9p2IfwKrT3TYBiaq6gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;second&apos; title=&apos;second&apos; src=&apos;/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png&apos; srcset=&apos;/static/14846100df54ad09c5367e8df4aaecb2/e7570/second.png 170w,
/static/14846100df54ad09c5367e8df4aaecb2/527f2/second.png 339w&apos; sizes=&apos;(max-width: 339px) 100vw, 339px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;li&gt;스니펫을 이용해서 &lt;code class=&quot;language-text&quot;&gt;src/docs/asciidoc&lt;/code&gt; 하위에 adoc 파일을 생성했다면, &lt;code class=&quot;language-text&quot;&gt;./gradlew build&lt;/code&gt; 명령어를 통해 빌드를 해준다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 353px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQoz42S207CQBCGfQoE1HjlhUbbIniAdruz3S203R63hVYMiDHRKInvf+m0Em48pMmfzR7+LzM7MwdjAoQJ5nrqYRVE6dQPQcxM6vwn4GOLXg9vDvBgOy735Pp1G0QJAX5v0bbwxGYoDI5YuX7JyuUsqIPjZQuY1CaEqePOH5+SeSXjDJNvB9s72AauNm/R87YqqzBVmLwFvBWMwg0Av8uW4+WrlBFW4c60f4//EzYpx8x9tYir1dSTrh9iC4BPW8IOcVyZqPVj4UcJ/vz789jLP2GCrYKdCGWUcS8Inz8+ZazCJAviNMpyyl182tvQY5IG7mj2oUb36qIM1tXZUOZXIC9G4vxWnA1ZT6OdK3rYCDcnmjVEGG97+k59A/q46vRoIAa50IVjjBztFi5HcGwAOvt6bejq9NRoYJvxWk0+mMyEEALifbspFkVeVJEq0qKMEqXyYr4oVTFPsgz9pg1NwagzbkqFQ6qqVZyXQZjMPEGFoHxaTx6OAKtfUdh5i4lJM8IIfwEBQsLymO4IDwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;third&apos; title=&apos;third&apos; src=&apos;/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png&apos; srcset=&apos;/static/a7bf9f7dfb5ce4935434e295f7a8b010/e7570/third.png 170w,
/static/a7bf9f7dfb5ce4935434e295f7a8b010/f46e7/third.png 340w,
/static/a7bf9f7dfb5ce4935434e295f7a8b010/8e4bf/third.png 353w&apos; sizes=&apos;(max-width: 353px) 100vw, 353px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
빌드가 완료되면 위와 같이 &lt;code class=&quot;language-text&quot;&gt;resources - static - docs&lt;/code&gt; 하위에 HTML 문서가 생성된다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;어플리케이션을 실행 한 후, &lt;code class=&quot;language-text&quot;&gt;http://localhost:8080/docs/{HTML 파일명}&lt;/code&gt; 을 웹브라우저에 검색하면 생성한 REST API 문서를 확인 할 수 있다. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;❗❗ API문서 url은 코드를 통해 변경 가능하다.&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;❗유의할 점&lt;/h3&gt;
&lt;p&gt;resources - static - docs 하위의 HTML 파일은 실제로는 build.gradle의 설정파일에 따라서 위와같이 build - docs - asciidoc 하위의 HTML 파일을 복사해온 파일이다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 48.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVQoz32RS0/DMBCE85s4NH6ksdOEtHb8WDtxogKFQ6VKcGsPSBz55yylKpe00lxs+fPMzmZVJdq20Wr98vzUaWksaVpR19V9IZXnNPOqjLDegfz2DynSAeWWTlfQyVsKRlolFjnJnBa+k9HVA7SnQPeR98BG4PgC72cFRholckoRLvEc7ApcewS2h2IINAUWrLgPLzA2xnD6F8bwX0AOkfmeRiudWnld3YXJxdmfh4l+8wHLU6TekwnQn3sj5uGNIIRlVpXX2+iaN1cePN9OjykWKVAMD7ecCT3D5hIPV6VUpc1qd+zTWI5AtikfA5t1zgn9bzv49hPYIbA+sjSRsacJO+8E6NvOfzMDmtvm3RWvgKvig+MD/uKWMNfZtbAfFm+qS78dXqMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;four&apos; title=&apos;four&apos; src=&apos;/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png&apos; srcset=&apos;/static/1c4dd4c620257df717630f3974410098/e7570/four.png 170w,
/static/1c4dd4c620257df717630f3974410098/f46e7/four.png 340w,
/static/1c4dd4c620257df717630f3974410098/3a2f8/four.png 352w&apos; sizes=&apos;(max-width: 352px) 100vw, 352px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;아이디어&lt;/h3&gt;
&lt;p&gt;REST API 문서를 확인할 때, &lt;code class=&quot;language-text&quot;&gt;http://localhost:8080/docs/{HTML 파일명}&lt;/code&gt; 을 통해서 웹브라우저에 접근하지 않아도 확인하는 방법이 있다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/761a34bf571d990e90fd93be1543a239/867ee/five.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 58.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQoz22Ri46cIBSGfZIZZ7ZZFRBQ8K6Id5xR27RNb+//ID3s7G6yTU++4G/053B+nPH4k/V71m+w5sMBgEg7+5roW6xM0t5AyNZqqe9Cb4DUe3E7nKy95doU2iT1WPW3XC2i7EXRRbmWzZQ0c2LXN9ScqAWQammn1RFCpmlCMEKBj3wP+c8hCYtUUkYZ55TSwPcv7uUNF3DP7tP1Wredk4pIcEJDjMmHwhinWZGXdSQSHot/iGVSKm3NWRwKHnIavhelIUK4n6avP36abV/3w+zH+pF2mJyIM8lwzKyHACS0bQkOgkDp7vuv32AeFjOadVwMiH5eABCqH605YiSC8Rh7GZLD0x4aYzibPWQkKItIyDChAcKeHwAgiqZ1BHTmRMIe3AIpwR7QHb6XdTMZ041TpXRRN2XTVuqVutW1HhxKGbZh2QO/1yOzWEgGPaGhjzwvuF4+nc7u+Xw5nSD3p7xSDzMCP0Lwx7P3Ur7v+Z4n0wzSTvMiKyoQMs1hkAciySq4KrhJa0YIZh7mdYZsII9x1t0ACUFai2Vb7htos7+y7rtNW4qMcciDRrFYty/349t6P0CY+2eYtu66puv/S637v4zpm5Q7i9sbAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;five&apos; title=&apos;five&apos; src=&apos;/static/761a34bf571d990e90fd93be1543a239/ca1dc/five.png&apos; srcset=&apos;/static/761a34bf571d990e90fd93be1543a239/e7570/five.png 170w,
/static/761a34bf571d990e90fd93be1543a239/f46e7/five.png 340w,
/static/761a34bf571d990e90fd93be1543a239/ca1dc/five.png 680w,
/static/761a34bf571d990e90fd93be1543a239/02d09/five.png 1020w,
/static/761a34bf571d990e90fd93be1543a239/9d567/five.png 1360w,
/static/761a34bf571d990e90fd93be1543a239/867ee/five.png 1586w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
AsciiDoc 플러그인을 설치하면 위와같이, 인텔리제이 상에서도 REST API 문서를 실시간으로 확인할수 있다.  (✔설치 추천)&lt;/p&gt;
&lt;h2&gt;Rest Docs 사용을 위한 빌드파일 설정&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;plugins &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    id &apos;org&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asciidoctor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;jvm&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;convert&apos; version &lt;span class=&quot;token char&quot;&gt;&apos;3.3.2&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 1&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

ext &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    snippetsDir &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&apos;build&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;generated&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;snippets&apos;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 2&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

test &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
    outputs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dir snippetsDir &lt;span class=&quot;token comment&quot;&gt;// 3&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;useJUnitPlatform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

configurations &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    asciidoctorExtensions
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

asciidoctor &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 4&lt;/span&gt;
    configurations &apos;asciidoctorExtensions&apos; 
    inputs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dir snippetsDir 
    dependsOn test
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

dependencies &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    testImplementation &apos;org&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;springframework&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restdocs&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;spring&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;restdocs&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;mockmvc&apos; &lt;span class=&quot;token comment&quot;&gt;// 5&lt;/span&gt;
    asciidoctorExtensions &apos;org&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;springframework&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restdocs&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;spring&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;restdocs&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;asciidoctor&apos; &lt;span class=&quot;token comment&quot;&gt;// 6&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

task &lt;span class=&quot;token function&quot;&gt;copyDocument&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Copy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 7&lt;/span&gt;
    dependsOn asciidoctor
    
    from &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;build/docs/asciidoc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    into &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;src/main/resources/static/docs&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
	
bootJar &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
    dependsOn copyDocument &lt;span class=&quot;token comment&quot;&gt;// 8&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;gradle7부터 사용하는 플러그인으로 asciidoc 파일 변환, build 디렉토리에 복사하는 플러그인이다.&lt;/li&gt;
&lt;li&gt;생성된 스니펫을 저장할 위치를 정의한다. gradle은 &lt;code class=&quot;language-text&quot;&gt;build/generated-snippets&lt;/code&gt;에 스니펫이 생성된다.&lt;/li&gt;
&lt;li&gt;테스트 Task의 결과 아웃풋 디렉토리를 &lt;code class=&quot;language-text&quot;&gt;build/generated-snippets&lt;/code&gt;로 지정한다.&lt;/li&gt;
&lt;li&gt;asciidoctor Task가 사용할 인풋 디렉토리를 &lt;code class=&quot;language-text&quot;&gt;build/generated-snippets&lt;/code&gt;로 지정한다.
dependsOn test로 문서가 작성되기 전에 테스트가 실행되도록 한다.&lt;/li&gt;
&lt;li&gt;MockMvc를 테스트에 사용하기 위한 의존성을 추가 해준다.&lt;/li&gt;
&lt;li&gt;일반 텍스트를 처리하고 HTML 파일을 생성하는 의존성을 추가 해준다.&lt;/li&gt;
&lt;li&gt;asciidoctor Task로 생성한 &lt;code class=&quot;language-text&quot;&gt;build/docs/asciidoc&lt;/code&gt;파일을 &lt;code class=&quot;language-text&quot;&gt;src/main/resources/static/docs&lt;/code&gt;로 복사한다.&lt;/li&gt;
&lt;li&gt;bootJar 실행시 copyDocument를 먼저 실행하도록 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;✅MockMvc를 사용한 Rest Docs 테스트 작성을 알아보기 전에 우선 MockMvc에 대해 알아보자.&lt;/p&gt;
&lt;h2&gt;MockMvc 기본 메서드&lt;/h2&gt;
&lt;p&gt;어떠한 것들이 있는지 알아보고 밑에서 자세히 알아보자.&lt;/p&gt;
&lt;h3&gt;perform()&lt;/h3&gt;
&lt;p&gt;가상의 request를 처리한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/schedules/?year=2022&amp;amp;month=7&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;andExpert()&lt;/h3&gt;
&lt;p&gt;andExpert()&lt;/p&gt;
&lt;p&gt;예상값을 검증한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// status 값이 정상인 경우를 기대하고 만든 체이닝 메소드의 일부&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;contentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;application/json;charset=utf-8&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;//contentType을 검증&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;andDo()&lt;/h3&gt;
&lt;p&gt;요청에 대한 처리를 맡는다. print() 메소드가 일반적이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;andReturn()&lt;/h3&gt;
&lt;p&gt;테스트한 결과 객체를 받을 때 사용한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token class-name&quot;&gt;MvcResult&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andReturn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;MockMvc 요청 만들기&lt;/h2&gt;
&lt;p&gt;요청을 만들 때는 static 메서드인 get, post, put, delete, fileUpload 등을 이용해서 MockHttpServletRequestBuilder 객체를 생성하는 것에서 시작한다.&lt;/p&gt;
&lt;p&gt;MockHttpServletRequestBuilder는 ServletRequest를 구성하기에 필요한 다양한 메서드를 제공한다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/339d06cdbd29be2a7151137a00024a12/7a863/six.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAACD0lEQVQozz2QTYvTQBjH88HUghcPHr159APsVg/ixZt+A99gQUHcdRUUEUT3IkrSNGmbSTN5nWSSmaQv22aSJou0K5580nQLP4Znfs8z8H9GunEoA9cPlTuPtXtPtduP+tcOlMYcyDcf9Drdptvpqrce9u8+GQKd+2qnq7SvpOMf/OQsffuNHn12X38Jjj45774zkMD7M2hxuL78YL76OH5xip6fomcnozdfQ3gCA1LMqoTXJBKWkznebIxTmqxAbn1zwtWyMxNzc8wMM0EWC6mIWQ0tKS83YnWZzUo/TNNp4RE+W9RgwAPLYl1Uf/kkd3zmBhxmCJ3mq03blUhctbhEGFbqhWJvwmRX+LQcmkxHsWZQh+Tkyks4KACblKaz7A+TsZfbWwM4pGhqv7A80R8xWYt6A4rsc3w1ILUBIOd8eRHGMzj3mfNyDbHL+h/LhOVS12d+mAGwyC52yKoW7E1HKMbeLOL1XkKN/Tmy4LcSNGbaKBxCgTOSrKArWZCqodRRJqtkgDIclK2EwFBraKLqsQqZ9fhXL5B12hvAdgIGIPYaENXlZFa6bjxfQOzNTq7WC/EH/pmlS0LSiE4huRekTsC3220kmtYtbjC3MIczzi5oWrUSaic4h42wnZoWG6DIsBLT5hFvBiTDzhscoepMVog2TJEjWokAR/SNqaxSaCl68lMhv6HW2QgvYeA/pmdSXa5mm6MAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;six&apos; title=&apos;six&apos; src=&apos;/static/339d06cdbd29be2a7151137a00024a12/ca1dc/six.png&apos; srcset=&apos;/static/339d06cdbd29be2a7151137a00024a12/e7570/six.png 170w,
/static/339d06cdbd29be2a7151137a00024a12/f46e7/six.png 340w,
/static/339d06cdbd29be2a7151137a00024a12/ca1dc/six.png 680w,
/static/339d06cdbd29be2a7151137a00024a12/02d09/six.png 1020w,
/static/339d06cdbd29be2a7151137a00024a12/7a863/six.png 1139w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
위 메서드들은 메서드 체이닝을 지원하기 때문에, 아래와 같이 요청 데이터를 연결해서 작성하면된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;MockHttpServletRequestBuilder&lt;/span&gt; builder &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/schedules&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;year&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2022&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;month&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;7&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sessionId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;세션아이디입니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;builder&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;❗❗ 유의 할 점&lt;/strong&gt;&lt;/em&gt;
MockMvc.perform() 의 파라미터 값이 MockHttpServletRequestBuilder의 상위 객체이다. &lt;/p&gt;
&lt;p&gt;그래서 perform() 파라미터로 아래와 같이 넣어주어도 작동된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/schedules&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;year&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2022&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;month&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;7&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sessionId&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;세션아이디입니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;MockMvc 실행 결과 검증&lt;/h2&gt;
&lt;p&gt;perform()은 반환 값으로 ResultActions가 반환된다.
ResultActions의 andExpect는 요청 실행 결과를 검증 하려면 ResultMatcher를 넘겨줘서 검증해야한다.
ResultMatcher는 다음의 MockMvcResultMatchers가 가지는 static 메서드를 통해서 얻는다.&lt;/p&gt;
&lt;p&gt;MockMvcResultMatchers는 다음의 static 메서드를 통해 다양한 ResultMatcher를 제공한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c2f972798e14e46166995818bb7fdcd2/7a863/seven.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAABoUlEQVQozz2OT2vUQBiH53NpF0HQb+DBgxfvbRXs0ZssWAVB1Jtg1YOF6k2Qoq27m26X3U3SySSTP5PNJJkkm002TU2tXn3TWQsPw/s+72/gh9Y2BsD19cGdx8P73dHtR8q19ZW5+bDf2WznzsbRra3h3Sfje93pjQfDzqYif6FXe17LZ/byE33xEa/WS958Ya/B7zrbO/rTd+qz99r2jtZ9O37+AUMeAogFp4DPa+rmuhHJ9b9svctKTGIdh8BE9cdTj5iC8RoCaF7+BvLlRZhUlhuni0YayaL6w3huOqHjp7afYCsAqBdDHq6Ii19AmDQsWGIrDuJamitmUU29uUGFTrhm8BMSMl7JE9KtEjihywme90e+ZhbSXMr2xXY1wVl/NDsY2D+P3MFoBmEZQDnUK84Xy4soqWwmxPwMZpASqA1XA6q6glBOaEhoEERFUf2FK4rSpiU7D6JTm2VhcrYyaRNnDRe17WWWm5qOMG0BA7ZC6qWMlxBAmllKpkaujPnVqpIC6h2r8dd9tTdk33v0UHF7x/63H3j/kBwoDmT+ATySs4QQFb3nAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;seven&apos; title=&apos;seven&apos; src=&apos;/static/c2f972798e14e46166995818bb7fdcd2/ca1dc/seven.png&apos; srcset=&apos;/static/c2f972798e14e46166995818bb7fdcd2/e7570/seven.png 170w,
/static/c2f972798e14e46166995818bb7fdcd2/f46e7/seven.png 340w,
/static/c2f972798e14e46166995818bb7fdcd2/ca1dc/seven.png 680w,
/static/c2f972798e14e46166995818bb7fdcd2/02d09/seven.png 1020w,
/static/c2f972798e14e46166995818bb7fdcd2/7a863/seven.png 1139w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;아래의 예시를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;	&lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;builder&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;handlerType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ScheduleController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;methodName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;save&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forwardedUrl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringValues&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Content-Language&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;attribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;저장이 잘되었습니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;MockMvc 실행 결과 처리&lt;/h2&gt;
&lt;p&gt;실행 결과를 출력할 떄는 andDo 메서드를 사용한다.
andDo 메서드 의 인수에는 실행 결과를 처리 할 수 있는 ResultHandler를 지정한다.
MockMvcResultHandlers는 다양한 ResultHandler를 제공하지만 print()를 주로 사용한다.&lt;/p&gt;
&lt;h2&gt;MockMvc를 사용한 Rest Docs 생성&lt;/h2&gt;
&lt;p&gt;테스트 코드와 함께 MockMvc를 사용한 Rest Docs 생성을 알아보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@WebMvcTest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ScheduleController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@AutoConfigureRestDocs&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ScheduleControllerTest&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MockMvc&lt;/span&gt; mockMvc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@MockBean&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 2&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ScheduleService&lt;/span&gt; scheduleService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Test&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// given&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;ScheduleCreateRequest&lt;/span&gt; request &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ScheduleCreateRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;제목&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;메모&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token function&quot;&gt;given&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scheduleService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;willReturn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1L&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 3&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// when &amp;amp; then&lt;/span&gt;
        mockMvc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/schedules&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;objectMapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;contentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_JSON&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andExpect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isOk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;andDo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;schedule-save&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 4&lt;/span&gt;
                        &lt;span class=&quot;token function&quot;&gt;requestFields&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;fieldWithPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonFieldType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;STRING&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;제목&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;fieldWithPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;startDateTime&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonFieldType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;STRING&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                                        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;2022-07-04T13:00&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;fieldWithPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;endDateTime&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonFieldType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;STRING&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;2022-07-05T07:00&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;token function&quot;&gt;fieldWithPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;memo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonFieldType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;STRING&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;메모입니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;target/generated-snippets dir 생성하고 테스트 코드를 통해 snippets를 추가해주는 애노테이션이다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ScheduleService&lt;/code&gt;를 mocking을 하기위해서 &lt;code class=&quot;language-text&quot;&gt;@MockBean&lt;/code&gt; 을 선언한다.&lt;/li&gt;
&lt;li&gt;mocking을 통해 &lt;code class=&quot;language-text&quot;&gt;ScheduleService&lt;/code&gt; 를 통해 받을 응답값을 설정한다.&lt;/li&gt;
&lt;li&gt;test 수행시 &lt;code class=&quot;language-text&quot;&gt;andDo(document(&quot;xxx&quot;))&lt;/code&gt;를 통해서 &lt;code class=&quot;language-text&quot;&gt;./build/generated-snippets&lt;/code&gt; 하위에 문서가 작성된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2&gt;끝내면서&lt;/h2&gt;
&lt;p&gt;이상 Rest Docs의 매커니즘, 설정 그리고 MockMvc를 활용한 Rest Docs 생성 방법을 살펴보았다.
프로젝트에 RestAssuered를 사용한 Rest Docs를 적용하면서 테스트 격리에 문제를 경험하였는데,
테스트 격리에 대해서 추후에 포스팅 해봐야겠다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[JPA 작동 메커니즘]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 '리버'가 작성했습니다. 들어가기에 앞서 이전 포스팅에서 SQL 중심적인 개발의 문제점을 살펴보고 객체 중심적인 개발을 하기위한 JAVA의 JPA를 가볍게 언급해보았다. 그렇다면, JPA는 어떠한 매커니즘으로 JAVA…]]></description><link>https://dallog.github.io/mechanism-of-jpa/</link><guid isPermaLink="false">https://dallog.github.io/mechanism-of-jpa/</guid><pubDate>Tue, 26 Jul 2022 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/gudonghee2000&quot;&gt;리버&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;들어가기에 앞서&lt;/h3&gt;
&lt;p&gt;이전 포스팅에서 SQL 중심적인 개발의 문제점을 살펴보고 객체 중심적인 개발을 하기위한 JAVA의 JPA를 가볍게 언급해보았다.&lt;/p&gt;
&lt;p&gt;그렇다면, JPA는 어떠한 매커니즘으로 JAVA에서 작동할까?
이번 포스팅에서 JPA의 구동방식을 자세히 알아보자.  &lt;/p&gt;
&lt;h3&gt;JPA 구동방식&lt;/h3&gt;
&lt;p&gt;우선, 아래의 그림을 통해 JPA의 구동방식을 가볍게 살펴보자.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/a03ffcc3f1c93248b7d90f632efc734b/64756/jpa-mechanism.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABJ0AAASdAHeZh94AAABG0lEQVQoz5VS2XLCMAzM/39gmSmQlBzQ0JDLxKdkV8JuKaEvaHZsj0ar1eFMiXqRRggxT5PRKrxiWbo9hIB8gg3e8yMBySOmYewv0zhc5zGg44BIvt04j8PhUJItVxHQBKdvUAyP/TC8bTbb3e7S90ngrkyZwLErIgSlVNM0PiqQVIBlHgkUyrX8Kt87AMP4zziYUqCbBdu6Z0A08uq0dIDPXIaT1IJUmopakf3l63z+PNFJ8PiHD9YqqeVijQajA9rHaXMPQHOqyo9jUym5pCHHeq1u27aq67o8zEMXEDzXb+mRyN6Zqizft9s8L45N7XlbP+J42x9actIIi6LY7/Ou6+LCshSB8LDb57bjOkgZHInFmOylL7VK/Q3CQoTKKFZc0gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;jpa mechanism&apos; title=&apos;jpa mechanism&apos; src=&apos;/static/a03ffcc3f1c93248b7d90f632efc734b/ca1dc/jpa-mechanism.png&apos; srcset=&apos;/static/a03ffcc3f1c93248b7d90f632efc734b/e7570/jpa-mechanism.png 170w,
/static/a03ffcc3f1c93248b7d90f632efc734b/f46e7/jpa-mechanism.png 340w,
/static/a03ffcc3f1c93248b7d90f632efc734b/ca1dc/jpa-mechanism.png 680w,
/static/a03ffcc3f1c93248b7d90f632efc734b/02d09/jpa-mechanism.png 1020w,
/static/a03ffcc3f1c93248b7d90f632efc734b/64756/jpa-mechanism.png 1200w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;먼저, JPA는 Build 파일을 통해서 JPA 인터페이스를 구현할 &lt;strong&gt;구현체 클래스인&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;Persistence&lt;/code&gt; 생성한다.
&lt;strong&gt;(JPA는 인터페이스이며 구현체로는 Hibernate, EclipseLink 등이 있음)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;그리고 생성한 &lt;code class=&quot;language-text&quot;&gt;Persistence&lt;/code&gt;로 &lt;code class=&quot;language-text&quot;&gt;META-INF/Persistence.xml&lt;/code&gt;라는 설정파일의 정보를 읽어서 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;라는 클래스를 생성한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;는 필요할때 마다 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt; 라는 클래스를 생성한다. &lt;/p&gt;
&lt;p&gt;개발자는 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;를 통해서 DB에 접근하고 CRUD 작업을 수행한다.&lt;/p&gt;
&lt;p&gt;위와 같은 과정을 통해 JPA를 사용 할 수 있다.&lt;/p&gt;
&lt;p&gt;그렇다면, &lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;란 무엇일까?
아래에서 자세히 살펴보자.&lt;/p&gt;
&lt;h3&gt;Persistence.xml란?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt;은 JPA가 엑세스하려는 데이터베이스들에 대해 필요한 설정정보 들을 기술해둔 파일이다.
JPA는 이 파일의 설정정보를 바탕으로 접근할 DB의 정보를 가져 올 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt; 파일에 대해 아래 그림과 함께 자세히 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&amp;lt;persistence version=&quot;2.2&quot;
 	xmlns=&quot;http://xmlns.jcp.org/xml/ns/persistence&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd&quot;&gt;
	&amp;lt;persistence-unit name=&quot;hello&quot;&gt;
 		&amp;lt;properties&gt;
 			&amp;lt;!-- 필수 속성 --&gt;
 			&amp;lt;property name=&quot;javax.persistence.jdbc.driver&quot; value=&quot;org.h2.Driver&quot;/&gt;
 			&amp;lt;property name=&quot;javax.persistence.jdbc.user&quot; value=&quot;sa&quot;/&gt;
 			&amp;lt;property name=&quot;javax.persistence.jdbc.password&quot; value=&quot;&quot;/&gt;
			&amp;lt;property name=&quot;javax.persistence.jdbc.url&quot; value=&quot;jdbc:h2:tcp://localhost/~/test&quot;/&gt;
 			&amp;lt;property name=&quot;hibernate.dialect&quot; value=&quot;org.hibernate.dialect.H2Dialect&quot;/&gt;

 			&amp;lt;!-- 옵션 --&gt;
 			&amp;lt;property name=&quot;hibernate.show_sql&quot; value=&quot;true&quot;/&gt;
 			&amp;lt;property name=&quot;hibernate.format_sql&quot; value=&quot;true&quot;/&gt;
 			&amp;lt;property name=&quot;hibernate.use_sql_comments&quot; value=&quot;true&quot;/&gt;
 			&amp;lt;!--&amp;lt;property name=&quot;hibernate.hbm2ddl.auto&quot; value=&quot;create&quot; /&gt;--&gt;
 		&amp;lt;/properties&gt;
	&amp;lt;/persistence-unit&gt;
&amp;lt;/persistence&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;첫번째로 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;persistence version=&quot;2.2&quot; ...&gt;&lt;/code&gt;태그는 사용할 JPA의 버전과 버전에 대한 Persistence.XML 문서형식 링크를 담고 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;persistence-unit name=&quot;hello&quot;&gt;&lt;/code&gt;태그는 하나의 지속성 단위를 의미한다. 서술적으로 표현하면, &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt;라는 이름을 가지는 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 하위 설정에 따라 만들것이라는 의미이다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;properties&gt;&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;persistence-unit&gt;&lt;/code&gt;이 엑세스할 DB의 정보와 추가적인 옵션 정보들을 담는다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;property&gt;&lt;/code&gt;는 옵션 정보를 하나씩 설정하는 부분이다.
위 그림과 같이 &lt;code class=&quot;language-text&quot;&gt;필수 속성&lt;/code&gt; 부분은 엑세스할 DB에 대한 정보를 담는다.&lt;/p&gt;
&lt;p&gt;추가로 &lt;code class=&quot;language-text&quot;&gt;옵션&lt;/code&gt; 부분을 하나씩 살펴보자.
&lt;code class=&quot;language-text&quot;&gt;hibernate.show_sql&lt;/code&gt;는 DB에 날리는 쿼리문을 확인 할것인지에 대한 설정이다.
&lt;code class=&quot;language-text&quot;&gt;hibernate.format_sql&lt;/code&gt;는 보여지는 쿼리문을 포맷팅하는 설정이다.
&lt;code class=&quot;language-text&quot;&gt;hibernate.use_sql_comments&lt;/code&gt;는 추가적인 &lt;code class=&quot;language-text&quot;&gt;/* */&lt;/code&gt; 주석을 쿼리문에 보여주는 설정이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;hibernate.hbm2ddl.auto&lt;/code&gt; 는 데이터베이스 스키마 자동생성에 대한 설정이다.
&lt;code class=&quot;language-text&quot;&gt;hibernate.hbm2ddl.auto&lt;/code&gt;가 가지는 옵션은 아래와 같다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;create: 기존 테이블 삭제 후 다시 생성 (DROP + CREATE)
create-drop: create와 같으나 종료시점에 테이블 DROP
update: 변경된 부분만 반영 (운영 DB에 사용하면 안됌)
validate: entity와 table이 정상 매핑되었는지만 확인
none: 사용하지 않음&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;strong&gt;주의점❗&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;create, create-drop, update는 운영 DB에 사용하면 안된다.&lt;br&gt;
create, create-drop은 운영 DB의 데이터를 전체 삭제 시키기 때문이다.
update는 아직 알아볼필요가있음&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;이제 설정파일을 통해 생성하는 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 살펴보자.&lt;/p&gt;
&lt;h3&gt;EntityManagerFactory란?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;(Entity를 관리하고 DB 관련작업을 수행 함)을 생성하는 일을한다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;💡 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt; 는 DB 테이블에 대응하는 하나의 객체를 의미한다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;우리는 &lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt; 설정정보를 통해서 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 생성할수 있다.&lt;/p&gt;
&lt;p&gt;아래의 예시코드로 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaMain&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;EntityManagerFactory&lt;/span&gt; emf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
        			&lt;span class=&quot;token class-name&quot;&gt;Persistence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createEntityManagerFactory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// 파라미터로 Persistence.xml에 설정한 persistence-unit의 name 속성값을 넣는다.&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;전 장에서 설정했던 &lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt; 파일을 통해
우리는 &lt;code class=&quot;language-text&quot;&gt;hello&lt;/code&gt;라는 이름을 가진 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;persistence-unit&gt;&lt;/code&gt;이 어떤 DB에 엑세스 할 것인지에 대한 정보를 설정했었다.&lt;/p&gt;
&lt;p&gt;위 코드가 바로 &lt;code class=&quot;language-text&quot;&gt;Persistence.xml&lt;/code&gt;에 작성한 Persistence Unit(지속성 단위)을 바탕으로 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 생성하는 코드이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 통해서 우리는 DB 관련 작업을 실제로 수행할 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;를 생성 할 수 있다.&lt;/p&gt;
&lt;h4&gt;🔎&lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;가 가지는 특징&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;1. 엔티티 매니저 팩토리는 하나의 데이터베이스에 하나만 생성한다. (생성 비용이 비싸기 때문)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 엔티티 매니저 팩토리는 여러 스레드가 동시에 접근해도 안전하다.&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;EntityManager란?&lt;/h3&gt;
&lt;p&gt;엔티티 매니저는 특정 작업을 위해 데이터베이스에 액세스 하는 역할을 한다.
또한 엔티티를 데이터베이스에 CRUD 할 수 있다.
즉, 엔티티와 관련된 모든 일을 처리하기에 이름 그대로 엔티티를 관리하는 관리자다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaMain&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;EntityManagerFactory&lt;/span&gt; emf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
        			&lt;span class=&quot;token class-name&quot;&gt;Persistence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createEntityManagerFactory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// 파라미터로 Persistence.xml에 설정한 persistence-unit의 name 속성값을 넣는다.&lt;/span&gt;
        
        &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; em &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; emf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createEntityManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt;를 통해서 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;를 생성 할 수 있다.&lt;/p&gt;
&lt;h4&gt;🔎&lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;가 가지는 특징&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;1. 엔티티 매니저는 DB connection과 밀접한 관계가 있기 때문에, 스레드 간에 공유하거나 재사용하면 안된다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 엔티티 매니저의 CRUD 작업은 트랜잭션 단위로 처리 해야한다.&lt;/strong&gt;&lt;/p&gt;
&lt;h4&gt;&lt;strong&gt;주의점❗&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;EntityManager의 작업은 트랜잭션 단위로 진행되어야한다.
왜냐하면, CRUD 작업을 수행하다가 중간에 문제가 발생하는 경우 트랜잭션 이전의 상태로 돌아가야 하기 때문이다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;마지막으로 코드를 통해 &lt;code class=&quot;language-text&quot;&gt;EntityManagerFactory&lt;/code&gt; 생성부터 DB에 엔티티의 데이터를 저장하는 과정을 살펴보자.&lt;/p&gt;
&lt;h3&gt;JPA의 구동과정&lt;/h3&gt;
&lt;p&gt;JAVA 코드상에서 &lt;code class=&quot;language-text&quot;&gt;JPA&lt;/code&gt;를 통해 데이터를 DB에 저장하는 과정은 아래와 같다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaMain&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;EntityManagerFactory&lt;/span&gt; emf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
        			&lt;span class=&quot;token class-name&quot;&gt;Persistence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createEntityManagerFactory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
                    &lt;span class=&quot;token comment&quot;&gt;// 엔티티 매니저 팩토리 생성&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; em &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; emf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createEntityManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 엔티티 매니저 생성&lt;/span&gt;
        
        &lt;span class=&quot;token class-name&quot;&gt;EntityTransaction&lt;/span&gt; tx &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; em&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getTransaction&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 트랜잭션 생성&lt;/span&gt;
        tx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 트랜잭션 시작&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        	&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; member &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 멤버 엔티티 생성&lt;/span&gt;
            member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100L&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            member&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;JPA&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            
            em&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;persist&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;member&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 멤버 엔티티 데이터를 저장&lt;/span&gt;
        
            tx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 트랜잭션 커밋&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            tx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 트랜잭션 롤백&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            em&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 엔티티 매니저 연결 종료&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        emf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;Persistence.xml 설정파일의 Persistence Unit을 통해 엔티티 매니저 팩토리를 생성한다.&lt;/li&gt;
&lt;li&gt;엔티티 매니저 팩토리로 엔티티 매니저를 생성한다. &lt;/li&gt;
&lt;li&gt;엔티티 매니저에 대한 트랜잭션을 생성한다.&lt;/li&gt;
&lt;li&gt;트랜잭션을 시작한다.&lt;/li&gt;
&lt;li&gt;DB에 저장할 멤버 엔티티를 생성한다.&lt;/li&gt;
&lt;li&gt;em.persist(member)를 통해 엔티티 데이터를 저장한다.&lt;/li&gt;
&lt;li&gt;트랜잭션을 커밋한다.&lt;/li&gt;
&lt;li&gt;엔티티 매니저를 닫는다.&lt;/li&gt;
&lt;li&gt;엔티티 매니저 팩토리를 닫는다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위와 같은 과정을 통해 DB에 데이터를 저장 할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;em.persist()&lt;/code&gt; 메서드는 파라미터로 들어온 엔티티에 대한 insert 쿼리문을 JPA가 작성하여 DB에 엔티티의 데이터를 저장하는 메서드이다.&lt;/p&gt;
&lt;p&gt;얼핏 보면, &lt;code class=&quot;language-text&quot;&gt;em.persist(member)&lt;/code&gt;를 실행할때 데이터가 바로 DB에 저장 될 것 같다.&lt;/p&gt;
&lt;p&gt;하지만 실제로는 &lt;code class=&quot;language-text&quot;&gt;Member&lt;/code&gt; 엔티티가 &lt;code class=&quot;language-text&quot;&gt;EntityManager&lt;/code&gt;의 영속 컨텍스트라는 공간에 저장되고 트랜잭션이 커밋되는 시점에 DB에 &lt;code class=&quot;language-text&quot;&gt;Member&lt;/code&gt; 엔티티에 대한 insert 쿼리문이 날라간다.&lt;/p&gt;
&lt;p&gt;왜 바로, DB에 데이터를 저장하지 않고 영속 컨텍스트에 데이터를 저장할까? 다음 포스팅에서 알아보자.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[젠킨스를 사용한 달록팀의 지속적 배포 환경 구축기 (2) - 프론트엔드편]]></title><description><![CDATA[…]]></description><link>https://dallog.github.io/continuous-deploy-with-jenkins-2-frontend/</link><guid isPermaLink="false">https://dallog.github.io/continuous-deploy-with-jenkins-2-frontend/</guid><pubDate>Sun, 24 Jul 2022 18:30:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;안녕하세요, 우테코 달록팀 후디입니다. 바로 &lt;a href=&quot;https://dallog.github.io/continuous-deploy-with-jenkins-1-backend/&quot;&gt;직전 포스팅&lt;/a&gt;으로 달록팀 백엔드의 배포 환경과 지속적 배포 환경을 구축한 방법을 소개해드렸었죠. 이번 포스팅에서는 프론트엔드의 배포 환경과 지속적 배포 환경 구성을 소개해드리려고 합니다. 바로 시작할까요?&lt;/p&gt;
&lt;h2&gt;프론트엔드 CD 다이어그램&lt;/h2&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/91e04a38c950370c6add24f7154e184c/42d3e/fe.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABaklEQVQoz3VSS0vDQBDOX/fuyYuevYmgogdFwYsHqSDSqgRbiq22ia1tmqRJ9r2fs0ti66MfDJnszHzzDKy1cOKwrsvZG6BKrxuj6d3Udnr+HJCzhPO0xnzbHIKGpBGjlTfEZ9t4al2hMEQgJYQQXjQRvB9uIQzbqLQF5xy8trn4ABtQkeNFL0JaMXBWQBIxly6ZxTTLcUm2Bq42TkmN1giUUmCMUVuUeRzj/PoGZVkhjmPvPHx+xOnejtezokRRFhCMqtIc3cUI4XyI9+UMWmloR+jIkmTh2wq7fezuHyCjCkajEaKPCTrtDk6OjhGNx0iXBfkmyNIUkzzFw7SH+8kLBvl0RSjr+TgoKXxgsyBpLPqvA9y27jw5jcx3oihQWfxtmZb3Y4bZklqlQKUk3CiEkJD0lTQ7R8K58ISuCLcI5uXXUlanYhHlFr15nbWuxtbi9bXzav69mH/OxoFRBUle+eo2ofHdZPsC8ji4T1JhqTcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;프론트엔드 지속적 배포 환경&apos; title=&apos;프론트엔드 지속적 배포 환경&apos; src=&apos;/static/91e04a38c950370c6add24f7154e184c/ca1dc/fe.png&apos; srcset=&apos;/static/91e04a38c950370c6add24f7154e184c/e7570/fe.png 170w,
/static/91e04a38c950370c6add24f7154e184c/f46e7/fe.png 340w,
/static/91e04a38c950370c6add24f7154e184c/ca1dc/fe.png 680w,
/static/91e04a38c950370c6add24f7154e184c/02d09/fe.png 1020w,
/static/91e04a38c950370c6add24f7154e184c/9d567/fe.png 1360w,
/static/91e04a38c950370c6add24f7154e184c/42d3e/fe.png 2314w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;프론트엔드 지속적 배포 환경&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;프론트엔드의 지속적 배포 과정은 사실 백엔드과 크게 다른점이 없습니다. PR이 생성되고, 병합되고, 이 이벤트가 Webhook을 통해 젠킨스 서버에 전달됩니다.&lt;/p&gt;
&lt;p&gt;젠킨스 서버는 Webpack을 이용하여 리액트 프로젝트를 빌드하고, &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;bundle.js&lt;/code&gt;를 생성합니다. 달록의 프론트엔드 EC2 인스턴스에는 &lt;strong&gt;NGINX가 도커 컨테이너&lt;/strong&gt;로 띄워져 있는데요, 생성된 정적파일은 이 NGINX 디렉토리로 전송됩니다.&lt;/p&gt;
&lt;h2&gt;파이프라인 셋업&lt;/h2&gt;
&lt;h3&gt;사전 작업&lt;/h3&gt;
&lt;p&gt;달록팀 프론트엔드 팀은 리액트를 사용합니다. 또한 달록팀은 모듈 번들러로 &lt;strong&gt;웹팩(Webpack)&lt;/strong&gt;을 채택하여 사용하고 있습니다. 또한 웹팩을 사용하여 프로젝트를 빌드하기 위해서는 빌드 서버에 &lt;strong&gt;node.js&lt;/strong&gt;가 설치되어있어야 합니다.&lt;/p&gt;
&lt;p&gt;이를 위해서 달록팀은 젠킨스에 &lt;code class=&quot;language-text&quot;&gt;NodeJS&lt;/code&gt; 플러그인을 설치했습니다. 플러그인을 설치한 이후 사용할 node.js의 버전을 선택해야합니다. &lt;strong&gt;Jenkins 관리 &gt; Global Tool Configuration &gt; NodeJS &gt; NodeJS Installation&lt;/strong&gt; 에 들어가 사용할 node.js 버전을 선택하고 이름을 지정해줍니다.&lt;/p&gt;
&lt;p&gt;달록팀은 개발 환경에서 node.js 16.14.0을 사용하므로 16.14.0 버전을 선택하고 이름을 &lt;code class=&quot;language-text&quot;&gt;NodeJS 16.14.0&lt;/code&gt;로 지정하였습니다.&lt;/p&gt;
&lt;h3&gt;파이프라인 스크립트&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;pipeline &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   agent any
   stages &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Github&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               git branch&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;develop&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;https://github.com/woowacourse-teams/2022-dallog.git&apos;&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Build&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               &lt;span class=&quot;token function&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;frontend&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                   &lt;span class=&quot;token function&quot;&gt;nodejs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nodeJSInstallationName&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NodeJS 16.14.0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;npm install &amp;amp;&amp;amp; npm run build&apos;&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
               &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Deploy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               &lt;span class=&quot;token function&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;frontend/dist&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                   &lt;span class=&quot;token function&quot;&gt;sshagent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;credentials&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;key-dallog&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;ls&apos;&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;scp ./index.html ubuntu@192.168.XXX.XXX:/home/ubuntu/&apos;&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;scp ./bundle.js ubuntu@192.168.XXX.XXX:/home/ubuntu/&apos;&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;ssh ubuntu@192.168.XXX.XXX &quot;sudo mv ./index.html ./html &amp;amp;&amp;amp; sudo mv ./bundle.js ./html&quot;&apos;&lt;/span&gt;
                   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
               &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Build stage&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;nodejs&lt;/code&gt; Directive를 사용하여 사용할 NodeJS Installation의 이름을 입력하고, 실행할 명령을 입력합니다. &lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt; 로 필요한 모듈을 설치하고, &lt;code class=&quot;language-text&quot;&gt;npm run build&lt;/code&gt; 명령으로 빌드합니다.&lt;/p&gt;
&lt;h4&gt;Deploy stage&lt;/h4&gt;
&lt;p&gt;백엔드와 마찬가지로 &lt;code class=&quot;language-text&quot;&gt;sshagent&lt;/code&gt; 를 사용하여 프론트엔드 배포 서버에 SSH로 접속합니다. 빌드된 두개의 파일 &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;bundle.js&lt;/code&gt; 을 전송합니다.&lt;/p&gt;
&lt;p&gt;이후 전송된 파일을 원격지의 sudo 권한으로 &lt;code class=&quot;language-text&quot;&gt;html&lt;/code&gt; 디렉토리로 이동합니다. 이 &lt;code class=&quot;language-text&quot;&gt;html&lt;/code&gt; 디렉토리는 이후 설명하겠지만, NGINX 컨테이너 내부의 디렉토리와 마운팅된 디렉토리입니다. 배포 서버의 Docker가 sudo 권한으로 실행되고 있으므로, 파일을 해당 디렉토리로 이동시킬 때에도 sudo 권한이 필요합니다.&lt;/p&gt;
&lt;h2&gt;도커 및 NGINX 설정&lt;/h2&gt;
&lt;h3&gt;docker-compose&lt;/h3&gt;
&lt;p&gt;맨 위의 다이어그램과 같이 프론트엔드 배포 서버는 NGINX가 도커로 띄워져있습니다. 이를 위한 &lt;strong&gt;docker-compose.yml&lt;/strong&gt; 내용은 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;3&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;dallog-front&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; nginx
    &lt;span class=&quot;token key atrule&quot;&gt;volumes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; ./html&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;/usr/share/nginx/html
    &lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token datetime number&quot;&gt;80:80&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;/usr/share/nginx/html&lt;/code&gt; 디렉토리는 NGINX가 서빙할 정적 파일이 위치될 디렉토리입니다. 이를 컨테이너 외부의 &lt;code class=&quot;language-text&quot;&gt;./html&lt;/code&gt; 디렉토리와 볼륨 마운팅 설정을 해두었습니다.&lt;/p&gt;
&lt;h3&gt;클라이언트 사이드 라우팅 대응&lt;/h3&gt;
&lt;p&gt;달록은 리액트 라우터를 사용하여 클라이언트 사이드 라우팅을 구현하였습니다. 따라서 이를 위해서 NGINX에 별도 설정이 필요합니다. &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; 로 접속하면 html 파일을 잘 찾을 수 있지만, 그 외의 라우트로 접속한다면 html 파일 자체를 찾지 못해 404 에러를 반환하기 때문입니다.&lt;/p&gt;
&lt;p&gt;도커 내부의 &lt;code class=&quot;language-text&quot;&gt;/etc/nginx/conf.d/default.conf&lt;/code&gt; 파일을 열어 아래와 같이 설정을 수정합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;...

location / {
	    root   /usr/share/nginx/html;
	    index  index.html index.htm;
	    try_files $uri $uri/ /index.html;
}

...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;알 수 없는 라우트로 접속했을 때 자동으로 &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; 로 Fallback 되도록 &lt;code class=&quot;language-text&quot;&gt;try_files&lt;/code&gt; 설정을 추가하였습니다. 파일을 수정하고 도커 컨테이너를 재시작해주면 설정이 완료됩니다.&lt;/p&gt;
&lt;h2&gt;트러블 슈팅&lt;/h2&gt;
&lt;h3&gt;빌드 시 메모리 부족 문제&lt;/h3&gt;
&lt;p&gt;리액트 프로젝트를 빌드할 때 아래와 같은 메모리 이슈를 마주하게 되었습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;--- Last few GCs ---&gt;

[21854:0x147b3960]    21931 ms: Scavenge 456.7 (469.5) -&gt; 456.4 (470.7) MB, 3.2 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure
[21854:0x147b3960]    21939 ms: Scavenge 457.4 (470.7) -&gt; 457.2 (475.2) MB, 4.5 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure


&amp;lt;--- JS stacktrace ---&gt;

FATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory
 1: 0xaf9c78 node::Abort() [webpack]
 2: 0xa21a88 node::FatalError(char const*, char const*) [webpack]
 3: 0xccdec8 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [webpack]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jenkins 관리 &gt; 시스템 설정 &gt; Global Properties&lt;/strong&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;NODE_OPTIONS&lt;/code&gt; 환경변수를 &lt;code class=&quot;language-text&quot;&gt;-max-old-space-size=3072&lt;/code&gt; 로 설정하여 메모리 이슈를 해결하였습니다.&lt;/p&gt;
&lt;h2&gt;마치며&lt;/h2&gt;
&lt;p&gt;현재 생성된 PR에 대한 코드를 검사하고 정상적으로 빌드되지 않은 PR의 병합을 막기 위해 Github Actions를 사용하고 있습니다. 가능하다면 조금 더 학습하여 이후 이런 작업까지 젠킨스에서 처리하도록 할 계획이 있습니다.&lt;/p&gt;
&lt;p&gt;또한 현재 백엔드와 프론트엔드 모두 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt; 이라는 하나의 브랜치에서 작업을 하다보니 백엔드, 프론트엔드 어느 한쪽의 코드만 병합되어도 백엔드, 프론트엔드 두개의 빌드 프로세스가 실행되는 이슈가 존재합니다. 이후에는 빌드 트리거를 조금 더 세분화하여 Github의 라벨을 기반으로 트리거 되도록 개선할 계획을 가지고 있습니다.&lt;/p&gt;
&lt;p&gt;여기까지 달록팀의 젠킨스를 사용한 달록팀의 지속적 배포 환경 구축기를 읽어주셔서 감사드립니다 🙂&lt;/p&gt;</content:encoded></item><item><title><![CDATA[젠킨스를 사용한 달록팀의 지속적 배포 환경 구축기 (1) - 백엔드편]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 후디가 작성했습니다. 안녕하세요, 달록팀 후디입니다. 지난번 포스팅에서 달록팀이 도커를 활용하여 EC…]]></description><link>https://dallog.github.io/continuous-deploy-with-jenkins-1-backend/</link><guid isPermaLink="false">https://dallog.github.io/continuous-deploy-with-jenkins-1-backend/</guid><pubDate>Sun, 24 Jul 2022 18:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;안녕하세요, 달록팀 후디입니다. 지난번 포스팅에서 달록팀이 도커를 활용하여 EC2 인스턴스에 도커를 설치한 과정을 이야기 드렸었죠. 이번 포스팅에서는 젠킨스를 활용해서 백엔드와 프론트엔드에 지속적 배포 환경을 구성한 과정에 대해 이야기 드리려고 합니다.&lt;/p&gt;
&lt;h2&gt;달록팀 지속적 배포 환경&lt;/h2&gt;
&lt;p&gt;일단 현재 구성된 달록팀의 지속적 배포 환경을 간단한 다이어그램으로 살펴보겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/362ecaa69f58311f8c89b2bb692cde67/2bae1/be.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 44.705882352941174%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdElEQVQoz3VSTUvDQBDNr/fk2au99SAooiDeqgc9iYhSDy2VQm2bZNN8NN3uZ54zm0ZaaBeGTHZ23pt5M1HTNGDj0/o++Cr5Acp58J2zaLyH97vYYgRXLMFZ3rtw732LEXWAnXlK5pO/XuHtoYdEU5JzUNpAqS0YUgwuIb8H4JfWGBgyrTURuxbw1HmeppiXNbbVCso6aNdW6aiaLst4Hb58z8ARO1LKwJBmK1zdPUJkOdIkgazXqEWK/vkZ9IaAjUVR5CjLkiqzkKbGy/SeyDYkSdMCKqUghIC1BnEqcNHrYxGnSOIYs/kCo9EYN9e3GA6HkEqjqiqs12tK1phkX3j/fcJYfIQKrbWIuG92wlDosshXrfgkhaO+RFFgPJlgtlhSez7o2b03VlM3Alstg/6hwn3NNsoiy6swOSZiGSwDkDkC64T/j1HbDMIEB0PpBrOSDT6XVMXu3+9WpbNmtzbHYt1KHQAyW1Fvic2cnPz++2OxP3yMuVsRjMY3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;백엔드 지속적 배포 환경&apos; title=&apos;백엔드 지속적 배포 환경&apos; src=&apos;/static/362ecaa69f58311f8c89b2bb692cde67/ca1dc/be.png&apos; srcset=&apos;/static/362ecaa69f58311f8c89b2bb692cde67/e7570/be.png 170w,
/static/362ecaa69f58311f8c89b2bb692cde67/f46e7/be.png 340w,
/static/362ecaa69f58311f8c89b2bb692cde67/ca1dc/be.png 680w,
/static/362ecaa69f58311f8c89b2bb692cde67/02d09/be.png 1020w,
/static/362ecaa69f58311f8c89b2bb692cde67/9d567/be.png 1360w,
/static/362ecaa69f58311f8c89b2bb692cde67/2bae1/be.png 2308w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;백엔드 지속적 배포 환경&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;우선, 달록의 백엔드 개발자가 열심히 기능을 개발하여 Github에 PR을 생성합니다. 이때 PR 코드가 정상적으로 빌드되고, 모든 테스트를 통과하는지 &lt;strong&gt;Github Actions&lt;/strong&gt;를 사용하여 우선적으로 검사합니다. 이때, PR 브랜치의 코드가 문제가 있다면 develop 브랜치로 병합이 불가능합니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;달록팀의 브랜치 전략에 대해서는 달록팀 매트가 작성한 &apos;&lt;a href=&quot;https://dallog.github.io/git-branch-strategy/&quot;&gt;달록팀의 git 브랜치 전략을 소개합니다.&lt;/a&gt;&apos; 포스팅을 참고해주세요!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;정상적으로 빌드가 되는 코드는 이후 달록 개발자들끼리 코드리뷰가 진행되고, develop 브랜치에 병합이 됩니다. 이때, Github는 달록팀이 구축한 젠킨스 서버에 &lt;strong&gt;Webhook&lt;/strong&gt;을 통해 병합 사실을 알립니다.&lt;/p&gt;
&lt;p&gt;Webhook이란, 특정한 애플리케이션이 다른 애플리케이션으로 &lt;strong&gt;이벤트 발생 정보를 실시간으로 제공하기 위한 방법&lt;/strong&gt;입니다. 젠킨스는 외부에 Webhook URL을 열어두고, Github으로부터 이 Webhook URL로 요청을 받아 이벤트가 발생한 즉시 그 사실을 알 수 있습니다.&lt;/p&gt;
&lt;p&gt;Webhook을 통해 신호를 받은 젠킨스는 미리 지정된 젠킨스 파이프라인 스크립트를 실행하여 스프링부트 어플리케이션을 빌드하여 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일을 생성합니다.&lt;/p&gt;
&lt;p&gt;생성한 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일은 스프링부트 어플리케이션이 실행되고 있는 EC2 인스턴스로 전송됩니다. 그리고 스프링부트 인스턴스에서 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일이 실행되어 배포가 완료됩니다.&lt;/p&gt;
&lt;h2&gt;프리스타일과 파이프라인&lt;/h2&gt;
&lt;p&gt;젠킨스에서 잡(Job)을 생성하는 방식은 크게 &lt;strong&gt;프리스타일과 파이프라인&lt;/strong&gt; 두가지로 나뉩니다.&lt;/p&gt;
&lt;h3&gt;프리스타일&lt;/h3&gt;
&lt;p&gt;프리스타일은 &lt;strong&gt;GUI기반&lt;/strong&gt;으로 젠킨스 잡을 구성할 수 있습니다. 따라서 간단한 작업에 적합하고, &lt;strong&gt;복잡한 작업에는 다소 적절치 않습니다.&lt;/strong&gt; 또한 GUI 기반이므로 설정 과정이 다소 난잡하게 느껴질 수 있습니다.&lt;/p&gt;
&lt;h3&gt;파이프라인&lt;/h3&gt;
&lt;p&gt;반면 젠킨스 파이프라인은 일련의 배포 과정을 &lt;strong&gt;코드로 작성&lt;/strong&gt;할 수 있습니다. 이 코드는 &lt;strong&gt;Jenkinsfile&lt;/strong&gt; 라고 불리는 파일로 관리할 수 있어, Git 등을 통한 &lt;strong&gt;버전관리&lt;/strong&gt;도 가능합니다. 또한 파이프라인을 사용하면 스테이지(Stage)라는 단위로 각 작업에 소요되는 시간, 실패여부를 &lt;strong&gt;시각화&lt;/strong&gt;하여 확인할 수 있습니다.&lt;/p&gt;
&lt;p&gt;달록은 프리스타일 대신 젠킨스 파이프라인을 이용하여 잡(Job)을 생성했습니다. 개발자 입장에서는 아무래도 GUI보다는 코드 기반으로 작업 과정을 작성하는 것이 편하게 느껴집니다. 또한 추후 배포 프로세스 자체를 Github 저장소에서 관리할 수 있다는 것이 큰 장점으로 다가왔습니다.&lt;/p&gt;
&lt;h4&gt;Scripted vs Declarative&lt;/h4&gt;
&lt;p&gt;파이프라인도 문법에 따라 크게 &lt;strong&gt;Scripted Pipeline&lt;/strong&gt;과 &lt;strong&gt;Declarative Pipeline&lt;/strong&gt; 두가지로 나뉩니다.&lt;/p&gt;
&lt;p&gt;Scripted는 Groovy라는 언어로 작성되며, 변수 선언등이 지원되어 프로그래밍을 할 수 있다는 특징이 있다. 반면, Declarative는 Scripted에 비해 간단하며, Groovy를 알지 않아도 사용할 수 있다는 장점이 존재합니다. &lt;strong&gt;Scripted 문법은 Declarative에 비해 유연성이나 확장성이 높지만, 복잡도와 유지보수 난이도가 더 높습니다&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;최근 CI/CD 기조는 Declarative 스타일로 많이 이동되고 있다고 합니다 (&lt;a href=&quot;https://www.theserverside.com/answer/Declarative-vs-scripted-pipelines-Whats-the-difference&quot;&gt;참고&lt;/a&gt;). 당장 비교적 최근에 출시된 Github Actions 도 YAML 기반의 Declarative 스타일만 사용할 수 있습니다. 따라서 달록팀은 Declarative 문법을 사용하기로 결정했습니다.&lt;/p&gt;
&lt;h2&gt;잡(Job) 생성 및 세팅&lt;/h2&gt;
&lt;h3&gt;파이프라인으로 생성&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/bb5fc7fc2233f7523c1e8c017a45a138/973af/pipeline.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFklEQVQoz5WSyXbDIAxF/f9/120zeIZ4AINtbOMsXiUdJ216mkUX90gC8XgMSQgBzjl474WZ6nVdsSzLvwhEjBGJMQZpmiLNMpwvFzRtCz+Osolz/uB7w3dwD5tLVGdxKjQy3SO/kTjFq+qQEhKpPpUN2t5ioo3+EhuPcXaajHOAbg2MoQXTTO4mcfg7jtNE8+9hURF0zuL6+YG6rpHnObquE+vzPP/gdTGPsYDk1PsYkztcwoi2PiMvChGsqkrE+76XYwzDIPBdM8Pg5L44t9ZKD0fuEUEfVpSthdbq+VL8ytu2Ie671JLHI3/W8YWdevf7HQk3sO2iLFESSimJ7FRpLW45Z5qmkaPKD3g8CB2XfwKbYcEvY5hhgTOF7S0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;pipeline&apos; title=&apos;pipeline&apos; src=&apos;/static/bb5fc7fc2233f7523c1e8c017a45a138/ca1dc/pipeline.png&apos; srcset=&apos;/static/bb5fc7fc2233f7523c1e8c017a45a138/e7570/pipeline.png 170w,
/static/bb5fc7fc2233f7523c1e8c017a45a138/f46e7/pipeline.png 340w,
/static/bb5fc7fc2233f7523c1e8c017a45a138/ca1dc/pipeline.png 680w,
/static/bb5fc7fc2233f7523c1e8c017a45a138/02d09/pipeline.png 1020w,
/static/bb5fc7fc2233f7523c1e8c017a45a138/9d567/pipeline.png 1360w,
/static/bb5fc7fc2233f7523c1e8c017a45a138/973af/pipeline.png 1956w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;젠킨스 메뉴에서 &apos;새로운 Item&apos;을 클릭하고, &apos;Pipeline&apos;을 선택하여 새로운 잡을 생성합니다.&lt;/p&gt;
&lt;h3&gt;Github URL 설정&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;General &gt; GitHub project &gt; Project url&lt;/strong&gt; 에 저희 깃허브 저장소 주소인 &lt;strong&gt;&lt;a href=&quot;https://github.com/woowacourse-teams/2022-dallog&quot;&gt;https://github.com/woowacourse-teams/2022-dallog&lt;/a&gt;&lt;/strong&gt; 를 입력합니다.&lt;/p&gt;
&lt;h3&gt;오래된 빌드 삭제&lt;/h3&gt;
&lt;p&gt;빌드 이력을 오래 가지고 있어봤자 큰 의미가 없을 것 같기도 하고, 아무래도 &lt;strong&gt;t4g.micro&lt;/strong&gt; 에서 돌리다보니 용량이 넉넉치 않기도 합니다. 따라서 &lt;strong&gt;General &gt; 오래된 빌드 삭제&lt;/strong&gt; 옵션을 클릭하여 활성화하고, 보관할 최대 갯수를 3으로 지정했습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;나중에 빌드 이력 보관 개수가 너무 적다고 판단되면 조금 더 늘릴 생각입니다 🙂&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;빌드 트리거 설정&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Build Triggers &gt; GitHub hook trigger for GITScm polling&lt;/strong&gt; 을 체크해줍니다. Github의 Webhook을 통해 빌드가 트리거되는 옵션입니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;이 기능은 &lt;strong&gt;GitHub plugin&lt;/strong&gt;에서 제공하는 기능입니다. 최초 젠킨스를 설치했을 때 Install suggested plugins 를 선택하지 않으면 이 플러그인이 설치되어있지 않을수도 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;Github 저장소에 Webhook 등록하기&lt;/h4&gt;
&lt;p&gt;Webhook을 사용하려면 Github 저장소의 Settings &gt; Webhooks 에서 Webhook URL을 등록해주어야 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;http://{서비스 IP 혹은 도메인 주소}/github-webhook/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 URL을 등록해줍니다. 이때 URL의 마지막에 &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt;가 들어가지 않으면 오류가 발생하니 꼭 추가합니다.&lt;/p&gt;
&lt;h2&gt;파이프라인 작성&lt;/h2&gt;
&lt;p&gt;이제 빌드가 트리거 되었을 때 실행될 파이프라인 스크립트를 작성할 차례입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;groovy&quot;&gt;&lt;pre class=&quot;language-groovy&quot;&gt;&lt;code class=&quot;language-groovy&quot;&gt;pipeline &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   agent any
   stages &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Github&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               git branch&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;develop&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;https://github.com/woowacourse-teams/2022-dallog.git&apos;&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Build&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               &lt;span class=&quot;token function&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;backend&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                   sh &lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;./gradlew bootJar&quot;&lt;/span&gt;&lt;/span&gt;
               &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token function&quot;&gt;stage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Deploy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
           steps &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
               &lt;span class=&quot;token function&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;backend/build/libs&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                   &lt;span class=&quot;token function&quot;&gt;sshagent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;credentials&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;key-dallog&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;scp backend-0.0.1-SNAPSHOT.jar ubuntu@192.168.XXX.XXX:/home/ubuntu&apos;&lt;/span&gt;
                        sh &lt;span class=&quot;token string&quot;&gt;&apos;ssh ubuntu@192.168.XXX.XXX &quot;sh run.sh&quot; &amp;amp;&apos;&lt;/span&gt;
                   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
               &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
           &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
       &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Github stage&lt;/h3&gt;
&lt;p&gt;Github stage에서는 사용할 깃허브의 저장소 주소와 브랜치를 설정합니다. 젠킨스는 이 스테이지에 명시된 저장소와 브랜치를 기준으로 코드를 가져옵니다.&lt;/p&gt;
&lt;h3&gt;Build stage&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;gradlew&lt;/code&gt; 파일을 사용하여 빌드합니다. 이때, &lt;code class=&quot;language-text&quot;&gt;dir&lt;/code&gt; 지시어(Directive)를 사용하여 명령을 수행할 디렉토리를 지정할 수 있습니다.&lt;/p&gt;
&lt;h3&gt;Deploy stage&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;이 작업을 위해서 사전에 Jenkins 관리 &gt; Manage Credentials 에서 &apos;SSH Username with private key&apos; 로 AWS에서 발급 받은 PEM 키를 먼저 등록해야합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;달록팀은 SSH Agent 플러그인을 사용하여 배포 서버에 원격으로 접속합니다. SSH Agent 플러그인을 사용하여 파이프라인에서 젠킨스에 등록해둔 SSH 자격증명을 쉽게 사용할 수 있습니다. 플러그인을 설치하면 &lt;code class=&quot;language-text&quot;&gt;sshagent&lt;/code&gt; 라는 Directive를 사용할 수 있는데, 인자로 사전에 젠킨스 Credential로 등록한 PEM키의 이름을 넣어줍니다. 이렇게 만들어진 &lt;code class=&quot;language-text&quot;&gt;sshagent&lt;/code&gt; Directive Block 내부에서 &lt;code class=&quot;language-text&quot;&gt;sh&lt;/code&gt; 를 통해 &lt;code class=&quot;language-text&quot;&gt;ssh&lt;/code&gt; 관련 명령을 수행할 수 있습니다.&lt;/p&gt;
&lt;h4&gt;jar 파일 전송&lt;/h4&gt;
&lt;p&gt;SCP(Secure Copy)는 SSH 통신 기반으로 원격지에 파일이나 디렉토리를 전송할 수 있는 프로토콜입니다. 리눅스에서는 &lt;code class=&quot;language-text&quot;&gt;scp&lt;/code&gt; 명령을 통해 SCP 프로토콜을 사용할 수 있습니다. 달록팀은 이 &lt;code class=&quot;language-text&quot;&gt;scp&lt;/code&gt; 명령을 통해 스프링부트 애플리케이션이 실행되고 있는 EC2 인스턴스로 빌드된 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일을 전송합니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;여기서 IP주소가 프라이빗 IP로 적혀있습니다. 우테코에서 제공되는 EC2 인스턴스의 보안그룹 설정상 잠실 및 선릉 캠퍼스의 IP로만 SSH(22번 포트) 인바운드가 허용되어 있습니다. 따라서 퍼블릭 IP 대신 프라이빗 IP로 지정해주었습니다. 프라이빗 IP를 사용해도 두 EC2 인스턴스가 같은 VPC에 존재하므로 정상적으로 접근이 가능합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;원격지의 쉘 스크립트 실행&lt;/h4&gt;
&lt;p&gt;스프링부트 인스턴스에는 사전에 &lt;code class=&quot;language-text&quot;&gt;run.sh&lt;/code&gt; 라는 이름의 쉘 스크립트가 작성되어 있습니다. 이 쉘 스크립트는 현재 실행중인 스프링부트 애플리케이션의 프로세스를 제거하고, 환경변수를 설정하고, 같은 디렉토리에 있는 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일을 실행합니다. 스크립트는 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#! /bin/bash&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;PROJECT_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;backend
&lt;span class=&quot;token assign-left variable&quot;&gt;CURRENT_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;pgrep -f $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;PROJECT_NAME&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;-.*.jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션이 없으므로 종료하지 않습니다.&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션을 종료했습니다. (pid : &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;kill&lt;/span&gt; -15 &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;🌈 SpringBoot 환경변수 설정&quot;&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXXXXXXXXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_SECRET&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXXXXXXXXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_REDIRECT_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXXXXXXXXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_TOKEN_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXXXXXXXXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_EXPIRE_LENGTH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;86400000&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_SECRET_KEY&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXXXXXXXXXXX&quot;&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;🌈 SpringBoot 애플리케이션을 실행합니다.&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;JAR_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; .jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; -E &lt;span class=&quot;token function&quot;&gt;nohup&lt;/span&gt; java -jar /home/ubuntu/&lt;span class=&quot;token variable&quot;&gt;$JAR_NAME&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;지난 포스팅인 &lt;strong&gt;&lt;a href=&quot;/deploy-automation-with-shell-script&quot;&gt;쉘 스크립트와 함께하는 달록의 스프링부트 어플리케이션 배포 자동화&lt;/a&gt;&lt;/strong&gt; 에서 소개드린 쉘 스크립트에서 소스코드를 Pull 해오고 빌드하는 과정만 사라진 스크립트입니다.&lt;/p&gt;
&lt;p&gt;이 원격지에 있는 스크립트를 &lt;code class=&quot;language-text&quot;&gt;ssh&lt;/code&gt; 명령을 통해 실행하게되면 배포과정이 완료됩니다.&lt;/p&gt;
&lt;h2&gt;트러블슈팅&lt;/h2&gt;
&lt;h3&gt;Webhook 트리거 이슈&lt;/h3&gt;
&lt;p&gt;처음 젠킨스를 설정할 때 아무리 Webhook 설정을 건드려봐도 빌드가 트리거되지 않는 이슈가 발생했었습니다.&lt;/p&gt;
&lt;p&gt;먼저 위 파이프라인 스크립트의 Github 스테이지에서 사용된 &lt;code class=&quot;language-text&quot;&gt;git&lt;/code&gt; Directive를 명시적으로 사용해줘야합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;git branch: &apos;develop&apos;, url: &apos;https://github.com/woowacourse-teams/2022-dallog.git&apos;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또한 최초로 &apos;지금 빌드&apos; 버튼을 클릭해야지 그 이후 Webhook 요청을 수신할 수 있게됩니다.&lt;/p&gt;
&lt;h3&gt;SSH 자격 증명 이슈&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Host key verification failed.
lost connection&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;젠킨스 서버에서 다른 인스턴스에 최초로 SSH 연결을 시도할 경우 젠킨스에서 위와 같은 에러가 발생할 수 있습니다. 다들 SSH로 최초 원격접속 시 아래와 같은 메시지를 본 적이 있을 것 입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;root@XXXXXXXX:/home# ssh -i key.pem ubuntu@192.168.XXX.XXX
The authenticity of host &apos;192.168.XXX.XXX (192.168.XXX.XXX)&apos; can&apos;t be established.
ECDSA key fingerprint is SHA256:XXXXXXXXXXXXXXXX
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;터미널에서 직접 접속할 때에는 yes 를 입력하면, 곧바로 접속될텐데요. 젠킨스 파이프라인에서는 불가능합니다. 따라서 미리 젠킨스 측의 &lt;code class=&quot;language-text&quot;&gt;known_hosts&lt;/code&gt; 에 원격지의 공개키를 등록해야합니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;keyscan&lt;/code&gt; 명령을 통해서 호스트의 공개키를 수집할 수 있습니다. 이 명령을 통해서 &lt;code class=&quot;language-text&quot;&gt;~/.ssh/known_hosts&lt;/code&gt; 에 접속할 호스트의 공개키를 추가해야합니다.&lt;/p&gt;
&lt;h2&gt;마치며&lt;/h2&gt;
&lt;p&gt;이번 포스팅으로 달록팀이 젠킨스를 활용하여 스프링부트 애플리케이션의 지속적 배포 환경을 구축한 방법을 소개드렸습니다. 이어지는 다음 포스팅에서는 달록팀의 프론트엔드 배포 환경과 지속적 배포 환경 구축 방법을 소개드리려고 합니다. 읽어주셔서 감사드립니다 😄&lt;/p&gt;</content:encoded></item><item><title><![CDATA[외부와 의존성 분리하기]]></title><description><![CDATA[…]]></description><link>https://dallog.github.io/separated-interface/</link><guid isPermaLink="false">https://dallog.github.io/separated-interface/</guid><pubDate>Sun, 24 Jul 2022 15:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &apos;&lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;&apos;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;외부와 의존성 분리하기&lt;/h2&gt;
&lt;p&gt;도메인 로직은 우리가 지켜야할 매우 소중한 비즈니스 로직들이 담겨있다. 이러한 도메인 로직들은 변경이 최소화되어야 한다. 그렇기 때문에 외부와의 의존성을 최소화 해야 한다. &lt;/p&gt;
&lt;h3&gt;인터페이스 활용하기&lt;/h3&gt;
&lt;p&gt;우선 우리가 지금까지 학습한 것 중 객체 간의 의존성을 약하게 만들어 줄 수 있는 수단으로 인터페이스를 활용할 수 있다. 간단한 예시로 &lt;code class=&quot;language-text&quot;&gt;JpaRepository&lt;/code&gt;를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MemberRepository&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findByEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; email&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;existsByEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; email&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러한 인터페이스 덕분에 우리는 실제 DB에 접근하는 내부 구현에 의존하지 않고 데이터를 조작할 수 있다. 핵심은 &lt;code class=&quot;language-text&quot;&gt;실제 DB에 접근하는 행위&lt;/code&gt;이다.&lt;/p&gt;
&lt;p&gt;아래는 &lt;code class=&quot;language-text&quot;&gt;Spring Data&lt;/code&gt;가 만든 &lt;code class=&quot;language-text&quot;&gt;JpaRepository의 구현체&lt;/code&gt; &lt;code class=&quot;language-text&quot;&gt;SimpleJpaRepository&lt;/code&gt;의 일부를 가져온 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Repository&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;readOnly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SimpleJpaRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ID&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaRepositoryImplementation&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ID&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; ID_MUST_NOT_BE_NULL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;The given id must not be null!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaEntityInformation&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; entityInformation&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; em&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PersistenceProvider&lt;/span&gt; provider&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@Nullable&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CrudMethodMetadata&lt;/span&gt; metadata&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EscapeCharacter&lt;/span&gt; escapeCharacter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EscapeCharacter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DEFAULT&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SimpleJpaRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JpaEntityInformation&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; entityInformation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EntityManager&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

		&lt;span class=&quot;token class-name&quot;&gt;Assert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;notNull&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityInformation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;JpaEntityInformation must not be null!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;token class-name&quot;&gt;Assert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;notNull&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityManager&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;EntityManager must not be null!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

		&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;entityInformation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; entityInformation&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;em &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; entityManager&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;provider &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PersistenceProvider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fromEntityManager&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entityManager&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 구현체는 &lt;code class=&quot;language-text&quot;&gt;entityManger&lt;/code&gt;를 통해 객체를 영속 시키는 행위를 진행하고 있기 때문에 &lt;code class=&quot;language-text&quot;&gt;영속 계층&lt;/code&gt;에 가깝다고 판단했다. 즉 도메인의 입장에서 &lt;code class=&quot;language-text&quot;&gt;MemberRepository&lt;/code&gt;를 바라볼 때 단순히 &lt;code class=&quot;language-text&quot;&gt;JpaRepository&lt;/code&gt;를 상속한 인터페이스를 가지고 있기 때문에 &lt;code class=&quot;language-text&quot;&gt;영속 계층&lt;/code&gt;에 대한 직접적인 의존성은 없다고 봐도 무방하다. 정리하면 우리는 인터페이스를 통해 실제 구현체에 의존하지 않고 로직을 수행할 수 있게 된다. &lt;/p&gt;
&lt;h3&gt;관점 변경하기&lt;/h3&gt;
&lt;p&gt;이러한 사례를 외부 서버와 통신을 담당하는 우리가 직접 만든 인터페이스인 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;에 대입해본다. &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;의 가장 큰 역할은 n의 소셜에서 &lt;code class=&quot;language-text&quot;&gt;OAuth 2.0&lt;/code&gt;을 활용한 인증의 행위를 정의한 인터페이스이다. google, github 등 각자에 맞는 요청을 처리하기 위해 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;를 구현한 뒤 로직을 처리할 수 있다. 아래는 실제 google의 인가 코드를 기반으로 토큰 정보에서 회원 정보를 조회하는 로직을 담고 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Component&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; JWT_DELIMITER &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\\.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleRedirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleClientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleClientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleTokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplate&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleOAuthClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.redirect_uri}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleRedirectUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.client_id}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleClientId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.client_secret}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleClientSecret&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${oauth.google.token_uri}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; googleTokenUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;RestTemplate&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ObjectMapper&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;googleRedirectUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleRedirectUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;googleClientId &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleClientId&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;googleClientSecret &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleClientSecret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;googleTokenUri &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; googleTokenUri&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;restTemplate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objectMapper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt; googleTokenResponse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;requestGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; payload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getPayloadFrom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;googleTokenResponse&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getIdToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; decodedPayload &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;decodeJwtPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateOAuthMemberBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;decodedPayload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;JsonProcessingException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IllegalArgumentException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;requestGoogleToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;HttpHeaders&lt;/span&gt; headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpHeaders&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        headers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setContentType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;APPLICATION_FORM_URLENCODED&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateRequestParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;HttpEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; request &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpEntity&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; restTemplate&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;postForEntity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;googleTokenUri&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;GoogleTokenResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBody&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateRequestParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;MultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LinkedMultiValueMap&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;client_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; googleClientId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;client_secret&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; googleClientSecret&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;grant_type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;authorization_code&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;redirect_uri&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; googleRedirectUri&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getPayloadFrom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; jwt&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; jwt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;JWT_DELIMITER&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;decodeJwtPayload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Base64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getUrlDecoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StandardCharsets&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;UTF_8&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateOAuthMemberBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; decodedIdToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JsonProcessingException&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; userInfo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; objectMapper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;readValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;decodedIdToken&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; email &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;email&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; displayName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; profileImageUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; userInfo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;picture&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;email&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; displayName&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; profileImageUrl&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;보통의 생각은 인터페이스인 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;와 구현체인 &lt;code class=&quot;language-text&quot;&gt;GoogleOAuthClient&lt;/code&gt;를 같은 패키지에 두려고 할 것이다. &lt;code class=&quot;language-text&quot;&gt;GoogleOAuthClient&lt;/code&gt;는 외부 의존성을 강하게 가지고 있기 때문에 &lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; 패키지와 별도로 관리하기 위한 &lt;code class=&quot;language-text&quot;&gt;infrastructure&lt;/code&gt; 패키지가 적합할 것이다. 결국 인터페이스인 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt; 또한 &lt;code class=&quot;language-text&quot;&gt;infrastructure&lt;/code&gt;에 위치하게 될 것이다. 우리는 이러한 생각에서 벗어나 새로운 관점에서 살펴봐야 한다.&lt;/p&gt;
&lt;p&gt;앞서 언급한 의존성에 대해 생각해보자. 위 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;를 사용하는 주체는 누구일까? 우리는 이러한 주체를 &lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; 내에 인증을 담당하는 &lt;code class=&quot;language-text&quot;&gt;auth&lt;/code&gt; 패키지 내부의 &lt;code class=&quot;language-text&quot;&gt;Authservice&lt;/code&gt;로 결정 했다. 아래는 실제 &lt;code class=&quot;language-text&quot;&gt;OAuthClient&lt;/code&gt;를 사용하고 있는 주체인 &lt;code class=&quot;language-text&quot;&gt;AuthService&lt;/code&gt;이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;readOnly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthEndpoint&lt;/span&gt; oAuthEndpoint&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MemberService&lt;/span&gt; memberService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JwtTokenProvider&lt;/span&gt; jwtTokenProvider&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthEndpoint&lt;/span&gt; oAuthEndpoint&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MemberService&lt;/span&gt; memberService&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JwtTokenProvider&lt;/span&gt; jwtTokenProvider&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;oAuthEndpoint &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthEndpoint&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;oAuthClient &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memberService &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberService&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;jwtTokenProvider &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; jwtTokenProvider&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateGoogleLink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; oAuthEndpoint&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateTokenWithCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; oAuthMember &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; email &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;memberService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;existsByEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;email&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            memberService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateMemberBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; foundMember &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberService&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findByEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;email&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; accessToken &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; jwtTokenProvider&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;valueOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;foundMember&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;accessToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateMemberBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEmail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getProfileImageUrl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; oAuthMember&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDisplayName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SocialType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GOOGLE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;지금 까지 설명한 구조의 패키지 구조는 아래와 같다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── allog
    │   │           └── dallog
    │   │               ├── auth
    │   │               │   └── application
    │   │               │       └── AuthService.java
    │   │               ...
    │   │               ├── infrastructure
    │   │               │   ├── oauth
    │   │               │   │   └── client
    │   │               │   │       ├── OAuthClient.java
    │   │               │   │       └── GoogleOAuthClient.java
    │   │               │   └── dto
    │   │               │       └── OAuthMember.java     
    │   │               └── AllogDallogApplication.java
    |   |
    │   └── resources
    │       └── application.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;결국 이러한 구조는 아래와 같이 &lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; 패키지에서 &lt;code class=&quot;language-text&quot;&gt;infrastructure&lt;/code&gt;에 의존하게 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;com&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dallog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;infrastructure&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 의존성 발생!&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;com&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dallog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;infrastructure&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;oauth&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 의존성 발생!&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;readOnly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateTokenWithCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; oAuthMember &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Separated Interface Pattern&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;분리된 인터페이스&lt;/code&gt;를 활용하자. 즉 &lt;code class=&quot;language-text&quot;&gt;인터페이스&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;구현체&lt;/code&gt;를 각각의 패키지로 분리한다. 분리된 인터페이스를 사용하여 &lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; 패키지에서 인터페이스를 정의하고 &lt;code class=&quot;language-text&quot;&gt;infrastructure&lt;/code&gt; 패키지에 구현체를 둔다. 이렇게 구성하면 인터페이스에 대한 종속성을 가진 주체가 구현체에 대해 인식하지 못하게 만들 수 있다.&lt;/p&gt;
&lt;p&gt;아래와 같은 구조로 인터페이스와 구현체를 분리했다고 가정한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── allog
    │   │           └── dallog
    │   │               ├── auth
    │   │               │   ├── application
    │   │               │   │   ├── AuthService.java
    │   │               │   │   └── OAuthClient.java
    │   │               │   └── dto
    │   │               │       └── OAuthMember.java         
    │   │               ...
    │   │               ├── infrastructure
    │   │               │   ├── oauth
    │   │               │       └── client
    │   │               │           └── GoogleOAuthClient.java
    │   │               └── AllogDallogApplication.java
    |   |
    │   └── resources
    │       └── application.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;자연스럽게 &lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; 내에 있던 &lt;code class=&quot;language-text&quot;&gt;infrastructure&lt;/code&gt; 패키지에 대한 의존성도 제거된다. 즉 외부 서버와의 통신을 위한 의존성이 완전히 분리된 것을 확인할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;com&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dallog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;auth&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// auth 패키지 내부를 의존&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;readOnly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuthService&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OAuthClient&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Transactional&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TokenResponse&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generateTokenWithCode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;OAuthMember&lt;/span&gt; oAuthMember &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oAuthClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOAuthMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.martinfowler.com/eaaCatalog/separatedInterface.htmlhttps://www.martinfowler.com/eaaCatalog/separatedInterface.html&quot;&gt;Separated Interface&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[EC2 환경에서 도커를 활용한 젠킨스 설치하기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 후디가 작성했습니다. 안녕하세요, 우테코 달록팀 후디입니다. 이번 스프린트에서는 저는 배포와 CI/CD…]]></description><link>https://dallog.github.io/install-jenkins-with-docker-on-ec2/</link><guid isPermaLink="false">https://dallog.github.io/install-jenkins-with-docker-on-ec2/</guid><pubDate>Thu, 21 Jul 2022 00:15:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;안녕하세요, 우테코 달록팀 후디입니다. 이번 스프린트에서는 저는 배포와 CI/CD와 같이 인프라와 관련된 태스크에 집중하고 있습니다.&lt;/p&gt;
&lt;p&gt;지난번 포스팅으로 달록팀이 쉘 스크립트를 통해 배포 자동화를 구축한 이야기를 했었죠. 하지만 새로운 기능이 병합될 때 마다 SSH로 EC2 인스턴스에 접속하여 쉘 스크립트를 &lt;strong&gt;매번 실행해야한다는 단점&lt;/strong&gt;이 존재했습니다. 따라서 저희 팀은 메인 브랜치에 기능이 새로 병합 될 때마다 자동으로 감지하고, 스프링 어플리케이션을 &lt;code class=&quot;language-text&quot;&gt;jar&lt;/code&gt; 파일로 빌드하여 배포하는 환경이 필요하다고 느꼈습니다. 따라서 &lt;strong&gt;CI/CD 도구를 도입&lt;/strong&gt;하기로 결정했습니다.&lt;/p&gt;
&lt;p&gt;이번 포스팅에서는 달록이 EC2 환경에서 도커를 사용하여 젠킨스를 설치한 방법에 대해서 정리합니다.&lt;/p&gt;
&lt;h2&gt;젠킨스 도입 배경&lt;/h2&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/98a0df2f651f2d57bf0909634184ba03/b986c/google-trends.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABjklEQVQoz41Ti3LjMAj0/3/a3Ud0JrnWjh0/a71BW5BiJ7256RzJDgItCCHcJGLEGIGc5Z9BKSGGUHxqMyWkVNcqSez4YlMiBOGrX6VZNoNhuOOQfVlwa1us21psZxaM9+HcX/YN/TCUAgpf4ru2g3OuJmRmMFOtjkhOojM4SbW6r7G6p+sjUX7cSH+HqN1o5n3fC9EYg3VdS7Cu53ku19Hrq/844CecCQ9Ya+G9L4kOvNq6/o5QYjSP6kZJ0zSVahRa2Xmd/4DKcaDqBv+QnxM8NQ79Ik11VFJtOj/J+SXo4Q9JeOJzSXuW0RuGjQwdv/IoXgizq6cocfWMTeCEFCTICxbH2D1htoR+Z4yWcTdVj6JXVzmRJGEnhN9tHRWSCr04jczoGoDJV+h6cfLy6THMj1vyX62SgiXhJ+PXNZwJcwzIQbJ4GdSg8EVnX0HymqzaGrCA7I5UtDymjFvjAuE2bqVHJH3w84Q43hH7W8XQF+1v8jV8vCOKjn2H0F4RuytS/w735wJzeZODLL4AwzqsnFEiEkgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;유명한 CI/CD 도구들의 구글 트렌드 결과&apos; title=&apos;유명한 CI/CD 도구들의 구글 트렌드 결과&apos; src=&apos;/static/98a0df2f651f2d57bf0909634184ba03/ca1dc/google-trends.png&apos; srcset=&apos;/static/98a0df2f651f2d57bf0909634184ba03/e7570/google-trends.png 170w,
/static/98a0df2f651f2d57bf0909634184ba03/f46e7/google-trends.png 340w,
/static/98a0df2f651f2d57bf0909634184ba03/ca1dc/google-trends.png 680w,
/static/98a0df2f651f2d57bf0909634184ba03/02d09/google-trends.png 1020w,
/static/98a0df2f651f2d57bf0909634184ba03/9d567/google-trends.png 1360w,
/static/98a0df2f651f2d57bf0909634184ba03/b986c/google-trends.png 1846w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;유명한 CI/CD 도구들의 구글 트렌드 결과&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;달록은 CI/CD 도구로 &lt;strong&gt;Jenkins&lt;/strong&gt;를 선정하였습니다. 위 사진은 시중에 배포되어있는 여러 CI/CD 도구의 구글 트렌드 분석 결과입니다. 파란색이 Jenkins 인데요, &lt;strong&gt;압도적으로 높은 관심도&lt;/strong&gt;를 유지하고 있습니다.&lt;/p&gt;
&lt;p&gt;아무래도 달록팀 모두가 CI/CD에 익숙하지 않아 가장 사람들이 많이 사용하고, 그에 따라 &lt;strong&gt;생태계가 넓고 레퍼런스가 많은 도구&lt;/strong&gt;를 선정하는 것이 좋다고 판단하였습니다. &lt;strong&gt;레퍼런스가 많아&lt;/strong&gt; 초기 학습 비용이 적게 들고, 이슈가 발생했을때에도 &lt;strong&gt;트러블슈팅이 비교적 쉽다&lt;/strong&gt;고 생각했습니다.&lt;/p&gt;
&lt;h2&gt;도커&lt;/h2&gt;
&lt;p&gt;달록팀은 EC2 인스턴스에 &lt;strong&gt;도커를 사용하여&lt;/strong&gt; 젠킨스 컨테이너를 띄웠습니다. 도커를 사용하지 않고 젠킨스를 우분투에 직접 설치한다면 해주어야할 환경 설정이 가득합니다. 젠킨스를 돌리기 위한 JDK 설치, 젠킨스 설치, 젠킨스 포트 설정, 방화벽 설정 등등...&lt;/p&gt;
&lt;p&gt;하지만 도커를 사용하면 이런 &lt;strong&gt;환경 설정 없이 간단한 명령어 몇가지로 젠킨스를 설치하고 서버에 띄울 수 있습니다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;도커는 서비스를 운용하는데 필요한 실행환경, 라이브러리, 소프트웨어, 코드 등을 컨테이너라는 단위로 가상화하는 컨테이너 기반 가상화 플랫폼입니다. 도커를 사용하면 EC2 인스턴스에는 미리 &lt;strong&gt;도커라이징(Dockerizing)&lt;/strong&gt;된 이미지를 다운로드 받고 도커를 통해 실행하기만 하면되며, 해당 컨테이너가 어떤 환경을 필요로 하는지 전혀 알 필요가 없습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;더 자세한 내용은 제가 작성한 &lt;a href=&quot;https://hudi.blog/about-docker/&quot;&gt;이론과 실습을 통해 이해하는 Docker 기초&lt;/a&gt;를 읽어보시면 좋을 것 같습니다 🤭&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;우분투에 도커 설치&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;달록팀은 EC2 t4g.micro 인스턴스에 우분투 22.04 (ARM 64) 환경을 사용하고 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;아래 설치 방법은 &lt;a href=&quot;https://docs.docker.com/engine/install/ubuntu/&quot;&gt;도커 공식 도큐먼트&lt;/a&gt;에서 제공되는 내용입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4&gt;레포지토리 셋업&lt;/h4&gt;
&lt;p&gt;아래 명령을 통해서 우분투의 &lt;code class=&quot;language-text&quot;&gt;apt&lt;/code&gt;의 패키지 인덱스를 최신화하고, &lt;code class=&quot;language-text&quot;&gt;apt&lt;/code&gt;가 HTTPS를 통해 패키지를 설치할 수 있도록 설정합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; update
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
    ca-certificates &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
    gnupg &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
    lsb-release&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;도커의 공식 GPG 키 추가&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; -p /etc/apt/keyrings
$ &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; -fsSL https://download.docker.com/linux/ubuntu/gpg &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; gpg --dearmor -o /etc/apt/keyrings/docker.gpg&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;레포지토리 셋업&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;deb [arch=&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;dpkg --print-architecture&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;lsb_release -cs&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt; stable&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;tee&lt;/span&gt; /etc/apt/sources.list.d/docker.list &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; /dev/null&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;도커 엔진 설치&lt;/h4&gt;
&lt;p&gt;아래 명령을 실행하면 가장 최신버전의 도커 엔진이 설치됩니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; update
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; docker-ce docker-ce-cli containerd.io docker-compose-plugin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;도커 설치 확인&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; run hello-world

Hello from Docker&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;
This message shows that your installation appears to be working correctly.
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령을 실행하여 위와 같이 &lt;code class=&quot;language-text&quot;&gt;Hello from Docker!&lt;/code&gt; 메시지가 출력되면 성공적으로 도커 설치가 완료된 것 입니다. 다음 단계로 넘어가볼까요? 🤗&lt;/p&gt;
&lt;h2&gt;젠킨스 컨테이너 실행&lt;/h2&gt;
&lt;h3&gt;젠킨스 이미지 다운로드&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; pull jenkins/jenkins:lts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령을 통해 Jenkins LTS(Long Term Support) 버전의 이미지를 다운로드 받습니다.&lt;/p&gt;
&lt;h3&gt;젠킨스 컨테이너 띄우기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; run -d -p &lt;span class=&quot;token number&quot;&gt;8080&lt;/span&gt;:8080 -v /jenkins:/var/jenkins_home --name jenkins -u root jenkins/jenkins:lts&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령을 통해 다운로드 받은 젠킨스 이미지를 컨테이너로 띄울 수 있습니다. 사용된 각 옵션을 간단히 알아볼까요?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-d&lt;/strong&gt; : 컨테이너를 &lt;strong&gt;데몬&lt;/strong&gt;으로 띄웁니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-p 8080:8080&lt;/strong&gt; : 컨테이너 외부와 내부 포트를 &lt;strong&gt;포워딩&lt;/strong&gt;합니다. 좌측이 호스트 포트, 우측이 컨테이너 포트입니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-v /jenkins:/var/jenkins_home&lt;/strong&gt; : 도커 컨테이너의 데이터는 &lt;strong&gt;컨테이너가 종료되면 휘발&lt;/strong&gt;됩니다. 도커 컨테이너의 데이터를 보존하기 위한 여러 방법이 존재하는데, 그 중 한 방법이 &lt;strong&gt;볼륨 마운트&lt;/strong&gt;입니다. 이 옵션을 사용하여 젠킨스 컨테이너의 &lt;code class=&quot;language-text&quot;&gt;/var/jenkins_home&lt;/code&gt; 이라는 디렉토리를 호스트의 &lt;code class=&quot;language-text&quot;&gt;/jenkins&lt;/code&gt; 와 마운트하고 데이터를 보존할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;--name jenkins&lt;/strong&gt; : 도커 컨테이너의 이름을 설정합니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-u root&lt;/strong&gt; : 컨테이너가 실행될 리눅스의 사용자 계정을 root 로 명시합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;docker-compose 사용하기&lt;/h3&gt;
&lt;p&gt;하지만 위와 같은 명령어를 모두 외우고 있다가, 도커 컨테이너를 실행할 때 마다 입력하게 된다면 굉장히 번거롭겠죠. 따라서 도커는 docker-compose 라는 것을 지원합니다. 도커 컴포즈는 여러 컨테이너의 실행을 한번에 관리할 수 있게 도와주는 도커의 도구입니다. 하지만 저희와 같이 하나의 컨테이너만 필요한 상황에서도 유용하게 사용할 수 있죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker-compose&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령을 이용하여 &lt;code class=&quot;language-text&quot;&gt;docker-compose&lt;/code&gt; 를 설치합니다.&lt;/p&gt;
&lt;p&gt;그리고 도커를 실행할 경로에 &lt;code class=&quot;language-text&quot;&gt;docker-compose.yml&lt;/code&gt; 이란 파일을 만들고, 아래의 내용을 작성해줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;3&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; jenkins/jenkins&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;lts
    &lt;span class=&quot;token key atrule&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; root
    &lt;span class=&quot;token key atrule&quot;&gt;volumes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; ./jenkins&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;/var/jenkins_home
    &lt;span class=&quot;token key atrule&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; 8080&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8080&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;생성한 &lt;code class=&quot;language-text&quot;&gt;docker-compose.yml&lt;/code&gt; 이 존재하는 경로에서 아래의 명령을 실행하면 복잡한 명령 없이도 도커 컨테이너를 실행할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker-compose&lt;/span&gt; up -d&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;-d 옵션은 컨테이너가 데몬으로 실행됨을 의미합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;젠킨스 설정&lt;/h2&gt;
&lt;p&gt;도커를 사용하여 젠킨스 컨테이너가 EC2 인스턴스에 성공적으로 띄워졌다면, EC2의 퍼블릭 IP를 통해 외부에서 접속할 수 있을 것 입니다. localhost:8080으로 접속하면 아래와 같은 화면이 보일 것 입니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/960b1726cd3b94778b3a7bf6dba2b159/7c958/unlock-jenkins.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHUlEQVQoz4WSW4+CMBCF+f8/To26D4QHEELk2isg97OdIgTduE7ype3QHmZO63ieB9d1kaYpiqKw5Hm+sea+UZYlwjCE07Ytuq7Dp5jn+SMgnnsoOOdwpmlClmUIgsBws1VFUQTf9xHHsf3ZMAx/GMdxg9akQ5U6pEwCp+MRl/MZt8DHz/WC0+FgxiuoAzrQ9/02vkOiFIyxRVBXFZjgyIRGXCrceWXJuUSWZ0gN9yRBYhBCQGttqcw5GlfLbMs06esGj4KjKYVBLjBlcgKdyXcmPzYtvsUm2FQ1NBeopYRmHMpAa82XuSwZtFS2IqXUVtHLBe0FpaTWzDMxpj7Is6fRw7hj5x95RiJ0ESuvLe8Mpo//PZV3IWK9FBL8Bd0qt5ADeAszAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;unlock jenkins&apos; title=&apos;unlock jenkins&apos; src=&apos;/static/960b1726cd3b94778b3a7bf6dba2b159/ca1dc/unlock-jenkins.png&apos; srcset=&apos;/static/960b1726cd3b94778b3a7bf6dba2b159/e7570/unlock-jenkins.png 170w,
/static/960b1726cd3b94778b3a7bf6dba2b159/f46e7/unlock-jenkins.png 340w,
/static/960b1726cd3b94778b3a7bf6dba2b159/ca1dc/unlock-jenkins.png 680w,
/static/960b1726cd3b94778b3a7bf6dba2b159/02d09/unlock-jenkins.png 1020w,
/static/960b1726cd3b94778b3a7bf6dba2b159/9d567/unlock-jenkins.png 1360w,
/static/960b1726cd3b94778b3a7bf6dba2b159/7c958/unlock-jenkins.png 2026w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; logs jenkins&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 명령을 사용하면, &lt;code class=&quot;language-text&quot;&gt;jenkins&lt;/code&gt; 컨테이너에 출력된 로그를 확인할 수 있습니다. 젠킨스를 최초로 설치하고 실행하면 사진에서 요구하는 initial admin password를 출력해주는데요, 로그를 확인해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;*************************************************************
*************************************************************
*************************************************************

Jenkins initial setup is required. An admin user has been created and a password generated.

Please use the following password to proceed to installation:


XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


This may also be found at: /var/jenkins_home/secrets/initialAdminPassword

*************************************************************
*************************************************************
*************************************************************&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위에서 표시된 &lt;code class=&quot;language-text&quot;&gt;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&lt;/code&gt; 를 웹사이트에 넣어주시면 됩니다.&lt;/p&gt;
&lt;p&gt;혹은 아래의 명령으로 &lt;code class=&quot;language-text&quot;&gt;jenkins&lt;/code&gt; 컨테이너 내부에 직접 접속하여, &lt;code class=&quot;language-text&quot;&gt;/var/jenkins_home/secrets/initialAdminPassword&lt;/code&gt; 파일의 내용을 조회하는 방법도 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; -it jenkins /bin/bash
$ &lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; /var/jenkins_home/secrets/initialAdminPassword&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/34033c88d26a34735801aa2c4d16bf9a/d9349/customize-jenkins.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 50.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABcElEQVQoz32S2W6DMBBF+f+f6lNbtVLVtA8hkETsS4AQcBKz59YzCNKqKCNd2WPsM3eMNV3Xsd/vWVmWIc9zHI/HeZxE+SMVRQHLsqB5noeu69C2LR7F7XbDMAw8LokijmNovu/zxiAI2OV2u4VpmqBCjuOAOqD8er3yvr7vWTSfcjI0AwlEQYfXax2GOkwQ27a5wEbNDcPgtiopGcy6XCBVTrDJ4eFwgBZFESdU6XdQ9a7r/6zTYVJd16ymafj7BEyS5A4MThc8mz5WToIPO4ZfSJTtAFH3CMIQG+XSVl1QW1So49aHsfgS0MoEntYuNocSzkkiFDUS2SOXLd/nbrdDWZYQQrCzum7mH7no0M0v+A5yrNwMX/4Rn27KeVhckaqNdNeu687K1FMi8Hg9C0A9PuHFTvDmpHh3R72quRkraBjAIZBy6nk+O/bU65Cymu/7HzA9S3YTlXeFSplaP4sztyp4HFWWAlVV/XmHBPwBwYz5V7eUMhUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;customize jenkins&apos; title=&apos;customize jenkins&apos; src=&apos;/static/34033c88d26a34735801aa2c4d16bf9a/ca1dc/customize-jenkins.png&apos; srcset=&apos;/static/34033c88d26a34735801aa2c4d16bf9a/e7570/customize-jenkins.png 170w,
/static/34033c88d26a34735801aa2c4d16bf9a/f46e7/customize-jenkins.png 340w,
/static/34033c88d26a34735801aa2c4d16bf9a/ca1dc/customize-jenkins.png 680w,
/static/34033c88d26a34735801aa2c4d16bf9a/02d09/customize-jenkins.png 1020w,
/static/34033c88d26a34735801aa2c4d16bf9a/9d567/customize-jenkins.png 1360w,
/static/34033c88d26a34735801aa2c4d16bf9a/d9349/customize-jenkins.png 2040w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그 다음 위 화면에서 Install suggested plugins를 클릭하여 추천되는 플러그인을 설치합니다. 그 이후 요구되는 여러 정보의 입력을 끝 마쳐주세요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;System.setProperty(&apos;org.apache.commons.jelly.tags.fmt.timeZone&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이후 대시보드에서 &lt;strong&gt;Jenkins 관리 &gt; Script Console&lt;/strong&gt; 에서 위의 스크립트를 입력하여 타임존을 서울로 설정하기만 하면, 젠킨스 기본 설정이 완료됩니다! 🎉&lt;/p&gt;
&lt;h2&gt;마치며&lt;/h2&gt;
&lt;p&gt;다음 포스팅에서는 달록이 젠킨스를 이용하여 어떻게 배포 자동화 프로세스를 구축하였는지 작성해보도록 하겠습니다. 많은 기대 부탁드립니다 🙏&lt;/p&gt;</content:encoded></item><item><title><![CDATA[쉘 스크립트와 함께하는 달록의 스프링부트 어플리케이션 배포 자동화]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 후디가 작성했습니다. 웹서비스 개발팀은 새롭게 개발한 서비스의 기능을 어떻게 사용자에게 전달할까요? 새로운 기능이 메인 브랜치에 병합될 때 마다 EC2 인스턴스에 접속하여 브랜치를 Pull…]]></description><link>https://dallog.github.io/deploy-automation-with-shell-script/</link><guid isPermaLink="false">https://dallog.github.io/deploy-automation-with-shell-script/</guid><pubDate>Tue, 19 Jul 2022 01:45:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;웹서비스 개발팀은 새롭게 개발한 서비스의 기능을 어떻게 사용자에게 전달할까요? 새로운 기능이 메인 브랜치에 병합될 때 마다 EC2 인스턴스에 접속하여 브랜치를 Pull 하고, 프로젝트를 빌드하고, 현재 동작중인 어플리케이션의 프로세스를 종료하고, 새롭게 빌드된 어플리케이션의 프로세스를 띄우는 과정...&lt;/p&gt;
&lt;p&gt;배포가 필요할때마다 이런 명령을 수동으로 일일히 입력한다면, 그건 너무 지루한 작업아닐까요? 😫 실수라도 하면 어쩌죠? 😰&lt;/p&gt;
&lt;p&gt;우테코 달록팀 백엔드는 이런 한계점을 극복하고자 쉘 스크립트를 활용하여 배포 프로세스를 자동화하였습니다. 달록팀은 어떻게 스프링부트 어플리케이션의 배포를 자동화했을까요?&lt;/p&gt;
&lt;h2&gt;쉘 스크립트&lt;/h2&gt;
&lt;p&gt;쉘 스크립트는 유닉스/리눅스 기반 운영체제에서의 일련의 명령으로 구성된 실행가능한 텍스트 파일입니다. 원래라면 일일히 키보드로 입력해야하는 리눅스 명령을 하나의 파일에 모아두고, 한번에 실행할 수 있죠. 작성된 명령은 셸이라고 불리는 명령줄 인터프리터에서 실행되며, 위에서부터 아래로 차례로 실행됩니다. 이 쉘 스크립트를 이용해 리눅스 환경에서 여러 프로세스를 자동화할 수 있습니다.&lt;/p&gt;
&lt;p&gt;달록이 스프링부트 어플리케이션을 배포하는 환경은 Ubuntu 22 버전이므로 쉘 스크립트를 활용할 수 있습니다.&lt;/p&gt;
&lt;h2&gt;수동으로 배포하기&lt;/h2&gt;
&lt;p&gt;배포 프로세스를 자동화하려면 우선 수동으로 어떤 명령을 사용해서 배포를 하는지 알아야합니다. 어떤과정을 거쳐 배포되는지부터 알아볼까요?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;레포지토리는 이미 Clone 되어있다고 가정합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;1. Git Pull&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2022&lt;/span&gt;-dallog/backend
$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; pull&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;우선 Github에서 가장 최신 버전을 pull 해와야겠죠?&lt;/p&gt;
&lt;h3&gt;2. 빌드&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./gradlew bootJar&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;gradlew&lt;/code&gt; 를 사용하여 자바 프로젝트를 빌드해서 &lt;code class=&quot;language-text&quot;&gt;.jar&lt;/code&gt; 파일을 생성합니다.&lt;/p&gt;
&lt;h3&gt;3. 프로세스 종료&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; jar
$ &lt;span class=&quot;token function&quot;&gt;kill&lt;/span&gt; -15 XXXXX&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ps&lt;/code&gt; 명령을 사용해서 실행중인 스프링부트 어플리케이션의 PID를 알아내고, &lt;code class=&quot;language-text&quot;&gt;kill&lt;/code&gt; 명령을 통해 프로세스를 종료합니다.&lt;/p&gt;
&lt;h3&gt;4. 환경변수 설정&lt;/h3&gt;
&lt;p&gt;달록의 스프링부트 어플리케이션은 여러 민감한 정보를 환경변수를 사용하여 외부에 노출되지 않도록 하였습니다. 따라서 어플리케이션이 실행될 때 환경변수도 함께 설정을 해주어야합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_SECRET&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_REDIRECT_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_TOKEN_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_SECRET_KEY&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_EXPIRE_LENGTH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3600&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;5. 드디어 실행&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; -E &lt;span class=&quot;token function&quot;&gt;nohup&lt;/span&gt; java -jar ./build/libs/backend-0.0.1-SNAPSHOT.jar&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;드디어 스프링부트 어플리케이션을 실행합니다.&lt;/p&gt;
&lt;p&gt;이 귀찮은 과정을 배포 할때마다 해야한다니 벌써 머리가 어질어질 하네요. 😵‍💫 그렇다면 앞서 소개드린 쉘 스크립트를 통해서 이 과정을 자동화해볼까요?&lt;/p&gt;
&lt;h2&gt;달록의 배포 쉘 스크립트&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#! /bin/bash&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;PROJECT_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/home/ubuntu/2022-dallog
&lt;span class=&quot;token assign-left variable&quot;&gt;PROJECT_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;backend
&lt;span class=&quot;token assign-left variable&quot;&gt;PROJECT_BUILD_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;backend/build/libs

&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$PROJECT_PATH&lt;/span&gt;/&lt;span class=&quot;token variable&quot;&gt;$PROJECT_NAME&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;clear&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 Github에서 프로젝트를 Pull 합니다.&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; pull

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;🌈 SpringBoot 프로젝트 빌드를 시작합니다.&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;

./gradlew bootJar

&lt;span class=&quot;token assign-left variable&quot;&gt;CURRENT_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;pgrep -f $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;PROJECT_NAME&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;-.*.jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
	&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션이 없으므로 종료하지 않습니다.&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
	&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션을 종료했습니다. (pid : &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;)&quot;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;kill&lt;/span&gt; -15 &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;🌈 SpringBoot 환경변수 설정&quot;&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_CLIENT_SECRET&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_REDIRECT_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GOOGLE_TOKEN_URI&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_SECRET_KEY&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;JWT_EXPIRE_LENGTH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3600&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;🌈 SpringBoot 애플리케이션을 실행합니다.&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;JAR_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; $PROJECT_PATH/$PROJECT_BUILD_PATH/ &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; .jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; -E &lt;span class=&quot;token function&quot;&gt;nohup&lt;/span&gt; java -jar &lt;span class=&quot;token variable&quot;&gt;$PROJECT_PATH&lt;/span&gt;/&lt;span class=&quot;token variable&quot;&gt;$PROJECT_BUILD_PATH&lt;/span&gt;/&lt;span class=&quot;token variable&quot;&gt;$JAR_PATH&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;달록이 작성한 배포 자동화 쉘 스크립트는 아래와 같습니다. 차근차근 알아볼까요?&lt;/p&gt;
&lt;h3&gt;#! /bin/bash&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;#! /bin/bash&lt;/code&gt; 은 해당 쉘 스크립트가 많은 쉘 중 &lt;strong&gt;Bash Shell 로 실행됨&lt;/strong&gt;을 알립니다.&lt;/p&gt;
&lt;h3&gt;변수 사용&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;PROJECT_PATH&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;PROJECT_NAME&lt;/code&gt; 과 같이 자주 사용되는 데이터는 쉘 스크립트에서 제공하는 변수 기능으로 분리하였습니다. 이때 주의할 점은 쉘 스크립트에서 변수를 선언할 때 &lt;code class=&quot;language-text&quot;&gt;=&lt;/code&gt; &lt;strong&gt;앞뒤에 공백이 와서는 안된다는 점&lt;/strong&gt; 입니다.&lt;/p&gt;
&lt;h3&gt;echo&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;echo&lt;/code&gt; 명령을 통해 배포 프로세스가 어디까지 진행됐는지 사용자에게 알려줍니다.&lt;/p&gt;
&lt;h3&gt;실행중인 어플리케이션의 PID 가져오기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;CURRENT_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;pgrep -f $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;PROJECT_NAME&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;-.*.jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;pgrep&lt;/h4&gt;
&lt;p&gt;쉘 스크립트 중 위와 같은 코드가 있었습니다. 위 코드는 우선 &lt;code class=&quot;language-text&quot;&gt;pgrep&lt;/code&gt; 이라는 명령을 통해서 실행중인 프로세스의 이름으로 PID 목록을 가져옵니다.&lt;/p&gt;
&lt;h4&gt;pipe와 head&lt;/h4&gt;
&lt;p&gt;그리고 파이프(&lt;code class=&quot;language-text&quot;&gt;|&lt;/code&gt;)명령으로 다른 프로세스로 PID 목록을 보냅니다. PID 목록은 &lt;code class=&quot;language-text&quot;&gt;head&lt;/code&gt; 명령으로 전달되며, &lt;code class=&quot;language-text&quot;&gt;head&lt;/code&gt; 명령은 PID 목록의 첫번째만을 가져옵니다.&lt;/p&gt;
&lt;h4&gt;명령의 실행결과를 변수에 담기&lt;/h4&gt;
&lt;p&gt;이렇게 가져온 PID는 &lt;code class=&quot;language-text&quot;&gt;$()&lt;/code&gt; 문법을 통해 &lt;code class=&quot;language-text&quot;&gt;CURRENT_PID&lt;/code&gt; 변수에 저장됩니다. &lt;code class=&quot;language-text&quot;&gt;$()&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;$(command)&lt;/code&gt; 형태로 사용되며, 괄호 내부의 실행 결과를 변수로 저장하기 위해 사용됩니다.&lt;/p&gt;
&lt;h3&gt;조건문&lt;/h3&gt;
&lt;p&gt;쉘 스크립트에도 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문을 사용하여 조건문을 작성할 수 있습니다. 다만, 우리에게 익숙한 프로그래밍 언어에서의 if문과는 조금 괴리가 존재해서 별도로 학습이 필요할수도 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
	&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션이 없으므로 종료하지 않습니다.&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
	&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;🌈 구동중인 애플리케이션을 종료했습니다. (pid : &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;)&quot;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;kill&lt;/span&gt; -15 &lt;span class=&quot;token variable&quot;&gt;$CURRENT_PID&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 코드는 아까 PID를 담은 &lt;code class=&quot;language-text&quot;&gt;CURRENT_PID&lt;/code&gt; 가 비어있는지 확인한 후 존재하지 않다면 메시지만 출력하고, 존재한다면 해당 PID를 &lt;code class=&quot;language-text&quot;&gt;kill&lt;/code&gt; 명령으로 종료합니다.&lt;/p&gt;
&lt;p&gt;쉘 스크립트의 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문에서 &lt;code class=&quot;language-text&quot;&gt;-z&lt;/code&gt; 는 조건식의 종류 중 하나이며, 주어진 문자열의 길이가 0이라면 True를 나타냅니다. 확실히 조금 낯설죠? 😅&lt;/p&gt;
&lt;h3&gt;JAR파일 경로 가져오기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;JAR_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; $PROJECT_PATH/$PROJECT_BUILD_PATH/ &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; .jar &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt; -n &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ls&lt;/code&gt; 명령을 통해 빌드 디렉토리의 파일 목록을 가져오고, &lt;code class=&quot;language-text&quot;&gt;grep&lt;/code&gt; 명령을 통해 &lt;code class=&quot;language-text&quot;&gt;.jar&lt;/code&gt; 파일만을 가져옵니다. 그다음 &lt;code class=&quot;language-text&quot;&gt;head&lt;/code&gt; 명령을 통해 단 하나의 파일만을 가져온 다음, &lt;code class=&quot;language-text&quot;&gt;JAR_PATH&lt;/code&gt; 변수에 저장합니다.&lt;/p&gt;
&lt;h3&gt;어플리케이션 실행하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; -E &lt;span class=&quot;token function&quot;&gt;nohup&lt;/span&gt; java -jar &lt;span class=&quot;token variable&quot;&gt;$PROJECT_PATH&lt;/span&gt;/&lt;span class=&quot;token variable&quot;&gt;$PROJECT_BUILD_PATH&lt;/span&gt;/&lt;span class=&quot;token variable&quot;&gt;$JAR_PATH&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;어플리케이션을 실행합니다.&lt;/p&gt;
&lt;h4&gt;sudo -E&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;sudo&lt;/code&gt; 명령 뒤에 붙은 &lt;code class=&quot;language-text&quot;&gt;-E&lt;/code&gt; 옵션은 유저가 설정한 환경변수를 &lt;code class=&quot;language-text&quot;&gt;sudo&lt;/code&gt; 명령에서도 공유하여 사용할 수 있도록 만드는 옵션입니다.&lt;/p&gt;
&lt;h4&gt;nohup&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;nohup&lt;/code&gt; 명령은 현재 &lt;strong&gt;터미널 세션이 끊어져도 프로세스가 계속 살아있도록&lt;/strong&gt; 만들기 위해 사용되는 명령입니다.&lt;/p&gt;
&lt;h4&gt;Background 프로세스&lt;/h4&gt;
&lt;p&gt;그리고 명령 맨 뒤에 &lt;code class=&quot;language-text&quot;&gt;&amp;amp;&lt;/code&gt; 가 붙어있는데, 프로세스를 Foreground가 아닌 &lt;strong&gt;Background에서 실행&lt;/strong&gt;하기 위해 붙여줍니다.&lt;/p&gt;
&lt;h2&gt;한계점&lt;/h2&gt;
&lt;p&gt;하지만, 이런 방식도 결국 한계점이 존재합니다. 특히나 달록과 같이 애자일한 조직에서는 최대한 작은 기능단위로 개발이 병렬적으로 진행되어, 메인 브랜치에 머지됩니다. 하루에 몇번이고 배포를 해야하는 상황이 발생할수도 있죠.
그렇지 않아도 모든 개발자가 바쁘게 새로운 기능을 개발하기 바쁜데, 메인 브랜치에 병합된 시점마다 EC2 인스턴스에 접속해서 쉘 스크립트를 실행해야할까요?&lt;/p&gt;
&lt;p&gt;이런 한계점을 극복하고자, 달록팀은 앞으로 CI/CD 도구를 도입할 예정입니다. 세상에는 참 다양한 CI/CD 도구가 존재합니다. Jenkins, Github Actions, Travis CI, Circle CI, Gitlab CI/CD 등등...&lt;/p&gt;
&lt;p&gt;달록의 이번 스프린트의 배포 태스크에서는 이런 다양한 CI/CD 도구들의 장단을 분석하고 도입할 예정입니다. 많은 기대 부탁드립니다. 👏👏&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Spring Data JPA의 Auditing]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. auditing이란 엔티티와 관련된 이벤트(insert, update, delete…]]></description><link>https://dallog.github.io/data-jpa-auditing/</link><guid isPermaLink="false">https://dallog.github.io/data-jpa-auditing/</guid><pubDate>Mon, 18 Jul 2022 23:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;auditing이란 엔티티와 관련된 이벤트(insert, update, delete)를 추적하고 기록하는 것을 의미한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;모든 엔티티에 생성일시, 수정일시, 생성한 사람을 추가하고 싶은 경우를 생각해보자. 모든 엔티티에 생성일시, 수정일시, 생성한 사람에 대한 필드를 일일이 구현해주어야 한다. 이렇게 되면 모든 엔티티에 중복이 생기고 유지보수가 어려워진다. Spring Data JPA가 제공하는 &lt;code class=&quot;language-text&quot;&gt;Auditing&lt;/code&gt; 기능을 사용하면 이런 기능을 쉽고 빠르게 구현할 수 있다.&lt;/p&gt;
&lt;h2&gt;Spring Data JPA Auditing 적용하기&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Auditing&lt;/code&gt;을 적용하기 위해서는 우선 어노테이션을 적용해야 한다. &lt;code class=&quot;language-text&quot;&gt;@Configuration&lt;/code&gt; 어노테이션이 적용된 Config 클래스에 아래와 같이 &lt;code class=&quot;language-text&quot;&gt;@EnableJpaAuditing&lt;/code&gt;을 추가한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EnableJpaAuditing&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;⚠️ 주의 : 원활한 Slice 테스트를 위해 @SpringBootApplication 과 @EnableJpaAuditing 어노테이션 분리하기&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing&quot;&gt;https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Spring Entity Callback Listener 적용하기&lt;/h3&gt;
&lt;p&gt;Auditing entity listener class로 지정하기 위해 &lt;code class=&quot;language-text&quot;&gt;@EntityListeners&lt;/code&gt; 어노테이션을 Entity 클래스에 추가한다. 인자로는 &lt;code class=&quot;language-text&quot;&gt;AuditingEntityListener.class&lt;/code&gt;를 넘긴다. 이 설정을 통해 엔티티에 이벤트가 발생했을 때 정보를 캡처할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Entity&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EntityListeners&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;AuditingEntityListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseEntity&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;생성일시, 수정일시 추적하기&lt;/h3&gt;
&lt;p&gt;생성일시는 &lt;code class=&quot;language-text&quot;&gt;@CreatedDate&lt;/code&gt;, 수정일시는 &lt;code class=&quot;language-text&quot;&gt;@LastModifiedDate&lt;/code&gt; 어노테이션을 통해 추적할 수 있다. 생성일시의 경우 한 번 생성되면 변경되어선 안 되며, 항상 존재해야 하므로 &lt;code class=&quot;language-text&quot;&gt;nullable = false&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;updatable = false&lt;/code&gt;로 지정한다.&lt;/p&gt;
&lt;p&gt;추가적으로 BaseEntity를 다른 Entity들이 상속받아 사용할 수 있도록 &lt;code class=&quot;language-text&quot;&gt;@MappedSuperclass&lt;/code&gt; 어노테이션을 통해 해당 클래스를 Entity가 아닌 SuperClass로 지정했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@MappedSuperclass&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EntityListeners&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;AuditingEntityListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseEntity&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@CreatedDate&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;created_at&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; nullable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; updatable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt; createdAt&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LastModifiedDate&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;updated_at&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt; updatedAt&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;생성한 사람, 수정한 사람 추적하기&lt;/h3&gt;
&lt;p&gt;생성한 사람은 &lt;code class=&quot;language-text&quot;&gt;@CreatedBy&lt;/code&gt;, 수정한 사람은 &lt;code class=&quot;language-text&quot;&gt;@LastModifiedBy&lt;/code&gt; 어노테이션을 통해 추적할 수 있다. 해당 필드는 생성자, 수정자의 이름으로 채워진다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@MappedSuperclass&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EntityListeners&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;AuditingEntityListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseEntity&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@CreatedBy&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;created_by&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; createdBy&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@LastModifiedBy&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Column&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;modified_by&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; modifiedBy&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;유저에 대한 정보는 SecurityContext&apos;s Authentication 인스턴스로부터 가져온다. 이 값을 커스텀하고 싶다면 &lt;code class=&quot;language-text&quot;&gt;AuditorAware&amp;lt;T&gt;&lt;/code&gt; 인터페이스를 구현해야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuditorAwareImpl&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuditorAware&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getCurrentAuditor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// your custom logic&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 만든 &lt;code class=&quot;language-text&quot;&gt;AuditorAwareImpl&lt;/code&gt;를 사용하려면 Config 클래스에 &lt;code class=&quot;language-text&quot;&gt;AuditorAwareImpl&lt;/code&gt; 인스턴스로 초기화되는 &lt;code class=&quot;language-text&quot;&gt;AuditorAware&lt;/code&gt; 타입의 빈을 설정해주어야 한다. 그리고 &lt;code class=&quot;language-text&quot;&gt;@EnableJpaAuditing&lt;/code&gt; 어노테이션에 &lt;code class=&quot;language-text&quot;&gt;auditorAwareRef=&quot;auditorProvider&quot;&lt;/code&gt; 설정을 추가한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@EnableJpaAuditing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;auditorAwareRef&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;auditorProvider&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;AuditorAware&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;auditorProvider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AuditorAwareImpl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h3&gt;References&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://www.baeldung.com/database-auditing-jpa&quot;&gt;https://www.baeldung.com/database-auditing-jpa&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Spring Data JPA의 Slice & Page]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 파랑이 작성했습니다. Spring Data JPA에서는 Pagination을 위한 두 가지 객체를 제공한다. 바로 Slice와 Page다. Repository…]]></description><link>https://dallog.github.io/data-jpa-slice-page/</link><guid isPermaLink="false">https://dallog.github.io/data-jpa-slice-page/</guid><pubDate>Mon, 18 Jul 2022 22:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/summerlunaa&quot;&gt;파랑&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Spring Data JPA에서는 Pagination을 위한 두 가지 객체를 제공한다. 바로 Slice와 Page다. Repository 코드를 먼저 보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MemberRepository&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Slice&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findSliceBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findPageBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Controller&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// queryParameter를 통해 page, size를 받는다&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/members&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MemberResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 생략&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Service&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;PageRequest&lt;/span&gt; pageRequest &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PageRequest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// pageRequest 생성&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;Slice&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; slices &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findSliceBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// repository에서 페이지 가져오기&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; pages &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findPageBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;메서드를 보면 파라미터로 &lt;code class=&quot;language-text&quot;&gt;Pageable&lt;/code&gt; 객체를 받는다. &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Pageable&lt;/code&gt; 객체는 Pagination을 위한 정보를 저장하는 객체&lt;/strong&gt;다. &lt;code class=&quot;language-text&quot;&gt;Pageable&lt;/code&gt; 인터페이스의 구현체인 &lt;code class=&quot;language-text&quot;&gt;PageRequest&lt;/code&gt;의 인스턴스를 생성하여 메서드 인자로 넘겨줄 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/65d143925c3decfa2843ee7004381e24/bbbf7/pagerequest.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBklEQVQoz3VSWW6DQBTjOsz6toGEpL3/rVwzEYqqph+WHzCLF5buDd1OVDQPNNtRakPOCbnkF1JCInLO/+L6vtjNsT8O9K1C7wp9BOcO2RpkJ+8NlReWXrhpxbquSOuLL1yHnbyEZIRWxNhg7nN2U5h2qHR4DAwtcLc5q/JSM8Lns3EupbwVChe3Xml5RxOqE87SOJN5eOtUSPuVmyqjKKWSL7TJvyw7Ld+/ntAj4E/im+oOQx/KTIV5vhZ/xvrn3SLWaddnKWdBElSnhqqBKs6SqKqWeXuZBVzllI/lLNETnIHHuDHDgaBdV4HSqjEKkXdewRi8JUQ4xnabuTv/DKWAM0sRwQ8p/NgckM6l/AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;PageRequest static constructor&apos; title=&apos;PageRequest static constructor&apos; src=&apos;/static/65d143925c3decfa2843ee7004381e24/ca1dc/pagerequest.png&apos; srcset=&apos;/static/65d143925c3decfa2843ee7004381e24/e7570/pagerequest.png 170w,
/static/65d143925c3decfa2843ee7004381e24/f46e7/pagerequest.png 340w,
/static/65d143925c3decfa2843ee7004381e24/ca1dc/pagerequest.png 680w,
/static/65d143925c3decfa2843ee7004381e24/02d09/pagerequest.png 1020w,
/static/65d143925c3decfa2843ee7004381e24/bbbf7/pagerequest.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;PageRequest static constructor&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;PageRequest&lt;/code&gt;는 정적 팩토리 메서드 &lt;code class=&quot;language-text&quot;&gt;of&lt;/code&gt;를 사용하여 인스턴스를 생성할 수 있다. &lt;code class=&quot;language-text&quot;&gt;PageRequest&lt;/code&gt;는 인자로 page, size, 필요하다면 sort까지 받을 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;page&lt;/code&gt; : 0부터 시작하는 페이지 인덱스 번호&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;size&lt;/code&gt; : 한 페이지에 반환할 데이터의 개수&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;sort&lt;/code&gt; : 정렬 방식&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;page와 size를 쿼리 파라미터로 받아 &lt;code class=&quot;language-text&quot;&gt;PageRequest&lt;/code&gt;를 생성하여 Repository 메서드에 넘겨주는 것으로 간단하게 Pagination을 구현할 수 있는 것이다.&lt;/p&gt;
&lt;h2&gt;Slice VS Page&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MemberRepository&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpaRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token class-name&quot;&gt;Slice&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findSliceBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findPageBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Repository의 메서드를 보면 반환 값으로 &lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;를 받을 수 있다. 둘은 어떤 차이가 있을까?&lt;/p&gt;
&lt;h3&gt;Slice&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7d61658568e3566c020b6599fc453c07/1745e/slice.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 5.294117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATElEQVQI1w3Kyw2AIBAAUeuRj1FY0I2EgBL7r2jkMJeXWWryvNmgh6EEQ0uWLisaN+7aKLM9ChosI1uazFd1eqe/H+0ZyHkRU8I5zw8d0SEOziWYOQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;slice&apos; title=&apos;slice&apos; src=&apos;/static/7d61658568e3566c020b6599fc453c07/ca1dc/slice.png&apos; srcset=&apos;/static/7d61658568e3566c020b6599fc453c07/e7570/slice.png 170w,
/static/7d61658568e3566c020b6599fc453c07/f46e7/slice.png 340w,
/static/7d61658568e3566c020b6599fc453c07/ca1dc/slice.png 680w,
/static/7d61658568e3566c020b6599fc453c07/1745e/slice.png 814w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;slice&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;Streamable&lt;/code&gt;을 상속받는 인터페이스로 Pagination과 관련된 여러 메서드를 갖고 있다. 대표적인 메서드 몇 가지만 살펴보자.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c73e01b98b8943bb49f9769041dd52bd/bbbf7/slice_methods.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 67.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCklEQVQ4y1WT6ZKCQAyEeQcXELmP4b5E2LI8yvd/qmx3VqzdH1FmCF+6kxmra2rZpkmqqpIsz6U2RrZ5kjrPJA5D8X1fPM+Tsixl2za5XC5ikFPXtYYf+Jqzh1XEkRT40HEc+ULkeF6KXCbEESDbdcVFZFkm/TDIOI4yzbOs66oibNvWvOPxqIWtMk0kRBVuukdPWOC7KgEspElT4XsmEng+n6XrOhnhaEIMKJDD1Q5ToEkSCSDVxSajiCJZS/MLA9zEsX5AINW1AO4wWo+QTwcfYAUF9VsFgTkSzqaQFgCqdt6WCyju+15BBNJ2iqLcD9Cmj2XCFijyT6cP8EKFWap7WgjAFAUIIrRDUO0MKAvsg/OQrwpnDICwL8dVIAvUADKBClk9hnUCmqbR4RDENQsdDgcdKvMsKlFFAHMgefyrcK2MFuKaibTHoRCyLIs+E8oh0TaPVYSiVhIEUBVKhQUHEkI+//c9AqnS4IPb7Sb3+12ez6e8Xi9p21YLcTh8zwFZFaa8YAgn2OM5TAGiMg6GMPuPZQKoSPuIf+7TKsPeLZcADm9Aj34QOGI95IxMVlNoO2jper2qwsfjoWrZTz2XGBAjxLStDD9tEuMsnvSY7JYZBgpDtIRT5gFm73hD9itIV1T176bUULiiB7wtnDQVdlBGdVSaYM19VmevqLTCHS5x7fbD/Dd+AB7gbVwhB7yeAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;slice methods&apos; title=&apos;slice methods&apos; src=&apos;/static/c73e01b98b8943bb49f9769041dd52bd/ca1dc/slice_methods.png&apos; srcset=&apos;/static/c73e01b98b8943bb49f9769041dd52bd/e7570/slice_methods.png 170w,
/static/c73e01b98b8943bb49f9769041dd52bd/f46e7/slice_methods.png 340w,
/static/c73e01b98b8943bb49f9769041dd52bd/ca1dc/slice_methods.png 680w,
/static/c73e01b98b8943bb49f9769041dd52bd/02d09/slice_methods.png 1020w,
/static/c73e01b98b8943bb49f9769041dd52bd/bbbf7/slice_methods.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;slice methods&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;현재 페이지의 내용을 확인하거나 다음 페이지, 이전 페이지에 대한 정보를 가져올 수 있다. 그렇다면 &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;는 무엇일까?&lt;/p&gt;
&lt;h3&gt;Page&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/cdcdbc9212162f613deb93dccec679af/911ab/page.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 5.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATklEQVQI1w3JWw5AMBBAUeupSSWVTh9IlJQisf/dXM7v6TYVnizMY8/keq4k7EE4gyFH5bhflnXDeaV4of3foiF5R6mNslc0ZbwGrB34AC6TIVh3KXKvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;page&apos; title=&apos;page&apos; src=&apos;/static/cdcdbc9212162f613deb93dccec679af/ca1dc/page.png&apos; srcset=&apos;/static/cdcdbc9212162f613deb93dccec679af/e7570/page.png 170w,
/static/cdcdbc9212162f613deb93dccec679af/f46e7/page.png 340w,
/static/cdcdbc9212162f613deb93dccec679af/ca1dc/page.png 680w,
/static/cdcdbc9212162f613deb93dccec679af/911ab/page.png 710w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;page&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;를 상속한다. 따라서 &lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;가 가진 모든 메서드를 &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;도 사용할 수 있다. 다만 &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;가 다른 점은 &lt;strong&gt;조회 쿼리 이후 전체 데이터 개수를 조회하는 쿼리가 한 번 더 실행된다는 것&lt;/strong&gt;이다.&lt;/p&gt;
&lt;p&gt;Page가 추가적으로 구현하고 있는 메서드 두 가지만 살펴보자.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8e015d06af588554f4e07efaca3105ae/bbbf7/page_methods.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 15.294117647058824%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjklEQVQI122PSw7DIAxEc4sSyi8USAmCFIh6/5tNMdt08STLHo/HS84ZvXfUWpFSQikF53lCaw2lFLz3uK4LIYTZM8ZMqP7HEmOEtRZSSgghkJxDf+/4eIf0smO2obUOOky01uCGhjEGzvmNZR8LUjzxGAISxW0YDLPvHuC0mikp8XEc04w+oMV1XW9Q/wdm+VSCquaNqQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;page methods&apos; title=&apos;page methods&apos; src=&apos;/static/8e015d06af588554f4e07efaca3105ae/ca1dc/page_methods.png&apos; srcset=&apos;/static/8e015d06af588554f4e07efaca3105ae/e7570/page_methods.png 170w,
/static/8e015d06af588554f4e07efaca3105ae/f46e7/page_methods.png 340w,
/static/8e015d06af588554f4e07efaca3105ae/ca1dc/page_methods.png 680w,
/static/8e015d06af588554f4e07efaca3105ae/02d09/page_methods.png 1020w,
/static/8e015d06af588554f4e07efaca3105ae/bbbf7/page_methods.png 1280w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;page methods&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Page의 경우 전체 데이터 개수를 조회하는 쿼리가 추가적으로 실행되므로 Slice와 다르게 전체 데이터 개수나 전체 페이지 수까지 확인할 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;추가적으로..&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PagingAndSortingRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ID&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CrudRepository&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ID&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Sort&lt;/span&gt; sort&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token class-name&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;를 반환받을 경우 아래처럼 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;를 반환하는 &lt;code class=&quot;language-text&quot;&gt;findAll&lt;/code&gt; 메서드가 이미 존재&lt;/strong&gt;한다. 따로 Repository Interface에 메서드를 추가해주지 않아도 &lt;code class=&quot;language-text&quot;&gt;findAll&lt;/code&gt; 메서드에 &lt;code class=&quot;language-text&quot;&gt;Pageable&lt;/code&gt; 객체를 넘겨주면 Pagination을 사용할 수 있다. (Slice를 반환하려면 메서드를 정의해주어야 한다.)&lt;/p&gt;
&lt;h3&gt;Slice VS Page 어떤 걸 사용해야 할까?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;는 전체 데이터 개수를 조회하지 않고 이전 or 다음 &lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;가 존재하는지만 확인할 수 있다. 따라서 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;는 무한 스크롤 등을 구현하는 경우 유용&lt;/strong&gt;하다. &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;에 비해 쿼리가 하나 덜 날아가므로 &lt;strong&gt;데이터 양이 많을수록 &lt;code class=&quot;language-text&quot;&gt;Slice&lt;/code&gt;를 사용하는 것이 성능상 유리&lt;/strong&gt;하다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt;는 전체 데이터 개수를 조회하는 쿼리를 한 번 더 실행한다. 따라서 &lt;strong&gt;전체 페이지 개수나 데이터 개수가 필요한 경우 유용&lt;/strong&gt;하다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;알록에서는 카테고리 조회를 무한 스크롤로 구현하므로 Slice를 사용했다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;컨트롤러에서 queryParameter를 Pageable 객체로 받는 방법&lt;/h2&gt;
&lt;p&gt;앞에선 queryParameter를 통해 page, size를 받아 PageRequest를 만들어 넘겨주는 방법을 설명했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Controller&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// queryParameter를 통해 page, size를 받는다&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/members&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MemberResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 생략&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만 이렇게 구현하니까 &lt;em&gt;“ModelAttribute를 통해 queryParameter를 DTO로 받는 것처럼, queryParameter를 Pageable 객체로 받을 수 없을까?”&lt;/em&gt;하는 의문이 생겼다. 직접 ArgumentResolver를 구현할 뻔했지만 찾아보니 역시 똑똑한 JPA.. Pageable 객체를 인수로 설정하면 어노테이션 없이도 자동으로 객체를 만들어준다. &lt;code class=&quot;language-text&quot;&gt;PageableHandlerMethodArgumentResolver&lt;/code&gt; 가 이미 구현되어 있기 때문이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Controller&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Pageable 객체를 바로 받을 수 있다.&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/api/members&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;MemberResponse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;findAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Pageable&lt;/span&gt; pagealbe&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 생략&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Service&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;Slice&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Member&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; slices &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; memberRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;findSliceBy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pageable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// PageReqeust를 생성할 필요 없이 바로 객체를 넘겨줄 수 있다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 사용하면 PageReqeust를 생성할 필요 없이 바로 객체를 넘겨줄 수 있어 훨씬 편하다. 하지만 문제가 한 가지 발생한다. &lt;strong&gt;프론트에서는 page index를 1부터 계산하는 것과 달리 Pageable은 page index를 0부터 계산한다.&lt;/strong&gt; 따라서 page의 인덱스를 1부터 시작하도록 설정할 필요가 있다.&lt;/p&gt;
&lt;h2&gt;page 인덱스를 1부터 시작하도록 설정하기&lt;/h2&gt;
&lt;h3&gt;방법 1. PageableHandlerMethodArgumentResolverCustomizer 커스터마이징 하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CustomPageableConfiguration&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PageableHandlerMethodArgumentResolverCustomizer&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;customize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;-&gt;&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setOneIndexedParameters&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;따로 &lt;code class=&quot;language-text&quot;&gt;CustomPageableConfiguration&lt;/code&gt; 클래스를 만들어 &lt;code class=&quot;language-text&quot;&gt;PageableHandlerMethodArgumentResolverCustomizer&lt;/code&gt;를 커스터마이징 해주는 방법이 있다. 여기서 &lt;code class=&quot;language-text&quot;&gt;setOneIndexedParameters&lt;/code&gt; 메서드를 통해 인덱스를 1부터 시작하게 설정할 수 있다.&lt;/p&gt;
&lt;h3&gt;방법 2. application-properties에 설정 추가하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;spring&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;web&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pageable&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;one&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;indexed&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;parameters&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;유의점 1&lt;/h3&gt;
&lt;p&gt;이렇게 인덱스를 1부터 시작하도록 설정하면 &lt;strong&gt;단순히 Controller에서 받는 Pageable의 page 값이 -1 되어 저장될 뿐이다.&lt;/strong&gt; Pageable 객체나 이후에 반환받은 Slice, Page 객체에서는 &lt;strong&gt;page 인덱스가 여전히 0부터 시작&lt;/strong&gt;한다. &lt;/p&gt;
&lt;p&gt;따라서 getNumber 등의 메서드를 통해 page 번호를 받으면 -1씩 차이가 난다는 사실을 잊어선 안 된다. &lt;strong&gt;현재 페이지 index를 반환하고 싶다면 반드시 -1&lt;/strong&gt;을 해줘야 한다. 유의해서 사용하자.&lt;/p&gt;
&lt;h3&gt;유의점 2&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;무한 스크롤을 Slice나 Page로 구현하면 데이터가 중복으로 나타날 수 있다.&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;예를 들어 생각해보자. 30개의 데이터를 불러왔고 10개의 데이터를 추가로 요청하려 하는데, 그 사이에 10개의 데이터가 앞에 추가되었다. 이 경우 데이터가 10개씩 밀려서 21~30번째 데이터가 중복으로 나타나게 된다.
달록에서는 아직 이 경우까지 고려해서 페이징을 구현하지 못했다. 좀 더 고민해보아야 할 부분인 것 같다.&lt;/p&gt;
&lt;h3&gt;References&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/&quot;&gt;https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://treasurebear.tistory.com/59&quot;&gt;https://treasurebear.tistory.com/59&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html&quot;&gt;https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html&quot;&gt;https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[달록에 적절한 패키지 구조 고민하기]]></title><description><![CDATA[…]]></description><link>https://dallog.github.io/package-structure/</link><guid isPermaLink="false">https://dallog.github.io/package-structure/</guid><pubDate>Mon, 18 Jul 2022 12:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;달록에 적절한 패키지 구조 고민하기&lt;/h2&gt;
&lt;p&gt;우리는 프로젝트를 진행하며 어떠한 패키지 구조를 구성할지 고민하게 된다. 보통 패키지 구조를 나누는 대표적인 방법으로 &lt;code class=&quot;language-text&quot;&gt;계층별&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;기능별&lt;/code&gt;로 나눌 수 있다.&lt;/p&gt;
&lt;h3&gt;계층별 패키지 구조&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── allog
    │   │           └── dallog
    │   │               ├── application
    │   │               ├── config
    │   │               ├── domain
    │   │               ├── dto
    │   │               ├── exception
    │   │               ├── presentation
    │   │               └── DallogApplication.java
    │   └── resources
    │       └── application.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;계층형 구조는 각 계층을 대표하는 패키지를 기준으로 코드를 구성한다. 계층형 구조의 가장 큰 장점은 해당 프로젝트에 대한 이해도가 낮아도 각 계층에 대한 역할을 충분히 숙지하고 있다면 전체적인 구조를 빠르게 파악할 수 있다.&lt;/p&gt;
&lt;p&gt;하지만 단점도 존재한다. 하나의 패키지에 모든 클래스들이 모이게 되기 때문에 규모가 커지면 클래스의 개수가 많아져 구분이 어려워진다. 아래는 이전에 계층형 구조를 기반으로 작성한 프로젝트이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;└── presentation
    ├── ChampionController.java
    ├── CommentController.java
    ├── PlaylistController.java
    ├── RankingController.java
    ├── SearchController.java
    ├── UserController.java
    ├── WardController.java
    └── ...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;비교적 적은 코드의 양이지만 규모가 커질수록 애플리케이션에서 presentation 계층에 해당하는 모든 객체가 해당 패키지에 모이게 될 것이다.&lt;/p&gt;
&lt;h3&gt;기능별 패키지 구조&lt;/h3&gt;
&lt;p&gt;기능별로 패키지를 나눠 구성한다. 기능별 패키지 구조의 장점은 해당 도메인에 관련된 코드들이 응집되어 있다는 점이다. 덕분에 &lt;code class=&quot;language-text&quot;&gt;지역성의 원칙&lt;/code&gt;를 잘 지킬 수 있다고 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;컴퓨터 과학에서, 참조의 지역성, 또는 지역성의 원칙이란 프로세서가 짧은 시간 동안 동일한 메모리 공간에 반복적으로 접근하는 경향을 의미한다. 참조 지역성엔 두 가지 종류가 있다. 바로 시간적 지역성과 공간적 지역성이다. 시간적 지역성이란 특정 데이터 또는 리소스가 짧은 시간 내에 반복적으로 사용되는 것을 가리킨다. 공간적 지역성이란 상대적으로 가까운 저장 공간에 있는 데이터 요소들이 사용되는 것을 가리킨다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;개발자 역시 복잡하고 거대한 프로젝트의 전체 구조를 모두 인지하는 것은 힘든일이다. 우선 특정 지역의 흐름을 파악할 수 있다면 해당 패키지에 대해서는 마치 캐시에 적재된 데이터에 접근 하듯 빠르게 인지가 가능하다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── allog
    │   │           └── dallog
    │   │               ├── auth
    │   │               │   ├── application
    |   |               |   ├── domain
    │   │               │   ├── dto
    │   │               │   ├── exception
    │   │               │   └── presentation
    │   │               ├── category
    │   │               │   ├── application
    |   |               |   ├── domain
    │   │               │   ├── dto
    │   │               │   ├── exception
    │   │               │   └── presentation
    │   │               ├── schedule
    │   │               │   ├── application
    |   |               |   ├── domain
    │   │               │   ├── dto
    │   │               │   ├── exception
    │   │               │   └── presentation
    │   │               ├── global
    │   │               │   ├── config
    │   │               │   ├── dto
    │   │               │   ├── error
    │   │               │   └── exception
    │   │               ├── infrastructure
    │   │               │   └── oauth
    │   │               └── AllogDallogApplication.java
    |   |
    │   └── resources
    │       └── application.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만 각 계층이 기능별로 모여 있기 때문에 프로젝트에 대한 이해도가 낮으면 전체 구조를 파악하는데 오랜 시간이 걸린다.&lt;/p&gt;
&lt;h3&gt;더 나아가기&lt;/h3&gt;
&lt;p&gt;현재 구조에서는 도메인에 해당하는 다양한 기능들이 패키지 전반적으로 퍼져 있다. 각각의 도메인 기능이 밀집되어 있지 않은 구조를 가지고 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── allog
    │   │           └── dallog
    │   │               ├── domain
    │   │               │   ├── auth
    │   │               │   │   ├── application
    |   |               │   |   ├── domain
    │   │               │   │   ├── dto
    │   │               │   │   ├── exception
    │   │               │   │   └── presentation
    │   │               │   ├── category
    │   │               │   │   ├── application
    |   |               │   |   ├── domain
    │   │               │   │   ├── dto
    │   │               │   │   ├── exception
    │   │               │   │   └── presentation
    │   │               │   └── schedule
    │   │               │       ├── application
    |   |               │       ├── domain
    │   │               │       ├── dto
    │   │               │       ├── exception
    │   │               │       └── presentation
    │   │               ├── global
    │   │               │   ├── config
    │   │               │   ├── dto
    │   │               │   ├── error
    │   │               │   └── exception
    │   │               ├── infrastructure
    │   │               │   └── oauth
    │   │               └── AllogDallogApplication.java
    |   |
    │   └── resources
    │       └── application.properties&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;domain&lt;/h3&gt;
&lt;p&gt;실제 애플리케이션의 핵심이 되는 도메인 로직이 모여 있다. 애플리케이션의 주요 비즈니스 로직이 모여 있기 때문에 &lt;code class=&quot;language-text&quot;&gt;외부와의 의존성을 최소화&lt;/code&gt;해야 한다. 즉 &lt;code class=&quot;language-text&quot;&gt;외부의 변경에 의해 도메인 내부가 변경되는 것을 막아야 한다는 것&lt;/code&gt;을 인지해야 한다.&lt;/p&gt;
&lt;h3&gt;global&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;global&lt;/code&gt;은 프로젝트 전반에서 사용하는 객체로 구성한다. 공통적으로 사용하는 dto나 error, config에 대한 것들이 모여 있다.&lt;/p&gt;
&lt;h3&gt;infrastructure&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;infrasturcture&lt;/code&gt;는 외부와의 통신을 담당하는 로직들이 담겨 있다. 이번 프로젝트에서는 OAuth를 활용한 회원 관리를 진행하기 때문에 google의 인증 서버와 통신이 필요해진다. 이 패키지는 우리의 의지와 다르게 외부의 변화에 따라 변경될 여지를 가지고 있다. 즉 변화에 매우 취약한 구조이며 외부 서버에 의존적 이기 때문에 항시 변화에 대응할 수 있도록 대비해야 한다. 이것이 의미하는 바는 결국 &lt;code class=&quot;language-text&quot;&gt;도메인 관련 패키지에서 infrastructure를 직접적으로 의존하는 것&lt;/code&gt;은 도메인 로직을 안전하게 지킬 수 없다는 의미를 내포한다.&lt;/p&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;p&gt;각각의 방법은 서로 다른 장단점을 가지고 있기 때문에 정답은 없다고 생각한다. 현재 프로젝트의 규모와 요구사항을 고려하여 선택해야 한다. 다만 선택한 패키지 구조에 충분한 근거를 가져야하고, 객체와 패키지 사이의 의존성에 대해 충분히 고민해야 한다.&lt;/p&gt;
&lt;p&gt;달록은 현재 기능별 패키지 구조로 진행되고 있다. 모든 팀원들이 처음 부터 기획과 설계에 대한 고민을 진행했기 때문에 프로젝트의 구조에 대해 분석 하는 시간이 불필요했기 때문이다. 하지만 각각의 기능들이 난잡하게 퍼져 있기 때문에 &lt;a href=&quot;#%E1%84%83%E1%85%A5-%E1%84%82%E1%85%A1%E1%84%8B%E1%85%A1%E1%84%80%E1%85%A1%E1%84%80%E1%85%B5&quot;&gt;더 나아가기&lt;/a&gt;에서 언급한 것 처럼 좀 더 밀접한 기능들을 모아둘 필요가 있다고 판단한다. 이것은 추후 팀원들과 충분한 논의를 통해 개선해갈 예정이다.&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://cheese10yun.github.io/spring-guide-directory&quot;&gt;Spring Guide - Directory&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://ahnheejong.name/articles/package-structure-with-the-principal-of-locality-in-mind&quot;&gt;지역성의 원칙을 고려한 패키지 구조: 기능별로 나누기&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[React에서 무한 스크롤 구현하기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 나인이 작성했습니다. 🎯 "무한 스크롤을 구현해보세요!" 어떻게 구현하실 건가요? 무한 스크롤을 처음 마주했을때 🤔 저는 처음 무한 스크롤을 구현할 때 다음과 같은 방식을 사용했어요. scroll event…]]></description><link>https://dallog.github.io/infinite-scroll/</link><guid isPermaLink="false">https://dallog.github.io/infinite-scroll/</guid><pubDate>Mon, 18 Jul 2022 08:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/jhy979&quot;&gt;나인&lt;/a&gt;이 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;🎯 &quot;무한 스크롤을 구현해보세요!&quot;&lt;/p&gt;
&lt;p&gt;어떻게 구현하실 건가요?&lt;/p&gt;
&lt;h2&gt;무한 스크롤을 처음 마주했을때&lt;/h2&gt;
&lt;p&gt;🤔 저는 처음 무한 스크롤을 구현할 때 다음과 같은 방식을 사용했어요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1. scroll 이벤트를 감지한다.

2. 현재 스크롤 영역의 `위치를 계산`한다.

3. 영역 계산을 통해 페이지 아래에 위치하면 API 요청을 진행한다.

4. 받아온 데이터를 추가하여 다시 렌더링한다.

5. 무한 반복&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h2&gt;scroll event 사용하기&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.dev/jhy979/javascript-youtube-classroom/tree/jhy979-step2&quot;&gt;우테코 레벨1 유튜브 미션&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;처음 제가 무한 스크롤을 구현했던 방법은 다음과 같습니다.&lt;/p&gt;
&lt;p&gt;바로 스크롤 이벤트와 offset을 이용한 방식이죠!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;scrollToBottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; isScrollBottom &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;$videoList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scrollHeight &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;$videoList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scrollTop &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;$videoList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offsetHeight &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;EVENT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SCROLL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;OFFSET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isScrollBottom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;$searchInput&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;메서드 네이밍을 통해서도 알 수 있듯이, 화면 하단까지 내려갔을 경우 (offset 정도를 감안하여) 인자로 받은 함수를 실행시켜주었습니다.&lt;/p&gt;
&lt;p&gt;아 물론, 스크롤 이벤트는 워낙 많이 발생하기 때문에 throttle을 걸어주었습니다. (이건 필수죠)&lt;/p&gt;
&lt;p&gt;😢 하지만, &lt;code class=&quot;language-text&quot;&gt;documentElement.scrollTop&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;documentElement.scrollHeight&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;documentElement.offsetHeight&lt;/code&gt;는 리플로우(Reflow)가 발생합니다.&lt;/p&gt;
&lt;p&gt;확실히 비효율적이겠죠!&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;IntersectionObserver 사용하기&lt;/h2&gt;
&lt;p&gt;달록에서는 무한 스크롤을 구현할 때 &lt;a href=&quot;https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API&quot;&gt;Intersection Observer&lt;/a&gt;를 사용했습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Intersection Observer는 쉽게 말해 지정한 대상이 화면에 보이는지 감시하고 판단하는 도구입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;브라우저 Viewport와 Target으로 설정한 요소의 교차점을 관찰하여 그 Target이 Viewport에 포함되는지 구별하는 기능을 제공합니다.&lt;/p&gt;
&lt;img src=&apos;https://velog.velcdn.com/images/jhy979/post/19500233-65fc-4ba9-b421-81516700c00b/image.png&apos;&gt;
&lt;h3&gt;useIntersect 커스텀훅&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;가장 먼저 useIntersect 라는 커스텀훅을 제작했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 커스텀훅은 &lt;code class=&quot;language-text&quot;&gt;인자로 intersect시 실행할 함수&lt;/code&gt;를 받고 &lt;code class=&quot;language-text&quot;&gt;ref를 제공&lt;/code&gt;하여 관찰할 대상을 지정할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ts&quot;&gt;&lt;pre class=&quot;language-ts&quot;&gt;&lt;code class=&quot;language-ts&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IntersectHandler&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  entry&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectionObserverEntry&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  observer&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectionObserver
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 인자로 onIntersect와 options를 받습니다.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// onIntersect는 intersect 발생 시 실행하고 싶은 함수입니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useIntersect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  onIntersect&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectHandler&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  options&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectionObserverInit
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// 관찰하고 싶은 친구를 잡기 위해 ref를 만들어주세요.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; ref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token generic-function&quot;&gt;&lt;span class=&quot;token function&quot;&gt;useRef&lt;/span&gt;&lt;span class=&quot;token generic class-name&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;HTMLDivElement&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// intersect 시 실행할 함수를 만들어줍시다.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; callback &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useCallback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entries&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectionObserverEntry&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; observer&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IntersectionObserver&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      entries&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isIntersecting&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token function&quot;&gt;onIntersect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; observer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;onIntersect&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// 🔨 옵저버에게 일을 시켜봅시다.&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// 우리가 관찰하고 싶은 친구가 없으면 그냥 return 해버려요.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// 관찰할 대상이 있으면 옵저버 데꼬 와야죠!&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; observer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IntersectionObserver&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;callback&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// 이 옵저버한테 감시를 시킵시다.&lt;/span&gt;
    observer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;observe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// 할 일 끝나면 고생한 옵저버도 쉬게 해줍시다!&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      observer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; callback&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; ref&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; useIntersect&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;실제 사용&lt;/h3&gt;
&lt;p&gt;useIntersect 커스텀훅을 잘 만들었으니 이제 이 커스텀훅을 무한 스크롤에 사용해 봅시다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/jhy979/post/4643727c-852d-4f23-ab4f-44ce79e2e3b2/image.gif&quot;&gt;&lt;/p&gt;
&lt;p&gt;다음은 카테고리 목록을 계속 불러와 리스트를 보여주는 컴포넌트입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;tsx&quot;&gt;&lt;pre class=&quot;language-tsx&quot;&gt;&lt;code class=&quot;language-tsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;CategoryList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  categoryList&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  getMoreCategories&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hasNextPage&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; CategoryListProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// useIntersect 커스텀훅의 인자로 (교차 시) 실행할 함수를 넣어줍시다.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; ref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useIntersect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    hasNextPage &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getMoreCategories&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;categoryTable&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;categoryTableHeader&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; 생성 날짜 &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; 카테고리 이름 &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;categoryList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;CategoryItem&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;category&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;category&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      // 페이지 하단까지 내리면 이 친구가 등장하여 옵저버에게 감지될 거예요.
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;ref&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;intersectTarget&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;💪 무한 스크롤함에 따라 props로 받아오는 categoryList가 길어지게 될텐데요, 다행히 React에서는 key값으로 변경 여부를 확인하기 때문에 새롭게 추가된 리스트들만 리렌더링해주었습니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[달록팀의 git 브랜치 전략을 소개합니다.]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 매트가 작성했습니다. Git-flow git 브랜치 전략 중 하나이다, 이것은 어떠한 기능을 나타내는 것이 아니라 방법론이다. 각각의 프로젝트와 개발 환경에 따라 알맞게 수정하여 사용해야 한다. 이 게시글은 git…]]></description><link>https://dallog.github.io/git-branch-strategy/</link><guid isPermaLink="false">https://dallog.github.io/git-branch-strategy/</guid><pubDate>Tue, 12 Jul 2022 23:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/hyeonic&quot;&gt;매트&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Git-flow&lt;/h2&gt;
&lt;p&gt;git 브랜치 전략 중 하나이다, 이것은 어떠한 기능을 나타내는 것이 아니라 방법론이다. 각각의 프로젝트와 개발 환경에 따라 알맞게 수정하여 사용해야 한다.&lt;/p&gt;
&lt;p&gt;이 게시글은 git을 알고 사용해 본 경험이 있다는 것을 전제로 작성하였다. 또한 직접 프로젝트에 적용하고 연습하고 있기 때문에 정답이 될 수 없고, 지속적으로 개선할 예정이다.&lt;/p&gt;
&lt;h2&gt;Git Repository&lt;/h2&gt;
&lt;p&gt;프로젝트에 적용하기 앞서 어떠한 형태로 Git Repository가 구성되는지 살펴보았다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8eeec1db0a8e2a1451b02f210499e2bb/bf9c5/git-repository.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 79.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACt0lEQVQ4y21U2XLaUAz1//9JJ9O3TLc0D03TydKmCQkUAtgGvO8r2BibU0nUKV2Y0Uj3SlfL0THKbrdDL23b/mNvNhWqusGadFEUIk3T4PjdsShd14GFD9vt9iUR27u2gz4fY3h7ClN9QF6sYZgWsizDfr//f8I8z5EkCVhzddYvUpRYqiMMb15Df3oP7ccFltNrlGX50sTfEypcraoqueiD2ME2j2YYBnzfh2VZ8FwbmjqVwtxhH3cMlcLOflTWdV0Tbhus12vpJAgCOft+ID6eJo5j8XEMT3IMlYzMnbD4vofnyUSS9MlZgsCHrmtwHEc6Yx8LJzRNE6o6F5t9CldK05SShfBYPF9G9DxPqvKZ7x3Hg0+FTIKAi/BkrusjjBLY5HMpnt9IQo8ShI6K1B7AnF9jW+WStKKHpqEjtgawtTtkaYg0K2TcJEnhLAYIzQECayRYcnFJyJXnj2eY3LzC/eUJ2R/hmDotq8FqMYf6+Bb64BRPt2+wmD0INznh6O4DFo+nGF6fQB9/oYTuYSmMY+A5csFtu64rHTLIjKtlLmFRp76twVjMaGTGr4RtGfAck3wazOUzwjD4vRT+pWlGG0zEZvza9kClrtvLOMRzAr73tRLHX1BM3R7edAceHtbeCR2iKPqDrFyMl8A8ZM3nniJs53mG4Nc0QhumCIttW6RD4ZtN9GC+Mf8sy0YQRgcYKI41J2ZIODYIQ7Edx5WGlHK9ga5N4cwu0GxiqlqjLDJJWK4rzIaXqNIFmm2Nrm2Q0KM8Lwi/FWLjK+oyEF+1KaWAsqP2jdUSq+dLLMefMLk/w3R4RfTIBJ/Z6ArG5BzTwTkW489waQk1/fuYK1oE3WvDc4y+vYOpfSdORlCY3bLlIEIUp9Q28YvGYjoxtv19FMUyLsPDi+KPgUkdxSwxcTmQNz8BEyy7pfzcKroAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;git repository&apos; title=&apos;git repository&apos; src=&apos;/static/8eeec1db0a8e2a1451b02f210499e2bb/ca1dc/git-repository.png&apos; srcset=&apos;/static/8eeec1db0a8e2a1451b02f210499e2bb/e7570/git-repository.png 170w,
/static/8eeec1db0a8e2a1451b02f210499e2bb/f46e7/git-repository.png 340w,
/static/8eeec1db0a8e2a1451b02f210499e2bb/ca1dc/git-repository.png 680w,
/static/8eeec1db0a8e2a1451b02f210499e2bb/02d09/git-repository.png 1020w,
/static/8eeec1db0a8e2a1451b02f210499e2bb/9d567/git-repository.png 1360w,
/static/8eeec1db0a8e2a1451b02f210499e2bb/bf9c5/git-repository.png 1489w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;Upstream Remote Repository&lt;/h3&gt;
&lt;p&gt;개발자가 공유하는 저장소로 최신 소스코드가 저장되어 있는 원격 저장소이다.&lt;/p&gt;
&lt;h4&gt;적용하기&lt;/h4&gt;
&lt;p&gt;이러한 Remote Repository 생성을 위하여 github에 New organization을 사용히였다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 219px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/3841b2e403417a99e067872ce9c8cf0f/7223d/new-organization.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 97.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACpklEQVQ4y51USWtTYRR9f0EQW1tNbabmNUnTqqW0otm4UKwLd4ILF8WFIIiiuBNcuOtCUAT3op0dqCC4FnFjBzsl0qRtkjZtEmyb4Y3p8d4vzfPRUCF+cPLN5917zv0iOX0h1A25E063F842P1w0dskhAd6T3HIQ9aEDTq8Mz/nr8HSF0erxodXrJ7TD5QtAcvk6ICBzH4SnPYS2QBe8/s4a8Dqf6+k9h/DAIDzdl9Dd04u+8EV0912A3HEG0sELDpcPDSecaHS4anC8xY2jTS0IdPWgv/8KGpodkENncfnqNUo/AF/wNKTGk3SZ0ESHjxxrxo2bA3j3YRJDI+MYHp3A0Gilr2JkbAJvR8YI43j9ZhjvP05iLZHE85evcIpSl+7efwjGvQePcOv2HXz99h3cTNNEve3xk6eQDi6aZhmqquLn3DymZ2axupbAwuISfkxNi7W5+QUsRaJivVwuwzAM0Wu6Lu5LPDEZFJFCRIx62t7enpVRsViCxAtVaJouwJuJZJKQwkY6bWFldQ3JVEqsJ0i3bC5nERqGSVEalZTthCqBx9lsDvH4CtbXN5DJZmmeRYzm/CEm535za8si5N8M3TmUsJ5WNXDw2YtaQhaXhZ4lA9gETpN7NoINY82rqN7jMbdPn7/UaqiqmvVVVdOESb+3t2lP+6cpHERJ0f6WjSDUKxEyGQteKBQEkaKowsHd3V1CHjna297ZQT5fsAg5yvV0plI2onQoHY5G3Xc5Eo2K+mPxOe2p6RksLkWEMSzBciwuxnYdi0Xl8JT/pw45IMkuskJkTMp6sAnLsRjSm5v0VhMi0kj0l3ghdiPthCVFOZiyZkXItcd1xvXImvGY/wRYx8NKRxDaQ7c/P52i1EX16/swYNA+Z1AsKSjZQaaxcXzuD5wW37umFKGoAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;new organization&apos; title=&apos;new organization&apos; src=&apos;/static/3841b2e403417a99e067872ce9c8cf0f/7223d/new-organization.png&apos; srcset=&apos;/static/3841b2e403417a99e067872ce9c8cf0f/e7570/new-organization.png 170w,
/static/3841b2e403417a99e067872ce9c8cf0f/7223d/new-organization.png 219w&apos; sizes=&apos;(max-width: 219px) 100vw, 219px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;다양한 기능을 제공하는 Team과 Enterprice는 월마다 일정 금액을 사용해야 한다. 하지만 간단한 프로젝트 진행을 위해 생성하였기 때문에 Free만 사용하여도 충분한 실습과 프로젝트를 진행할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fa26164ec13e89c5c184f602a91f9336/094ea/fare.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+klEQVQoz21SO3PTQBj0L6LhB6QlBRU0wP+goIChCAWvGeBPpE1JQQpmUiThMcxQ4GQg2LJsxZZ0utPjHjpp+b6TZSi48c5Je7t7qztP+r5H1/XgmX7beeC6rvsP3+34cfybMfkb1iNeLtE0TRCNRh6rJMEmTcOz90OY1hrzaEGIIIpi55mMuxpjIJVCXddk8ui2uzKf5yLAWrtrx7osywg5hBBo23Zs2KGlAIYjkhc4kJuMnHUuzJ60O94NPOvHNS4w8Z2HqBSKgiAVVFmjbgwJPSrdQEhJXEUmTwGMFpqaFqoMemMplDZhPnwyf1quJJLrDZ3VOojYzIFlU2N1vQ7IRBFMjkI5cJ1mgV9vMiqggycEclVZ1ciFguR22pBhMFZ08EJVUFWDxrjQ0NihIWuFLMOabbvA+/FSxqEryfe4fesCnC7Re0M0oXf8JwloTQXTlCSxwzqGy5o4Sr9cWfyIDT6c/cS3XxLTpUNetvi9MXh/eoWT7wnOpilOLwTi3CErPY4/z/Hx6xxfLnN8mma4iPVwKalqcff1AreezXH/bYI7r2LsPZnh6Fzi4WGCm49n2H8RYf9lhBuPrnBwtMbhSYG9pxEevFuRZ4nbz2PcexNDOz5D32NFu8aZDVgSFoRSe2yUw4xaRqkN4Gdurhof3kcPIxEuNPwDnN9Bb3yW+LoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;fare&apos; title=&apos;fare&apos; src=&apos;/static/fa26164ec13e89c5c184f602a91f9336/ca1dc/fare.png&apos; srcset=&apos;/static/fa26164ec13e89c5c184f602a91f9336/e7570/fare.png 170w,
/static/fa26164ec13e89c5c184f602a91f9336/f46e7/fare.png 340w,
/static/fa26164ec13e89c5c184f602a91f9336/ca1dc/fare.png 680w,
/static/fa26164ec13e89c5c184f602a91f9336/02d09/fare.png 1020w,
/static/fa26164ec13e89c5c184f602a91f9336/094ea/fare.png 1047w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;organization을 생성하게 되면 소속된 repository를 생성할 수 있다. 이것을 &lt;code class=&quot;language-text&quot;&gt;Upstream Remote Repository&lt;/code&gt;로 적용한다.&lt;/p&gt;
&lt;h3&gt;A&apos;s, B&apos;s, C&apos;s Origin Remote Repository&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Upstream Repository&lt;/code&gt;를 Fork한 원격 개인 저장소이다. Upstream Repository를 직접 clone하여 작업하는 것이 아니라 각각의 팀원들이 &lt;code class=&quot;language-text&quot;&gt;Fork&lt;/code&gt;를 하여 원격 저장소를 생성하고 그것을 clone하여 &lt;code class=&quot;language-text&quot;&gt;Local Repository&lt;/code&gt;를 생성하여 작업한다.&lt;/p&gt;
&lt;p&gt;이렇게 두 개의 remote repository로 나눈 이유는 Upstream repository의 경우 &lt;code class=&quot;language-text&quot;&gt;팀원이 공유&lt;/code&gt;하고 있는 Repository이기 때문에 다양한 시도를 하기에 큰 위험 부담을 가지고 있다. 각자의 개인 repository에서 &lt;code class=&quot;language-text&quot;&gt;작업을 시도&lt;/code&gt;한 후 적절한 기능 merge 하기 위해 &lt;code class=&quot;language-text&quot;&gt;Pull Request&lt;/code&gt;를 요청한다.&lt;/p&gt;
&lt;h3&gt;운영 방식&lt;/h3&gt;
&lt;p&gt;git-flow는 기본적으로 5가지의 브랜치를 사용하여 운영한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;: 제품으로 출시될 수 있는 브랜치&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;: 다음 출시 버전을 개발하는 브랜치&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;feature&lt;/code&gt;: 기능을 개발하는 브랜치&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;release&lt;/code&gt;: 이번 출시 버전을 준비하는 브랜치&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;hotfix&lt;/code&gt;: 출시 버전에서 발생한 버그를 수정하는 브랜치&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/029f0c1db58db7df780f7cda860d2092/3b5a6/git-flow-dev.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 34.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVQoz31Ry3KDMBDL//8Vlx7TW9KUhqSdQMDmEQi4wd61avNq6KGe0UirXcvYbKxl+MVsYa11zAvm5f2V/i1BRAuMMdikcY7LV4JMpkizK4QUeA8PCD8OkLmYvAxxcsF+v0MqxpnodMT+bQete/R971iPgXXRIYsaeL7JFm2tcMtbFEnrvBbNrUUlHOQdhaycvg9+IWrIpILu9RI2BDITHjUjDwnliaAqQvXJuL4ymoTQlYTiSKgvrlfyouuYUUbWBRoXOIZpo7HxgtiAoR0MHmqs3esMNduJMc95PHlk1m/YdR2CIMB2u4VRwPnlG43QbrMbmE/2POFZz/0Z/urDF/pQpdR4kqHVn/uL4Ub/9H4A3oYd/xo5ia0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;git flow dev&apos; title=&apos;git flow dev&apos; src=&apos;/static/029f0c1db58db7df780f7cda860d2092/ca1dc/git-flow-dev.png&apos; srcset=&apos;/static/029f0c1db58db7df780f7cda860d2092/e7570/git-flow-dev.png 170w,
/static/029f0c1db58db7df780f7cda860d2092/f46e7/git-flow-dev.png 340w,
/static/029f0c1db58db7df780f7cda860d2092/ca1dc/git-flow-dev.png 680w,
/static/029f0c1db58db7df780f7cda860d2092/02d09/git-flow-dev.png 1020w,
/static/029f0c1db58db7df780f7cda860d2092/3b5a6/git-flow-dev.png 1302w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt; 브랜치이다. 두 브랜치는 항시 운영되어야 하는 브랜치이다. &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;는 개발을 위한 브랜치이고, &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;은 제품으로 출시될 수 있는 브랜치 이기 때문에 &lt;code class=&quot;language-text&quot;&gt;항시 배포 가능한 상태&lt;/code&gt;이어야 한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;은 &lt;code class=&quot;language-text&quot;&gt;Upstream remote repository&lt;/code&gt;에서 운영한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/606d65acf7592c436f92357df92671ec/2d324/git-flow-feature.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVQoz12Q7YrbMBBF8/6PFeif9l8pS6GbTRY2sS1/SE5kW9+nI2dbSg2XuRpLhztzSCmxrAtmNuhJo7XGGEPbtgzDyDzP+9naRWR3BR+IMbIsCyE8/Z96KGRul57re4e5j4x6QJuJ0/kXXd8wGemNvUBHTm+vXN7f6IeOpm348fKdcRr+AqsOKSfCmnm0mfu1YIeCt0U86Au4e2ExmeYS2EziMUW6U8BOgfEc2e6ROmWK6Qms9JhEW6RtHDe1kWdZg5KRGukLRGnH8Wow2nMbN3rlKY/MMkScFWBlfKZ8AkVZoEvxXNNKnx2qCLxsDNWnjddo+eINL1JV3uiSwxbZWxboHuqfhDVy/Wp9SLPxjg+/cXYrdzlvolU0BMccPEr+K/H1boj/ASuk73uOxyNKKWxTUN8kaVz5us78dFagHnlBEWV5XD27T/t0dX/pE/gbMGwbM0hRgfsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;git flow feature&apos; title=&apos;git flow feature&apos; src=&apos;/static/606d65acf7592c436f92357df92671ec/ca1dc/git-flow-feature.png&apos; srcset=&apos;/static/606d65acf7592c436f92357df92671ec/e7570/git-flow-feature.png 170w,
/static/606d65acf7592c436f92357df92671ec/f46e7/git-flow-feature.png 340w,
/static/606d65acf7592c436f92357df92671ec/ca1dc/git-flow-feature.png 680w,
/static/606d65acf7592c436f92357df92671ec/02d09/git-flow-feature.png 1020w,
/static/606d65acf7592c436f92357df92671ec/2d324/git-flow-feature.png 1306w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;feature&lt;/code&gt; 브랜치는 단위 기능을 개발하는 브랜치이다. 기능 개발이 완료되면 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt; 브랜치와 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 된다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;은 모든 팀원이 &lt;code class=&quot;language-text&quot;&gt;공유&lt;/code&gt;하는 브랜치이다. feature는 각자 맡아 작성한 코드들이 들어 있는 브랜치이다. merge 작업 전에 팀원들 간의 &lt;code class=&quot;language-text&quot;&gt;지속적인 코드 리뷰&lt;/code&gt;가 필요하다.&lt;/p&gt;
&lt;p&gt;그렇기 때문에 &lt;code class=&quot;language-text&quot;&gt;Pull Request&lt;/code&gt;를 사용하여 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 작업 전 리뷰어들에게 코드 리뷰를 받고 반영 사항을 수정하여 commit 후 merge 한다. 이 과정은 &lt;code class=&quot;language-text&quot;&gt;협업에서 가장 중요한 부분&lt;/code&gt;이라고 생각된다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d39d89a765f3fefdebaac1e1b20b596c/2d324/git-flow-release.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQoz32SzW7bMBCE8/7P0rxAL70UzaGHAoabAI1dJJYq68dW9E8tSenrkrHToIcQGOxgdzWc5erGOQ+shLMsyxu896zra/6jE3pCb/jGWsvNsi5kh5I0ySiKgjzPKcuS7XZLkiSRh1xVVex2O/b73zFXFTk/NlvqusY5h4hcBT1NOXJKemYxjOOEMTPDMDIqhn6gv6BpWtq2jfy56HhMz8hsomBAFPReifH0pQtDR6yX+A9rxHqJlfbfV54X+1oPzxbGjoJB2S+OrrBkPy3nxNJVlvzBctwqLxz1UXh8UPfKT5nwa6MTlJb9Rphe3MXhO0GnLle94dQIeWfALEinDa0+troph5mvp4ZKY9JPdJ1lnTzSa8+shv53GF0qRi8kbiLzJuLZTxydoVA8uZHv0nJve/5oLeSHxWLVjImm3gmGlcdfQKPRZDHN5NaQ6pJsqIfLxJENQmMsjW70JDq29oa6BENXwUDSNOX29lP8TdoD5HfCQd19Hs58mxpqK6S148tOuHtS0VEXuPi3Ua8Ign8BbZK2bz/IY30AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;git flow release&apos; title=&apos;git flow release&apos; src=&apos;/static/d39d89a765f3fefdebaac1e1b20b596c/ca1dc/git-flow-release.png&apos; srcset=&apos;/static/d39d89a765f3fefdebaac1e1b20b596c/e7570/git-flow-release.png 170w,
/static/d39d89a765f3fefdebaac1e1b20b596c/f46e7/git-flow-release.png 340w,
/static/d39d89a765f3fefdebaac1e1b20b596c/ca1dc/git-flow-release.png 680w,
/static/d39d89a765f3fefdebaac1e1b20b596c/02d09/git-flow-release.png 1020w,
/static/d39d89a765f3fefdebaac1e1b20b596c/2d324/git-flow-release.png 1306w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;release&lt;/code&gt; 브랜치는 배포를 하기 전에 충분한 검증을 위해 생성하는 브랜치이다. 배포 가능한 상태가 되면 &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 브랜치로 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 작업을 거친다. 또한 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;에도 반영사항을 모두 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 시켜야 한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/b976091578d645e47743411f76cedbe7/919e0/git-flow-hotfix.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQoz1WS227bMBBE/f/f5MciQAOkTdI2BQw78E232IEky6LIXUqnS8eIm4d9IDk7OzvDmaoSx8hoFeOt3DCgersfxwlNbwl/xYzxa0/imo1TZLssWK92FEVOlmWUZcXz4z3b9YK8PJLlbxT7BX9/3bFYLKkMl2d77u5/UNc1IkII4YMwTkrfCm0ZiJMgQS4PqgE5v6KuQLoV4bwjWKNa9V5YVJ63k2eKesF/Kox2EZzSFvKxnib5CTARpSf6I7FfMfnaVsbWVPa1sDwKx06ZxviV8MNDU/kubB4Dh22gq5T8ScifI10Jb5nn8anBlZFy61k+e1wlrA3jGlMoet3qSpgqTWokUIUBm/BpelJUBc9317L1jlffE1SYTG5a9/+QbgrtwDThDJjpwGZ0bI34NThK8RyNMBPHi3SstWcvAzsb3lmbN2sGvfpu/s4SWUqobVtLK+DOyuHgKaxpZWrOBk5KG/N58e7JLcCTH6wODKcXZKjQkYvvF4Up8vRV5vM5RV7S7Ebe/wRT6vjW1/y0VWtTmDfCw87z28LrzidwG7R5QPudhWV/1AYnrn9j/rS7u2jXTQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;git flow hotfix&apos; title=&apos;git flow hotfix&apos; src=&apos;/static/b976091578d645e47743411f76cedbe7/ca1dc/git-flow-hotfix.png&apos; srcset=&apos;/static/b976091578d645e47743411f76cedbe7/e7570/git-flow-hotfix.png 170w,
/static/b976091578d645e47743411f76cedbe7/f46e7/git-flow-hotfix.png 340w,
/static/b976091578d645e47743411f76cedbe7/ca1dc/git-flow-hotfix.png 680w,
/static/b976091578d645e47743411f76cedbe7/02d09/git-flow-hotfix.png 1020w,
/static/b976091578d645e47743411f76cedbe7/919e0/git-flow-hotfix.png 1308w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;hotifx&lt;/code&gt; 브랜치는 배포 중 버그가 생겨 긴급하게 수정해야 하는 브랜치이다. 배포 이후에 이루어지는 브랜치이고, 반영 사항을 &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;에 모두 적용 시켜야 한다.&lt;/p&gt;
&lt;p&gt;앞서 말했듯이 &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;는 항시 운영되는 브랜치이다. 이 둘을 제외한 나머지 브랜치 들은 제 역할이 마무리 되어 &lt;code class=&quot;language-text&quot;&gt;merge&lt;/code&gt; 작업이 완료되면 브랜치를 삭제하여 정리한다.&lt;/p&gt;
&lt;h3&gt;간단히 적용해보기&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Upstream Remote Repository&lt;/code&gt;를 기반으로 원격 개인 저장소에 &lt;code class=&quot;language-text&quot;&gt;Fork&lt;/code&gt; 해야 한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 444px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c8b7617c7dae9763e031856313f8a9f1/39d25/fork.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZUlEQVQoz41Su07EMBDMh9HBV0CF+AY6JDpEi6iAjg4BNQU1xRU0dIjHvfK6PO+SOE5iO8Ou7wJ0YGlk7Xp3dmYTp+0UBnRKI18V8PwQQRhhVVSQskEtJUQtsYhTRATOCVFDNq3NhYsIFb3XdQ2HSX4TlpVAnGS2sLRNjW1kpPkSSZrbHA9p2g5LEpCkGQ2kHJE6A9GAIdam/84xGTdrYyy4Zsjxu9LGxm2n4bjBArOpi8lsDiFbUlhbW7O5C59sN9QcZzk8qhtPpgijxJJE5GLu+kjojYliUun6AVm2dnmSgrKKSKFVuVFK05Uym1tvan4w5JRexw7+cUxv0BlFd/9nreN6Ptnz7D4qIayt9/EEopB4TcbYudvH9v0+9h4OsXWzi4PHI0Rk/+3jE0VZrQea9SD+M5x8uQKDbTb8JWknSZahlR2CIsbp6BInowucPV/j+OkcVy+30FRblKVdC59+o5zjL5LYYBNviXhlAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;fork&apos; title=&apos;fork&apos; src=&apos;/static/c8b7617c7dae9763e031856313f8a9f1/39d25/fork.png&apos; srcset=&apos;/static/c8b7617c7dae9763e031856313f8a9f1/e7570/fork.png 170w,
/static/c8b7617c7dae9763e031856313f8a9f1/f46e7/fork.png 340w,
/static/c8b7617c7dae9763e031856313f8a9f1/39d25/fork.png 444w&apos; sizes=&apos;(max-width: 444px) 100vw, 444px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Organization에 생성한 repository에 Fork를 누르면 손쉽게 할 수 있다. Fork로 생성된 repository를 기반으로 &lt;code class=&quot;language-text&quot;&gt;Local Repository&lt;/code&gt;를 생성해야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;개인 github 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;git clone을 사용하여 원격 저장소에 있는 repository를 손쉽게 clone할 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; remote -v

origin  https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;github 사용자 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fetch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
origin  https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;github 사용자 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;clone 받은 local repository를 git remote -v로 확인해보면 원격 저장소가 등록되어 있는 것을 확인 할 수 있다. 매번 최신 코드를 &lt;code class=&quot;language-text&quot;&gt;fetch&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;rebase&lt;/code&gt; 하기 위해서는 &lt;code class=&quot;language-text&quot;&gt;Upstream&lt;/code&gt;을 등록해야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; remote &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; upstream https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;organization 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git

$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; remote -v

origin  https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;github 사용자 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fetch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
origin  https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;github 사용자 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;push&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
upstream        https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;organization 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git
upstream        https://github.com/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;organization 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;repository 이름&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.git&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git remote add upstream&lt;/code&gt;을 통하여 upstream을 등록한다. 정상적으로 등록 된 것을 확인할 수 있다. 이제 작업할 때 마다 브랜치를 생성하고 최신 코드를 pull 받아야 한다.&lt;/p&gt;
&lt;p&gt;우리 팀원은 각각 개발해야 하는 기능을 github issue에 등록한 후 등록 번호를 기반으로 브랜치를 생성하기로 하였다.&lt;/p&gt;
&lt;p&gt;우선 간단한 예시를 위하여 이슈를 등록한다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/3cd5ff0b5baab0356e4b04bb99b928e7/2928f/issue.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 85.88235294117648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACPElEQVQ4y41UyZLaMBDl/78pOeQwh1xSKTKBGUIA4wVveJElb7J56ZZtMDNDalz1qmW79fR608L1PKxfXrHbH4y1rCOef6/MumkaDM/lDpfLYyyqqkIQRggJrusZG0YR/CBAmqZIkgSxaBGKDqdMk9XQ3WPixY9fa6w2W7S6g1QV6qY1qBh1g9KgvUPdaNTtDQ1b8tfEsVivlthuX42TVCUa+mjQzqFHDIdNBNPBkzWEY5JQFBIcvipL5KIw8vueMIZSjv/quia/2ryzFbRPkD+/dx0R9n2PjhCfY3gnD64foShpEylWVfMpcBryQhF5MShkFVGSwfN8eI4H++jApnVelMZ52mTWs1yq8R8fnuUFFTEbCSm0mAj9U2AIQz+EkCUkKb0RfowrIYWdZflN4TnN4ZAqy7JxzgRVr7sL6X8hT4RpRgqn/gnjBJvNXyyXzzgcXWqZ9lNk7wjnITMp55LVsdNUmLd9OMcDhYBHedtRuLuDDct2sbccsz4FETyGP9kQQZTAPQ2WSa9FMQpnIXNl2dGl4ri0MTqnZoMsKxQ0RVwkLhav2QoahCmCNyH3M+fBClkZZNRf3D6MTCjy47wNodZNB91c0LWAkkRMB18JE6psTIqmXLJlcPXTXCAhm1BblDQdPL8t5fkkYqyjHf4kFn66L4iKZCDUWhu5PEIG1PE8ioz+7jYBTdUFmgTwTfZy3uPL8QnfnO/4aj/BKfybQibhuZRSGVKp1DCnBsNBmawRFx1BG2QK755/M8Ad8v8uEJwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;issue&apos; title=&apos;issue&apos; src=&apos;/static/3cd5ff0b5baab0356e4b04bb99b928e7/ca1dc/issue.png&apos; srcset=&apos;/static/3cd5ff0b5baab0356e4b04bb99b928e7/e7570/issue.png 170w,
/static/3cd5ff0b5baab0356e4b04bb99b928e7/f46e7/issue.png 340w,
/static/3cd5ff0b5baab0356e4b04bb99b928e7/ca1dc/issue.png 680w,
/static/3cd5ff0b5baab0356e4b04bb99b928e7/2928f/issue.png 691w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;3번 번호가 부여된 이슈라고 가정한다. 해당 번호를 기반으로 &lt;code class=&quot;language-text&quot;&gt;local repository&lt;/code&gt;에서 feature 브랜치를 생성한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; branch feature/3-init-setting
$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; checkout feature/3-init-setting&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 Upstream에 있는 remote repository에서 최신 소스코드를 받아 와야 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; fetch upstream
$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; rebase upstream/develop&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;git pull을 사용하여 등록한 upstream develop에서 commit 기록을 병합한다. 이제 신나게 작업을 진행하고 자신의 원격 저장소인 &lt;code class=&quot;language-text&quot;&gt;Origin remote repository&lt;/code&gt;에 push한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; push origin feature/3-init-setting&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그렇게 github repository를 살펴보면 &lt;code class=&quot;language-text&quot;&gt;변경을 감지&lt;/code&gt;하고 pull request를 생성할 것인지에 대한 탭을 확인할 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e9849d6835bbf7a8a51926d007cdbf71/2728a/upstream-repository.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 76.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACU0lEQVQ4y42SS2/UMBSF839ZsaBdVKz4I+wQu1JALBC0dIkE005fM0M7VGIyeTuJ7bwfh3udmVCNVMDSJ9u5vueea8fqGx+1niKX18jSC+KS1pfQyQXNVyjUBlrzvsln6OsFEsqJ5ARCndHMfENd2bDa4ga/Fi+xnL9GaL8xCPcIweoQwjlC6r9D4g3E3ls08iO0+oDnp/vYO9nH/skeDk4P8Oz4Ka7cz7C62kWdTdEU10AzA7rFH9r5AH/fUs/QldcQ8jsxMTjxV9wHX6DyJay66eEHCVZrD0XVQukcQqTQWQmlNOJEYju6Dli7AfwwpvZa2JyjahzefsKT4xd4NXsPK8s1nGCNIIoRihgiThGnEgkhUkVopFIhJfG8rCB1NsRpL5KUYprc2ThbzeHIEFaU+JgvL6lqAtvx4HgBXD8k1xEViuEJRTFhUFlBggVCKhqR81AkBiEkZJqjItdWVlMbaQ8Rhej6fmyvaVuk7IRceEGILMvRU7zrevAxXveb80pr011Z1bBU1eM+KhH4HrI8Hw/XdYMwEoZgM7dUZBDtRnjPV8LxqiZBTkylxNpxTaVRsGnoPhMEYWTgu23o29ZlN7rtIbeC7JATuYLr+Sax3iRxIRbcuuT9rjsDC6qhZeOQ29D0ckVZmnszNC211w1OumFuaX4MjnMe51jchucHdPmJSX44+vGRejw+hhi7Y1GLNyG1Op8vqG0Pd8uf+HF7R671juhfJDdn2KkRtNcOJmdTrFY2bmYLTM6n9B8Gm0Pd+Iv8CyPY7rT5cLS7D/Af/Ab3t3oeprLDWAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;upstream repository&apos; title=&apos;upstream repository&apos; src=&apos;/static/e9849d6835bbf7a8a51926d007cdbf71/2728a/upstream-repository.png&apos; srcset=&apos;/static/e9849d6835bbf7a8a51926d007cdbf71/e7570/upstream-repository.png 170w,
/static/e9849d6835bbf7a8a51926d007cdbf71/f46e7/upstream-repository.png 340w,
/static/e9849d6835bbf7a8a51926d007cdbf71/2728a/upstream-repository.png 655w&apos; sizes=&apos;(max-width: 655px) 100vw, 655px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이제 fork한 개인 원격 저장소를 살펴보면 새롭게 작성한 브랜치를 감지하고 pull request 작성을 위한 버튼이 생성된다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 635px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ffb02f56c9c578a40db4a74046d8cf1e/ee2c8/pull-request.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 102.94117647058825%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC8klEQVQ4y41VyW7UQBCdD+cjQEJCcOCAQAIkBAIhceCAuCUQksCQSSazrx7v7vZuzzxetTNkIshi6al686tyvepyq9cfoHPaRX8wxFn3HO3fHWPjJEFRlsjzAkVRXqBATpRclz1ZK6uq2SsrpMUaLa1jBGGESGmEkYLvB2YsUNzTcWys0tqMdZzQWQp5T6lmTSmFUKdYqQqtlBHESWag49TYSMWIdAM/iMx6XlRmLxQSEuaMqChrVNUGdb1FzQh52PFDjKcLjKZzY7u9IXqDMbr9IYbjGRaWg6XtYjSZ43wwwnAyg2V7UHRgBR6WgYsF4dJ5awOgqNbGc0TySCfwQwWXTmzXh7pYk7njBfD4kliZxykJQ89gGboImLLWu4+fsH/0C06QYTxzMFlFGFt8UVeIMsBPagQJHWabBumlDbgXpYDiuTCRsxSlf34Cy1rC8mJM5i7mjsLEEBZ8qW4gpHFFgn/hx6XZ84iQ8xYunjRNkWSZGYt622ez2ZhyEZUTipHwXMZzZszSkgoJiZhqVyyh1ma9Rk2Y3FGU+XKF6XxpEi/5SvOSjgpjr0MmFZDmJA+bCCUKSfS438MB83n4s43jdocKT42jLel1kH0tiq/sS0KJZmWvcHreR+esh8FoapQUlW+KcpfQtp2GcE1ClxGOzo6w9/0Qe99+kHDC4q1v/eRdwtUuodTekiFLpNtDu590lwj/EsonW7wJE4ohuZQk34XsxghdP2KEDqtdXzl4m8LXRijXbMaS8UP93wjvorK9S7hyPDaGpjksLPsOJDeUzZqFvS3QrRVIizK2uLRb5eMsvwLFm+MFwVWVTReRenQD2B67DeeOWM6lxcnccnz2xRyo+WUlUcGMazaJVOdN++IyPeTwwqYzm/vJVtRAmy6dsFVp+S1kJcbBAg8OnuHJ8Ws8OnqJx8evcO/rfbw9/UzCTUMY0enYYpS2ZdSSfCwWS/NLqOv1hdvGvZ14eNp+gxedD3h+8t7g4eFzfJnu4w/OaUSPxFrqmwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;pull request&apos; title=&apos;pull request&apos; src=&apos;/static/ffb02f56c9c578a40db4a74046d8cf1e/ee2c8/pull-request.png&apos; srcset=&apos;/static/ffb02f56c9c578a40db4a74046d8cf1e/e7570/pull-request.png 170w,
/static/ffb02f56c9c578a40db4a74046d8cf1e/f46e7/pull-request.png 340w,
/static/ffb02f56c9c578a40db4a74046d8cf1e/ee2c8/pull-request.png 635w&apos; sizes=&apos;(max-width: 635px) 100vw, 635px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;feature/3-init-setting&lt;/code&gt; 브랜치를 develop에 merge하기 위한 pull request를 진행하는 예시이다. 작성한 코드를 리뷰해줄 팀원들을 선택하고, commit한 코드의 내용을 간단히 요약하여 작성한다. 이제 생성한 PR을 기반으로 &lt;code class=&quot;language-text&quot;&gt;코드리뷰&lt;/code&gt;를 진행한다. 변경 사항이 적용되면 develop에 반영하기 위해 merge한다.&lt;/p&gt;
&lt;h3&gt;달록에 맞게 수정하기&lt;/h3&gt;
&lt;p&gt;git-flow는 빠르게 급변하는 웹 서비스에는 맞지 않은 git 브랜치 전략이다. 관리해야 할 브랜치가 늘어나기 때문에 개발자들이 신경써야 할 포인트가 늘어난다.&lt;/p&gt;
&lt;p&gt;빈번한 배포로 인해 급작스러운 이슈가 발생할 수 있다. 즉 예상치 못한 롤백이 자주일어날 수 있다. 또한 웹 서비스의 특성상 다양한 릴리즈 버전을 유지할 필요가 없다. 이러한 특성들로 인해 웹 서비스에는 다소 보수적인 git-flow 전략은 맞지 않을 수 있다.&lt;/p&gt;
&lt;p&gt;그럼에도 우리 달록팀은 git-flow를 선택했다. 우리는 실제 운영할 수 있는 서비스를 개발하며 다양한 경험을 습득해야 한다. 또한 대부분의 팀원들이 git에 익숙하지 않았으며 다양한 시도를 통해 빠르게 학습해야 한다.&lt;/p&gt;
&lt;p&gt;대신 git-flow를 정석적으로 사용하지 않고 필요한 부분을 수정하여 반영하려 한다. 현재 수준에서 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;에서 대부분의 빌드를 진행하기 때문에 &lt;code class=&quot;language-text&quot;&gt;release&lt;/code&gt; 브랜치의 필요성이 다소 옅어졌다. 결국 &lt;code class=&quot;language-text&quot;&gt;release&lt;/code&gt;를 제외한 &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;feature&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;hotfix&lt;/code&gt;만 사용하기로 결정하였다.&lt;/p&gt;
&lt;h3&gt;달록이 집중한 것&lt;/h3&gt;
&lt;p&gt;달록의 팀 각 구성원들은 맡은 이슈를 기반으로 브랜치를 생성한 뒤 작업을 진행할 것이다. 결국 다수의 브랜치가 아래와 같이 병렬적으로 커밋이 쌓이게 된다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/54509e71415c86f1358129aaad6fee13/7bf1f/force-push.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACN0lEQVQ4y52T+U8TQRiG998lYoByiCAiiBKNEREohzXGxgSNR4iQgMoRjBgRJQoItA1Huj32KN22W6Tt7vZxZ7FNNegPvMmXmflm95l3vpmRdkJhFFVlO3qIYaQJRWMkNY1IPEpS1YgqKgfxBLKaZD8eQ9FS7OwdIuSUy5T/Cqmzq4doTObgOMuubLChKli2hXxssB3PsB5LkrdOMAp5wpkcM+/XuTUw7AEp18RvSS9npvmmRrxcMPiUpdUV1HKOFCbzC8s8m5pCd/uKZRA+2KfB186d+0OkSjmOLNNr07aJnNdwHAdJUEuuI6Fh/zifVteYnp1j7es6C4tLvJp6zXYoxOTzF0Qie/T29RPeCpM7+umFmS6QVnMM+sfQUykkQXVsxwOOTgT4vrFJ8MkkH1Y+sri07AE3t34wNDLOzm6YG/233S/TlE50nILihsbAoJ+WS53ougusFFNIJDzweIC5t/MUi0VM02T18xfu3hsi5/bn3ryDvA6FDPZxGv/YGHX1jVzpvn7qsAKrtEJROYam6dVxJptFdnMVJRMJsnqChw8mqG9s5UKDj+a2DlT3dki2u2URYuu2bWNZdvVHy7L+GJes01rHFY3RwGN8bZ3UNzR7DgOPgt7CEmdIwGsdi35tTnOddHRdw9d6maaWdq9E1WtTPuNy/i+ExEO42tNH3cUm112Tt1jFyJkO/6VaYHfvTUZGJ9wDW6NYKlXnzwVMJJIesDZfmTsXUByeYWS8LdbWVrS/AEIftPnuRFHFAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;force push&apos; title=&apos;force push&apos; src=&apos;/static/54509e71415c86f1358129aaad6fee13/ca1dc/force-push.png&apos; srcset=&apos;/static/54509e71415c86f1358129aaad6fee13/e7570/force-push.png 170w,
/static/54509e71415c86f1358129aaad6fee13/f46e7/force-push.png 340w,
/static/54509e71415c86f1358129aaad6fee13/ca1dc/force-push.png 680w,
/static/54509e71415c86f1358129aaad6fee13/7bf1f/force-push.png 938w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;만약 팀원 중 한명이 작업을 끝내서 PR이 merge된 상황이라고 가정하자. develop 브랜치의 커밋 베이스는 변경됬으며 이전에 작업을 진행하던 브랜치들은 시작점이 뒤로 밀려나게 된다.&lt;/p&gt;
&lt;p&gt;여러 사람이 하나의 저장소를 기반으로 작업을 진행하기 때문에 함께 사용하는 공간의 코드들은 충돌을 야기할 가능성이 크다. 즉 지속적인 &lt;code class=&quot;language-text&quot;&gt;fetch&lt;/code&gt; + &lt;code class=&quot;language-text&quot;&gt;rebase&lt;/code&gt;를 통해 사전에 충돌에 대비하며 항상 &lt;code class=&quot;language-text&quot;&gt;develop&lt;/code&gt; 브랜치와 커밋 싱크를 맞춘다.&lt;/p&gt;
&lt;p&gt;정리하면 위 그림과 같이 항시 develop 브랜치의 끝 단에서 시작해야 한다. 이러한 방식은 코드의 충돌을 최소화할 수 있으며 순차적인 git 커밋 목록을 기반으로 쉽게 기능이 추가된 것을 확인할 수 있다.&lt;/p&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;p&gt;지금까지 간단히 &lt;code class=&quot;language-text&quot;&gt;git-flow의 흐름&lt;/code&gt;과 이것을 기반으로 &lt;code class=&quot;language-text&quot;&gt;달록에 적용한 과정&lt;/code&gt;들을 알아보았다. git-flow는 언급한 것 처럼 부가적인 브랜치로 인해 &lt;code class=&quot;language-text&quot;&gt;관리에 대한 부담감&lt;/code&gt;을 느낄 수 있다. 하지만 &lt;code class=&quot;language-text&quot;&gt;upstream&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;origin&lt;/code&gt;을 분리한 환경은 좀 더 도전적인 과제들을 적용하기에 매우 좋은 환경을 구성해준다. 또한 &lt;code class=&quot;language-text&quot;&gt;pull request&lt;/code&gt;를 통한 코드 리뷰를 통해 보다 더 양질의 애플리케이션 개발에 힘쓸 수 있다.&lt;/p&gt;
&lt;h2&gt;References.&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://vallista.kr/git-flow;-%ED%99%98%EC%83%81%EA%B3%BC-%ED%98%84%EC%8B%A4-%EA%B7%B8-%EC%82%AC%EC%9D%B4%EC%97%90-%EC%84%9C%EB%B9%84%EC%8A%A4/&quot;&gt;git flow; 환상과 현실 그 사이에 서비스&lt;/a&gt;&lt;br&gt;
&lt;a href=&quot;https://woowabros.github.io/experience/2017/10/30/baemin-mobile-git-branch-strategy.html&quot;&gt;우린 Git-flow를 사용하고 있어요&lt;/a&gt;&lt;br&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[IntelliJ에서 메소드 추출한 메소드의 파라미터에 final 키워드 자동 추가하기]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 후디가 작성했습니다. 배경 우테코 레벨…]]></description><link>https://dallog.github.io/intellij-final-keyword/</link><guid isPermaLink="false">https://dallog.github.io/intellij-final-keyword/</guid><pubDate>Tue, 12 Jul 2022 22:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/devHudi&quot;&gt;후디&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;배경&lt;/h2&gt;
&lt;p&gt;우테코 레벨3 달록 팀에서 메소드의 파라미터에는 반드시 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드를 붙이도록 컨벤션을 정했습니다. 이유는 무엇일까요? 일반적으로 가변적인 변수는 프로그램의 흐름을 예측하기 어렵게 만듭니다. 따라서 변수를 가변적으로 만드는 것이 중요한데, 자바에서는 변수의 재할당을 막기 위해 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드를 사용합니다. 물론 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드 하나만으로 완전한 불변을 보장하도록 만들수는 없지만, 어느정도 예측 가능한 코드를 만드는데에는 도움이 됩니다.&lt;/p&gt;
&lt;p&gt;이는 메소드의 파라미터에도 적용됩니다. 아래의 코드는 &lt;code class=&quot;language-text&quot;&gt;Memo&lt;/code&gt; 객체를 생성하기 위한 생성자입니다. &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt; 라는 String 값을 전달받아 객체 필드에 할당합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Memo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;validateLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 예상치 못한 코드&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만 위처럼 예상치 못한 코드가 추가되면 어떻게 될까요? &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt; 필드에는 개발자가 의도하지 못한 값이 할당될 것 입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Memo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;validateLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// error: final parameter value may not be assigned&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이를 보완하기 위해서 위처럼 메소드 파라미터에 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드를 붙이면, 재할당 시 컴파일 에러가 발생하여 예상치 못한 동작을 사전에 방지할 수 있을 것 입니다.&lt;/p&gt;
&lt;h2&gt;IntelliJ 설정하기&lt;/h2&gt;
&lt;p&gt;하지만, 저희는 아직 메소드 파라미터에 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드를 붙이는 습관이 들어있지 않았습니다. 따라서 IDE의 도움이 필요한데요, 다행히도 IntelliJ에서 메소드 추출 리팩토링을 할 때 생성되는 메소드 파라미터에 자동으로 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드를 붙여주는 옵션을 발견하였습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/01f66d512c9053274ff2f8a3d6731de4/9a26f/intellij.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 75.88235294117648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADIElEQVQ4y6WTXW8TRxSGt1LtNFSNqoom5YZ+OCSIijSxSWLvx8zO7Mx+e4mxkzRYQgSVO0CgpjetlFQCq+KWv9Ff0GsixC+hueACtQVLZDyHM2srRUVc1dKrc7y788x7zpyxuDVTiQTbWw/ow6ZDBjahKH/QdEmpdccdiDgZyCQbtDxSvnv7m4btDOq289tKy94/u7DwmfXRh5XPuQz/kVkGYZpBEMVAAwkiSiBMxs98IcHzObgoBIGDMpEyAWmUQR6iMK6vXLpk4W9OxumzrNgAJqLXlAvlMqGYjFGRQrBiIlTmuY8RoYqwQNmUqSzK1C8b144PejdHB92br9otumaAp1c9+ieREdRtd4T29RphmkeppoHQhAcYpUaI9iYyOQsjncaZ7pNMd3kBfScZXvhqvm4VLj+729l8fn1zG65v9Eb9/DL08g5QkaBCiNK8LNmUiI6xHaLMEQxpcRkIF9q0oEX5sHb+24b1iO4s7m/d+/vH/h78tHV3dOvKLbjT3gWOC3wZlj0N4qSE8XCcY+ngmv5hm3x0bzawDXDxQsPa++S7L73o5xd2bwD1bH+0lN+HiO2C9H1cnAI3IIRiiQgdb2CiQ1npFKVN3iIT4MfTp2Zjhx5tRilckfEo9xhwwqDJOBCEeFhi8B7gRHoMnwCrU1Ozqy45ElkbPCFHeEB42iHstLuw29mBbrtTOuQIlDhCAl0b4MTdiUOMw9rCYsOaqk7NtgwQ586jHIEErsoCHmz+AL92b8DtZAt6NIY+TaHL09IxHsSJ/nVIh7VzCwhEhzjxR3gTTINHa4TqjiN0FGaa57nGQ9BhlusUx6jrSt0yjlB+mOowbWtsASoxpz78Zv5cw6pUKsbhM9Mb3Ol4nfqqcIW6SjL1PcvUDkvVtp/i/0RtuFI18T2WpxwcfgSh4uMAZ9Kj/ksE1o3DOQT9ZUbCXC3X2MeIC94Vl+AaYc7iNva0KK8oSwpwsE1f12qrVrVa/XS5sfr70kr9Keox6nCsxn9UP9HF5fph03YOm457uNZsPl6y5ZPzbvHHmTNfzJur9wFqGjXzP3XKsN4A7nHD0EjMeYgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;IntelliJ 설정 화면&apos; title=&apos;IntelliJ 설정 화면&apos; src=&apos;/static/01f66d512c9053274ff2f8a3d6731de4/ca1dc/intellij.png&apos; srcset=&apos;/static/01f66d512c9053274ff2f8a3d6731de4/e7570/intellij.png 170w,
/static/01f66d512c9053274ff2f8a3d6731de4/f46e7/intellij.png 340w,
/static/01f66d512c9053274ff2f8a3d6731de4/ca1dc/intellij.png 680w,
/static/01f66d512c9053274ff2f8a3d6731de4/02d09/intellij.png 1020w,
/static/01f66d512c9053274ff2f8a3d6731de4/9d567/intellij.png 1360w,
/static/01f66d512c9053274ff2f8a3d6731de4/9a26f/intellij.png 2176w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;IntelliJ 설정 화면&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;맥 기준으로 Preferences → Editor → Code Style → Java 페이지에서 Code Generation 탭을 클릭합니다. 해당 탭의 하단에 ‘Final Modifier’ 에서 ‘Make generated parameters final’ 을 체크해줍니다. 위와 같이 옵션을 변경하면 메소드 추출 시 파라미터에 자동으로 &lt;code class=&quot;language-text&quot;&gt;final&lt;/code&gt; 키워드가 생성되는 모습을 확인할 수 있습니다 😊&lt;/p&gt;</content:encoded></item><item><title><![CDATA[JPA 등장배경]]></title><description><![CDATA[이 글은 우테코 달록팀 크루 리버가 작성했습니다. JPA 등장배경 1990년대 인터넷이 보급되면서 온라인 비지니스가 활성화 되었다.
자연스럽게, 온라인 비지니스에서 DB에 데이터를 저장하고 가져올때 사용할 Connection Connector…]]></description><link>https://dallog.github.io/appearance-background-of-jpa/</link><guid isPermaLink="false">https://dallog.github.io/appearance-background-of-jpa/</guid><pubDate>Thu, 07 Jul 2022 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;이 글은 우테코 달록팀 크루 &lt;a href=&quot;https://github.com/gudonghee2000&quot;&gt;리버&lt;/a&gt;가 작성했습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;JPA 등장배경&lt;/h2&gt;
&lt;p&gt;1990년대 인터넷이 보급되면서 온라인 비지니스가 활성화 되었다.
자연스럽게, 온라인 비지니스에서 DB에 데이터를 저장하고 가져올때 사용할 Connection Connector에 대한 니즈가 높아졌다.
그래서 각 언어들에서 DB Connection을 지원하는 API 기술들이 등장하였다. 이후에 Spring에서는 DB Connection을 좀 더 쉽게 관리하는 Spring JDBC API를 만들고 지원하였다. (이외에도 Query문을 XML파일을 통해 관리하게끔 도와주는 Mybatis도 등장하였음)
하지만, 여전히 쿼리문을 개발자가 직접 작성해야하는 등 다양한 문제를 가지고 있었다.
그래서 JAVA 진영에서는 개발자가 쿼리문을 직접 작성하지 않아도 프레임워크 내부에서 지원해주는 ORM(Object Relational Model)기술인 JPA가 등장하였다.
그렇다면, JPA 이전에 개발자들이 직접 쿼리문을 작성하던 SQL 중심적인 개발의 단점은 무엇이 있을까?
아래에서 살펴보자.&lt;/p&gt;
&lt;h2&gt;SQL 중심적인 개발의 단점&lt;/h2&gt;
&lt;h4&gt;1. 쿼리문 무한 반복과 지루한 코딩&lt;/h4&gt;
&lt;p&gt;JDBC API는 쿼리문을 개발자들이 직접 작성 해야한다.
그래서 개발자들은 쿼리문을 작성하는 지루한 작업을 개발 과정에서 무한반복해야한다.&lt;/p&gt;
&lt;h4&gt;2. 객체의 필드가 추가되면 모든 쿼리문을 수정해야한다.&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://velog.velcdn.com/images/gudonghee2000/post/488a7899-d55b-4447-aafc-bada8d840192/image.jpg&quot;&gt;
위 그림과 같이 SQL 중심적인 개발에서는 객체의 필드가 변경되면 해당하는 모든 쿼리문을 찾아 개발자가 수정해야한다.&lt;/p&gt;
&lt;h4&gt;3. 객체와 관계형 DB의 패러다임의 불일치&lt;/h4&gt;
&lt;p&gt;객체라고 하면 떠오르는 키워드는 무엇이 있을까?
캡슐화, 협력, 의존, 상속, 참조 등의 기술이 있다. 그런데, DB에서는 이러한 기술들이 없다.
적용되는 기술들의 패러다임 불일치로 인해 개발자들은 SQL 지향적인 개발을 할 수 밖에 없다.
아래에서 자세히 살펴보자.&lt;/p&gt;
&lt;h2&gt;객체와 관계형 DB의 패러다임 차이&lt;/h2&gt;
&lt;p&gt;객체와 관계형 DB는 연관관계를 통해 작업을 수행한다는 공통점을 가진다.
하지만 연관관계를 맺는 패러다임의 차이를 가진다.&lt;/p&gt;
&lt;p&gt;객체는 상속, 참조를 통해 연관관계를 맺는다.
반면 관계형 DB는 PK, FK를 통해 연관관계를 맺는다.
이때, 연관관계를 맺는 방식의 차이로 발생하는 문제점을 코드와 함께 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Crew&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; nickName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; team_name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt; 객체가 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt; 객체를 필드로 가지고 참조한다고 하자.
객체지향적인 관점에서, &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt;의 관계를 위와 같이 표현하는것은 자연스럽다.&lt;/p&gt;
&lt;p&gt;하지만, DB에서는 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;가 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt;을 참조한다는 개념이 없다.
그래서 위 객체들을 가지고 DB의 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;테이블과 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt;테이블의 관계를 맺을때, 아래와 같이 &lt;code class=&quot;language-text&quot;&gt;PK&lt;/code&gt; 값인 id를 &lt;code class=&quot;language-text&quot;&gt;FK&lt;/code&gt;로 가지도록 구현 하여야한다.
&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/059cb21d6371d7d2f19ee0d066e55808/6a959/erd.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 63.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABJ0AAASdAHeZh94AAABY0lEQVQ4y41Ti26CQBDk/78MTWxStBEjRhCR8jxQUPA13bnWprU1HslkD46bnZ3btaqqRtd16PsevcSqqtC2LQ6HA/b7vQbX5/P5X5xOp1/vVryJURQ5sixDLtEZO9jEsU5C4qZpUJblQ8J7WN58Dsd5xcC2YQ9sDIcDeN4cSilJVKCua8SSYLfbfSt6BE1YqhJRFAnWXzGCH/hY+kuE67W2gGRUaqSQ3h2PR437bMTt+yPCPx4+y3i5XPQhquT6qUKTMugjb1p3goAXRuXc+1kh8ZTwVq5SlcaNgN4G4jX3CHYEExsR8mcll7dYLDB1p3ibTDARjEYvmoSEtISdYVTydrtF4PtC6MF1XcxmM4lTHTdxhKb9VEjVRoRUyey1HOAAsNXyPNOqk/RdLOjBhz5bphPAEey7HkmSIE1TIU5RCGmSJrrs6/VqTsh2oU8sKZJm94MAYRgiXK30IHAAdAVC/AG73ezOA324UwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;ERD&apos; title=&apos;ERD&apos; src=&apos;/static/059cb21d6371d7d2f19ee0d066e55808/ca1dc/erd.png&apos; srcset=&apos;/static/059cb21d6371d7d2f19ee0d066e55808/e7570/erd.png 170w,
/static/059cb21d6371d7d2f19ee0d066e55808/f46e7/erd.png 340w,
/static/059cb21d6371d7d2f19ee0d066e55808/ca1dc/erd.png 680w,
/static/059cb21d6371d7d2f19ee0d066e55808/6a959/erd.png 699w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;ERD&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;연관관계에 대해서 객체의 구조와 DB의 구조가 달라진다는 것이다.&lt;/p&gt;
&lt;p&gt;그렇다면 객체지향적인 연관관계를 가진 객체들을 DB에 저장 할 때,
DB의 연관관계로 변경하는 것이 왜 문제가 될까?&lt;/p&gt;
&lt;h2&gt;객체와 RDB의 연관관계 차이가 가져오는 문제&lt;/h2&gt;
&lt;p&gt;위에서 봤던 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt;의 객체 모델링을 다시한번 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Crew&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; nickName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; team&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; team_name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 모델링된 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt;을 DB에 저장한다고 한다면 다음의 과정이 필요하다.
DB에 접근하고자 하는 Dao 객체는 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;객체를 분해하고 각자 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt; 테이블과 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt; 테이블에 대한 쿼리를 작성해야한다. 단순히 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;의 객체정보를 저장하는데 3가지 과정을 거쳐야한다.&lt;/p&gt;
&lt;p&gt;이러한 복잡한 과정을 피하는 방법은 없을까?
아래 코드를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Crew&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; nickName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; team_id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Team&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Long&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; team_name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위와 같이 DB 테이블 구조에 맞추어 &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Team&lt;/code&gt; 객체를 설계하는 방법이있다.
이러한 객체 모델링은 Dao 객체를 통해 데이터를 DB에 저장 할 때, &lt;code class=&quot;language-text&quot;&gt;Crew&lt;/code&gt; 객체를 분해하는 과정을 삭제 할 수 있다.
객체가 DB 구조에 맞추어 설계되어 있기 때문이다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;하지만, 객체 모델링을 할 때 객체가 서로 참조하는 객체지향적인 개발이 아닌
DB 테이블구조에 맞추어 개발하는 SQL 중심적인 개발을 하게 된다는 문제를 가진다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;객체와 관계형 DB의 연관관계의 패러다임 차이는 객체를 객체답지 못하게 만든다는 것이다.
그렇다면, 패러다임의 차이를 해결하는 방법은 없을까?&lt;/p&gt;
&lt;h2&gt;JPA&lt;/h2&gt;
&lt;p&gt;객체와 관계형 DB의 패러다임의 차이로 인해 우리는 객체지향적인 프로그래밍을 하지못하고 DB에 종속적인 개발을 하게된다.
이러한 문제를 해결하기 위해 JAVA진영에서는 JPA를 제공한다.&lt;/p&gt;
&lt;p&gt;JPA를 통해 개발자는 더이상 쿼리문을 반복적으로 작성하거나 유지보수하는 것을 신경쓰지 않아도 된다.
왜냐하면 JPA가 쿼리문을 작성해주기 때문이다.
그리고 SQL 중심적인 개발에서 벗어나 객체지향적인 개발을 할 수 있게 된다.
왜냐하면 패러다임의 불일치를 JPA가 내부적으로 맵핑해주기 때문이다.&lt;/p&gt;
&lt;p&gt;다음 포스팅에서는 JPA의 작동 메커니즘을 자세히 살펴보자.&lt;/p&gt;</content:encoded></item></channel></rss>
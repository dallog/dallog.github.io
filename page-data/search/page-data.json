{"componentChunkName":"component---src-pages-search-jsx","path":"/search/","result":{"data":{"allMarkdownRemark":{"nodes":[{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. @SpringBootTest  ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ë’¤ ê°„í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ë¹ˆì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì€ ë‹¨ì ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ë¹„êµì  ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤. ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì˜ì¡´ì„±ì„ â€¦","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"date":"August 01, 2022","title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸","tags":["í†µí•© í…ŒìŠ¤íŠ¸","ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## @SpringBootTest\n\n`@SpringBootTest` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ë’¤ ê°„í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ë¹ˆì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì€ ë‹¨ì ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.\n\n- ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ë¹„êµì  ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.\n- ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì˜ì¡´ì„±ì„ ê³ ë ¤í•˜ì§€ ì•Šê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. ì¦‰ í…ŒìŠ¤íŠ¸ í•˜ê³ ì í•˜ëŠ” ê°ì²´ì˜ ì˜ì¡´ì„±ì„ ë¬´ì‹œí•œì±„ í…ŒìŠ¤íŠ¸í•˜ê²Œ ëœë‹¤.\n- ë„ë©”ì¸ í˜¹ì€ ì˜ì† ê³„ì¸µì˜ ê²½ìš° application ê³„ì¸µ, presentation ê³„ì¸µì— ëŒ€í•´ ì˜ì¡´í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í•„ìš” ì—†ëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì†Œëª¨ê°€ ëŠ˜ì–´ë‚œë‹¤.\n\nì´ëŸ¬í•œ `@SpringBootTest`ëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ì±„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” `í†µí•© í…ŒìŠ¤íŠ¸`ì— ì í•©í•œ ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\n\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤. \n\n```java\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n@Import(TestConfig.class)\nclass AcceptanceTest {\n\n    @LocalServerPort\n    private int port;\n\n    @Autowired\n    private DatabaseCleaner databaseCleaner;\n\n    @BeforeEach\n    void setUp() {\n        RestAssured.port = port;\n        databaseCleaner.execute();\n    }\n}\n```\n\n```java\n@DisplayName(\"êµ¬ë… ê´€ë ¨ ê¸°ëŠ¥\")\n@Import(TestConfig.class)\npublic class SubscriptionAcceptanceTest extends AcceptanceTest {\n\n    @DisplayName(\"ì¸ì¦ëœ íšŒì›ì´ ì¹´í…Œê³ ë¦¬ë¥¼ êµ¬ë…í•˜ë©´ 201ì„ ë°˜í™˜í•œë‹¤.\")\n    @Test\n    void ì¸ì¦ëœ_íšŒì›ì´_ì¹´í…Œê³ ë¦¬ë¥¼_êµ¬ë…í•˜ë©´_201ì„_ë°˜í™˜í•œë‹¤() {\n        // given\n        String accessToken = ìì²´_í† í°ì„_ìƒì„±í•˜ê³ _í† í°ì„_ë°˜í™˜í•œë‹¤(GOOGLE_PROVIDER, ì¸ì¦_ì½”ë“œ);\n        CategoryResponse ê³µí†µ_ì¼ì • = ìƒˆë¡œìš´_ì¹´í…Œê³ ë¦¬ë¥¼_ë“±ë¡í•œë‹¤(accessToken, ê³µí†µ_ì¼ì •_ìƒì„±_ìš”ì²­);\n\n        // when\n        ExtractableResponse<Response> response = RestAssured.given().log().all()\n                .auth().oauth2(accessToken)\n                .contentType(MediaType.APPLICATION_JSON_VALUE)\n                .body(ë¹¨ê°„ìƒ‰_êµ¬ë…_ìƒì„±_ìš”ì²­)\n                .when().post(\"/api/members/me/categories/{categoryId}/subscriptions\", ê³µí†µ_ì¼ì •.getId())\n                .then().log().all()\n                .statusCode(HttpStatus.CREATED.value())\n                .extract();\n\n        // then\n        ìƒíƒœì½”ë“œ_201ì´_ë°˜í™˜ëœë‹¤(response);\n    }\n    ...\n}\n```\n\nì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° ì‚¬ìš©ìì˜ ì‹œë‚˜ë¦¬ì˜¤ì— ë§ì¶° ìˆ˜í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— ì‹¤ì œ ìš´ì˜ í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒ ë³´ë‹¤ ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ì—¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì ì ˆíˆ ìˆ˜í–‰í•˜ëŠ”ì§€ ì§‘ì¤‘í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— `@SpringBootTest`ë¥¼ í™œìš©í•œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í•œë‹¤.\n\n## ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸\n\nì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ íŠ¹ì • ê³„ì¸µì€ ë‹¤ë¥¸ ê³„ì¸µì— ì˜ì¡´í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì…ë°›ì•„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ê³„ì¸µë³„ë¡œ í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì…ë°›ê¸° ìœ„í•´ì„œ Springì€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ê´€ë ¨ ì• ë…¸í…Œì´ì…˜ì„ ì œê³µí•œë‹¤.\n\nìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë€? ë ˆì´ì–´ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì… ë°›ì•„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.. ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ì ì ˆíˆ í™œìš©í•˜ë©´ ëª¨ë“  ë¹ˆë“¤ì„ ApplicationContextì— ë“±ë¡í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë³´ë‹¤ ë” í˜¸ìœ¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤.\n\n### @WebMvcTest\n\n`@WebMvcTest`ëŠ” ì›¹ ê³„ì¸µ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ë¹ˆë“¤ì´ ì£¼ì…ëœë‹¤. ì£¼ì… ë˜ëŠ” ë¹ˆì˜ í•­ëª©ì€ ì•„ë˜ì™€ ê°™ë‹¤.\n\n- `@Controller`\n- `@ControllerAdvice`\n- `@JsonComponent`\n- `Converter`\n- `Filter`\n- `WebMvcConfigurer`\n- `HandlerMethodArgumentResolver`\n- `MockMvc`\n- ë“±\n\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\n\n```java\n@AutoConfigureRestDocs\n@WebMvcTest(SubscriptionController.class)\nclass SubscriptionControllerTest {\n\n    private static final String AUTHORIZATION_HEADER_NAME = \"Authorization\";\n    private static final String AUTHORIZATION_HEADER_VALUE = \"Bearer aaaaa.bbbbb.ccccc\";\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @Autowired\n    private ObjectMapper objectMapper;\n\n    @MockBean\n    private AuthService authService;\n\n    @MockBean\n    private SubscriptionService subscriptionService;\n\n    @DisplayName(\"íšŒì›ê³¼ ì¹´í…Œê³ ë¦¬ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ë…í•œë‹¤.\")\n    @Test\n    void íšŒì›ê³¼_ì¹´í…Œê³ ë¦¬_ì •ë³´ë¥¼_ê¸°ë°˜ìœ¼ë¡œ_êµ¬ë…í•œë‹¤() throws Exception {\n        // given\n        CategoryResponse ê³µí†µ_ì¼ì •_ì‘ë‹µ = ê³µí†µ_ì¼ì •_ì‘ë‹µ(ê´€ë¦¬ì_ì‘ë‹µ);\n        SubscriptionResponse ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ = ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ(ê³µí†µ_ì¼ì •_ì‘ë‹µ);\n\n        given(authService.extractMemberId(any())).willReturn(ë§¤íŠ¸_ì‘ë‹µ.getId());\n        given(subscriptionService.save(any(), any(), any())).willReturn(ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ);\n\n        // when & then\n        mockMvc.perform(post(\"/api/members/me/categories/{categoryId}/subscriptions\", ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ.getId())\n                        .header(AUTHORIZATION_HEADER_NAME, AUTHORIZATION_HEADER_VALUE)\n                        .accept(MediaType.APPLICATION_JSON).contentType(MediaType.APPLICATION_JSON)\n                        .content(objectMapper.writeValueAsString(ë¹¨ê°„ìƒ‰_êµ¬ë…_ìƒì„±_ìš”ì²­)))\n                .andDo(print())\n                .andDo(document(\"subscription/save\",\n                        preprocessRequest(prettyPrint()),\n                        preprocessResponse(prettyPrint()),\n                        pathParameters(\n                                parameterWithName(\"categoryId\").description(\"ì¹´í…Œê³ ë¦¬ id\")\n                        ),\n                        requestHeaders(\n                                headerWithName(\"Authorization\").description(\"JWT í† í°\")\n                        ),\n                        requestFields(\n                                fieldWithPath(\"color\").type(JsonFieldType.STRING).description(\"êµ¬ë… ìƒ‰ ì •ë³´\")\n                        )))\n                .andExpect(status().isCreated());\n    }\n    ...\n]\n```\n\nì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° ì‹¤ì œ ë™ì‘í•˜ëŠ” ë¡œì§ì„ í™œìš©í•˜ëŠ” ê²ƒ ë³´ë‹¤ APIì˜ ë¬¸ì„œí™”ì— ì§‘ì¤‘í–ˆê¸° ë•Œë¬¸ì— ì›¹ ê³„ì¸µì— ëŒ€í•œ ì˜ì¡´ì„±ë§Œ ì¶”ê°€í•œ ë’¤ ì˜ì¡´í•˜ëŠ” ê°ì²´ëŠ” Mockingì„ í†µí•´ ì§„í–‰í•˜ì˜€ë‹¤.\n\n### @DataJpaTest\n\nSpring Data JPAë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ê°„ë‹¨íˆ `@DataJpaTest`ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. `@Entity` ê°ì²´, `JpaRepository` ë“± JPA ì‚¬ìš©ì— í•„ìš”í•œ ë¹ˆë“¤ì„ ë“±ë¡í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ `@DataJpaTest`ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@BootstrapWith(DataJpaTestContextBootstrapper.class)\n@ExtendWith(SpringExtension.class)\n@OverrideAutoConfiguration(enabled = false)\n@TypeExcludeFilters(DataJpaTypeExcludeFilter.class)\n@Transactional\n@AutoConfigureCache\n@AutoConfigureDataJpa\n@AutoConfigureTestDatabase\n@AutoConfigureTestEntityManager\n@ImportAutoConfiguration\npublic @interface DataJpaTest {\n\t...\n}\n```\n\nì£¼ì˜ ê¹Šê²Œ ë´ì•¼í•  ì• ë…¸í…Œì´ì…˜ë“¤ì´ ë§ë‹¤. ëª‡ ê°€ì§€ ì˜ˆì‹œë¡œ `@AutoConfigureTestDatabase`, `@Transactional`ì— ëŒ€í•´ ê°„ë‹¨íˆ ì‚´í´ë³´ì.\n\n#### @AutoConfigureTestDatabase\n\n```java\n...\n@AutoConfigureTestDatabase\n...\npublic @interface DataJpaTest {\n\t...\n}\n```\n\nì• í”Œë¦¬ì¼€ì´ì…˜ì— ì •ì˜ë˜ì–´ ìˆê±°ë‚˜ ìë™ìœ¼ë¡œ ì„¤ì •ëœ DataSoruceë¥¼ ëŒ€ì‹ í•˜ì—¬ í…ŒìŠ¤íŠ¸ìš© DBë¥¼ ì •ì˜í•  ë•Œ ì‚¬ìš©ëœë‹¤. ì•„ë˜ ì‹¤ì œ ì½”ë“œë¥¼ ì‚´í´ë³´ì.\n\n```java\n@Target({ ElementType.TYPE, ElementType.METHOD })\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@ImportAutoConfiguration\n@PropertyMapping(\"spring.test.database\")\npublic @interface AutoConfigureTestDatabase {\n\n\t@PropertyMapping(skip = SkipPropertyMapping.ON_DEFAULT_VALUE)\n\tReplace replace() default Replace.ANY;\n\n\tEmbeddedDatabaseConnection connection() default EmbeddedDatabaseConnection.NONE;\n\n\tenum Replace {\n\t\tANY,\n\t\tAUTO_CONFIGURED,\n\t\tNONE\n\t}\n}\n```\n\n- `replace()`:  ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ê¸°ì¡´ DataSource ë¹ˆì˜ ìœ í˜•ì„ ê²°ì •í•œë‹¤.\n    - `Replace.ANY`: ìë™ êµ¬ì„± ë˜ëŠ” ìˆ˜ë™ ì •ì˜ì˜ ì—¬ë¶€ì— ìƒê´€ ì—†ì´ DataSourceë¥¼ êµì²´í•œë‹¤. default ì„¤ì • ì´ê¸° ë•Œë¬¸ì— `@DataJpaTest`ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ `in-memory embedded database`ë¥¼ í™œìš©í•œë‹¤.\n    - `Replace.AUTO_CONFIGURED`: ìë™ ì„¤ì •ëœ ê²½ìš°ì—ë§Œ DataSourceë¥¼ êµì²´í•œë‹¤.\n    - `Replace.NONE`: ê¸°ë³¸ DataSourceë¥¼ êµì²´í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰ ìš°ë¦¬ê°€ ì§ì ‘ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê±°ë‚˜ ëª…ì‹œí•œ DataSourceë¥¼ ì‚¬ìš©í•œë‹¤. ë§Œì•½ `in-memory embedded database`ê°€ ì•„ë‹Œ ì™¸ë¶€ DBë‚˜ í…ŒìŠ¤íŠ¸ ìš© DBë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ `@AutoConfigureTestDatabase(replace = Replace.NONE)`ìœ¼ë¡œ ì„¤ì •ì„ ë®ì–´ì•¼ í•œë‹¤.\n\n#### @Transactional\n\n```java\n...\n@Transactional\n...\npublic @interface DataJpaTest {\n\t...\n}\n```\n\nì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ `@DataJpaTest`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `@Transactional` ì• ë…¸í…Œì´ì…˜ì„ ë“¤ê³  ìˆê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±ëœë‹¤.\n\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\n\n```java\n@DataJpaTest\n@Import(JpaConfig.class)\nclass ScheduleRepositoryTest {\n\n    @Autowired\n    private ScheduleRepository scheduleRepository;\n\n    @DisplayName(\"ì‹œì‘ì¼ì‹œì™€ ì¢…ë£Œì¼ì‹œë¥¼ ì „ë‹¬í•˜ë©´ ê·¸ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì¼ì •ì„ ì¡°íšŒí•œë‹¤.\")\n    @Test\n    void ì‹œì‘ì¼ì‹œì™€_ì¢…ë£Œì¼ì‹œë¥¼_ì „ë‹¬í•˜ë©´_ê·¸_ì‚¬ì´ì—_í•´ë‹¹í•˜ëŠ”_ì¼ì •ì„_ì¡°íšŒí•œë‹¤() {\n        // given\n        Schedule schedule1 = new Schedule(TITLE, LocalDateTime.of(2022, 7, 14, 14, 20),\n                LocalDateTime.of(2022, 7, 15, 16, 20), MEMO);\n\n        Schedule schedule2 = new Schedule(TITLE, LocalDateTime.of(2022, 8, 15, 14, 20),\n                LocalDateTime.of(2022, 8, 15, 16, 20), MEMO);\n\n        scheduleRepository.save(schedule1);\n        scheduleRepository.save(schedule2);\n\n        // when\n        List<Schedule> schedules = scheduleRepository.findByBetween(START_DAY_OF_MONTH, END_DAY_OF_MONTH);\n\n        // then\n        assertThat(schedules).hasSize(1);\n    }\n    ...\n}\n```\n\n## ì •ë¦¬\n\nì´ ë°–ì—ë„ `@JdbcTest`, `@DataMongoTest`, `@RestClientTest` ë“± ë‹¤ì–‘í•œ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• ë…¸í…Œì´ì…˜ì´ ì œê³µëœë‹¤. ì–´ë– í•œ ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•˜ê¸° ë³´ë‹¤ `í…ŒìŠ¤íŠ¸ì˜ ëª©ì `ì— ëŒ€í•´ ê³ ë¯¼í•´ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸í•˜ê³ ì í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•˜ì—¬ ì˜ì¡´í•˜ê±°ë‚˜ í•„ìš”í•œ ë¹ˆë“¤ì— ëŒ€í•´ ê³ ë¯¼í•œ ë’¤ ì ì ˆí•œ ì• ë…¸í…Œì´ì…˜ì„ ì ìš©í•˜ë©´ ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìœ¼ë©° ë³´ë‹¤ ë” ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ í”¼ë“œë°±ì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ íŒë‹¨í•œë‹¤.\n\n## References.\n[Spring Boot Test](https://meetup.toast.com/posts/124)<br>\n[8. Testing](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing)<br>\n[Spring Boot ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸](https://tecoble.techcourse.co.kr/post/2021-05-18-slice-test/)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸° ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ í†µì‹ ì— SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ì—¬ HTTPS í†µì‹ ì„ í•˜ë„ë¡ í•˜ì˜€ë‹¤.\nHTTPSì˜ í†µì‹ ê³¼ì •ì— ëŒ€í•œ ì´í•´ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤. HTTPS ëŠ” SSL(Secure Sokect Layer) ìœ„ì— ë¥¼ ì–¹ì–´ì„œ ë³´ì•ˆì´â€¦","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"date":"July 31, 2022","title":"SSLì„ í†µí•œ HTTPSí†µì‹  ê³¼ì •","tags":["HTTPS"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸°\nìš°ì•„í•œí…Œí¬ì½”ìŠ¤ ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ í†µì‹ ì— SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ì—¬ HTTPS í†µì‹ ì„ í•˜ë„ë¡ í•˜ì˜€ë‹¤.\nHTTPSì˜ í†µì‹ ê³¼ì •ì— ëŒ€í•œ ì´í•´ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤.\n\n\n## HTTPS\n`HTTPS`ëŠ” SSL(Secure Sokect Layer) ìœ„ì— `HTTP`ë¥¼ ì–¹ì–´ì„œ ë³´ì•ˆì´ ë³´ì¥ëœ í†µì‹ ì„ í•˜ê³ ìí•˜ëŠ” í”„ë¡œí† ì½œì´ë‹¤.\n\n## SSL ì¸ì¦ì„œ\ní´ë¼ì´ì–¸íŠ¸ì™€ ì›¹ ì„œë²„ê°„ì˜ í†µì‹ ì„ ì œ3ìê°€ ë³´ì¦í•´ì£¼ëŠ” ì „ìë¬¸ì„œì´ë‹¤.\ní´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í•œ ì§í›„ì— ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ `SLL ì¸ì¦ì„œ`ë¥¼ ì „ë‹¬í•œë‹¤.\ní´ë¼ì´ì–¸íŠ¸ëŠ” ì‹ ë¢° í•  ìˆ˜ ìˆëŠ” ì¸ì¦ì„œì¸ì§€ ê²€ì¦í•œ í›„ ì„œë²„ì™€ í†µì‹ ì„ ì§„í–‰í•œë‹¤.\n(ë°‘ì—ì„œ ìì„¸íˆ ì„¤ëª…)\n\n## SSL ì¸ì¦ì„œ ì‚¬ìš©ì´ìœ \nì™œ HTTP í†µì‹ ì— êµ³ì´ SSL ì¸ì¦ ê³¼ì •ì„ ë¶™í˜“ì„ê¹Œ? ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\n- í†µì‹  ë‚´ìš©ì´ ì•…ì˜ì ì¸ ëª©ì ì„ ê°€ì§„ ì‚¬ëŒì—ê²Œ ë…¸ì¶œë˜ëŠ” ê²ƒ ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.\n- í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•˜ëŠ” ì„œë²„ê°€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„œë²„ì¸ì§€ íŒë‹¨ í•  ìˆ˜ ìˆë‹¤.\n- í†µì‹  ë‚´ìš©ì˜ ì•…ì˜ì ì¸ ë³€ê²½ì„ ë°©ì§€ í•  ìˆ˜ ìˆë‹¤.\n\n\nSSL í†µì‹ ê³¼ì •ì€ ê½¤ë‚˜ ë³µì¡í•˜ë‹¤. \nê·¸ë˜ì„œ SSL í”„ë¡œí† ì½œì„ ì´í•´í•˜ë ¤ë©´ ìš°ì„  `ì•”í˜¸í™”/ë³µí˜¸í™”`ì™€ `í‚¤(ëŒ€ì¹­í‚¤, ê³µê°œí‚¤)`ì— ëŒ€í•´ ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.\n\n## ì•”í˜¸í™”, ë³µí˜¸í™”, í‚¤\nì–´ë–¤ ì •ë³´ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê¸° ìœ„í•´ ë³€í˜•í•˜ëŠ” ê²ƒì„ `ì•”í˜¸í™”` ë¼ê³ í•œë‹¤.\në°˜ëŒ€ë¡œ ì•”í˜¸í™”ëœ ë°ì´í„°ë¥¼ ì›ë³¸ìœ¼ë¡œ ë³µì›í•˜ëŠ”ê²ƒì„ `ë³µí˜¸í™”`ë¼ê³  í•œë‹¤.\nì•”í˜¸í™”ì™€ ë³µí˜¸í™”ì—ì„œ ë°ì´í„° ë³€í˜•ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ”ê²ƒì„ `í‚¤`ë¼ê³  í•œë‹¤.\n\nì´ë ‡ê²Œ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ `ì•”í˜¸í™”/ë³µí˜¸í™”` í•˜ëŠ” ë°©ì‹ì—ëŠ” `ëŒ€ì¹­í‚¤ ë°©ì‹`ê³¼ `ê³µê°œí‚¤ ë°©ì‹`ì´ ìˆë‹¤. \në‘ ë°©ì‹ ëª¨ë‘ `SSL í†µì‹ `ì— ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.\n\n\n## ëŒ€ì¹­í‚¤ ë°©ì‹\nëŒ€ì¹­í‚¤ëŠ” ë™ì¼í•œ í‚¤ë¡œ `ì•”í˜¸í™”`ì™€ `ë³µí˜¸í™”`ë¥¼ ê°™ì´ í•  ìˆ˜ ì‡ëŠ” ë°©ì‹ì˜ ì•”í˜¸í™” ê¸°ë²•ì„ ì˜ë¯¸í•œë‹¤.\n`ì•”í˜¸í™”`ì™€ `ë³µí˜¸í™”`ë¥¼ ìœ„í•´ ì–‘ìª½ì´ ê°™ì€ í‚¤ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤ëŠ” ì ì—ì„œ ì´ í‚¤ë¥¼ `ëŒ€ì¹­í‚¤`ë¼ê³  í•œë‹¤.\n\n![](https://velog.velcdn.com/images/gudonghee2000/post/01b1f9b4-66ed-46d6-87d4-b18948611b80/image.JPG)\n\nì „ìŸìƒí™©ì„ ê°€ì •í•´ì„œ ì‚´í´ë³´ì. `Aì§„ì˜`ê³¼ `Bì§„ì˜`ì´ ì „ìŸ ì¤‘ì¼ ë•Œ, ì êµ°ì—ê²Œ ì •ë³´ë¥¼ ë…¸ì¶œí•˜ì§€ ì•Šìœ¼ë ¤ë©´ `ì„œë¡œ ê°™ì€ í‚¤(ëŒ€ì¹­í‚¤)`ë¥¼ ê°€ì§€ê³  ì •ë³´ë¥¼ ì•”í˜¸í™” í•´ì„œ ì „ë‹¬ í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.\n\nê·¸ëŸ°ë°, `ëŒ€ì¹­í‚¤`ëŠ” í•˜ë‚˜ì˜ í° ë‹¨ì ì„ ê°€ì§„ë‹¤. ë°”ë¡œ `ëŒ€ì¹­í‚¤`ë¥¼ `Aì§„ì˜`ì—ì„œ `Bì§„ì˜` ë˜ëŠ” `Bì§„ì˜`ì—ì„œ `Aì§„ì˜`ìœ¼ë¡œ ì „ë‹¬ í•  ë•Œ, \n`ëŒ€ì¹­í‚¤`ê°€ íƒˆì·¨ ëœë‹¤ë©´ ì êµ°ë„ ì •ë³´ë¥¼ ë³µí˜¸í™” í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.\n\nì´ëŸ° ë°°ê²½ì—ì„œ ë‚˜ì˜¨ ì•”í˜¸í™” ë°©ì‹ì´ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.\n\n## ê³µê°œí‚¤ ë°©ì‹\n`ê³µê°œí‚¤`ëŠ” í‚¤ê°€ ë‘ê°œê°€ ìˆë‹¤.\nAí‚¤ë¡œ ì•”í˜¸í™” í•˜ë©´ Bí‚¤ë¡œ ë³µí˜¸í™” í•  ìˆ˜ ìˆê³  Bí‚¤ë¡œ ì•”í˜¸í™” í•˜ë©´ Aí‚¤ë¡œ ë³µí˜¸í™” í•˜ëŠ” ë°©ì‹ì´ë‹¤.\n\nì´ ë°©ì‹ì— ì°©ì•ˆí•´ì„œ ë‘ê°œì˜ í‚¤ ì¤‘ í•˜ë‚˜ë¥¼ ê³µê°œí‚¤, í•˜ë‚˜ë¥¼ ë¹„ê³µê°œ í‚¤ë¡œ ì§€ì •í•œë‹¤. \n\nê·¸ë¦¼ì„ í†µí•´ ìì„¸íˆ ì‚´í´ë³´ì.\n\n![](https://velog.velcdn.com/images/gudonghee2000/post/58d5be37-7ee5-4d8f-aacb-8ea66c23ecda/image.JPG)\n\n`Aì§„ì˜`ì€ `ê³µê°œí‚¤`ë¥¼ `Bì§„ì˜`ì—ê²Œ ì „ë‹¬í•œë‹¤.\nê·¸ë¦¬ê³  `Bì§„ì˜`ì€ `Aì§„ì˜`ì˜ `ê³µê°œí‚¤`ë¥¼ í†µí•´ ì •ë³´ë¥¼ ì•”í˜¸í™” í•œ í›„ `Aì§„ì˜`ì— ì „ë‹¬í•œë‹¤.\n`Aì§„ì˜`ì€ `ë¹„ê³µê°œí‚¤`ë¥¼ í†µí•´ ì „ë‹¬ ë°›ì€ ì •ë³´ë¥¼ ë³µí˜¸í™”í•œë‹¤.\n\n`Aì§„ì˜`ì˜ ê³µê°œí‚¤ê°€ íƒˆì·¨ë˜ê±°ë‚˜ `Bì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ê°€ íƒˆì·¨ë˜ì–´ë„ `ë¹„ê³µê°œí‚¤`ê°€ ì—†ìœ¼ë©´ ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥ í•˜ê¸° ë•Œë¬¸ì— `ëŒ€ì¹­í‚¤ ë°©ì‹`ì˜ ë‹¨ì ì„ ê·¹ë³µ í•  ìˆ˜ ìˆë‹¤.\n\n`ê³µê°œí‚¤ ë°©ì‹`ì€ ì´ë ‡ê²Œ ì‘ìš© í•  ìˆ˜ ìˆë‹¤.\n`Aì§„ì˜`ì´ `ë¹„ê³µê°œí‚¤`ë¥¼ ì´ìš©í•´ì„œ ì •ë³´ë¥¼ ì•”í˜¸í™” í•œ í›„ì— ê³µê°œí‚¤ì™€ í•¨ê»˜ ì•”í˜¸í™”ëœ ì •ë³´ë¥¼ `Bì§„ì˜`ì— ì „ë‹¬í•œë‹¤.\n\nê·¸ëŸ°ë°, ì´ëŸ° ì‘ìš©ë°©ì‹ì€ ì¤‘ê°„ì— `ê³µê°œí‚¤`ì™€ `ì•”í˜¸í™”ëœ ì •ë³´`ë¥¼ íƒˆì·¨ ë‹¹í•˜ë©´ ì êµ°ì—ê²Œ ì •ë³´ë¥¼ ë…¸ì¶œ ë‹¹í•  ìˆ˜ ìˆëŠ” ë¬¸ì œë¥¼ ê°€ì ¸ì˜¨ë‹¤.\n\nê·¸ëŸ°ë° `SSL í†µì‹ `ì—ì„œëŠ” ì´ëŸ° ì‘ìš©ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. ê·¸ ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œ?\n\n## SSL í†µì‹ ì´ ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ \nê·¸ ì´ìœ ëŠ” `ê³µê°œí‚¤ ì‘ìš©ë°©ì‹`ì´ ë°ì´í„° ë³´í˜¸ ëª©ì ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.\n\n![](https://velog.velcdn.com/images/gudonghee2000/post/bdfe5ab8-c202-4d3a-bd6a-34b1e46b37c3/image.JPG)\n\n`Aì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ë¥¼ `Aì§„ì˜ì˜ ê³µê°œí‚¤`ë¡œ ë³µí˜¸í™” í•  ìˆ˜ ìˆë‹¤ë©´, ì •ë³´ê°€ `Aì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ì„ì„ ì‹ ë¢° í•  ìˆ˜ ìˆë‹¤.\n\nì¦‰, ê³µê°œí‚¤ê°€ ì •ë³´ë¥¼ ì „ë‹¬í•œ ì‚¬ëŒì˜ ì‹ ì›ì„ ë³´ì¥í•´ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ê²ƒì„ ì „ì ì„œëª…ì´ë¼ê³  í•˜ê³  `SSL í†µì‹ `ì—ì„œ ì„œë²„ì˜ ì‹ ì› í™•ì¸ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤.\n\n\n## SSL ìš©ì–´ ì •ë¦¬\n\nì´ì œ SSL í†µì‹ ì— ì‚¬ìš©ë˜ëŠ” `ëŒ€ì¹­í‚¤ ë°©ì‹`, `ê³µê°œí‚¤ ë°©ì‹`, `ê³µê°œí‚¤ ì‘ìš©ë°©ì‹`ì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ SSLì„ í†µí•œ í†µì‹ ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë³´ì. \nìš°ì„ , SSLê³¼ ê´€ë ¨ëœ ìš©ì–´ë¥¼ ì •ë¦¬í•´ë³´ì.\n\n### CA\nSSL ì¸ì¦ì„œì˜ ì—­í• ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•œ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ë„í•œ ì„œë²„ê°€ ë§ëŠ”ì§€ë¥¼ ë³´ì¥í•˜ëŠ” ì—­í• ì„ í•œë‹¤. \nì´ ì—­í• ì„ í•˜ëŠ” ë¯¼ê°„ê¸°ì—…ë“¤ì´ ìˆëŠ”ë° ì´ëŸ° ê¸°ì—…ë“¤ì„ `CA(Certificate authority)` ë¼ê³ í•œë‹¤.\n\n\n### SSL ì¸ì¦ì„œ ë‚´ìš©\n`SSL ì¸ì¦ì„œ`ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.\n\n- ì„œë¹„ìŠ¤ì˜ ì •ë³´ (ì¸ì¦ì„œë¥¼ ë°œê¸‰í•œ CA, ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ë“±ë“±)\n- ì„œë²„ ì¸¡ ê³µê°œí‚¤ (ê³µê°œí‚¤ì˜ ë‚´ìš©, ê³µê°œí‚¤ì˜ ì•”í˜¸í™” ë°©ë²•)\n\n## SSL í†µì‹  ê³¼ì •\nì´ì œ `í‚¤ë¥¼ ì‚¬ìš©í•œ 3ê°€ì§€ í†µì‹  ë°©ë²•`ì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ SSL í†µì‹ ê³¼ì •ì„ ì´í•´í•´ë³´ì.\n\n`SSL í†µì‹ ê³¼ì •`ì—ì„œ ê°€ì¥ ì´ìƒì ì¸ ë°©ë²•ì€ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.(ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ ì•„ë‹˜)\n![](https://velog.velcdn.com/images/gudonghee2000/post/b528a5c7-9515-4a8b-a4d8-f1341abf57d2/image.JPG)\n\n\n`í´ë¼ì´ì–¸íŠ¸`ì™€ `ì„œë²„`ëŠ” ê°ê°ì˜ `ë¹„ê³µê°œí‚¤, ê³µê°œí‚¤`ë¥¼ ê°€ì§€ê³ \nìì‹ ì˜ `ê³µê°œí‚¤`ë¥¼ ì„œë¡œì—ê²Œ ì „ë‹¬í•œë‹¤. ì´ë•Œ, `ê³µê°œí‚¤`ëŠ” íƒˆì·¨ë˜ì–´ë„ `ë¹„ê³µê°œí‚¤`ê°€ ì—†ìœ¼ë©´ ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆì— ì·¨ì•½ì ì´ ì—†ë‹¤.\n\nê·¸ë¦¬ê³ , `í´ë¼ì´ì–¸íŠ¸`ëŠ” `ì„œë²„`ì˜ `ê³µê°œí‚¤`ë¡œ ì •ë³´ë¥¼ ì•”í˜¸í™” í•´ì„œ ì „ë‹¬í•˜ê³  `ì„œë²„`ëŠ” ì „ë‹¬ ë°›ì€ ì •ë³´ë¥¼ ìì‹ ì˜ `ë¹„ê³µê°œí‚¤(ì„œë²„ ë¹„ê³µê°œí‚¤)`ë¡œ ë³µí˜¸í™”í•œ ë’¤ ì •ë³´ë¥¼ ì²˜ë¦¬í•œë‹¤.\n\në§ˆì§€ë§‰ìœ¼ë¡œ `ì„œë²„`ëŠ” `í´ë¼ì´ì–¸íŠ¸ì˜ ê³µê°œí‚¤`ë¡œ ì‘ë‹µí•´ì¤„ ì •ë³´ë¥¼ ì•”í˜¸í™”í•´ì„œ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•œë‹¤.\n\nê·¸ëŸ°ë°, `ê³µê°œí‚¤ ë°©ì‹`ì€ ì»´í“¨íŒ… íŒŒì›Œë¥¼ ë§ì´ ì“´ë‹¤ê³ í•œë‹¤.(ì»´í“¨íŒ… íŒŒì›Œë¥¼ ë§ì´ì“°ëŠ” ì •í™•í•œ ì´ìœ ëŠ” ëª¨ë¦„) ê·¸ë˜ì„œ ì„±ëŠ¥ì¸¡ë©´ì—ì„œ ë¹„íš¨ìœ¨ì ì´ë‹¤.\n\nê²°ë¡ ì ìœ¼ë¡œ, `SSL í†µì‹ `ì€ `ê³µê°œí‚¤ ë°©ì‹ + ëŒ€ì¹­í‚¤ ë°©ì‹`ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì•ˆê³¼ì„±ëŠ¥ ë‘ê°€ì§€ ì¸¡ë©´ì„ ë³´ì¥í•œë‹¤.\n\nì´ì œ SSL í†µì‹ ê³¼ì •ì„ ì²œì²œíˆ ìì„¸í•˜ê²Œ ì‚´í´ë³´ì.\n\n> HandShake -> í†µì‹  -> í†µì‹ ì¢…ë£Œ\n\nê°„ë‹¨í•˜ê²Œ, SSL í†µì‹ ì€ ìœ„ ì„¸ê°€ì§€ ê³¼ì •ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤.\nìˆœì„œëŒ€ë¡œ í•˜ë‚˜ì”© ì‚´í´ë³´ì.\n\n### HandShake(ì•…ìˆ˜)\nSSL í†µì‹ ì€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ê¸°ì „ì— `ì–´ë–»ê²Œ ë°ì´í„°ë¥¼ ì•”í˜¸í™” í• ì§€`, `ë¯¿ì„ ë§Œí•œ ì„œë²„ì¸ì§€` ë“±ì— ëŒ€í•´ ì´ ê³¼ì •ì—ì„œ í™•ì¸í•œë‹¤.\n\n1. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í•œë‹¤. ì´ ë‹¨ê³„ë¥¼ `Client Hello`ë¼ê³  í•œë‹¤. ì´ ë‹¨ê³„ì—ì„œ ì£¼ê³  ë°›ëŠ” ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\n  \n    - í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ìƒì„±í•œ `ëœë¤ ë°ì´í„°` (ë°‘ì—ì„œ ì„¤ëª…)\n  \n    - í´ë¼ì´ì–¸íŠ¸ê°€ ì§€ì›í•˜ëŠ” ì•”í˜¸í™” ë°©ì‹ë“¤ => í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ëŠ¥í•œ ì•”í˜¸í™” ë°©ì‹ì„ ì„œë²„ì— ì•Œë ¤ì£¼ê¸° ìœ„í•¨\n  \n2. ì„œë²„ëŠ” `Client Hello`ì— ëŒ€í•œ ì‘ë‹µìœ¼ë¡œ `Server Hello`ë¥¼ í•˜ê²Œ ëœë‹¤. ì´ ë‹¨ê³„ì—ì„œ ì£¼ê³  ë°›ëŠ” ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\n  \n    - ì„œë²„ ì¸¡ì—ì„œ ìƒì„±í•œ ëœë¤ ë°ì´í„° (ë°‘ì—ì„œ ì„¤ëª…)\n  \n    - ì„œë²„ê°€ ì„ íƒí•œ í´ë¼ì´ì–¸íŠ¸ì˜ ì•”í˜¸í™” ë°©ì‹ => ì„ íƒí•œ ì•”í˜¸í™” ë°©ì‹ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ê¸° ìœ„í•¨\n  \n    - ì¸ì¦ì„œ\n  \n  \n3. `í´ë¼ì´ì–¸íŠ¸`ëŠ” `ì„œë²„ì˜ ì¸ì¦ì„œ`ê°€ `CA`ì— ì˜í•´ ë°œê¸‰ëœ ê²ƒì¸ì§€ í™•ì¸í•œë‹¤.\n  ì´ë•Œ, `í´ë¼ì´ì–¸íŠ¸`ì— ë‚´ì¥ëœ `CAë¦¬ìŠ¤íŠ¸ì™€ CAì˜ ê³µê°œí‚¤`ë¥¼ ì‚¬ìš©í•´ì„œ ì¸ì¦ì„œë¥¼ ë³µí˜¸í™” í•œë‹¤. \n>   ğŸ’¡ ì°¸ê³ \n  ìœ„ì—ì„œ ë§í•œ ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ì˜ í™œìš©\n  ê·¸ë¦¬ê³ , í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ëŠ” CA ì¢…ë¥˜ì™€ CAì˜ ê³µê°œí‚¤ê°€ ë‚´ì¥ë˜ìˆìŒ\n  \n  ì„±ê³µì ìœ¼ë¡œ ì¸ì¦ì„œê°€ ë³µí˜¸í™” ë¬ë‹¤ë©´, `ì„œë²„`ê°€ ì „ë‹¬í•œ ì¸ì¦ì„œê°€ `CAì˜ ê°œì¸í‚¤`ë¡œ ì•”í˜¸í™”ëœ ë¬¸ì„œì„ì´ ë³´ì¦ëœ ê²ƒì´ë‹¤.\n**  ì¦‰, ì˜¬ë°”ë¥¸ ì„œë²„ì„ì„ ì‹ ë¢° í• ìˆ˜ ìˆê²Œëœë‹¤.**\n  \n  ì„œë²„ë¥¼ ì‹ ë¢°í• ìˆ˜ ìˆìœ¼ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ëŠ” `ì„œë²„ê°€ ìƒì„±í•œ ëœë¤ ë°ì´í„°`ì™€ `í´ë¼ì´ì–¸íŠ¸ê°€ ìƒì„±í•œ ëœë¤ ë°ì´í„°`ë¥¼ ì¡°í•©í•˜ì—¬ `pre master secret`ì´ë¼ëŠ” í‚¤ë¥¼ ìƒì„±í•œë‹¤. \n  \n ì´ë•Œ, `pre master secret`í‚¤ëŠ” ëŒ€ì¹­í‚¤ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš© í•  ê²ƒì´ë‹¤.\n í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ë™ì¼í•˜ê²Œ ê°€ì§€ê³  ë°ì´í„°ë¥¼ ì•”í˜¸í™”/ë³µí˜¸í™” í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì´ë‹¤.\n \n ê·¸ëŸ°ë° ëŒ€ì¹­í‚¤ ë°©ì‹ì˜ ë‹¨ì ì—ì„œ ì‚´í´ë´¤ë“¯ì´ `pre master secret`ë¥¼ ê·¸ëŒ€ë¡œ ì„œë²„ì— ì „ë‹¬í•˜ë©´ ì¤‘ê°„ì— íƒˆì·¨ë‹¹í•´ ì•…ìš©ë ìˆ˜ ìˆë‹¤.\n \n ì´ë•Œ, ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.\n `ì„œë²„ì˜ ê³µê°œí‚¤(ì„œë²„ê°€ ì „ë‹¬í•´ì¤€ ì¸ì¦ì„œ ë‚´ë¶€ì— ë“¤ì–´ìˆì—ˆìŒ)`ë¡œ `pre master secret`ë¥¼ ì•”í˜¸í™”í•´ì„œ `ì„œë²„`ë¡œ ì „ì†¡í•œë‹¤.\n\n\n \n 4. `ì„œë²„`ëŠ” ìì‹ ì˜ ë¹„ê³µê°œí‚¤ë¥¼ í†µí•´ `pre master secret`ë¥¼ ë³µí˜¸í™”í•œë‹¤.\n \n ì´ë¥¼ í†µí•´, í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì•ˆì „í•˜ê²Œ ê°™ì€ `pre master secret`ë¥¼ ê°€ì§„ë‹¤.\n ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì„ í†µí•´ `pre master secret`ì„ `master secret`ë¼ëŠ” `session key`ë¥¼ ìƒì„±í•œë‹¤.\n`master secret`ì€ ì‹¤ì œë¡œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì£¼ê³ ë°›ëŠ” ë°ì´í„°ë¥¼ `ì•”í˜¸í™”/ë³µí˜¸í™”` í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤.\n\n5. í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” `HandShake`ê°€ ì¢…ë£Œë¬ìŒì„ ì„œë¡œì—ê²Œ ì•Œë¦°ë‹¤.\n\n\n### í†µì‹ \nì´ì œ `master secret`ì„ í†µí•´ `í´ë¼ì´ì–¸íŠ¸`ì™€ `ì„œë²„`ëŠ” ë°ì´í„°ë¥¼ `ì•”í˜¸í™”/ë³µí˜¸í™”`í•˜ë©´ì„œ ì£¼ê³  ë°›ëŠ”ë‹¤. \n\n### í†µì‹ ì¢…ë£Œ\në°ì´í„°ì˜ ì „ì†¡ì´ ëë‚˜ë©´ SSL í†µì‹ ì´ ëë‚¬ìŒì„ ì„œë¡œì—ê²Œ ì•Œë ¤ì¤€ë‹¤.\nê·¸ë¦¬ê³  ì‚¬ìš©í•œ ëŒ€ì¹­í‚¤ì¸ `master secret`ì€ íê¸°í•œë‹¤.\n \n \n## ë§ˆì¹˜ë©´ì„œ\nì´ìƒ SSLí†µì‹ ì— ëŒ€í•´ì„œ ìì„¸í•˜ê²Œ ì‚´í´ë³´ì•˜ë‹¤.\nSSL í†µì‹ ì€ `ê³µê°œí‚¤ ë°©ì‹`, `ëŒ€ì¹­í‚¤ ë°©ì‹`ì„ í•©ì³ì„œ ì‚¬ìš©í•˜ëŠ” ë§Œí¼ ê½¤ë‚˜ ë³µì¡í•˜ë‹¤. \nì‘ì„±í•œ ê¸€ì´ ë§ì€ í¬ë£¨ë“¤ì—ê²Œ HTTPSì™€ SSL í†µì‹ ì— ëŒ€í•œ ì´í•´ì— ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.\n\n## ì°¸ì¡°\nhttps://opentutorials.org/course/228/4894"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸° ìš°í…Œì½” ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ, HTTPS í†µì‹ ì„ ì ìš©í•˜ê¸° ìœ„í•´ NGINXì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í–ˆë‹¤.\nê·¸ë˜ì„œ NGINXì— ëŒ€í•œ ì´í•´ë¥¼ ë•ê¸°ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤. NGINXë€? NginxëŠ” WS(Web Server)ì˜ ì¼ì¢…ì´ë‹¤. ì£¼ë¡œ ì •ì  ì»¨í…ì¸ ë¥¼ ì œê³µí•˜ê±°ë‚˜ ReversePrâ€¦","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"date":"July 30, 2022","title":"NGINX ë€?","tags":["WS","NGINX"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸°\nìš°í…Œì½” ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ, HTTPS í†µì‹ ì„ ì ìš©í•˜ê¸° ìœ„í•´ NGINXì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í–ˆë‹¤.\nê·¸ë˜ì„œ NGINXì— ëŒ€í•œ ì´í•´ë¥¼ ë•ê¸°ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤.\n\n<br>\n\n## NGINXë€?\n> _NginxëŠ” WS(Web Server)ì˜ ì¼ì¢…ì´ë‹¤. ì£¼ë¡œ ì •ì  ì»¨í…ì¸ ë¥¼ ì œê³µí•˜ê±°ë‚˜ ReverseProxy, LoadBalancerì˜ ì—­í• ì„ í•œë‹¤._\n\n<br>\n\n## NGINXì˜ ë“±ì¥ ë°°ê²½\nNGINXë¥¼ ì‚´í´ë³´ê¸°ì „ì—, ë¬´ìŠ¨ ì´ìœ ë¡œ NGINXê°€ ë“±ì¥í–ˆëŠ”ì§€ë¥¼ ë¨¼ì € ì‚´í´ë³¼ í•„ìš”ê°€ ìˆë‹¤. ìš°ì„  NGINXì˜ ë“±ì¥ë°°ê²½ì„ ì‚´í´ë³´ì.\n\n<br>\n\nNGINX ë“±ì¥ì´ì „ Apacheê°€ ì›¹ì„œë²„ë¡œì¨ì˜ ë†’ì€ ì¸ê¸°ë¥¼ ê°€ì¡Œë‹¤.\nì˜ ì‚¬ìš©ë˜ë˜ Apache ì›¹ì„œë²„ëŠ” ì–´ëŠìˆœê°„ ì–´ë– í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤. Apacheì˜ ìš”ì²­ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ê³¼ í•¨ê»˜ ì–´ë– í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì™”ëŠ”ì§€ ì‚´í´ë³´ì. \n![](https://velog.velcdn.com/images/gudonghee2000/post/4c31d7af-155b-4998-9ef3-93559914949e/image.JPG)\n\n\nì´ˆê¸°ì˜ ApacheëŠ” ê·¸ë¦¼ê³¼ ê°™ì´ ìš”ì²­(Request)ì´ ë“¤ì–´ì˜¬ ë–„ ë§ˆë‹¤ ìƒˆë¡œìš´ Processë¥¼ ìƒì„±í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í•˜ê³  ìš”ì²­ì„ ì²˜ë¦¬í–ˆë‹¤.(ì´ëŸ¬í•œ ì²˜ë¦¬ë°©ì‹ì„ `prefork`ë¼ê³  í•¨)\n\nê·¸ëŸ°ë°, 2000ë…„ì— ì ‘ì–´ ë“¤ê³  ì¸í„°ë„· íŠ¸ë˜í”½ì´ ì¦ê°€í•˜ë©´ì„œ ì•„íŒŒì¹˜ì˜ ìš”ì²­ ì²˜ë¦¬ë°©ì‹ì€ `C10K` ë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤.\n> \nC10K ë¬¸ì œë€ Connection 10000 Problemì˜ ì¤„ì„ë§ë¡œ ì›¹ì„œë²„ê°€ 1ë§Œê°œì˜ ë™ì‹œ Connectionì„ ì²˜ë¦¬í•˜ê¸° ì–´ë µë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.\n\n\n\nì¼ë‹¨ ë™ì‹œ Connectionì„ ìì„¸íˆ ì‚´í´ë³´ì.\n![](https://velog.velcdn.com/images/gudonghee2000/post/954a297f-e564-43b1-acfa-0f2452854647/image.JPG)\n\n\n`ì›¹ì„œë²„`ëŠ” `í´ë¼ì´ì–¸íŠ¸`ë¡œ ë¶€í„° ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `Connection`ì„ ìƒì„±í•˜ê³  ìœ ì§€í•œë‹¤.\nê·¸ë¦¬ê³  ê·¸ë¦¼ê³¼ ê°™ì´ `í´ë¼ì´ì–¸íŠ¸`ëŠ” ìƒì„±ëœ `Connection`ì„ í†µí•´ ë˜ë‹¤ë¥¸ ìš”ì²­ì„ `ì„œë²„`ì—ê²Œ ì „ë‹¬í•œë‹¤. \n\nì´ë ‡ê²Œ `Connection` í•˜ë‚˜ë¡œ ì—¬ëŸ¬ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” `Connection`ì„ ìƒì„±í•˜ëŠ”ë° ì—¬ëŸ¬ê°€ì§€ ì ˆì°¨ê°€ í•„ìš”í•˜ë‹¤. \nê·¸ë˜ì„œ ë§¤ ìš”ì²­ë§ˆë‹¤ `Connection`ì„ ìƒì„±í•˜ëŠ”ê²ƒì€ ë¹„íš¨ìœ¨ì ì´ê³  ëŠë ¸ë‹¤. \n\në¹„íš¨ìœ¨ì„±ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ëŒë“¤ì€ ì´ë¯¸ ë§Œë“¤ì–´ì§„ `Connection`ì´ ìˆë‹¤ë©´ ì´ë¥¼ í™œìš©í•˜ì—¬ ìš”ì²­ì„ ë³´ë‚´ê³ ì í•˜ì˜€ë‹¤.\n\nì´ë ‡ê²Œ ìœ ì§€ë˜ëŠ” `Connection`ë“¤ì„ `ë™ì‹œ Connection`ì´ë¼ê³  í•œë‹¤.\n\n> ğŸ’¡ ì—¬ë‹´ìœ¼ë¡œ HTTP í”„ë¡œí† ì½œ `Header`ë¶€ë¶„ì˜ `Keep-Alive`ê°€ ë°”ë¡œ `Connection`ì„ ì–¼ë§ˆë‚˜ ìœ ì§€í•  ê²ƒì¸ì§€ì— ëŒ€í•œ í†µì‹  ê·œì•½ì´ë‹¤.\n\nì´ë•Œ, Apache ì„œë²„ëŠ” C10Kë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤.\n![](https://velog.velcdn.com/images/gudonghee2000/post/fa69475a-0326-4652-b1da-616e60164dea/image.JPG)\n\nê·¸ë¦¼ê³¼ ê°™ì´ `Apache`ì„œë²„ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ ë§ˆë‹¤, `Process`ë¥¼ ìƒì„±í–ˆëŠ”ë° ìš”ì²­ì´ ë§Œë‹¨ìœ„ë¥¼ ë„˜ì–´ê°€ë©´ì„œ ì–´ëŠìˆœê°„ ë¶€í„° ìš”ì²­ì— ëŒ€í•œ `Connection`ì„ ìƒì„±í•˜ì§€ ëª»í•œê²ƒì´ë‹¤. \n\nì´ëŸ¬í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì˜¨ ì›ì¸ì€ ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.\n-  ë©”ëª¨ë¦¬ ë¶€ì¡±\nApacheì„œë²„ëŠ” `Connection`ì´ ìƒì„±ë  ë•Œë§ˆë‹¤ `Process`ë¥¼ ìƒì„±í•´ì•¼í–ˆëŠ”ë° ë™ì‹œì— ìœ ì§€í•´ì•¼í•  `Connection`ì´ ë§ì•„ì§€ë©´ì„œ ìœ ì§€í•´ì•¼í•  `Process`ê°€ ì¦ê°€í–ˆê³  ë©”ëª¨ë¦¬ ë¶€ì¡±ì„ ë°œìƒì‹œì¼°ë‹¤.\n\n- CPU ê³¼ë¶€í•˜\në˜í•œ, ì‹¤í–‰ì¤‘ì¸ `Process`ê°€ ë§ì•„ì§€ë©´ì„œ CPUëŠ” `Process`ë¥¼ ì²˜ë¦¬ í•  ë•Œ, `ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­`ì„ êµ‰ì¥íˆ ë§ì´í•´ì•¼í–ˆë‹¤. ê·¸ë˜ì„œ CPUì˜ ë¶€í•˜ê°€ ì¦ê°€í–ˆë‹¤.\n\nê²°êµ­, ìˆ˜ë§ì€ ë™ì‹œ ì»¤ë„¥ì…˜ì„ ì²˜ë¦¬í•˜ê¸°ì—” Apacheì˜ ìš”ì²­ ì²˜ë¦¬êµ¬ì¡°ëŠ” ë¶€ì í•©í–ˆë‹¤.\n\nê·¸ë˜ì„œ Apacheì˜ ë‹¨ì ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ 2004ë…„ NGINXê°€ ë“±ì¥í–ˆë‹¤.\n\n<br>\n\n## NGINX ìì„¸íˆ ì•Œì•„ë³´ê¸°\n\nìš°ì„ , NGINXì˜ ìš”ì²­ ì²˜ë¦¬ ë°©ì‹ì„ ì‚´í´ë³´ì.![](https://velog.velcdn.com/images/gudonghee2000/post/93b0890b-c015-46d0-9165-5cf6a7b4d9f6/image.JPG)\n\nNGINXëŠ” `MasterProcess`ë¥¼ í†µí•´ ì„¤ì • íŒŒì¼ì„ ì½ê³  `WorkerProcess`ì™€ ê°™ì€ ìì‹ `Process` 3ì¢…ë¥˜ë¥¼ ìƒì„±í•œë‹¤. (`cache loader`, `cache manager`ê°€ ìˆìŒ)\n\nê·¸ë¦¬ê³  ìƒì„±ëœ `WorkerProcess`ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `Connection`ì„ í˜•ì„±í•˜ê³  ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\nìš”ì²­ì— ë”°ë¼ì„œ ë§¤ë²ˆ `Process`ë¥¼ ìƒì„±í•˜ë˜ Apacheì™€ ë‹¬ë¦¬, NGINXëŠ” `MasterProcess`ì— ë”°ë¼ `WorkerProcess`ë¥¼ ìƒì„±í•˜ê³  ê³ ì •ëœ ê°œìˆ˜ì˜ `WorkerProcess` ë“¤ì´ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\n\nì´ë ‡ê²Œ ê³ ì •ëœ `Process`ì˜ ê°œìˆ˜ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ NGINXëŠ” `Event-Driven` ë°©ì‹ìœ¼ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\n\n> ğŸ’¡ Event-Drivenì´ë€?\nNGINXëŠ” í˜•ì„±ëœ Connectionì— ì•„ë¬´ëŸ° ìš”ì²­ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ìš”ì²­ì— ëŒ€í•œ Connectionì„ í˜•ì„±í•˜ì—¬ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤. \në˜ëŠ” ì´ë¯¸ ë§Œë“¤ì–´ì§„ ë‹¤ë¥¸ Connectionìœ¼ë¡œë¶€í„° ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤. \nNginxì—ì„œì˜ Conneciton í˜•ì„±, Connection ì œê±°, ìƒˆë¡œìš´ ìš”ì²­ ì²˜ë¦¬ë¥¼ Eventë¼ê³  ë¶€ë¥¸ë‹¤.\në˜í•œ, Eventë¥¼ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ Event-Drivenì´ë¼ê³  í•œë‹¤.\n\n<br>\n\n![](https://velog.velcdn.com/images/gudonghee2000/post/f1b98399-de8f-4f10-bbba-050ca377c4be/image.JPG)\n\nNGINXëŠ” ê·¸ë¦¼ê³¼ ê°™ì´ íí˜•íƒœì˜ ì €ì¥ì†Œì— Eventë“¤ì„ ë‹´ì•„ `WorkerProcess`ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•œë‹¤.\n\n<br>\n\n## NGINXì˜ Apacheì˜ ì°¨ì´ì \nApacheëŠ” ë™ê¸°ë°©ì‹ìœ¼ë¡œ í•˜ë‚˜ì˜ `Connection`ì´ ëë‚  ë•Œ ê¹Œì§€ `Process`ë¥¼ ìœ ì§€í–ˆë‹¤. \n\në°˜ë©´, NGINXëŠ” ê³ ì •ëœ `WokerProcess`ë¥¼ ìƒì„±í•˜ê³  `Event`ê°€ ë°œìƒ í•  ë•Œë§ˆë‹¤ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¹„ë™ê¸° `Event-Driven` ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì´ ì°¨ì´ì ì´ë‹¤.\n\në³´í†µ `WorkerProcess`ëŠ” CPUì˜ ì½”ì–´ ê°œìˆ˜ë§Œí¼ ìƒì„±í•˜ëŠ”ê²ƒì´ ì¼ë°˜ì ì´ë¼ê³  í•œë‹¤. **(ì´ìœ : ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ íšŒìˆ˜ë¥¼ ìµœì†Œí•˜ í•˜ê¸° ìœ„í•¨.)**\n\n<br>\n\n## NGINXì˜ ì¥ì \nNGINXëŠ” Apacheì— ë¹„í•´ ì„±ëŠ¥ ì¸¡ë©´ì—ì„œ ë‘ê°€ì§€ ì¥ì ì´ìˆë‹¤.\n\n1. ì²˜ë¦¬í• ìˆ˜ ìˆëŠ” ë™ì‹œ ì»¤ë„¥ì…˜ ê°œìˆ˜ê°€ í›¨ì”¬ ë§ë‹¤.\n\n2. ë™ì¼í•œ ê°œìˆ˜ì˜ ì»¤ë„¥ì…˜ ì²˜ë¦¬ ì†ë„ê°€ ë” ë¹ ë¥´ë‹¤.\n\nì´ëŸ¬í•œ ì¥ì ì„ ê°€ì§€ê³  ì˜¤ëŠ” ì´ìœ ë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ ì •ë¦¬í•´ë³´ì.\n- ê³ ì •ëœ `Process` ê°œìˆ˜ ë§Œì„ ì‚¬ìš©í•˜ê¸°ì— `Process` ìƒì„± ë¹„ìš©ì´ ì—†ë‹¤.\n- ë˜í•œ, `Process` ê°œìˆ˜ê°€ ì œí•œë˜ì–´ CPUì˜ ë¶€ë‹´ì´ ì¤„ì–´ë“ ë‹¤. (ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ì´ ì ì–´ì§€ê¸° ë•Œë¬¸)\n- ë¹„ë™ê¸° ë°©ì‹ì´ê¸°ì— `Process`ê°€ ì‰¬ì§€ì•Šê³  ì¼ì„ í•  ìˆ˜ ìˆë‹¤.\n\n<br>\n\n## NGINX í™œìš© ë°©ë²•\në„ì…ë¶€ì—ì„œ ì´ì•¼ê¸°í–‡ë“¯ì´ NGINXëŠ” ì •ì íŒŒì¼ì²˜ë¦¬, ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ, ë¡œë“œë°¸ëŸ°ì„œì˜ ì—­í• ë¡œì¨ WASì˜ ë¶€ë‹´ì„ ì¤„ì—¬ì£¼ëŠ” ì—­í• ë¡œ ë‹¤ì–‘í•˜ê²Œ í™œìš© í•  ìˆ˜ ìˆë‹¤.\n\n<br>\n\n## ë§ˆì¹˜ë©´ì„œ\nì´ìƒ NGINXì˜ ë“±ì¥ ë°°ê²½ê³¼ ì‘ë™ ë°©ì‹ì„ ì‚´í´ë³´ì•˜ë‹¤.\në§ì€ í¬ë£¨ë“¤ì´ ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì‚¬ìš©í•˜ëŠ” NGINXì— ëŒ€í•œ ì´í•´ì— ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.\n\n<br>\n\n### ì°¸ì¡°\nhttps://livlikwav.github.io/study/NGINX-inside/\nhttps://jizard.tistory.com/306\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë¬¸ì œ ì—ì„œ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ í„°ì¡Œë‹¤.  ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ idë¥¼ ë„£ìœ¼ë©´ ì´ ë°œìƒí•´ì•¼ í•˜ëŠ”ë° ì•„ë¬´ëŸ° ì˜ˆì™¸ë„ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤. ë” ì´ìƒí•œ ì ì€ ë‹¨ë…ìœ¼ë¡œ ëŒë ¸ì„ ë•ŒëŠ” ì˜ ëŒì•„ê°€ì§€ë§Œ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ í„°ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œê°€ ìˆì–´ ë³´ì˜€ë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ì•˜ë‹¤.  MEMBERê¹Œì§€ ì €â€¦","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"date":"July 27, 2022","title":"í…ŒìŠ¤íŠ¸ì—ì„œ Entity ê°ì²´ë¥¼ ìƒìˆ˜ë¡œ ë‘ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ","tags":["Spring","test fixture","ìƒìˆ˜"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ë¬¸ì œ\n\n```java\n// MemberFixtures\n\npublic static final Member MEMBER \n\t\t= new Member(\"example@email.com\", \"/image.png\", \"example\", SocialType.GOOGLE);\npublic static final Member CREATOR \n\t\t= new Member(\"creator@email.com\", \"/image.png\", \"creator\", SocialType.GOOGLE);\n```\n\n```java\n// CategoryServiceTest\n\n@DisplayName(\"ìì‹ ì´ ë§Œë“¤ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ë¥¼ ìˆ˜ì •í•  ê²½ìš° ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.\")\n@Test\nvoid ìì‹ ì´_ë§Œë“¤ì§€_ì•Šì€_ì¹´í…Œê³ ë¦¬ë¥¼_ìˆ˜ì •í• _ê²½ìš°_ì˜ˆì™¸ë¥¼_ë˜ì§„ë‹¤() {\n    // given\n    Member member = memberRepository.save(MEMBER);\n    Member creator = memberRepository.save(CREATOR);\n    CategoryResponse savedCategory = categoryService.save(creator.getId(),\n            new CategoryCreateRequest(CATEGORY_NAME));\n\n    CategoryUpdateRequest categoryUpdateRequest = new CategoryUpdateRequest(MODIFIED_CATEGORY_NAME);\n\n    // when & then\n    assertThatThrownBy(\n            () -> categoryService.update(member.getId(), savedCategory.getId(), categoryUpdateRequest))\n            .isInstanceOf(NoPermissionException.class);\n}\n```\n\n`CategoryServiceTest`ì—ì„œ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ í„°ì¡Œë‹¤. `update` ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ idë¥¼ ë„£ìœ¼ë©´ `NoPermissionException`ì´ ë°œìƒí•´ì•¼ í•˜ëŠ”ë° ì•„ë¬´ëŸ° ì˜ˆì™¸ë„ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤. ë” ì´ìƒí•œ ì ì€ ë‹¨ë…ìœ¼ë¡œ ëŒë ¸ì„ ë•ŒëŠ” ì˜ ëŒì•„ê°€ì§€ë§Œ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ í„°ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œê°€ ìˆì–´ ë³´ì˜€ë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ì•˜ë‹¤.\n\n![member ê°ì²´](debug1.png)\n\nMEMBERê¹Œì§€ ì €ì¥í–ˆì„ ë•ŒëŠ” ë¶„ëª… ê°’ë“¤ì´ ì˜ ë“¤ì–´ê°€ìˆëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.\n\n![í•„ë“œê°€ ë³€ê²½ëœ member ê°ì²´](debug2.png)\n\nê·¼ë° CREATORë¥¼ ì €ì¥í•˜ëŠ” ìˆœê°„!? memberì˜ ê°’ì´ ê°‘ìê¸° CREATORì˜ ê°’ìœ¼ë¡œ ì „ë¶€ ë³€ê²½ë˜ì—ˆë‹¤. ì™œ ì´ëŸ° ê±¸ê¹Œ.\n\n## ì›ì¸\n\n> ê°€ë³€ê°ì²´ì¸ íšŒì›ì˜ Entityë¥¼ ìƒìˆ˜ë¡œ ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì´ ë¬¸ì œì˜€ë‹¤.\n\nì•„ë˜ ê·¸ë¦¼ì„ í†µí•´ ì•Œì•„ë³´ì.\n\n![](img1.png)\n\ní…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ MEMBERì™€ CREATORëŠ” idë¥¼ ê°€ì§€ì§€ ì•Šì€ ìƒíƒœì´ë‹¤. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë„ ë¹„ì–´ìˆë‹¤.\n\nì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ MEMBERì™€ CREATORëŠ” ìƒìˆ˜ì´ë¯€ë¡œ ì˜¨ê°– í…ŒìŠ¤íŠ¸ì—ì„œ ë‘ ê°œì˜ ìƒìˆ˜ë¥¼ ê°€ì ¸ë‹¤ ì“°ê²Œ ëœë‹¤. ê·¸ ê³¼ì •ì—ì„œ MEMBERê°€ ì €ì¥ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤.\n\n![](img2.png)\n\nê·¸ëŸ¼ ìƒìˆ˜ MEMBERì˜ id ê°’ì´ 1ë¡œ ë°”ë€Œê²Œ ëœë‹¤. ì´í›„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” CREATORê°€ ì €ì¥ëœë‹¤. ì´ ë•Œ ê°ê°ì˜ í…ŒìŠ¤íŠ¸ëŠ” ê²©ë¦¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë¹ˆ ìƒíƒœì´ë‹¤. ë”°ë¼ì„œ CREATORì˜ idë„ 1ë¡œ ì €ì¥ëœë‹¤.\n\n![](img3.png)\n\nì´ë ‡ê²Œ ìƒìˆ˜ MEMBERì™€ CREATORì˜ idê°€ ëª¨ë‘ 1ë¡œ ë°”ë€Œì—ˆë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ë‹ˆ ì‹¤ì œë¡œ ìƒìˆ˜ì˜ id ê°’ì´ ëª¨ë‘ 1ë¡œ ë°”ë€ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.\n\n![](debug3.png)\n\nì´ ìƒíƒœì—ì„œ ì²˜ìŒ ë´¤ë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ëŒì•„ê°€ë³´ì.\n\n```java\n// CategoryServiceTest\n\n@DisplayName(\"ìì‹ ì´ ë§Œë“¤ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ë¥¼ ìˆ˜ì •í•  ê²½ìš° ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.\")\n@Test\nvoid ìì‹ ì´_ë§Œë“¤ì§€_ì•Šì€_ì¹´í…Œê³ ë¦¬ë¥¼_ìˆ˜ì •í• _ê²½ìš°_ì˜ˆì™¸ë¥¼_ë˜ì§„ë‹¤() {\n    // given\n    Member member = memberRepository.save(MEMBER);\n    Member creator = memberRepository.save(CREATOR); // ë¬¸ì œ ë°œìƒ !!!\n    CategoryResponse savedCategory = categoryService.save(creator.getId(),\n            new CategoryCreateRequest(CATEGORY_NAME));\n\n    CategoryUpdateRequest categoryUpdateRequest = new CategoryUpdateRequest(MODIFIED_CATEGORY_NAME);\n\n    // when & then\n    assertThatThrownBy(\n            () -> categoryService.update(member.getId(), savedCategory.getId(), categoryUpdateRequest))\n            .isInstanceOf(NoPermissionException.class);\n}\n```\n\ní…ŒìŠ¤íŠ¸ë¥¼ ë³´ë©´ ì²˜ìŒìœ¼ë¡œ MEMBERë¥¼ ì €ì¥í•œë‹¤. ì´ê¹Œì§€ëŠ” ì•„ë¬´ ë¬¸ì œê°€ ì—†ë‹¤. ë¬¸ì œëŠ” ë‘ ë²ˆì§¸ë¡œ CREATORë¥¼ ì €ì¥í•  ë•Œ ë°œìƒí•œë‹¤.\n\n![](img4.png)\n\nCREATORë¥¼ ì €ì¥í•˜ë ¤ê³  í•˜ëŠ”ë° ì €ì¥ëœ MEMBERì˜ idë„ 1ì´ê³ , CREATORì˜ idë„ 1ì´ë‹¤. CREATORë¥¼ ì €ì¥í•  ë•Œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê°™ì€ idë¥¼ ê°€ì§„ entityê°€ ìˆìœ¼ë¯€ë¡œ CREATORë¥¼ ìƒˆë¡­ê²Œ ì €ì¥í•˜ì§€ ì•Šê³ , ê¸°ì¡´ì˜ idê°€ 1ë²ˆì¸ entityë¥¼ ìˆ˜ì •í•˜ê²Œ ëœë‹¤.\n\n![](img5.png)\n\nê¸°ì¡´ì˜ ê°’ì´ ìˆ˜ì •ë˜ë‹ˆ idê°€ 1ë²ˆì¸, MEMBERë¥¼ ì €ì¥í•œ member instanceì˜ ê°’ê¹Œì§€ ë³€ê²½ë˜ëŠ” ê²ƒì´ë‹¤.\n\n## í•´ê²°\n\nEntity ê°ì²´ì— ëŒ€í•œ fixtureê°€ í•„ìš”í•œ ê²½ìš° ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ë„ë¡ í–ˆë‹¤.\n\n```java\npublic static Member íŒŒë‘() {\n    return new Member(íŒŒë‘_ì´ë©”ì¼, íŒŒë‘_í”„ë¡œí•„, íŒŒë‘_ì´ë¦„, SocialType.GOOGLE);\n}\n```\n\n## ê²°ë¡ \n\nìƒìˆ˜ë€ ë³€í•˜ì§€ ì•Šê³  ê³ ì •ëœ ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” í•„ë“œê°€ ë³€í•˜ëŠ” ê°ì²´ì¸ Member Entityë¥¼ ìƒìˆ˜ë¡œ ì„ ì–¸í–ˆë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ë¥¼ ì•„ë¬´ë¦¬ ì˜ í•´ë„ ìƒìˆ˜ê¹Œì§€ ê³„ì† ë¦¬í”„ë ˆì‰¬ í•´ì£¼ì§„ ì•Šê¸° ë•Œë¬¸ì— ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•œ ê²ƒì´ë‹¤.\n\n**ë³€í•˜ì§€ ì•ŠëŠ” ë¶ˆë³€ ê°ì²´ë§Œ ìƒìˆ˜ë¡œ ì§€ì •í•˜ì!!**\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸° Springì—ì„œ ì´ë‚˜ ì— ì¡´ì¬í•˜ëŠ” ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì—ëŠ” ëŒ€í‘œì ìœ¼ë¡œ  ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ ë°©ë²•ê³¼ ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. ë‘ ë°©ì‹ì„ ì§ì ‘ ì ìš©í•´ ë³¸ ë’¤ ì°¨ì´ì™€ ì´ì ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤ í•œë‹¤. @Value ì‚¬ìš©í•˜ê¸° ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì • ì •ë³´ë¥¼ ë‹¨ì¼ê°’ìœ¼ë¡œ ì£¼ì… ë°›ê¸° ìœ„í•´ ì‚¬â€¦","fields":{"slug":"/properties-to-object/"},"frontmatter":{"date":"July 27, 2022","title":"properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°","tags":["properties","Value","ConfigurationProperties"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°\n\nSpringì—ì„œ `application.yml`ì´ë‚˜ `application.properties`ì— ì¡´ì¬í•˜ëŠ” ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì—ëŠ” ëŒ€í‘œì ìœ¼ë¡œ `@Value` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ ë°©ë²•ê³¼ `@ConfigurationProperties`ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. ë‘ ë°©ì‹ì„ ì§ì ‘ ì ìš©í•´ ë³¸ ë’¤ ì°¨ì´ì™€ ì´ì ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤ í•œë‹¤.\n\n## @Value ì‚¬ìš©í•˜ê¸°\n\n`@Value`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì • ì •ë³´ë¥¼ ë‹¨ì¼ê°’ìœ¼ë¡œ ì£¼ì… ë°›ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ ë‹¬ë¡ í”„ë¡œì íŠ¸ì—ì„œ ì ìš©í•œ ì˜ˆì‹œì´ë‹¤.\n\n```java\n@Component\npublic class GoogleOAuthClient implements OAuthClient {\n\n    private static final String JWT_DELIMITER = \"\\\\.\";\n\n    private final String clientId;\n    private final String clientSecret;\n    private final String grantType;\n    private final String redirectUri;\n    private final String tokenUri;\n    private final RestTemplate restTemplate;\n    private final ObjectMapper objectMapper;\n\n    public GoogleOAuthClient(@Value(\"${oauth.google.client-id}\") final String clientId,\n                             @Value(\"${oauth.google.client-secret}\") final String clientSecret,\n                             @Value(\"${oauth.google.grant-type}\") final String grantType,\n                             @Value(\"${oauth.google.redirect-uri}\") final String redirectUri,\n                             @Value(\"${oauth.google.token-uri}\") final String tokenUri,\n                             final RestTemplateBuilder restTemplateBuilder, final ObjectMapper objectMapper) {\n        this.clientId = clientId;\n        this.clientSecret = clientSecret;\n        this.grantType = grantType;\n        this.redirectUri = redirectUri;\n        this.tokenUri = tokenUri;\n        this.restTemplate = restTemplateBuilder.build();\n        this.objectMapper = objectMapper;\n    }\n\t\t...\n}\n```\n\nê°„ë‹¨í•˜ê²Œ ì ìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ê³µí†µìœ¼ë¡œ ë¬¶ì¸ í”„ë¡œí¼í‹°ê°€ ë§ì•„ì§ˆ ê²½ìš° ì½”ë“œê°€ ì§€ì €ë¶„í•´ì§„ë‹¤. ì´ëŸ¬í•œ í”„ë¡œí¼í‹° ê°’ë“¤ì„ ê°ì²´ë¡œ ë§¤í•‘í•˜ì—¬ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ `@ConfigurationProperties`ê°€ ì¡´ì¬í•œë‹¤.\n\n## @ConfigurationProperties\n\nìš°ë¦¬ëŠ” ë•Œë•Œë¡œ DB ì„¤ì •ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ `application.yml`ì„ í†µí•´ ê´€ë ¨ ì •ë³´ë¥¼ ì‘ì„±í•˜ê³¤ í•œë‹¤. ì•„ë˜ëŠ” ê°„ë‹¨í•œ h2 DBë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•œ ì„¤ì •ì„ ì ì€ ì˜ˆì‹œì´ë‹¤.\n\n```yaml\nspring:\n  datasource:\n    url: jdbc:h2:~/dallog;MODE=MYSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE\n    username: sa\n```\n\nì´ëŸ¬í•œ ì„¤ì •ë“¤ì€ ì–´ë””ì„œ ì–´ë–»ê²Œ í™œìš©ë˜ê³  ìˆì„ê¹Œ? ì‹¤ì œ ë°”ì¸ë”© ë˜ê³  ìˆëŠ” ê°ì²´ë¥¼ ë”°ë¼ê°€ë³´ì.\n\n```java\n@ConfigurationProperties(prefix = \"spring.datasource\")\npublic class DataSourceProperties implements BeanClassLoaderAware, InitializingBean {\n\t\n    private ClassLoader classLoader;\n    private boolean generateUniqueName = true;\n\tprivate String name;\n\tprivate Class<? extends DataSource> type;\n\tprivate String driverClassName;\n\tprivate String url;\n    ...\n}\n```\n\nìœ„ `DataSourceProperties`ëŠ” ìš°ë¦¬ê°€ `application.yml`ì— ì‘ì„±í•œ ì„¤ì • ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°ì²´ë¡œ ì¶”ì¶œí•˜ê³  ìˆë‹¤. ì´ê²ƒì€ Spring Bootì˜ ìë™ì„¤ì •ìœ¼ë¡œ `DataSource`ê°€ ë¹ˆìœ¼ë¡œ ì£¼ì…ë˜ëŠ” ì‹œì ì— ì„¤ì • ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ìƒì„±ëœë‹¤. \n\nê°„ë‹¨íˆ ë””ë²„ê¹…ì„ ì§„í–‰í•´ë³´ë©´ Beanì´ ì£¼ì…ë˜ëŠ” ì‹œì ì— ì•„ë˜ì™€ ê°™ì´ `application.yml`ì— ëª…ì‹œí•œ ê°’ë“¤ì„ ì¶”ì¶œí•œ `DataSourceProperties`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±í•˜ê³  ìˆë‹¤.\n\n![](debug-1.png)\n\n![](debug-2.png)\n\nì •ë¦¬í•˜ë©´ ìš°ë¦¬ëŠ” Spring Bootë¥¼ ì‚¬ìš©í•˜ë©° ìì—°ìŠ¤ëŸ½ê²Œ `@ConfigurationProperties`ë¥¼ í™œìš©í•˜ì—¬ ë§Œë“  ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.\n\nì´ì œ ìš°ë¦¬ê°€ ì‘ì„±í•œ ì„¤ì • ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ í™œìš©í•´ë³´ì. ì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” `application.yml`ì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\n\n```yaml\n...\noauth:\n  google:\n    client-id: ${GOOGLE_CLIENT_ID}\n    client-secret: ${GOOGLE_CLIENT_SECRET}\n    redirect-uri: ${GOOGLE_REDIRECT_URI}\n    oauth-end-point: https://accounts.google.com/o/oauth2/v2/auth\n    response-type: code\n    scopes:\n        - https://www.googleapis.com/auth/userinfo.profile\n        - https://www.googleapis.com/auth/userinfo.email\n    token-uri: ${GOOGLE_TOKEN_URI}\n    grant-type: authorization_code\n...\n```\n\nì´ê²ƒì„ ê°ì²´ë¡œ ì¶”ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì•¼ í•œë‹¤.\n\n```java\n@ConfigurationProperties(\"oauth.google\")\n@ConstructorBinding\npublic class GoogleProperties {\n\n    private final String clientId;\n    private final String clientSecret;\n    private final String redirectUri;\n    private final String oAuthEndPoint;\n    private final String responseType;\n    private final List<String> scopes;\n    private final String tokenUri;\n    private final String grantType;\n\n    public GoogleProperties(final String clientId, final String clientSecret, final String redirectUri,\n                            final String oAuthEndPoint, final String responseType, final List<String> scopes,\n                            final String tokenUri, final String grantType) {\n        this.clientId = clientId;\n        this.clientSecret = clientSecret;\n        this.redirectUri = redirectUri;\n        this.oAuthEndPoint = oAuthEndPoint;\n        this.responseType = responseType;\n        this.scopes = scopes;\n        this.tokenUri = tokenUri;\n        this.grantType = grantType;\n    }\n\n    public String getClientId() {\n        return clientId;\n    }\n\n    public String getClientSecret() {\n        return clientSecret;\n    }\n\n    public String getRedirectUri() {\n        return redirectUri;\n    }\n\n    public String getoAuthEndPoint() {\n        return oAuthEndPoint;\n    }\n\n    public String getResponseType() {\n        return responseType;\n    }\n\n    public List<String> getScopes() {\n        return scopes;\n    }\n\n    public String getTokenUri() {\n        return tokenUri;\n    }\n\n    public String getGrantType() {\n        return grantType;\n    }\n}\n```\n\n- `@ConfigurationProperties`: í”„ë¡œí¼í‹°ì— ìˆëŠ” ê°’ì„ í´ë˜ìŠ¤ë¡œ ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤. `@ConfigurationProperties`ëŠ” ê°’ì„ ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ `Setter`ê°€ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ `Setter`ë¥¼ ì—´ì–´ë‘˜ ê²½ìš° ë¶ˆë³€ì„±ì„ ë³´ì¥í•  ìˆ˜ ì—†ë‹¤. ì´ë•Œ ìƒì„±ìë¥¼ í†µí•´ ë°”ì¸ë”© í•˜ê¸° ìœ„í•´ì„œëŠ” `@ConstructorBinding`ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.\n- `@ConstructorBinding`: ì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ìƒì„±ìë¥¼ í†µí•´ ë°”ì¸ë”©í•˜ê¸° ìœ„í•œ ëª©ì ì˜ ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\n\n```java\n@Configuration\n@EnableConfigurationProperties(GoogleProperties.class)\npublic class PropertiesConfig {\n}\n```\n\n- `@EnableConfigurationProperties`: í´ë˜ìŠ¤ë¥¼ ì§€ì •í•˜ì—¬ ìŠ¤ìºë‹ ëŒ€ìƒì— í¬í•¨ì‹œí‚¨ë‹¤.\n\n### ê°œì„ í•˜ê¸°\n\n```java\n@Component\npublic class GoogleOAuthClient implements OAuthClient {\n\n    private static final String JWT_DELIMITER = \"\\\\.\";\n\n    private final GoogleProperties googleProperties;\n    private final RestTemplate restTemplate;\n    private final ObjectMapper objectMapper;\n\n    public GoogleOAuthClient(final GoogleProperties googleProperties, final RestTemplateBuilder restTemplateBuilder,\n                             final ObjectMapper objectMapper) {\n        this.googleProperties = googleProperties;\n        this.restTemplate = restTemplateBuilder.build();\n        this.objectMapper = objectMapper;\n    }\n    ...\n}\n```\n\nì´ì „ ë³´ë‹¤ ì ì€ ìˆ˜ì˜ í•„ë“œë¥¼ í™œìš©í•˜ì—¬ ì„¤ì • ì •ë³´ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ ê°œì„ ë˜ì—ˆë‹¤.\n\n### ì •ë¦¬\n\n ìš°ë¦¬ëŠ” `application.yml` í˜¹ì€ `application.properties`ì— ì‘ì„±í•˜ì—¬ ë©”íƒ€ ì •ë³´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ê´€ë¦¬í•  ê²½ìš° ìˆ˜ì •í•˜ê¸° ìœ„í•´ì„œëŠ” í•´ë‹¹ í´ë˜ìŠ¤ì— ì§ì ‘ ì ‘ê·¼í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ì„¤ì • íŒŒì¼ë¡œ ë¶„ë¦¬í•  ê²½ìš° ìš°ë¦¬ëŠ” í™˜ê²½ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ê°’ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ë˜í•œ `@ConfigurationProperties` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ê²½ìš° í´ë˜ìŠ¤ë¡œ ê°’ì„ ë°”ì¸ë”©í•˜ê¸° ë•Œë¬¸ì— ì—°ê´€ëœ ê°’ì„ í•œ ë²ˆì— ë°”ì¸ë”©í•  ìˆ˜ ìˆë‹¤.\n\n## References.\n\n[ë‹¬ë¡ repository](https://github.com/woowacourse-teams/2022-dallog)<br>\n[[Spring] @Valueì™€ @ConfigurationPropertiesì˜ ì‚¬ìš©ë²• ë° ì°¨ì´ - (2/2)](https://mangkyu.tistory.com/207)<br>\n[appendix.configuration-metadata.annotation-processor](https://docs.spring.io/spring-boot/docs/2.7.1/reference/html/configuration-metadata.html#appendix.configuration-metadata.annotation-processor)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Rest Docs Spring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ Rest API ë¬¸ì„œë¥¼ ì‘ì„± í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”„ë ˆì„ ì›Œí¬ì´ë‹¤. Rest Docsì™€ Swagger ìë°” ë¬¸ì„œ ìë™í™”ì—ëŠ” ì£¼ë¡œ Rest Docsì™€ Swaggerê°€ ì‚¬ìš©ëœë‹¤.\nê° ìë™í™” í”„ë ˆì„ ì›Œí¬ì˜ ì¥ë‹¨ì ì„ ì‚´í´ë³´ì.\nâ€¦","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"date":"July 26, 2022","title":"MockMvcë¥¼ ì‚¬ìš©í•œ Spring RestDocs","tags":["Spring","Rest API"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## Rest Docs\nSpring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ Rest API ë¬¸ì„œë¥¼ ì‘ì„± í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”„ë ˆì„ ì›Œí¬ì´ë‹¤.\n\n## Rest Docsì™€ Swagger\nìë°” ë¬¸ì„œ ìë™í™”ì—ëŠ” ì£¼ë¡œ Rest Docsì™€ Swaggerê°€ ì‚¬ìš©ëœë‹¤.\nê° ìë™í™” í”„ë ˆì„ ì›Œí¬ì˜ ì¥ë‹¨ì ì„ ì‚´í´ë³´ì.\n![](./compare.png)\n\nSwaggerëŠ” API ë¬¸ì„œì˜ ì‘ì„±ì„ ìœ„í•´ í”„ë¡œë•ì…˜ ì½”ë“œì— ì¶”ê°€ì ì¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤. \nê·¸ë˜ì„œ Swaggerì˜ ì‚¬ìš©ì€ í”„ë¡œë•ì…˜ ì½”ë“œì˜ ê°€ë…ì„±ì„ ë–¨ì–´íŠ¸ë¦°ë‹¤ê³  ìƒê°í•œë‹¤.\n\në°˜ëŒ€ë¡œ, Spring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì˜ì¡´ì ì´ê¸° ë•Œë¬¸ì— Spring Rest Docsë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤ê³  ìƒê°í•œë‹¤.\n\n## MockMvc vs Rest Assured\nSpring Rest Docsë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì„œë¥¼ ì‘ì„± í•˜ë ¤ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤.\ní…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„± í•  ë•Œ, ëŒ€í‘œì ìœ¼ë¡œ MockMvcì™€ Rest Assuredë¥¼ ì‚¬ìš©í•œë‹¤.\n\nMockMvcë¥¼ ì‚¬ìš©í•˜ë©´  `@WebMvcTest`ë¡œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆë‹¤.\nê·¸ë˜ì„œ Controller Layerë§Œìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ë¹ ë¥´ë‹¤.\n\në°˜ë©´, RestAssuredëŠ” `@SpringBootTest`ë¡œ ìˆ˜í–‰í•´ì•¼í•œë‹¤. ê·¸ëŸ¬ë©´ ì „ì²´ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¡œë“œí•˜ì—¬ ë¹ˆì„ ì£¼ì…í•˜ê¸°ì— í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ëŠë¦¬ë‹¤.\ní•˜ì§€ë§Œ, ì‹¤ì œ ê°ì²´ë¥¼ í†µí•œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ì˜ ì‹ ë¢°ì„±ì´ ë†’ë‹¤.\n\ní†µí•© í…ŒìŠ¤íŠ¸, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° RestAssuerdê°€ ì¢‹ì„ ìˆ˜ ìˆì§€ë§Œ, ë¬¸ì„œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ í…ŒìŠ¤íŠ¸ì—ëŠ” MockMvcê°€ ë” ì ì ˆí•˜ë‹¤ê³  ìƒê°í•œë‹¤.\n\n**_ğŸ’¡ @WebMvcTestì™€ @SpringBootTest_**\n@WebMvcTestëŠ” Application Contextë¥¼ ì™„ì „í•˜ê²Œ Startí•˜ì§€ ì•Šê³  Present Layer ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ë§Œ ìŠ¤ìº”í•˜ì—¬ ë¹ˆ ë“±ë¡í•œë‹¤.\në°˜ë©´, @SpringBootTestì˜ ê²½ìš° ëª¨ë“  ë¹ˆì„ ë¡œë“œí•˜ì—¬ ë“±ë¡í•œë‹¤.\n\n\n## AsciiDoc\n\nSpring Boot Rest DocsëŠ” Asciidocë¥¼ ë¬¸ì„œ ë²ˆì—­ì„ ìœ„í•œ í…ìŠ¤íŠ¸ í”„ë¡œì„¸ì„œë¡œ ì‚¬ìš©í•œë‹¤.\n\n## Rest Docs API ë¬¸ì„œ ìƒì„± ë§¤ì»¤ë‹ˆì¦˜\nìš°ì„ , Rest Docsì˜ ë¬¸ì„œ ìƒì„± ë§¤ì»¤ë‹ˆì¦˜ì„ ì‚´í´ë³´ì.\n\n1. MockMvcë¡œ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.\n\n2. í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ `build/generated-snippets` í•˜ìœ„ì— ìŠ¤ë‹ˆí«(ë¬¸ì„œì¡°ê°)ë“¤ì´ ìƒì„±ëœë‹¤. \n![](./first.png)\n\n   _â—â— gradleì€ build/generated-snippetsì— ìŠ¤ë‹ˆí«ì´ ìƒì„±ëœë‹¤._\n\n3. `build/generated-snippets` í•˜ìœ„ì— ìƒì„±ëœ ìŠ¤ë‹ˆí«ë“¤ì„ ë¬¶ì–´ì„œ HTML ë¬¸ì„œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ”, gradleì˜ ê²½ìš° ì•„ë˜ì™€ ê°™ì´`src/docs/asciidoc` í•˜ìœ„ì— ìŠ¤ë‹ˆí«ë“¤ì„ ë¬¶ì€ adocë¬¸ì„œë¥¼ ë§Œë“ ë‹¤.![](./second.png)\n\n4. ìŠ¤ë‹ˆí«ì„ ì´ìš©í•´ì„œ `src/docs/asciidoc` í•˜ìœ„ì— adoc íŒŒì¼ì„ ìƒì„±í–ˆë‹¤ë©´, `./gradlew build` ëª…ë ¹ì–´ë¥¼ í†µí•´ ë¹Œë“œë¥¼ í•´ì¤€ë‹¤.\n![](./third.png)\në¹Œë“œê°€ ì™„ë£Œë˜ë©´ ìœ„ì™€ ê°™ì´ `resources - static - docs` í•˜ìœ„ì— HTML ë¬¸ì„œê°€ ìƒì„±ëœë‹¤.\n\n5. ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ í•œ í›„, `http://localhost:8080/docs/{HTML íŒŒì¼ëª…}` ì„ ì›¹ë¸Œë¼ìš°ì €ì— ê²€ìƒ‰í•˜ë©´ ìƒì„±í•œ REST API ë¬¸ì„œë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. \n\n\t**â—â— APIë¬¸ì„œ urlì€ ì½”ë“œë¥¼ í†µí•´ ë³€ê²½ ê°€ëŠ¥í•˜ë‹¤.**\n    \n### â—ìœ ì˜í•  ì \nresources - static - docs í•˜ìœ„ì˜ HTML íŒŒì¼ì€ ì‹¤ì œë¡œëŠ” build.gradleì˜ ì„¤ì •íŒŒì¼ì— ë”°ë¼ì„œ ìœ„ì™€ê°™ì´ build - docs - asciidoc í•˜ìœ„ì˜ HTML íŒŒì¼ì„ ë³µì‚¬í•´ì˜¨ íŒŒì¼ì´ë‹¤.\n![](./four.png)\n\n### ì•„ì´ë””ì–´\nREST API ë¬¸ì„œë¥¼ í™•ì¸í•  ë•Œ, `http://localhost:8080/docs/{HTML íŒŒì¼ëª…}` ì„ í†µí•´ì„œ ì›¹ë¸Œë¼ìš°ì €ì— ì ‘ê·¼í•˜ì§€ ì•Šì•„ë„ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.\n![](./five.png)\nAsciiDoc í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë©´ ìœ„ì™€ê°™ì´, ì¸í…”ë¦¬ì œì´ ìƒì—ì„œë„ REST API ë¬¸ì„œë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í• ìˆ˜ ìˆë‹¤.  (âœ”ì„¤ì¹˜ ì¶”ì²œ)\n\n## Rest Docs ì‚¬ìš©ì„ ìœ„í•œ ë¹Œë“œíŒŒì¼ ì„¤ì •\n``` java\nplugins {\n    id 'org.asciidoctor.jvm.convert' version '3.3.2' // 1\n}\n\next {\n    snippetsDir = file('build/generated-snippets') // 2\n}\n\ntest { \n    outputs.dir snippetsDir // 3\n    useJUnitPlatform()\n}\n\nconfigurations {\n    asciidoctorExtensions\n}\n\nasciidoctor { // 4\n    configurations 'asciidoctorExtensions' \n    inputs.dir snippetsDir \n    dependsOn test\n}\n\ndependencies {\n    testImplementation 'org.springframework.restdocs:spring-restdocs-mockmvc' // 5\n    asciidoctorExtensions 'org.springframework.restdocs:spring-restdocs-asciidoctor' // 6\n}\n\ntask copyDocument(type: Copy) { // 7\n    dependsOn asciidoctor\n    \n    from file(\"build/docs/asciidoc\")\n    into file(\"src/main/resources/static/docs\")\n}\n\t\nbootJar { \n    dependsOn copyDocument // 8\n}\n  ```\n\n\n1. gradle7ë¶€í„° ì‚¬ìš©í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ asciidoc íŒŒì¼ ë³€í™˜, build ë””ë ‰í† ë¦¬ì— ë³µì‚¬í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ë‹¤.\n\n2. ìƒì„±ëœ ìŠ¤ë‹ˆí«ì„ ì €ì¥í•  ìœ„ì¹˜ë¥¼ ì •ì˜í•œë‹¤. gradleì€ `build/generated-snippets`ì— ìŠ¤ë‹ˆí«ì´ ìƒì„±ëœë‹¤.\n\n3. í…ŒìŠ¤íŠ¸ Taskì˜ ê²°ê³¼ ì•„ì›ƒí’‹ ë””ë ‰í† ë¦¬ë¥¼ `build/generated-snippets`ë¡œ ì§€ì •í•œë‹¤.\n\n4. asciidoctor Taskê°€ ì‚¬ìš©í•  ì¸í’‹ ë””ë ‰í† ë¦¬ë¥¼ `build/generated-snippets`ë¡œ ì§€ì •í•œë‹¤.\n\tdependsOn testë¡œ ë¬¸ì„œê°€ ì‘ì„±ë˜ê¸° ì „ì— í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤.\n    \n5. MockMvcë¥¼ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì˜ì¡´ì„±ì„ ì¶”ê°€ í•´ì¤€ë‹¤.\n\n6. ì¼ë°˜ í…ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³  HTML íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ì˜ì¡´ì„±ì„ ì¶”ê°€ í•´ì¤€ë‹¤.\n\n7. asciidoctor Taskë¡œ ìƒì„±í•œ `build/docs/asciidoc`íŒŒì¼ì„ `src/main/resources/static/docs`ë¡œ ë³µì‚¬í•œë‹¤.\n\n8. bootJar ì‹¤í–‰ì‹œ copyDocumentë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ë„ë¡ í•œë‹¤.\n\n\n--- \n\nâœ…MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs í…ŒìŠ¤íŠ¸ ì‘ì„±ì„ ì•Œì•„ë³´ê¸° ì „ì— ìš°ì„  MockMvcì— ëŒ€í•´ ì•Œì•„ë³´ì.\n\n##MockMvc ê¸°ë³¸ ë©”ì„œë“œ\nì–´ë– í•œ ê²ƒë“¤ì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ê³  ë°‘ì—ì„œ ìì„¸íˆ ì•Œì•„ë³´ì.\n\n### perform()\nê°€ìƒì˜ requestë¥¼ ì²˜ë¦¬í•œë‹¤.\n\n```java\nmockMvc.perform(get(\"/api/schedules/?year=2022&month=7\"))\n```\n\n### andExpert()\nandExpert()\n\nì˜ˆìƒê°’ì„ ê²€ì¦í•œë‹¤. \n\n```java\n.andExpect(status().isOk())\n// status ê°’ì´ ì •ìƒì¸ ê²½ìš°ë¥¼ ê¸°ëŒ€í•˜ê³  ë§Œë“  ì²´ì´ë‹ ë©”ì†Œë“œì˜ ì¼ë¶€\n\n.andExpect(content().contentType(\"application/json;charset=utf-8\"))\n//contentTypeì„ ê²€ì¦\n```\n\n### andDo()\nìš”ì²­ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë§¡ëŠ”ë‹¤. print() ë©”ì†Œë“œê°€ ì¼ë°˜ì ì´ë‹¤.\n\n```java\n.andDo(print())\n```\n\n### andReturn()\ní…ŒìŠ¤íŠ¸í•œ ê²°ê³¼ ê°ì²´ë¥¼ ë°›ì„ ë•Œ ì‚¬ìš©í•œë‹¤.\n\n```java\nMvcResult result = mockMvc.perform(get(\"/\"))\n.andDo(print())\n.andExpect(status().isOk())\n.andReturn();\n```\n\n## MockMvc ìš”ì²­ ë§Œë“¤ê¸°\nìš”ì²­ì„ ë§Œë“¤ ë•ŒëŠ” static ë©”ì„œë“œì¸ get, post, put, delete, fileUpload ë“±ì„ ì´ìš©í•´ì„œ MockHttpServletRequestBuilder ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì—ì„œ ì‹œì‘í•œë‹¤.\n\nMockHttpServletRequestBuilderëŠ” ServletRequestë¥¼ êµ¬ì„±í•˜ê¸°ì— í•„ìš”í•œ ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.\n![](./six.png)\nìœ„ ë©”ì„œë“œë“¤ì€ ë©”ì„œë“œ ì²´ì´ë‹ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì—, ì•„ë˜ì™€ ê°™ì´ ìš”ì²­ ë°ì´í„°ë¥¼ ì—°ê²°í•´ì„œ ì‘ì„±í•˜ë©´ëœë‹¤.\n\n\n```java \n@Test\n    void test() throws Exception {\n        MockHttpServletRequestBuilder builder = get(\"/api/schedules\")\n                .param(\"year\", \"2022\")\n                .param(\"month\", \"7\")\n                .accept(MediaType.APPLICATION_JSON)\n                .header(\"sessionId\", \"ì„¸ì…˜ì•„ì´ë””ì…ë‹ˆë‹¤.\");\n\n        mockMvc.perform(builder)\n                .andExpect(status().isOk());\n    }\n\n```\n_**â—â— ìœ ì˜ í•  ì **_\nMockMvc.perform() ì˜ íŒŒë¼ë¯¸í„° ê°’ì´ MockHttpServletRequestBuilderì˜ ìƒìœ„ ê°ì²´ì´ë‹¤. \n\nê·¸ë˜ì„œ perform() íŒŒë¼ë¯¸í„°ë¡œ ì•„ë˜ì™€ ê°™ì´ ë„£ì–´ì£¼ì–´ë„ ì‘ë™ëœë‹¤.\n```java\n@Test\n    void test() throws Exception {\n        mockMvc.perform(get(\"/api/schedules\")\n                .param(\"year\", \"2022\")\n                .param(\"month\", \"7\")\n                .accept(MediaType.APPLICATION_JSON)\n                .header(\"sessionId\", \"ì„¸ì…˜ì•„ì´ë””ì…ë‹ˆë‹¤.\"))\n                .andExpect(status().isOk());\n    }\n```\n\n## MockMvc ì‹¤í–‰ ê²°ê³¼ ê²€ì¦\nperform()ì€ ë°˜í™˜ ê°’ìœ¼ë¡œ ResultActionsê°€ ë°˜í™˜ëœë‹¤.\nResultActionsì˜ andExpectëŠ” ìš”ì²­ ì‹¤í–‰ ê²°ê³¼ë¥¼ ê²€ì¦ í•˜ë ¤ë©´ ResultMatcherë¥¼ ë„˜ê²¨ì¤˜ì„œ ê²€ì¦í•´ì•¼í•œë‹¤.\nResultMatcherëŠ” ë‹¤ìŒì˜ MockMvcResultMatchersê°€ ê°€ì§€ëŠ” static ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì–»ëŠ”ë‹¤.\n\nMockMvcResultMatchersëŠ” ë‹¤ìŒì˜ static ë©”ì„œë“œë¥¼ í†µí•´ ë‹¤ì–‘í•œ ResultMatcherë¥¼ ì œê³µí•œë‹¤.\n\n![](./seven.png)\n\nì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ì.\n```java\n\t@Test\n    void test() throws Exception {\n        mockMvc.perform(builder)\n                .andExpect(handler().handlerType(ScheduleController.class))\n                .andExpect(handler().methodName(\"save\"))\n                .andExpect(forwardedUrl(\"index\"))\n                .andExpect(header().stringValues(\"Content-Language\", \"en\"))\n                .andExpect(model().attribute(\"message\", \"ì €ì¥ì´ ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.\"))\n                .andExpect(status().isOk());\n    }\n```\n\n## MockMvc ì‹¤í–‰ ê²°ê³¼ ì²˜ë¦¬\nì‹¤í–‰ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë–„ëŠ” andDo ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.\nandDo ë©”ì„œë“œ ì˜ ì¸ìˆ˜ì—ëŠ” ì‹¤í–‰ ê²°ê³¼ë¥¼ ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” ResultHandlerë¥¼ ì§€ì •í•œë‹¤.\nMockMvcResultHandlersëŠ” ë‹¤ì–‘í•œ ResultHandlerë¥¼ ì œê³µí•˜ì§€ë§Œ print()ë¥¼ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.\n\n\n## MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs ìƒì„±\ní…ŒìŠ¤íŠ¸ ì½”ë“œì™€ í•¨ê»˜ MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs ìƒì„±ì„ ì•Œì•„ë³´ì.\n\n```java\n@WebMvcTest(ScheduleController.class)\n@AutoConfigureRestDocs // 1\nclass ScheduleControllerTest {\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @Autowired\n    private ObjectMapper objectMapper;\n\n    @MockBean // 2\n    private ScheduleService scheduleService;\n\n    @Test\n    void save() throws Exception {\n        // given\n        ScheduleCreateRequest request = new ScheduleCreateRequest(\"ì œëª©\", LocalDateTime.now(), LocalDateTime.now(), \"ë©”ëª¨\");\n\n        given(scheduleService.save(request))\n                .willReturn(1L); // 3\n\n        // when & then\n        mockMvc.perform(post(\"/api/schedules\")\n                        .content(objectMapper.writeValueAsString(request))\n                        .contentType(MediaType.APPLICATION_JSON)\n                        .accept(MediaType.APPLICATION_JSON))\n                .andExpect(status().isOk())\n                .andDo(document(\"schedule-save\", // 4\n                        requestFields(\n                                fieldWithPath(\"title\").type(JsonFieldType.STRING).description(\"ì œëª©\"),\n                                fieldWithPath(\"startDateTime\").type(JsonFieldType.STRING)\n                                        .description(\"2022-07-04T13:00\"),\n                                fieldWithPath(\"endDateTime\").type(JsonFieldType.STRING).description(\"2022-07-05T07:00\"),\n                                fieldWithPath(\"memo\").type(JsonFieldType.STRING).description(\"ë©”ëª¨ì…ë‹ˆë‹¤.\")\n                        )\n                ));\n    }\n}\n```\n\n1. target/generated-snippets dir ìƒì„±í•˜ê³  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ í†µí•´ snippetsë¥¼ ì¶”ê°€í•´ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\n\n2. `ScheduleService`ë¥¼ mockingì„ í•˜ê¸°ìœ„í•´ì„œ `@MockBean` ì„ ì„ ì–¸í•œë‹¤.\n\n3. mockingì„ í†µí•´ `ScheduleService` ë¥¼ í†µí•´ ë°›ì„ ì‘ë‹µê°’ì„ ì„¤ì •í•œë‹¤.\n\n4. test ìˆ˜í–‰ì‹œ `andDo(document(\"xxx\"))`ë¥¼ í†µí•´ì„œ `./build/generated-snippets` í•˜ìœ„ì— ë¬¸ì„œê°€ ì‘ì„±ëœë‹¤.\n\n\n---\n## ëë‚´ë©´ì„œ \nì´ìƒ Rest Docsì˜ ë§¤ì»¤ë‹ˆì¦˜, ì„¤ì • ê·¸ë¦¬ê³  MockMvcë¥¼ í™œìš©í•œ Rest Docs ìƒì„± ë°©ë²•ì„ ì‚´í´ë³´ì•˜ë‹¤.\ní”„ë¡œì íŠ¸ì— RestAssueredë¥¼ ì‚¬ìš©í•œ Rest Docsë¥¼ ì ìš©í•˜ë©´ì„œ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œë¥¼ ê²½í—˜í•˜ì˜€ëŠ”ë°,\ní…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ëŒ€í•´ì„œ ì¶”í›„ì— í¬ìŠ¤íŒ… í•´ë´ì•¼ê² ë‹¤.\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë“¤ì–´ê°€ê¸°ì— ì•ì„œ ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë¬¸ì œì ì„ ì‚´í´ë³´ê³  ê°ì²´ ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê¸°ìœ„í•œ JAVAì˜ JPAë¥¼ ê°€ë³ê²Œ ì–¸ê¸‰í•´ë³´ì•˜ë‹¤. ê·¸ë ‡ë‹¤ë©´, JPAëŠ” ì–´ë– í•œ ë§¤ì»¤ë‹ˆì¦˜ìœ¼ë¡œ JAVAì—ì„œ ì‘ë™í• ê¹Œ?\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ JPAì˜ êµ¬ë™ë°©ì‹ì„ ìì„¸íˆ ì•Œì•„ë³´ì.   JPA êµ¬ë™ë°©ì‹ ìš°ì„ , ì•„ë˜ì˜ ê·¸ë¦¼ì„ â€¦","fields":{"slug":"/mechanism-of-jpa/"},"frontmatter":{"date":"July 26, 2022","title":"JPA ì‘ë™ ë©”ì»¤ë‹ˆì¦˜","tags":["JPA"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n### ë“¤ì–´ê°€ê¸°ì— ì•ì„œ\nì´ì „ í¬ìŠ¤íŒ…ì—ì„œ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë¬¸ì œì ì„ ì‚´í´ë³´ê³  ê°ì²´ ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê¸°ìœ„í•œ JAVAì˜ JPAë¥¼ ê°€ë³ê²Œ ì–¸ê¸‰í•´ë³´ì•˜ë‹¤.\n\nê·¸ë ‡ë‹¤ë©´, JPAëŠ” ì–´ë– í•œ ë§¤ì»¤ë‹ˆì¦˜ìœ¼ë¡œ JAVAì—ì„œ ì‘ë™í• ê¹Œ?\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ JPAì˜ êµ¬ë™ë°©ì‹ì„ ìì„¸íˆ ì•Œì•„ë³´ì.  \n\n\n### JPA êµ¬ë™ë°©ì‹\nìš°ì„ , ì•„ë˜ì˜ ê·¸ë¦¼ì„ í†µí•´ JPAì˜ êµ¬ë™ë°©ì‹ì„ ê°€ë³ê²Œ ì‚´í´ë³´ì.\n\n![](./jpa-mechanism.png)\n\n\në¨¼ì €, JPAëŠ” Build íŒŒì¼ì„ í†µí•´ì„œ JPA ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•  **êµ¬í˜„ì²´ í´ë˜ìŠ¤ì¸** `Persistence` ìƒì„±í•œë‹¤. \n**(JPAëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë©° êµ¬í˜„ì²´ë¡œëŠ” Hibernate, EclipseLink ë“±ì´ ìˆìŒ)**\n\nê·¸ë¦¬ê³  ìƒì„±í•œ `Persistence`ë¡œ `META-INF/Persistence.xml`ë¼ëŠ” ì„¤ì •íŒŒì¼ì˜ ì •ë³´ë¥¼ ì½ì–´ì„œ `EntityManagerFactory`ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.\n\n`EntityManagerFactory`ëŠ” í•„ìš”í• ë•Œ ë§ˆë‹¤ `EntityManager` ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤. \n\nê°œë°œìëŠ” `EntityManager`ë¥¼ í†µí•´ì„œ DBì— ì ‘ê·¼í•˜ê³  CRUD ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.\n\nìœ„ì™€ ê°™ì€ ê³¼ì •ì„ í†µí•´ JPAë¥¼ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.\n\nê·¸ë ‡ë‹¤ë©´, `Persistence.xml`, `EntityManagerFactory`, `EntityManager`ë€ ë¬´ì—‡ì¼ê¹Œ?\nì•„ë˜ì—ì„œ ìì„¸íˆ ì‚´í´ë³´ì.\n\n### Persistence.xmlë€?\n`Persistence.xml`ì€ JPAê°€ ì—‘ì„¸ìŠ¤í•˜ë ¤ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë“¤ì— ëŒ€í•´ í•„ìš”í•œ ì„¤ì •ì •ë³´ ë“¤ì„ ê¸°ìˆ í•´ë‘” íŒŒì¼ì´ë‹¤.\nJPAëŠ” ì´ íŒŒì¼ì˜ ì„¤ì •ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì ‘ê·¼í•  DBì˜ ì •ë³´ë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ìˆë‹¤.\n\n`Persistence.xml` íŒŒì¼ì— ëŒ€í•´ ì•„ë˜ ê·¸ë¦¼ê³¼ í•¨ê»˜ ìì„¸íˆ ì‚´í´ë³´ì.\n\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<persistence version=\"2.2\"\n \txmlns=\"http://xmlns.jcp.org/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd\">\n\t<persistence-unit name=\"hello\">\n \t\t<properties>\n \t\t\t<!-- í•„ìˆ˜ ì†ì„± -->\n \t\t\t<property name=\"javax.persistence.jdbc.driver\" value=\"org.h2.Driver\"/>\n \t\t\t<property name=\"javax.persistence.jdbc.user\" value=\"sa\"/>\n \t\t\t<property name=\"javax.persistence.jdbc.password\" value=\"\"/>\n\t\t\t<property name=\"javax.persistence.jdbc.url\" value=\"jdbc:h2:tcp://localhost/~/test\"/>\n \t\t\t<property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.H2Dialect\"/>\n\n \t\t\t<!-- ì˜µì…˜ -->\n \t\t\t<property name=\"hibernate.show_sql\" value=\"true\"/>\n \t\t\t<property name=\"hibernate.format_sql\" value=\"true\"/>\n \t\t\t<property name=\"hibernate.use_sql_comments\" value=\"true\"/>\n \t\t\t<!--<property name=\"hibernate.hbm2ddl.auto\" value=\"create\" />-->\n \t\t</properties>\n\t</persistence-unit>\n</persistence> \n```\n\nì²«ë²ˆì§¸ë¡œ `<persistence version=\"2.2\" ...>`íƒœê·¸ëŠ” ì‚¬ìš©í•  JPAì˜ ë²„ì „ê³¼ ë²„ì „ì— ëŒ€í•œ Persistence.XML ë¬¸ì„œí˜•ì‹ ë§í¬ë¥¼ ë‹´ê³  ìˆë‹¤.\n\n`<persistence-unit name=\"hello\">`íƒœê·¸ëŠ” í•˜ë‚˜ì˜ ì§€ì†ì„± ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•œë‹¤. ì„œìˆ ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´, `hello`ë¼ëŠ” ì´ë¦„ì„ ê°€ì§€ëŠ” `EntityManagerFactory`ë¥¼ í•˜ìœ„ ì„¤ì •ì— ë”°ë¼ ë§Œë“¤ê²ƒì´ë¼ëŠ” ì˜ë¯¸ì´ë‹¤. \n\n`<properties>`ëŠ” `<persistence-unit>`ì´ ì—‘ì„¸ìŠ¤í•  DBì˜ ì •ë³´ì™€ ì¶”ê°€ì ì¸ ì˜µì…˜ ì •ë³´ë“¤ì„ ë‹´ëŠ”ë‹¤.\n\n`<property>`ëŠ” ì˜µì…˜ ì •ë³´ë¥¼ í•˜ë‚˜ì”© ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.\nìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ `í•„ìˆ˜ ì†ì„±` ë¶€ë¶„ì€ ì—‘ì„¸ìŠ¤í•  DBì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤.\n\nì¶”ê°€ë¡œ `ì˜µì…˜` ë¶€ë¶„ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ì.\n`hibernate.show_sql`ëŠ” DBì— ë‚ ë¦¬ëŠ” ì¿¼ë¦¬ë¬¸ì„ í™•ì¸ í• ê²ƒì¸ì§€ì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.\n`hibernate.format_sql`ëŠ” ë³´ì—¬ì§€ëŠ” ì¿¼ë¦¬ë¬¸ì„ í¬ë§·íŒ…í•˜ëŠ” ì„¤ì •ì´ë‹¤.\n`hibernate.use_sql_comments`ëŠ” ì¶”ê°€ì ì¸ `/* */` ì£¼ì„ì„ ì¿¼ë¦¬ë¬¸ì— ë³´ì—¬ì£¼ëŠ” ì„¤ì •ì´ë‹¤.\n\n`hibernate.hbm2ddl.auto` ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ìƒì„±ì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.\n`hibernate.hbm2ddl.auto`ê°€ ê°€ì§€ëŠ” ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ë‹¤.\n\n```\ncreate: ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ë‹¤ì‹œ ìƒì„± (DROP + CREATE)\ncreate-drop: createì™€ ê°™ìœ¼ë‚˜ ì¢…ë£Œì‹œì ì— í…Œì´ë¸” DROP\nupdate: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ë°˜ì˜ (ìš´ì˜ DBì— ì‚¬ìš©í•˜ë©´ ì•ˆëŒ)\nvalidate: entityì™€ tableì´ ì •ìƒ ë§¤í•‘ë˜ì—ˆëŠ”ì§€ë§Œ í™•ì¸\nnone: ì‚¬ìš©í•˜ì§€ ì•ŠìŒ\n```\n\n#### **ì£¼ì˜ì â—**\n**create, create-drop, updateëŠ” ìš´ì˜ DBì— ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.  \ncreate, create-dropì€ ìš´ì˜ DBì˜ ë°ì´í„°ë¥¼ ì „ì²´ ì‚­ì œ ì‹œí‚¤ê¸° ë•Œë¬¸ì´ë‹¤.\nupdateëŠ” ì•„ì§ ì•Œì•„ë³¼í•„ìš”ê°€ìˆìŒ**\n\nì´ì œ ì„¤ì •íŒŒì¼ì„ í†µí•´ ìƒì„±í•˜ëŠ” `EntityManagerFactory`ë¥¼ ì‚´í´ë³´ì.\n\n\n### EntityManagerFactoryë€?\n`EntityManagerFactory`ëŠ” `EntityManager`(Entityë¥¼ ê´€ë¦¬í•˜ê³  DB ê´€ë ¨ì‘ì—…ì„ ìˆ˜í–‰ í•¨)ì„ ìƒì„±í•˜ëŠ” ì¼ì„í•œë‹¤.\n\n**ğŸ’¡ `Entity` ëŠ” DB í…Œì´ë¸”ì— ëŒ€ì‘í•˜ëŠ” í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ì˜ë¯¸í•œë‹¤.**\n\nìš°ë¦¬ëŠ” `Persistence.xml` ì„¤ì •ì •ë³´ë¥¼ í†µí•´ì„œ `EntityManagerFactory`ë¥¼ ìƒì„±í• ìˆ˜ ìˆë‹¤.\n\nì•„ë˜ì˜ ì˜ˆì‹œì½”ë“œë¡œ ì‚´í´ë³´ì.\n``` java\npublic class JpaMain {\n\n    public static void main(String[] args) {\n        EntityManagerFactory emf = \n        \t\t\tPersistence.createEntityManagerFactory(\"hello\");\n        // íŒŒë¼ë¯¸í„°ë¡œ Persistence.xmlì— ì„¤ì •í•œ persistence-unitì˜ name ì†ì„±ê°’ì„ ë„£ëŠ”ë‹¤.\n        ...\n    }\n}\n```\n\nì „ ì¥ì—ì„œ ì„¤ì •í–ˆë˜ `Persistence.xml` íŒŒì¼ì„ í†µí•´ \nìš°ë¦¬ëŠ” `hello`ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ `<persistence-unit>`ì´ ì–´ë–¤ DBì— ì—‘ì„¸ìŠ¤ í•  ê²ƒì¸ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ì„¤ì •í–ˆì—ˆë‹¤.\n\nìœ„ ì½”ë“œê°€ ë°”ë¡œ `Persistence.xml`ì— ì‘ì„±í•œ Persistence Unit(ì§€ì†ì„± ë‹¨ìœ„)ì„ ë°”íƒ•ìœ¼ë¡œ `EntityManagerFactory`ë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œì´ë‹¤.\n\n`EntityManagerFactory`ë¥¼ í†µí•´ì„œ ìš°ë¦¬ëŠ” DB ê´€ë ¨ ì‘ì—…ì„ ì‹¤ì œë¡œ ìˆ˜í–‰í•  `EntityManager`ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë‹¤.\n\n#### ğŸ”`EntityManagerFactory`ê°€ ê°€ì§€ëŠ” íŠ¹ì§•\n**1. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” í•˜ë‚˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— í•˜ë‚˜ë§Œ ìƒì„±í•œë‹¤. (ìƒì„± ë¹„ìš©ì´ ë¹„ì‹¸ê¸° ë•Œë¬¸)**\n\n**2. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•´ë„ ì•ˆì „í•˜ë‹¤.**\n\n  \n### EntityManagerë€?\n\nì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” íŠ¹ì • ì‘ì—…ì„ ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤ í•˜ëŠ” ì—­í• ì„ í•œë‹¤.\në˜í•œ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— CRUD í•  ìˆ˜ ìˆë‹¤.\nì¦‰, ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ëª¨ë“  ì¼ì„ ì²˜ë¦¬í•˜ê¸°ì— ì´ë¦„ ê·¸ëŒ€ë¡œ ì—”í‹°í‹°ë¥¼ ê´€ë¦¬í•˜ëŠ” ê´€ë¦¬ìë‹¤.\n\n``` java\npublic class JpaMain {\n\n    public static void main(String[] args) {\n        EntityManagerFactory emf = \n        \t\t\tPersistence.createEntityManagerFactory(\"hello\");\n        // íŒŒë¼ë¯¸í„°ë¡œ Persistence.xmlì— ì„¤ì •í•œ persistence-unitì˜ name ì†ì„±ê°’ì„ ë„£ëŠ”ë‹¤.\n        \n        EntityManager em = emf.createEntityManager();\n        ...\n    }\n}\n```\n\nìœ„ì™€ ê°™ì´ `EntityManagerFactory`ë¥¼ í†µí•´ì„œ `EntityManager`ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë‹¤.\n\n#### ğŸ”`EntityManager`ê°€ ê°€ì§€ëŠ” íŠ¹ì§•\n**1. ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” DB connectionê³¼ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì—, ìŠ¤ë ˆë“œ ê°„ì— ê³µìœ í•˜ê±°ë‚˜ ì¬ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.**\n\n**2. ì—”í‹°í‹° ë§¤ë‹ˆì €ì˜ CRUD ì‘ì—…ì€ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì²˜ë¦¬ í•´ì•¼í•œë‹¤.**\n\n#### **ì£¼ì˜ì â—**\n**EntityManagerì˜ ì‘ì—…ì€ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì§„í–‰ë˜ì–´ì•¼í•œë‹¤.\nì™œëƒí•˜ë©´, CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ë‹¤ê°€ ì¤‘ê°„ì— ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš° íŠ¸ëœì­ì…˜ ì´ì „ì˜ ìƒíƒœë¡œ ëŒì•„ê°€ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.**\n\n\në§ˆì§€ë§‰ìœ¼ë¡œ ì½”ë“œë¥¼ í†µí•´ `EntityManagerFactory` ìƒì„±ë¶€í„° DBì— ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì„ ì‚´í´ë³´ì.\n\n### JPAì˜ êµ¬ë™ê³¼ì •\nJAVA ì½”ë“œìƒì—ì„œ `JPA`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ëŠ” ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ë‹¤.\n\n```java\npublic class JpaMain {\n\n    public static void main(String[] args) {\n        EntityManagerFactory emf = \n        \t\t\tPersistence.createEntityManagerFactory(\"hello\"); \n                    // ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±\n        EntityManager em = emf.createEntityManager(); // ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±\n        \n        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜ ìƒì„±\n        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘\n\n        try {\n        \tMember member = new Member() // ë©¤ë²„ ì—”í‹°í‹° ìƒì„±\n            member.setId(100L)\n            member.setName(\"JPA\")\n            \n            em.persist(member) // ë©¤ë²„ ì—”í‹°í‹° ë°ì´í„°ë¥¼ ì €ì¥\n        \n            tx.commit(); // íŠ¸ëœì­ì…˜ ì»¤ë°‹\n        } catch (Exception e) {\n            tx.rollback(); // íŠ¸ëœì­ì…˜ ë¡¤ë°±\n        } finally {\n            em.close(); // ì—”í‹°í‹° ë§¤ë‹ˆì € ì—°ê²° ì¢…ë£Œ\n        }\n        emf.close();\n    }\n}\n```\n1. Persistence.xml ì„¤ì •íŒŒì¼ì˜ Persistence Unitì„ í†µí•´ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ìƒì„±í•œë‹¤.\n\n2. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¡œ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±í•œë‹¤. \n\n3. ì—”í‹°í‹° ë§¤ë‹ˆì €ì— ëŒ€í•œ íŠ¸ëœì­ì…˜ì„ ìƒì„±í•œë‹¤.\n\n4. íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤.\n\n5. DBì— ì €ì¥í•  ë©¤ë²„ ì—”í‹°í‹°ë¥¼ ìƒì„±í•œë‹¤.\n\n6. em.persist(member)ë¥¼ í†µí•´ ì—”í‹°í‹° ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.\n\n7. íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•œë‹¤.\n\n8. ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ë‹«ëŠ”ë‹¤.\n\n9. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ë‹«ëŠ”ë‹¤.\n\n\nìœ„ì™€ ê°™ì€ ê³¼ì •ì„ í†µí•´ DBì— ë°ì´í„°ë¥¼ ì €ì¥ í•  ìˆ˜ ìˆë‹¤.\n\n`em.persist()` ë©”ì„œë“œëŠ” íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ì˜¨ ì—”í‹°í‹°ì— ëŒ€í•œ insert ì¿¼ë¦¬ë¬¸ì„ JPAê°€ ì‘ì„±í•˜ì—¬ DBì— ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.\n\nì–¼í• ë³´ë©´, `em.persist(member)`ë¥¼ ì‹¤í–‰í• ë•Œ ë°ì´í„°ê°€ ë°”ë¡œ DBì— ì €ì¥ ë  ê²ƒ ê°™ë‹¤.\n\ní•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” `Member` ì—”í‹°í‹°ê°€ `EntityManager`ì˜ ì˜ì† ì»¨í…ìŠ¤íŠ¸ë¼ëŠ” ê³µê°„ì— ì €ì¥ë˜ê³  íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë˜ëŠ” ì‹œì ì— DBì— `Member` ì—”í‹°í‹°ì— ëŒ€í•œ insert ì¿¼ë¦¬ë¬¸ì´ ë‚ ë¼ê°„ë‹¤.\n\nì™œ ë°”ë¡œ, DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ì§€ ì•Šê³  ì˜ì† ì»¨í…ìŠ¤íŠ¸ì— ë°ì´í„°ë¥¼ ì €ì¥í• ê¹Œ? ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ì•Œì•„ë³´ì.\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ë°”ë¡œ ì§ì „ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ ë°±ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œí•´ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì„±ì„ ì†Œê°œí•´ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë°”ë¡œ ì‹œì‘í• ê¹Œìš”? í”„ë¡ íŠ¸ì—”ë“œ CD ë‹¤ì´ì–´ê·¸ë¨  í”„ë¡ íŠ¸ì—”ë“œì˜ ì§€ì†ì  ë°°í¬ ê³¼ì •â€¦","fields":{"slug":"/continuous-deploy-with-jenkins-2-frontend/"},"frontmatter":{"date":"July 24, 2022","title":"ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸° (2) - í”„ë¡ íŠ¸ì—”ë“œí¸","tags":["DevOps"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ë°”ë¡œ [ì§ì „ í¬ìŠ¤íŒ…](https://dallog.github.io/continuous-deploy-with-jenkins-1-backend/)ìœ¼ë¡œ ë‹¬ë¡íŒ€ ë°±ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œí•´ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì„±ì„ ì†Œê°œí•´ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë°”ë¡œ ì‹œì‘í• ê¹Œìš”?\n\n## í”„ë¡ íŠ¸ì—”ë“œ CD ë‹¤ì´ì–´ê·¸ë¨\n\n![í”„ë¡ íŠ¸ì—”ë“œ ì§€ì†ì  ë°°í¬ í™˜ê²½](./fe.png)\n\ní”„ë¡ íŠ¸ì—”ë“œì˜ ì§€ì†ì  ë°°í¬ ê³¼ì •ì€ ì‚¬ì‹¤ ë°±ì—”ë“œê³¼ í¬ê²Œ ë‹¤ë¥¸ì ì´ ì—†ìŠµë‹ˆë‹¤. PRì´ ìƒì„±ë˜ê³ , ë³‘í•©ë˜ê³ , ì´ ì´ë²¤íŠ¸ê°€ Webhookì„ í†µí•´ ì  í‚¨ìŠ¤ ì„œë²„ì— ì „ë‹¬ë©ë‹ˆë‹¤.\n\nì  í‚¨ìŠ¤ ì„œë²„ëŠ” Webpackì„ ì´ìš©í•˜ì—¬ ë¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , `index.html`ê³¼ `bundle.js`ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë‹¬ë¡ì˜ í”„ë¡ íŠ¸ì—”ë“œ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” **NGINXê°€ ë„ì»¤ ì»¨í…Œì´ë„ˆ**ë¡œ ë„ì›Œì ¸ ìˆëŠ”ë°ìš”, ìƒì„±ëœ ì •ì íŒŒì¼ì€ ì´ NGINX ë””ë ‰í† ë¦¬ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.\n\n## íŒŒì´í”„ë¼ì¸ ì…‹ì—…\n\n### ì‚¬ì „ ì‘ì—…\n\në‹¬ë¡íŒ€ í”„ë¡ íŠ¸ì—”ë“œ íŒ€ì€ ë¦¬ì•¡íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ë‹¬ë¡íŒ€ì€ ëª¨ë“ˆ ë²ˆë“¤ëŸ¬ë¡œ **ì›¹íŒ©(Webpack)**ì„ ì±„íƒí•˜ì—¬ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì›¹íŒ©ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œëŠ” ë¹Œë“œ ì„œë²„ì— **node.js**ê°€ ì„¤ì¹˜ë˜ì–´ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\n\nì´ë¥¼ ìœ„í•´ì„œ ë‹¬ë¡íŒ€ì€ ì  í‚¨ìŠ¤ì— `NodeJS` í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•œ ì´í›„ ì‚¬ìš©í•  node.jsì˜ ë²„ì „ì„ ì„ íƒí•´ì•¼í•©ë‹ˆë‹¤. **Jenkins ê´€ë¦¬ > Global Tool Configuration > NodeJS > NodeJS Installation** ì— ë“¤ì–´ê°€ ì‚¬ìš©í•  node.js ë²„ì „ì„ ì„ íƒí•˜ê³  ì´ë¦„ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤.\n\në‹¬ë¡íŒ€ì€ ê°œë°œ í™˜ê²½ì—ì„œ node.js 16.14.0ì„ ì‚¬ìš©í•˜ë¯€ë¡œ 16.14.0 ë²„ì „ì„ ì„ íƒí•˜ê³  ì´ë¦„ì„ `NodeJS 16.14.0`ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\n\n### íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸\n\n```groovy\npipeline {\n   agent any\n   stages {\n       stage('Github') {\n           steps {\n               git branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\n           }\n       }\n       stage('Build') {\n           steps {\n               dir('frontend') {\n                   nodejs(nodeJSInstallationName: 'NodeJS 16.14.0') {\n                        sh 'npm install && npm run build'\n                    }\n               }\n           }\n       }\n       stage('Deploy') {\n           steps {\n               dir('frontend/dist') {\n                   sshagent(credentials: ['key-dallog']) {\n                        sh 'ls'\n                        sh 'scp ./index.html ubuntu@192.168.XXX.XXX:/home/ubuntu/'\n                        sh 'scp ./bundle.js ubuntu@192.168.XXX.XXX:/home/ubuntu/'\n                        sh 'ssh ubuntu@192.168.XXX.XXX \"sudo mv ./index.html ./html && sudo mv ./bundle.js ./html\"'\n                   }\n               }\n           }\n       }\n   }\n}\n```\n\n#### Build stage\n\n`nodejs` Directiveë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©í•  NodeJS Installationì˜ ì´ë¦„ì„ ì…ë ¥í•˜ê³ , ì‹¤í–‰í•  ëª…ë ¹ì„ ì…ë ¥í•©ë‹ˆë‹¤. `npm install` ë¡œ í•„ìš”í•œ ëª¨ë“ˆì„ ì„¤ì¹˜í•˜ê³ , `npm run build` ëª…ë ¹ìœ¼ë¡œ ë¹Œë“œí•©ë‹ˆë‹¤.\n\n#### Deploy stage\n\në°±ì—”ë“œì™€ ë§ˆì°¬ê°€ì§€ë¡œ `sshagent` ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ ì„œë²„ì— SSHë¡œ ì ‘ì†í•©ë‹ˆë‹¤. ë¹Œë“œëœ ë‘ê°œì˜ íŒŒì¼ `index.html`ê³¼ `bundle.js` ì„ ì „ì†¡í•©ë‹ˆë‹¤.\n\nì´í›„ ì „ì†¡ëœ íŒŒì¼ì„ ì›ê²©ì§€ì˜ sudo ê¶Œí•œìœ¼ë¡œ `html` ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•©ë‹ˆë‹¤. ì´ `html` ë””ë ‰í† ë¦¬ëŠ” ì´í›„ ì„¤ëª…í•˜ê² ì§€ë§Œ, NGINX ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ ë””ë ‰í† ë¦¬ì™€ ë§ˆìš´íŒ…ëœ ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ë°°í¬ ì„œë²„ì˜ Dockerê°€ sudo ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆìœ¼ë¯€ë¡œ, íŒŒì¼ì„ í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™ì‹œí‚¬ ë•Œì—ë„ sudo ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n## ë„ì»¤ ë° NGINX ì„¤ì •\n\n### docker-compose\n\në§¨ ìœ„ì˜ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ê°™ì´ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ ì„œë²„ëŠ” NGINXê°€ ë„ì»¤ë¡œ ë„ì›Œì ¸ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•œ **docker-compose.yml** ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\n\n```yaml\nversion: \"3\"\nservices:\n  dallog-front:\n    image: nginx\n    volumes:\n      - ./html:/usr/share/nginx/html\n    ports:\n      - 80:80\n```\n\n`/usr/share/nginx/html` ë””ë ‰í† ë¦¬ëŠ” NGINXê°€ ì„œë¹™í•  ì •ì  íŒŒì¼ì´ ìœ„ì¹˜ë  ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ì´ë¥¼ ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì˜ `./html` ë””ë ‰í† ë¦¬ì™€ ë³¼ë¥¨ ë§ˆìš´íŒ… ì„¤ì •ì„ í•´ë‘ì—ˆìŠµë‹ˆë‹¤.\n\n### í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ… ëŒ€ì‘\n\në‹¬ë¡ì€ ë¦¬ì•¡íŠ¸ ë¼ìš°í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ…ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë¥¼ ìœ„í•´ì„œ NGINXì— ë³„ë„ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. `index.html` ë¡œ ì ‘ì†í•˜ë©´ html íŒŒì¼ì„ ì˜ ì°¾ì„ ìˆ˜ ìˆì§€ë§Œ, ê·¸ ì™¸ì˜ ë¼ìš°íŠ¸ë¡œ ì ‘ì†í•œë‹¤ë©´ html íŒŒì¼ ìì²´ë¥¼ ì°¾ì§€ ëª»í•´ 404 ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\n\në„ì»¤ ë‚´ë¶€ì˜ `/etc/nginx/conf.d/default.conf` íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.\n\n```\n...\n\nlocation / {\n\t    root   /usr/share/nginx/html;\n\t    index  index.html index.htm;\n\t    try_files $uri $uri/ /index.html;\n}\n\n...\n```\n\nì•Œ ìˆ˜ ì—†ëŠ” ë¼ìš°íŠ¸ë¡œ ì ‘ì†í–ˆì„ ë•Œ ìë™ìœ¼ë¡œ `index.html` ë¡œ Fallback ë˜ë„ë¡ `try_files` ì„¤ì •ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ìˆ˜ì •í•˜ê³  ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•´ì£¼ë©´ ì„¤ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤.\n\n## íŠ¸ëŸ¬ë¸” ìŠˆíŒ…\n\n### ë¹Œë“œ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ\n\në¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•  ë•Œ ì•„ë˜ì™€ ê°™ì€ ë©”ëª¨ë¦¬ ì´ìŠˆë¥¼ ë§ˆì£¼í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n```\n<--- Last few GCs --->\n\n[21854:0x147b3960]    21931 ms: Scavenge 456.7 (469.5) -> 456.4 (470.7) MB, 3.2 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure\n[21854:0x147b3960]    21939 ms: Scavenge 457.4 (470.7) -> 457.2 (475.2) MB, 4.5 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure\n\n\n<--- JS stacktrace --->\n\nFATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory\n 1: 0xaf9c78 node::Abort() [webpack]\n 2: 0xa21a88 node::FatalError(char const*, char const*) [webpack]\n 3: 0xccdec8 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [webpack]\n```\n\n**Jenkins ê´€ë¦¬ > ì‹œìŠ¤í…œ ì„¤ì • > Global Properties** ì—ì„œ `NODE_OPTIONS` í™˜ê²½ë³€ìˆ˜ë¥¼ `-max-old-space-size=3072` ë¡œ ì„¤ì •í•˜ì—¬ ë©”ëª¨ë¦¬ ì´ìŠˆë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.\n\n## ë§ˆì¹˜ë©°\n\ní˜„ì¬ ìƒì„±ëœ PRì— ëŒ€í•œ ì½”ë“œë¥¼ ê²€ì‚¬í•˜ê³  ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ì§€ ì•Šì€ PRì˜ ë³‘í•©ì„ ë§‰ê¸° ìœ„í•´ Github Actionsë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ ì¡°ê¸ˆ ë” í•™ìŠµí•˜ì—¬ ì´í›„ ì´ëŸ° ì‘ì—…ê¹Œì§€ ì  í‚¨ìŠ¤ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ í•  ê³„íšì´ ìˆìŠµë‹ˆë‹¤.\n\në˜í•œ í˜„ì¬ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œ ëª¨ë‘ `develop` ì´ë¼ëŠ” í•˜ë‚˜ì˜ ë¸Œëœì¹˜ì—ì„œ ì‘ì—…ì„ í•˜ë‹¤ë³´ë‹ˆ ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ ì–´ëŠ í•œìª½ì˜ ì½”ë“œë§Œ ë³‘í•©ë˜ì–´ë„ ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ ë‘ê°œì˜ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ” ì´ìŠˆê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì´í›„ì—ëŠ” ë¹Œë“œ íŠ¸ë¦¬ê±°ë¥¼ ì¡°ê¸ˆ ë” ì„¸ë¶„í™”í•˜ì—¬ Githubì˜ ë¼ë²¨ì„ ê¸°ë°˜ìœ¼ë¡œ íŠ¸ë¦¬ê±° ë˜ë„ë¡ ê°œì„ í•  ê³„íšì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ê¹Œì§€ ë‹¬ë¡íŒ€ì˜ ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸°ë¥¼ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ™‚\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¬ë¡íŒ€ì´ ë„ì»¤ë¥¼ í™œìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ë„ì»¤ë¥¼ ì„¤ì¹˜í•œ ê³¼ì •ì„ ì´ì•¼ê¸° ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•´ì„œ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œì— ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì„±í•œ ê³¼ì •ì— ëŒ€í•´ ì´ì•¼ê¸° ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë‹¬ë¡íŒ€ ì§€ì†ì  ë°°í¬ í™˜ê²½ ì¼ë‹¨ í˜„ì¬ êµ¬ì„±ëœ ë‹¬ë¡íŒ€ì˜ â€¦","fields":{"slug":"/continuous-deploy-with-jenkins-1-backend/"},"frontmatter":{"date":"July 24, 2022","title":"ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸° (1) - ë°±ì—”ë“œí¸","tags":["DevOps"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nì•ˆë…•í•˜ì„¸ìš”, ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¬ë¡íŒ€ì´ ë„ì»¤ë¥¼ í™œìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ë„ì»¤ë¥¼ ì„¤ì¹˜í•œ ê³¼ì •ì„ ì´ì•¼ê¸° ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•´ì„œ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œì— ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì„±í•œ ê³¼ì •ì— ëŒ€í•´ ì´ì•¼ê¸° ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤.\n\n## ë‹¬ë¡íŒ€ ì§€ì†ì  ë°°í¬ í™˜ê²½\n\nì¼ë‹¨ í˜„ì¬ êµ¬ì„±ëœ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ ê°„ë‹¨í•œ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\n\n![ë°±ì—”ë“œ ì§€ì†ì  ë°°í¬ í™˜ê²½](./be.png)\n\nìš°ì„ , ë‹¬ë¡ì˜ ë°±ì—”ë“œ ê°œë°œìê°€ ì—´ì‹¬íˆ ê¸°ëŠ¥ì„ ê°œë°œí•˜ì—¬ Githubì— PRì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ë•Œ PR ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ê³ , ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ”ì§€ **Github Actions**ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš°ì„ ì ìœ¼ë¡œ ê²€ì‚¬í•©ë‹ˆë‹¤. ì´ë•Œ, PR ë¸Œëœì¹˜ì˜ ì½”ë“œê°€ ë¬¸ì œê°€ ìˆë‹¤ë©´ develop ë¸Œëœì¹˜ë¡œ ë³‘í•©ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\n\n> ë‹¬ë¡íŒ€ì˜ ë¸Œëœì¹˜ ì „ëµì— ëŒ€í•´ì„œëŠ” ë‹¬ë¡íŒ€ ë§¤íŠ¸ê°€ ì‘ì„±í•œ '[ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤.](https://dallog.github.io/git-branch-strategy/)' í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”!\n\nì •ìƒì ìœ¼ë¡œ ë¹Œë“œê°€ ë˜ëŠ” ì½”ë“œëŠ” ì´í›„ ë‹¬ë¡ ê°œë°œìë“¤ë¼ë¦¬ ì½”ë“œë¦¬ë·°ê°€ ì§„í–‰ë˜ê³ , develop ë¸Œëœì¹˜ì— ë³‘í•©ì´ ë©ë‹ˆë‹¤. ì´ë•Œ, GithubëŠ” ë‹¬ë¡íŒ€ì´ êµ¬ì¶•í•œ ì  í‚¨ìŠ¤ ì„œë²„ì— **Webhook**ì„ í†µí•´ ë³‘í•© ì‚¬ì‹¤ì„ ì•Œë¦½ë‹ˆë‹¤.\n\nWebhookì´ë€, íŠ¹ì •í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ **ì´ë²¤íŠ¸ ë°œìƒ ì •ë³´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œê³µí•˜ê¸° ìœ„í•œ ë°©ë²•**ì…ë‹ˆë‹¤. ì  í‚¨ìŠ¤ëŠ” ì™¸ë¶€ì— Webhook URLì„ ì—´ì–´ë‘ê³ , Githubìœ¼ë¡œë¶€í„° ì´ Webhook URLë¡œ ìš”ì²­ì„ ë°›ì•„ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ì¦‰ì‹œ ê·¸ ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nWebhookì„ í†µí•´ ì‹ í˜¸ë¥¼ ë°›ì€ ì  í‚¨ìŠ¤ëŠ” ë¯¸ë¦¬ ì§€ì •ëœ ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹Œë“œí•˜ì—¬ `jar` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nìƒì„±í•œ `jar` íŒŒì¼ì€ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìŠ¤í”„ë§ë¶€íŠ¸ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ `jar` íŒŒì¼ì´ ì‹¤í–‰ë˜ì–´ ë°°í¬ê°€ ì™„ë£Œë©ë‹ˆë‹¤.\n\n## í”„ë¦¬ìŠ¤íƒ€ì¼ê³¼ íŒŒì´í”„ë¼ì¸\n\nì  í‚¨ìŠ¤ì—ì„œ ì¡(Job)ì„ ìƒì„±í•˜ëŠ” ë°©ì‹ì€ í¬ê²Œ **í”„ë¦¬ìŠ¤íƒ€ì¼ê³¼ íŒŒì´í”„ë¼ì¸** ë‘ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\n\n### í”„ë¦¬ìŠ¤íƒ€ì¼\n\ní”„ë¦¬ìŠ¤íƒ€ì¼ì€ **GUIê¸°ë°˜**ìœ¼ë¡œ ì  í‚¨ìŠ¤ ì¡ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê°„ë‹¨í•œ ì‘ì—…ì— ì í•©í•˜ê³ , **ë³µì¡í•œ ì‘ì—…ì—ëŠ” ë‹¤ì†Œ ì ì ˆì¹˜ ì•ŠìŠµë‹ˆë‹¤.** ë˜í•œ GUI ê¸°ë°˜ì´ë¯€ë¡œ ì„¤ì • ê³¼ì •ì´ ë‹¤ì†Œ ë‚œì¡í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n### íŒŒì´í”„ë¼ì¸\n\në°˜ë©´ ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì€ ì¼ë ¨ì˜ ë°°í¬ ê³¼ì •ì„ **ì½”ë“œë¡œ ì‘ì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì½”ë“œëŠ” **Jenkinsfile** ë¼ê³  ë¶ˆë¦¬ëŠ” íŒŒì¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆì–´, Git ë“±ì„ í†µí•œ **ë²„ì „ê´€ë¦¬**ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë˜í•œ íŒŒì´í”„ë¼ì¸ì„ ì‚¬ìš©í•˜ë©´ ìŠ¤í…Œì´ì§€(Stage)ë¼ëŠ” ë‹¨ìœ„ë¡œ ê° ì‘ì—…ì— ì†Œìš”ë˜ëŠ” ì‹œê°„, ì‹¤íŒ¨ì—¬ë¶€ë¥¼ **ì‹œê°í™”**í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në‹¬ë¡ì€ í”„ë¦¬ìŠ¤íƒ€ì¼ ëŒ€ì‹  ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì„ ì´ìš©í•˜ì—¬ ì¡(Job)ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ê°œë°œì ì…ì¥ì—ì„œëŠ” ì•„ë¬´ë˜ë„ GUIë³´ë‹¤ëŠ” ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ì‘ì—… ê³¼ì •ì„ ì‘ì„±í•˜ëŠ” ê²ƒì´ í¸í•˜ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤. ë˜í•œ ì¶”í›„ ë°°í¬ í”„ë¡œì„¸ìŠ¤ ìì²´ë¥¼ Github ì €ì¥ì†Œì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ í° ì¥ì ìœ¼ë¡œ ë‹¤ê°€ì™”ìŠµë‹ˆë‹¤.\n\n#### Scripted vs Declarative\n\níŒŒì´í”„ë¼ì¸ë„ ë¬¸ë²•ì— ë”°ë¼ í¬ê²Œ **Scripted Pipeline**ê³¼ **Declarative Pipeline** ë‘ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\n\nScriptedëŠ” Groovyë¼ëŠ” ì–¸ì–´ë¡œ ì‘ì„±ë˜ë©°, ë³€ìˆ˜ ì„ ì–¸ë“±ì´ ì§€ì›ë˜ì–´ í”„ë¡œê·¸ë˜ë°ì„ í•  ìˆ˜ ìˆë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤. ë°˜ë©´, DeclarativeëŠ” Scriptedì— ë¹„í•´ ê°„ë‹¨í•˜ë©°, Groovyë¥¼ ì•Œì§€ ì•Šì•„ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. **Scripted ë¬¸ë²•ì€ Declarativeì— ë¹„í•´ ìœ ì—°ì„±ì´ë‚˜ í™•ì¥ì„±ì´ ë†’ì§€ë§Œ, ë³µì¡ë„ì™€ ìœ ì§€ë³´ìˆ˜ ë‚œì´ë„ê°€ ë” ë†’ìŠµë‹ˆë‹¤**.\n\nìµœê·¼ CI/CD ê¸°ì¡°ëŠ” Declarative ìŠ¤íƒ€ì¼ë¡œ ë§ì´ ì´ë™ë˜ê³  ìˆë‹¤ê³  í•©ë‹ˆë‹¤ ([ì°¸ê³ ](https://www.theserverside.com/answer/Declarative-vs-scripted-pipelines-Whats-the-difference)). ë‹¹ì¥ ë¹„êµì  ìµœê·¼ì— ì¶œì‹œëœ Github Actions ë„ YAML ê¸°ë°˜ì˜ Declarative ìŠ¤íƒ€ì¼ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¬ë¡íŒ€ì€ Declarative ë¬¸ë²•ì„ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.\n\n## ì¡(Job) ìƒì„± ë° ì„¸íŒ…\n\n### íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ìƒì„±\n\n![](./pipeline.png)\n\nì  í‚¨ìŠ¤ ë©”ë‰´ì—ì„œ 'ìƒˆë¡œìš´ Item'ì„ í´ë¦­í•˜ê³ , 'Pipeline'ì„ ì„ íƒí•˜ì—¬ ìƒˆë¡œìš´ ì¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n### Github URL ì„¤ì •\n\n**General > GitHub project > Project url** ì— ì €í¬ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ì£¼ì†Œì¸ **https://github.com/woowacourse-teams/2022-dallog** ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.\n\n### ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ\n\në¹Œë“œ ì´ë ¥ì„ ì˜¤ë˜ ê°€ì§€ê³  ìˆì–´ë´¤ì í° ì˜ë¯¸ê°€ ì—†ì„ ê²ƒ ê°™ê¸°ë„ í•˜ê³ , ì•„ë¬´ë˜ë„ **t4g.micro** ì—ì„œ ëŒë¦¬ë‹¤ë³´ë‹ˆ ìš©ëŸ‰ì´ ë„‰ë„‰ì¹˜ ì•Šê¸°ë„ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ **General > ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ** ì˜µì…˜ì„ í´ë¦­í•˜ì—¬ í™œì„±í™”í•˜ê³ , ë³´ê´€í•  ìµœëŒ€ ê°¯ìˆ˜ë¥¼ 3ìœ¼ë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\n\n> ë‚˜ì¤‘ì— ë¹Œë“œ ì´ë ¥ ë³´ê´€ ê°œìˆ˜ê°€ ë„ˆë¬´ ì ë‹¤ê³  íŒë‹¨ë˜ë©´ ì¡°ê¸ˆ ë” ëŠ˜ë¦´ ìƒê°ì…ë‹ˆë‹¤ ğŸ™‚\n\n### ë¹Œë“œ íŠ¸ë¦¬ê±° ì„¤ì •\n\n**Build Triggers > GitHub hook trigger for GITScm polling** ì„ ì²´í¬í•´ì¤ë‹ˆë‹¤. Githubì˜ Webhookì„ í†µí•´ ë¹Œë“œê°€ íŠ¸ë¦¬ê±°ë˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.\n\n> ì´ ê¸°ëŠ¥ì€ **GitHub plugin**ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ìµœì´ˆ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í–ˆì„ ë•Œ Install suggested plugins ë¥¼ ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì´ í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ì–´ìˆì§€ ì•Šì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n#### Github ì €ì¥ì†Œì— Webhook ë“±ë¡í•˜ê¸°\n\nWebhookì„ ì‚¬ìš©í•˜ë ¤ë©´ Github ì €ì¥ì†Œì˜ Settings > Webhooks ì—ì„œ Webhook URLì„ ë“±ë¡í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\n\n```\nhttp://{ì„œë¹„ìŠ¤ IP í˜¹ì€ ë„ë©”ì¸ ì£¼ì†Œ}/github-webhook/\n```\n\nìœ„ì™€ ê°™ì´ URLì„ ë“±ë¡í•´ì¤ë‹ˆë‹¤. ì´ë•Œ URLì˜ ë§ˆì§€ë§‰ì— `/`ê°€ ë“¤ì–´ê°€ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë‹ˆ ê¼­ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n## íŒŒì´í”„ë¼ì¸ ì‘ì„±\n\nì´ì œ ë¹Œë“œê°€ íŠ¸ë¦¬ê±° ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë  íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ì°¨ë¡€ì…ë‹ˆë‹¤.\n\n```groovy\npipeline {\n   agent any\n   stages {\n       stage('Github') {\n           steps {\n               git branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\n           }\n       }\n       stage('Build') {\n           steps {\n               dir('backend') {\n                   sh \"./gradlew bootJar\"\n               }\n           }\n       }\n       stage('Deploy') {\n           steps {\n               dir('backend/build/libs') {\n                   sshagent(credentials: ['key-dallog']) {\n                        sh 'scp backend-0.0.1-SNAPSHOT.jar ubuntu@192.168.XXX.XXX:/home/ubuntu'\n                        sh 'ssh ubuntu@192.168.XXX.XXX \"sh run.sh\" &'\n                   }\n               }\n           }\n       }\n   }\n}\n```\n\n### Github stage\n\nGithub stageì—ì„œëŠ” ì‚¬ìš©í•  ê¹ƒí—ˆë¸Œì˜ ì €ì¥ì†Œ ì£¼ì†Œì™€ ë¸Œëœì¹˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì  í‚¨ìŠ¤ëŠ” ì´ ìŠ¤í…Œì´ì§€ì— ëª…ì‹œëœ ì €ì¥ì†Œì™€ ë¸Œëœì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.\n\n### Build stage\n\n`gradlew` íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë¹Œë“œí•©ë‹ˆë‹¤. ì´ë•Œ, `dir` ì§€ì‹œì–´(Directive)ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª…ë ¹ì„ ìˆ˜í–‰í•  ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n### Deploy stage\n\n> ì´ ì‘ì—…ì„ ìœ„í•´ì„œ ì‚¬ì „ì— Jenkins ê´€ë¦¬ > Manage Credentials ì—ì„œ 'SSH Username with private key' ë¡œ AWSì—ì„œ ë°œê¸‰ ë°›ì€ PEM í‚¤ë¥¼ ë¨¼ì € ë“±ë¡í•´ì•¼í•©ë‹ˆë‹¤.\n\në‹¬ë¡íŒ€ì€ SSH Agent í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ ì„œë²„ì— ì›ê²©ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤. SSH Agent í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì´í”„ë¼ì¸ì—ì„œ ì  í‚¨ìŠ¤ì— ë“±ë¡í•´ë‘” SSH ìê²©ì¦ëª…ì„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë©´ `sshagent` ë¼ëŠ” Directiveë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì¸ìë¡œ ì‚¬ì „ì— ì  í‚¨ìŠ¤ Credentialë¡œ ë“±ë¡í•œ PEMí‚¤ì˜ ì´ë¦„ì„ ë„£ì–´ì¤ë‹ˆë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ `sshagent` Directive Block ë‚´ë¶€ì—ì„œ `sh` ë¥¼ í†µí•´ `ssh` ê´€ë ¨ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n#### jar íŒŒì¼ ì „ì†¡\n\nSCP(Secure Copy)ëŠ” SSH í†µì‹  ê¸°ë°˜ìœ¼ë¡œ ì›ê²©ì§€ì— íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆëŠ” í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” `scp` ëª…ë ¹ì„ í†µí•´ SCP í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¬ë¡íŒ€ì€ ì´ `scp` ëª…ë ¹ì„ í†µí•´ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¹Œë“œëœ `jar` íŒŒì¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.\n\n> ì—¬ê¸°ì„œ IPì£¼ì†Œê°€ í”„ë¼ì´ë¹— IPë¡œ ì í˜€ìˆìŠµë‹ˆë‹¤. ìš°í…Œì½”ì—ì„œ ì œê³µë˜ëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ë³´ì•ˆê·¸ë£¹ ì„¤ì •ìƒ ì ì‹¤ ë° ì„ ë¦‰ ìº í¼ìŠ¤ì˜ IPë¡œë§Œ SSH(22ë²ˆ í¬íŠ¸) ì¸ë°”ìš´ë“œê°€ í—ˆìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í¼ë¸”ë¦­ IP ëŒ€ì‹  í”„ë¼ì´ë¹— IPë¡œ ì§€ì •í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. í”„ë¼ì´ë¹— IPë¥¼ ì‚¬ìš©í•´ë„ ë‘ EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ì€ VPCì— ì¡´ì¬í•˜ë¯€ë¡œ ì •ìƒì ìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\n#### ì›ê²©ì§€ì˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰\n\nìŠ¤í”„ë§ë¶€íŠ¸ ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” ì‚¬ì „ì— `run.sh` ë¼ëŠ” ì´ë¦„ì˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì œê±°í•˜ê³ , í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ê³ , ê°™ì€ ë””ë ‰í† ë¦¬ì— ìˆëŠ” `jar` íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\n\n```shell\n#! /bin/bash\n\nPROJECT_NAME=backend\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\n\nif [ -z \"$CURRENT_PID\" ]; then\n    echo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\nelse\n    echo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\n    kill -15 $CURRENT_PID\nfi\n\necho \"\\nğŸŒˆ SpringBoot í™˜ê²½ë³€ìˆ˜ ì„¤ì •\"\n\nexport GOOGLE_CLIENT_ID=\"XXXXXXXXXXXXXX\"\nexport GOOGLE_CLIENT_SECRET=\"XXXXXXXXXXXXXX\"\nexport GOOGLE_REDIRECT_URI=\"XXXXXXXXXXXXXX\"\nexport GOOGLE_TOKEN_URI=\"XXXXXXXXXXXXXX\"\nexport JWT_EXPIRE_LENGTH=86400000\nexport JWT_SECRET_KEY=\"XXXXXXXXXXXXXX\"\n\necho \"\\nğŸŒˆ SpringBoot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\\n\"\n\nJAR_NAME=$(ls | grep .jar | head -n 1)\nsudo -E nohup java -jar /home/ubuntu/$JAR_NAME &\n```\n\nì§€ë‚œ í¬ìŠ¤íŒ…ì¸ **[ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ë‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìë™í™”](/deploy-automation-with-shell-script)** ì—ì„œ ì†Œê°œë“œë¦° ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì†ŒìŠ¤ì½”ë“œë¥¼ Pull í•´ì˜¤ê³  ë¹Œë“œí•˜ëŠ” ê³¼ì •ë§Œ ì‚¬ë¼ì§„ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.\n\nì´ ì›ê²©ì§€ì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ `ssh` ëª…ë ¹ì„ í†µí•´ ì‹¤í–‰í•˜ê²Œë˜ë©´ ë°°í¬ê³¼ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤.\n\n## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…\n\n### Webhook íŠ¸ë¦¬ê±° ì´ìŠˆ\n\nì²˜ìŒ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì •í•  ë•Œ ì•„ë¬´ë¦¬ Webhook ì„¤ì •ì„ ê±´ë“œë ¤ë´ë„ ë¹Œë“œê°€ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ë°œìƒí–ˆì—ˆìŠµë‹ˆë‹¤.\n\në¨¼ì € ìœ„ íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì˜ Github ìŠ¤í…Œì´ì§€ì—ì„œ ì‚¬ìš©ëœ `git` Directiveë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.\n\n```\ngit branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\n```\n\në˜í•œ ìµœì´ˆë¡œ 'ì§€ê¸ˆ ë¹Œë“œ' ë²„íŠ¼ì„ í´ë¦­í•´ì•¼ì§€ ê·¸ ì´í›„ Webhook ìš”ì²­ì„ ìˆ˜ì‹ í•  ìˆ˜ ìˆê²Œë©ë‹ˆë‹¤.\n\n### SSH ìê²© ì¦ëª… ì´ìŠˆ\n\n```\nHost key verification failed.\nlost connection\n```\n\nì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì— ìµœì´ˆë¡œ SSH ì—°ê²°ì„ ì‹œë„í•  ê²½ìš° ì  í‚¨ìŠ¤ì—ì„œ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë“¤ SSHë¡œ ìµœì´ˆ ì›ê²©ì ‘ì† ì‹œ ì•„ë˜ì™€ ê°™ì€ ë©”ì‹œì§€ë¥¼ ë³¸ ì ì´ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤.\n\n```\nroot@XXXXXXXX:/home# ssh -i key.pem ubuntu@192.168.XXX.XXX\nThe authenticity of host '192.168.XXX.XXX (192.168.XXX.XXX)' can't be established.\nECDSA key fingerprint is SHA256:XXXXXXXXXXXXXXXX\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\n```\n\ní„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì ‘ì†í•  ë•Œì—ëŠ” yes ë¥¼ ì…ë ¥í•˜ë©´, ê³§ë°”ë¡œ ì ‘ì†ë í…ë°ìš”. ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì—ì„œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë¯¸ë¦¬ ì  í‚¨ìŠ¤ ì¸¡ì˜ `known_hosts` ì— ì›ê²©ì§€ì˜ ê³µê°œí‚¤ë¥¼ ë“±ë¡í•´ì•¼í•©ë‹ˆë‹¤.\n\n`keyscan` ëª…ë ¹ì„ í†µí•´ì„œ í˜¸ìŠ¤íŠ¸ì˜ ê³µê°œí‚¤ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª…ë ¹ì„ í†µí•´ì„œ `~/.ssh/known_hosts` ì— ì ‘ì†í•  í˜¸ìŠ¤íŠ¸ì˜ ê³µê°œí‚¤ë¥¼ ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.\n\n## ë§ˆì¹˜ë©°\n\nì´ë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œë“œë ¸ìŠµë‹ˆë‹¤. ì´ì–´ì§€ëŠ” ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡íŒ€ì˜ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶• ë°©ë²•ì„ ì†Œê°œë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ˜„\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸° ë„ë©”ì¸ ë¡œì§ì€ ìš°ë¦¬ê°€ ì§€ì¼œì•¼í•  ë§¤ìš° ì†Œì¤‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë“¤ì´ ë‹´ê²¨ìˆë‹¤. ì´ëŸ¬í•œ ë„ë©”ì¸ ë¡œì§ë“¤ì€ ë³€ê²½ì´ ìµœì†Œí™”ë˜ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™” í•´ì•¼ í•œë‹¤.  ì¸í„°í˜ì´ìŠ¤ í™œìš©í•˜ê¸° ìš°ì„  ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ê²ƒ ì¤‘ ê°ì²´ ê°„ì˜ ì˜ì¡´ì„±ì„ ì•½í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆëŠ” ìˆ˜â€¦","fields":{"slug":"/separated-interface/"},"frontmatter":{"date":"July 24, 2022","title":"ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°","tags":["ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤","ì˜ì¡´ì„± ë¶„ë¦¬"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°\n\në„ë©”ì¸ ë¡œì§ì€ ìš°ë¦¬ê°€ ì§€ì¼œì•¼í•  ë§¤ìš° ì†Œì¤‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë“¤ì´ ë‹´ê²¨ìˆë‹¤. ì´ëŸ¬í•œ ë„ë©”ì¸ ë¡œì§ë“¤ì€ ë³€ê²½ì´ ìµœì†Œí™”ë˜ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™” í•´ì•¼ í•œë‹¤. \n\n### ì¸í„°í˜ì´ìŠ¤ í™œìš©í•˜ê¸°\n\nìš°ì„  ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ê²ƒ ì¤‘ ê°ì²´ ê°„ì˜ ì˜ì¡´ì„±ì„ ì•½í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ `JpaRepository`ë¥¼ ì‚´í´ë³´ì.\n\n```java\npublic interface MemberRepository extends JpaRepository<Member, Long> {\n\n    Optional<Member> findByEmail(final String email);\n\n    boolean existsByEmail(final String email);\n}\n```\n\nì´ëŸ¬í•œ ì¸í„°í˜ì´ìŠ¤ ë•ë¶„ì— ìš°ë¦¬ëŠ” ì‹¤ì œ DBì— ì ‘ê·¼í•˜ëŠ” ë‚´ë¶€ êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë°ì´í„°ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤. í•µì‹¬ì€ `ì‹¤ì œ DBì— ì ‘ê·¼í•˜ëŠ” í–‰ìœ„`ì´ë‹¤.\n\nì•„ë˜ëŠ” `Spring Data`ê°€ ë§Œë“  `JpaRepositoryì˜ êµ¬í˜„ì²´` `SimpleJpaRepository`ì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\n\n```java\n@Repository\n@Transactional(readOnly = true)\npublic class SimpleJpaRepository<T, ID> implements JpaRepositoryImplementation<T, ID> {\n\n\tprivate static final String ID_MUST_NOT_BE_NULL = \"The given id must not be null!\";\n\n\tprivate final JpaEntityInformation<T, ?> entityInformation;\n\tprivate final EntityManager em;\n\tprivate final PersistenceProvider provider;\n\n\tprivate @Nullable CrudMethodMetadata metadata;\n\tprivate EscapeCharacter escapeCharacter = EscapeCharacter.DEFAULT;\n\n\tpublic SimpleJpaRepository(JpaEntityInformation<T, ?> entityInformation, EntityManager entityManager) {\n\n\t\tAssert.notNull(entityInformation, \"JpaEntityInformation must not be null!\");\n\t\tAssert.notNull(entityManager, \"EntityManager must not be null!\");\n\n\t\tthis.entityInformation = entityInformation;\n\t\tthis.em = entityManager;\n\t\tthis.provider = PersistenceProvider.fromEntityManager(entityManager);\n\t}\n  ...\n}\n```\n\ní•´ë‹¹ êµ¬í˜„ì²´ëŠ” `entityManger`ë¥¼ í†µí•´ ê°ì²´ë¥¼ ì˜ì† ì‹œí‚¤ëŠ” í–‰ìœ„ë¥¼ ì§„í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— `ì˜ì† ê³„ì¸µ`ì— ê°€ê¹ë‹¤ê³  íŒë‹¨í–ˆë‹¤. ì¦‰ ë„ë©”ì¸ì˜ ì…ì¥ì—ì„œ `MemberRepository`ë¥¼ ë°”ë¼ë³¼ ë•Œ ë‹¨ìˆœíˆ `JpaRepository`ë¥¼ ìƒì†í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— `ì˜ì† ê³„ì¸µ`ì— ëŒ€í•œ ì§ì ‘ì ì¸ ì˜ì¡´ì„±ì€ ì—†ë‹¤ê³  ë´ë„ ë¬´ë°©í•˜ë‹¤. ì •ë¦¬í•˜ë©´ ìš°ë¦¬ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì‹¤ì œ êµ¬í˜„ì²´ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ëœë‹¤. \n\n### ê´€ì  ë³€ê²½í•˜ê¸°\n\nì´ëŸ¬í•œ ì‚¬ë¡€ë¥¼ ì™¸ë¶€ ì„œë²„ì™€ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“  ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient`ì— ëŒ€ì…í•´ë³¸ë‹¤. `OAuthClient`ì˜ ê°€ì¥ í° ì—­í• ì€ nì˜ ì†Œì…œì—ì„œ `OAuth 2.0`ì„ í™œìš©í•œ ì¸ì¦ì˜ í–‰ìœ„ë¥¼ ì •ì˜í•œ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. google, github ë“± ê°ìì— ë§ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ `OAuthClient`ë¥¼ êµ¬í˜„í•œ ë’¤ ë¡œì§ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ googleì˜ ì¸ê°€ ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í† í° ì •ë³´ì—ì„œ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë¡œì§ì„ ë‹´ê³  ìˆë‹¤.\n\n```java\npublic interface OAuthClient {\n\n    OAuthMember getOAuthMember(final String code);\n}\n```\n\n```java\n@Component\npublic class GoogleOAuthClient implements OAuthClient {\n\n    private static final String JWT_DELIMITER = \"\\\\.\";\n\n    private final String googleRedirectUri;\n    private final String googleClientId;\n    private final String googleClientSecret;\n    private final String googleTokenUri;\n    private final RestTemplate restTemplate;\n    private final ObjectMapper objectMapper;\n\n    public GoogleOAuthClient(@Value(\"${oauth.google.redirect_uri}\") final String googleRedirectUri,\n                             @Value(\"${oauth.google.client_id}\") final String googleClientId,\n                             @Value(\"${oauth.google.client_secret}\") final String googleClientSecret,\n                             @Value(\"${oauth.google.token_uri}\") final String googleTokenUri,\n                             final RestTemplate restTemplate, final ObjectMapper objectMapper) {\n        this.googleRedirectUri = googleRedirectUri;\n        this.googleClientId = googleClientId;\n        this.googleClientSecret = googleClientSecret;\n        this.googleTokenUri = googleTokenUri;\n        this.restTemplate = restTemplate;\n        this.objectMapper = objectMapper;\n    }\n\n    @Override\n    public OAuthMember getOAuthMember(final String code) {\n        GoogleTokenResponse googleTokenResponse = requestGoogleToken(code);\n        String payload = getPayloadFrom(googleTokenResponse.getIdToken());\n        String decodedPayload = decodeJwtPayload(payload);\n\n        try {\n            return generateOAuthMemberBy(decodedPayload);\n        } catch (JsonProcessingException e) {\n            throw new IllegalArgumentException();\n        }\n    }\n\n    private GoogleTokenResponse requestGoogleToken(final String code) {\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);\n        MultiValueMap<String, String> params = generateRequestParams(code);\n\n        HttpEntity<MultiValueMap<String, String>> request = new HttpEntity<>(params, headers);\n        return restTemplate.postForEntity(googleTokenUri, request, GoogleTokenResponse.class).getBody();\n    }\n\n    private MultiValueMap<String, String> generateRequestParams(final String code) {\n        MultiValueMap<String, String> params = new LinkedMultiValueMap<>();\n        params.add(\"client_id\", googleClientId);\n        params.add(\"client_secret\", googleClientSecret);\n        params.add(\"code\", code);\n        params.add(\"grant_type\", \"authorization_code\");\n        params.add(\"redirect_uri\", googleRedirectUri);\n        return params;\n    }\n\n    private String getPayloadFrom(final String jwt) {\n        return jwt.split(JWT_DELIMITER)[1];\n    }\n\n    private String decodeJwtPayload(final String payload) {\n        return new String(Base64.getUrlDecoder().decode(payload), StandardCharsets.UTF_8);\n    }\n\n    private OAuthMember generateOAuthMemberBy(final String decodedIdToken) throws JsonProcessingException {\n        Map<String, String> userInfo = objectMapper.readValue(decodedIdToken, HashMap.class);\n        String email = userInfo.get(\"email\");\n        String displayName = userInfo.get(\"name\");\n        String profileImageUrl = userInfo.get(\"picture\");\n\n        return new OAuthMember(email, displayName, profileImageUrl);\n    }\n}\n```\n\në³´í†µì˜ ìƒê°ì€ ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient`ì™€ êµ¬í˜„ì²´ì¸ `GoogleOAuthClient`ë¥¼ ê°™ì€ íŒ¨í‚¤ì§€ì— ë‘ë ¤ê³  í•  ê²ƒì´ë‹¤. `GoogleOAuthClient`ëŠ” ì™¸ë¶€ ì˜ì¡´ì„±ì„ ê°•í•˜ê²Œ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— `domain` íŒ¨í‚¤ì§€ì™€ ë³„ë„ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ `infrastructure` íŒ¨í‚¤ì§€ê°€ ì í•©í•  ê²ƒì´ë‹¤. ê²°êµ­ ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient` ë˜í•œ `infrastructure`ì— ìœ„ì¹˜í•˜ê²Œ ë  ê²ƒì´ë‹¤. ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ìƒê°ì—ì„œ ë²—ì–´ë‚˜ ìƒˆë¡œìš´ ê´€ì ì—ì„œ ì‚´í´ë´ì•¼ í•œë‹¤.\n\nì•ì„œ ì–¸ê¸‰í•œ ì˜ì¡´ì„±ì— ëŒ€í•´ ìƒê°í•´ë³´ì. ìœ„ `OAuthClient`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ì²´ëŠ” ëˆ„êµ¬ì¼ê¹Œ? ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ì£¼ì²´ë¥¼ `domain` ë‚´ì— ì¸ì¦ì„ ë‹´ë‹¹í•˜ëŠ” `auth` íŒ¨í‚¤ì§€ ë‚´ë¶€ì˜ `Authservice`ë¡œ ê²°ì • í–ˆë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ `OAuthClient`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì£¼ì²´ì¸ `AuthService`ì´ë‹¤.\n\n```java\n@Transactional(readOnly = true)\n@Service\npublic class AuthService {\n\n    private final OAuthEndpoint oAuthEndpoint;\n    private final OAuthClient oAuthClient;\n    private final MemberService memberService;\n    private final JwtTokenProvider jwtTokenProvider;\n\n    public AuthService(final OAuthEndpoint oAuthEndpoint, final OAuthClient oAuthClient,\n                       final MemberService memberService, final JwtTokenProvider jwtTokenProvider) {\n        this.oAuthEndpoint = oAuthEndpoint;\n        this.oAuthClient = oAuthClient;\n        this.memberService = memberService;\n        this.jwtTokenProvider = jwtTokenProvider;\n    }\n\n    public String generateGoogleLink() {\n        return oAuthEndpoint.generate();\n    }\n\n    @Transactional\n    public TokenResponse generateTokenWithCode(final String code) {\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\n        String email = oAuthMember.getEmail();\n\n        if (!memberService.existsByEmail(email)) {\n            memberService.save(generateMemberBy(oAuthMember));\n        }\n\n        Member foundMember = memberService.findByEmail(email);\n        String accessToken = jwtTokenProvider.createToken(String.valueOf(foundMember.getId()));\n\n        return new TokenResponse(accessToken);\n    }\n\n    private Member generateMemberBy(final OAuthMember oAuthMember) {\n        return new Member(oAuthMember.getEmail(), oAuthMember.getProfileImageUrl(), oAuthMember.getDisplayName(), SocialType.GOOGLE);\n    }\n}\n```\n\nì§€ê¸ˆ ê¹Œì§€ ì„¤ëª…í•œ êµ¬ì¡°ì˜ íŒ¨í‚¤ì§€ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\n\n```\nâ””â”€â”€ src\n    â”œâ”€â”€ main\n    â”‚   â”œâ”€â”€ java\n    â”‚   â”‚   â””â”€â”€ com\n    â”‚   â”‚       â””â”€â”€ allog\n    â”‚   â”‚           â””â”€â”€ dallog\n    â”‚   â”‚               â”œâ”€â”€ auth\n    â”‚   â”‚               â”‚   â””â”€â”€ application\n    â”‚   â”‚               â”‚       â””â”€â”€ AuthService.java\n    â”‚   â”‚               ...\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\n    â”‚   â”‚               â”‚   â”œâ”€â”€ oauth\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ client\n    â”‚   â”‚               â”‚   â”‚       â”œâ”€â”€ OAuthClient.java\n    â”‚   â”‚               â”‚   â”‚       â””â”€â”€ GoogleOAuthClient.java\n    â”‚   â”‚               â”‚   â””â”€â”€ dto\n    â”‚   â”‚               â”‚       â””â”€â”€ OAuthMember.java     \n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\n    |   |\n    â”‚   â””â”€â”€ resources\n    â”‚       â””â”€â”€ application.yml\n```\n\nê²°êµ­ ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì´ `domain` íŒ¨í‚¤ì§€ì—ì„œ `infrastructure`ì— ì˜ì¡´í•˜ê²Œ ëœë‹¤.\n  \n```java\n...\nimport com.allog.dallog.infrastructure.dto.OAuthMember; // ì˜ì¡´ì„± ë°œìƒ!\nimport com.allog.dallog.infrastructure.oauth.client.OAuthClient; // ì˜ì¡´ì„± ë°œìƒ!\n...\n\n@Transactional(readOnly = true)\n@Service\npublic class AuthService {\n\t...\n    private final OAuthClient oAuthClient;\n    ...\n\n    @Transactional\n    public TokenResponse generateTokenWithCode(final String code) {\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\n        ...\n    }\n    ...\n}\n```\n\n### Separated Interface Pattern\n\n`ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤`ë¥¼ í™œìš©í•˜ì. ì¦‰ `ì¸í„°í˜ì´ìŠ¤`ì™€ `êµ¬í˜„ì²´`ë¥¼ ê°ê°ì˜ íŒ¨í‚¤ì§€ë¡œ ë¶„ë¦¬í•œë‹¤. ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ `domain` íŒ¨í‚¤ì§€ì—ì„œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³  `infrastructure` íŒ¨í‚¤ì§€ì— êµ¬í˜„ì²´ë¥¼ ë‘”ë‹¤. ì´ë ‡ê²Œ êµ¬ì„±í•˜ë©´ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ì¢…ì†ì„±ì„ ê°€ì§„ ì£¼ì²´ê°€ êµ¬í˜„ì²´ì— ëŒ€í•´ ì¸ì‹í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.\n\nì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ë¥¼ ë¶„ë¦¬í–ˆë‹¤ê³  ê°€ì •í•œë‹¤.\n\n```\nâ””â”€â”€ src\n    â”œâ”€â”€ main\n    â”‚   â”œâ”€â”€ java\n    â”‚   â”‚   â””â”€â”€ com\n    â”‚   â”‚       â””â”€â”€ allog\n    â”‚   â”‚           â””â”€â”€ dallog\n    â”‚   â”‚               â”œâ”€â”€ auth\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ AuthService.java\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ OAuthClient.java\n    â”‚   â”‚               â”‚   â””â”€â”€ dto\n    â”‚   â”‚               â”‚       â””â”€â”€ OAuthMember.java         \n    â”‚   â”‚               ...\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\n    â”‚   â”‚               â”‚   â”œâ”€â”€ oauth\n    â”‚   â”‚               â”‚       â””â”€â”€ client\n    â”‚   â”‚               â”‚           â””â”€â”€ GoogleOAuthClient.java\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\n    |   |\n    â”‚   â””â”€â”€ resources\n    â”‚       â””â”€â”€ application.yml\n```\n\nìì—°ìŠ¤ëŸ½ê²Œ `domain` ë‚´ì— ìˆë˜ `infrastructure` íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì˜ì¡´ì„±ë„ ì œê±°ëœë‹¤. ì¦‰ ì™¸ë¶€ ì„œë²„ì™€ì˜ í†µì‹ ì„ ìœ„í•œ ì˜ì¡´ì„±ì´ ì™„ì „íˆ ë¶„ë¦¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\n\n```java\n...\nimport com.allog.dallog.auth.dto.OAuthMember; // auth íŒ¨í‚¤ì§€ ë‚´ë¶€ë¥¼ ì˜ì¡´\n...\n@Transactional(readOnly = true)\n@Service\npublic class AuthService {\n\t...\n    private final OAuthClient oAuthClient;\n    ...\n\n    @Transactional\n    public TokenResponse generateTokenWithCode(final String code) {\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\n        ...\n    }\n    ...\n}\n```\n\n## References.\n\n[Separated Interface](https://www.martinfowler.com/eaaCatalog/separatedInterface.htmlhttps://www.martinfowler.com/eaaCatalog/separatedInterface.html)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì—ì„œëŠ” ì €ëŠ” ë°°í¬ì™€ CI/CDì™€ ê°™ì´ ì¸í”„ë¼ì™€ ê´€ë ¨ëœ íƒœìŠ¤í¬ì— ì§‘ì¤‘í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë°°í¬ ìë™í™”ë¥¼ êµ¬ì¶•í•œ ì´ì•¼ê¸°ë¥¼ í–ˆì—ˆì£ . í•˜ì§€ë§Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë³‘í•©ë  ë•Œ ë§ˆë‹¤ SSHë¡œ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼â€¦","fields":{"slug":"/install-jenkins-with-docker-on-ec2/"},"frontmatter":{"date":"July 21, 2022","title":"EC2 í™˜ê²½ì—ì„œ ë„ì»¤ë¥¼ í™œìš©í•œ ì  í‚¨ìŠ¤ ì„¤ì¹˜í•˜ê¸°","tags":["DevOps","Jenkins"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì—ì„œëŠ” ì €ëŠ” ë°°í¬ì™€ CI/CDì™€ ê°™ì´ ì¸í”„ë¼ì™€ ê´€ë ¨ëœ íƒœìŠ¤í¬ì— ì§‘ì¤‘í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\nì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë°°í¬ ìë™í™”ë¥¼ êµ¬ì¶•í•œ ì´ì•¼ê¸°ë¥¼ í–ˆì—ˆì£ . í•˜ì§€ë§Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë³‘í•©ë  ë•Œ ë§ˆë‹¤ SSHë¡œ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ **ë§¤ë²ˆ ì‹¤í–‰í•´ì•¼í•œë‹¤ëŠ” ë‹¨ì **ì´ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ íŒ€ì€ ë©”ì¸ ë¸Œëœì¹˜ì— ê¸°ëŠ¥ì´ ìƒˆë¡œ ë³‘í•© ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê³ , ìŠ¤í”„ë§ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ `jar` íŒŒì¼ë¡œ ë¹Œë“œí•˜ì—¬ ë°°í¬í•˜ëŠ” í™˜ê²½ì´ í•„ìš”í•˜ë‹¤ê³  ëŠê¼ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ **CI/CD ë„êµ¬ë¥¼ ë„ì…**í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.\n\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡ì´ EC2 í™˜ê²½ì—ì„œ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•œ ë°©ë²•ì— ëŒ€í•´ì„œ ì •ë¦¬í•©ë‹ˆë‹¤.\n\n## ì  í‚¨ìŠ¤ ë„ì… ë°°ê²½\n\n![ìœ ëª…í•œ CI/CD ë„êµ¬ë“¤ì˜ êµ¬ê¸€ íŠ¸ë Œë“œ ê²°ê³¼](./google-trends.png)\n\në‹¬ë¡ì€ CI/CD ë„êµ¬ë¡œ **Jenkins**ë¥¼ ì„ ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ìœ„ ì‚¬ì§„ì€ ì‹œì¤‘ì— ë°°í¬ë˜ì–´ìˆëŠ” ì—¬ëŸ¬ CI/CD ë„êµ¬ì˜ êµ¬ê¸€ íŠ¸ë Œë“œ ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤. íŒŒë€ìƒ‰ì´ Jenkins ì¸ë°ìš”, **ì••ë„ì ìœ¼ë¡œ ë†’ì€ ê´€ì‹¬ë„**ë¥¼ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\nì•„ë¬´ë˜ë„ ë‹¬ë¡íŒ€ ëª¨ë‘ê°€ CI/CDì— ìµìˆ™í•˜ì§€ ì•Šì•„ ê°€ì¥ ì‚¬ëŒë“¤ì´ ë§ì´ ì‚¬ìš©í•˜ê³ , ê·¸ì— ë”°ë¼ **ìƒíƒœê³„ê°€ ë„“ê³  ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ì€ ë„êµ¬**ë¥¼ ì„ ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤. **ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ì•„** ì´ˆê¸° í•™ìŠµ ë¹„ìš©ì´ ì ê²Œ ë“¤ê³ , ì´ìŠˆê°€ ë°œìƒí–ˆì„ë•Œì—ë„ **íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì´ ë¹„êµì  ì‰½ë‹¤**ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.\n\n## ë„ì»¤\n\në‹¬ë¡íŒ€ì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì— **ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬** ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ë„ì› ìŠµë‹ˆë‹¤. ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì  í‚¨ìŠ¤ë¥¼ ìš°ë¶„íˆ¬ì— ì§ì ‘ ì„¤ì¹˜í•œë‹¤ë©´ í•´ì£¼ì–´ì•¼í•  í™˜ê²½ ì„¤ì •ì´ ê°€ë“í•©ë‹ˆë‹¤. ì  í‚¨ìŠ¤ë¥¼ ëŒë¦¬ê¸° ìœ„í•œ JDK ì„¤ì¹˜, ì  í‚¨ìŠ¤ ì„¤ì¹˜, ì  í‚¨ìŠ¤ í¬íŠ¸ ì„¤ì •, ë°©í™”ë²½ ì„¤ì • ë“±ë“±...\n\ní•˜ì§€ë§Œ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ° **í™˜ê²½ ì„¤ì • ì—†ì´ ê°„ë‹¨í•œ ëª…ë ¹ì–´ ëª‡ê°€ì§€ë¡œ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•˜ê³  ì„œë²„ì— ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**\n\në„ì»¤ëŠ” ì„œë¹„ìŠ¤ë¥¼ ìš´ìš©í•˜ëŠ”ë° í•„ìš”í•œ ì‹¤í–‰í™˜ê²½, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì†Œí”„íŠ¸ì›¨ì–´, ì½”ë“œ ë“±ì„ ì»¨í…Œì´ë„ˆë¼ëŠ” ë‹¨ìœ„ë¡œ ê°€ìƒí™”í•˜ëŠ” ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ê°€ìƒí™” í”Œë«í¼ì…ë‹ˆë‹¤. ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” ë¯¸ë¦¬ **ë„ì»¤ë¼ì´ì§•(Dockerizing)**ëœ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ê³  ë„ì»¤ë¥¼ í†µí•´ ì‹¤í–‰í•˜ê¸°ë§Œ í•˜ë©´ë˜ë©°, í•´ë‹¹ ì»¨í…Œì´ë„ˆê°€ ì–´ë–¤ í™˜ê²½ì„ í•„ìš”ë¡œ í•˜ëŠ”ì§€ ì „í˜€ ì•Œ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.\n\n> ë” ìì„¸í•œ ë‚´ìš©ì€ ì œê°€ ì‘ì„±í•œ [ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì´í•´í•˜ëŠ” Docker ê¸°ì´ˆ](https://hudi.blog/about-docker/)ë¥¼ ì½ì–´ë³´ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ ğŸ¤­\n\n### ìš°ë¶„íˆ¬ì— ë„ì»¤ ì„¤ì¹˜\n\n> ë‹¬ë¡íŒ€ì€ EC2 t4g.micro ì¸ìŠ¤í„´ìŠ¤ì— ìš°ë¶„íˆ¬ 22.04 (ARM 64) í™˜ê²½ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\n> ì•„ë˜ ì„¤ì¹˜ ë°©ë²•ì€ [ë„ì»¤ ê³µì‹ ë„íë¨¼íŠ¸](https://docs.docker.com/engine/install/ubuntu/)ì—ì„œ ì œê³µë˜ëŠ” ë‚´ìš©ì…ë‹ˆë‹¤.\n\n#### ë ˆí¬ì§€í† ë¦¬ ì…‹ì—…\n\nì•„ë˜ ëª…ë ¹ì„ í†µí•´ì„œ ìš°ë¶„íˆ¬ì˜ `apt`ì˜ íŒ¨í‚¤ì§€ ì¸ë±ìŠ¤ë¥¼ ìµœì‹ í™”í•˜ê³ , `apt`ê°€ HTTPSë¥¼ í†µí•´ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.\n\n```shell\n$ sudo apt-get update\n$ sudo apt-get install \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n```\n\n#### ë„ì»¤ì˜ ê³µì‹ GPG í‚¤ ì¶”ê°€\n\n```shell\n$ sudo mkdir -p /etc/apt/keyrings\n$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n```\n\n#### ë ˆí¬ì§€í† ë¦¬ ì…‹ì—…\n\n```shell\n$ echo \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n```\n\n#### ë„ì»¤ ì—”ì§„ ì„¤ì¹˜\n\nì•„ë˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ê°€ì¥ ìµœì‹ ë²„ì „ì˜ ë„ì»¤ ì—”ì§„ì´ ì„¤ì¹˜ë©ë‹ˆë‹¤.\n\n```shell\n$ sudo apt-get update\n$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n```\n\n#### ë„ì»¤ ì„¤ì¹˜ í™•ì¸\n\n```shell\n$ sudo docker run hello-world\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n...\n```\n\nìœ„ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ìœ„ì™€ ê°™ì´ `Hello from Docker!` ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ë©´ ì„±ê³µì ìœ¼ë¡œ ë„ì»¤ ì„¤ì¹˜ê°€ ì™„ë£Œëœ ê²ƒ ì…ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ë³¼ê¹Œìš”? ğŸ¤—\n\n## ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰\n\n### ì  í‚¨ìŠ¤ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ\n\n```shell\n$ docker pull jenkins/jenkins:lts\n```\n\nìœ„ ëª…ë ¹ì„ í†µí•´ Jenkins LTS(Long Term Support) ë²„ì „ì˜ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.\n\n### ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ë„ìš°ê¸°\n\n```shell\n$ sudo docker run -d -p 8080:8080 -v /jenkins:/var/jenkins_home --name jenkins -u root jenkins/jenkins:lts\n```\n\nìœ„ ëª…ë ¹ì„ í†µí•´ ë‹¤ìš´ë¡œë“œ ë°›ì€ ì  í‚¨ìŠ¤ ì´ë¯¸ì§€ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ëœ ê° ì˜µì…˜ì„ ê°„ë‹¨íˆ ì•Œì•„ë³¼ê¹Œìš”?\n\n- **-d** : ì»¨í…Œì´ë„ˆë¥¼ **ë°ëª¬**ìœ¼ë¡œ ë„ì›ë‹ˆë‹¤.\n- **-p 8080:8080** : ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì™€ ë‚´ë¶€ í¬íŠ¸ë¥¼ **í¬ì›Œë”©**í•©ë‹ˆë‹¤. ì¢Œì¸¡ì´ í˜¸ìŠ¤íŠ¸ í¬íŠ¸, ìš°ì¸¡ì´ ì»¨í…Œì´ë„ˆ í¬íŠ¸ì…ë‹ˆë‹¤.\n- **-v /jenkins:/var/jenkins_home** : ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„°ëŠ” **ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë˜ë©´ íœ˜ë°œ**ë©ë‹ˆë‹¤. ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ë°©ë²•ì´ ì¡´ì¬í•˜ëŠ”ë°, ê·¸ ì¤‘ í•œ ë°©ë²•ì´ **ë³¼ë¥¨ ë§ˆìš´íŠ¸**ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆì˜ `/var/jenkins_home` ì´ë¼ëŠ” ë””ë ‰í† ë¦¬ë¥¼ í˜¸ìŠ¤íŠ¸ì˜ `/jenkins` ì™€ ë§ˆìš´íŠ¸í•˜ê³  ë°ì´í„°ë¥¼ ë³´ì¡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- **--name jenkins** : ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ì„ ì„¤ì •í•©ë‹ˆë‹¤.\n- **-u root** : ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë¦¬ëˆ…ìŠ¤ì˜ ì‚¬ìš©ì ê³„ì •ì„ root ë¡œ ëª…ì‹œí•©ë‹ˆë‹¤.\n\n### docker-compose ì‚¬ìš©í•˜ê¸°\n\ní•˜ì§€ë§Œ ìœ„ì™€ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ëª¨ë‘ ì™¸ìš°ê³  ìˆë‹¤ê°€, ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ë§ˆë‹¤ ì…ë ¥í•˜ê²Œ ëœë‹¤ë©´ êµ‰ì¥íˆ ë²ˆê±°ë¡­ê² ì£ . ë”°ë¼ì„œ ë„ì»¤ëŠ” docker-compose ë¼ëŠ” ê²ƒì„ ì§€ì›í•©ë‹ˆë‹¤. ë„ì»¤ ì»´í¬ì¦ˆëŠ” ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆì˜ ì‹¤í–‰ì„ í•œë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ë„ì»¤ì˜ ë„êµ¬ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì €í¬ì™€ ê°™ì´ í•˜ë‚˜ì˜ ì»¨í…Œì´ë„ˆë§Œ í•„ìš”í•œ ìƒí™©ì—ì„œë„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì£ .\n\n```shell\n$ sudo apt install docker-compose\n```\n\nìœ„ ëª…ë ¹ì„ ì´ìš©í•˜ì—¬ `docker-compose` ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n\nê·¸ë¦¬ê³  ë„ì»¤ë¥¼ ì‹¤í–‰í•  ê²½ë¡œì— `docker-compose.yml` ì´ë€ íŒŒì¼ì„ ë§Œë“¤ê³ , ì•„ë˜ì˜ ë‚´ìš©ì„ ì‘ì„±í•´ì¤ë‹ˆë‹¤.\n\n```yaml\nversion: \"3\"\nservices:\n  jenkins:\n    image: jenkins/jenkins:lts\n    user: root\n    volumes:\n      - ./jenkins:/var/jenkins_home\n    ports:\n      - 8080:8080\n```\n\nìƒì„±í•œ `docker-compose.yml` ì´ ì¡´ì¬í•˜ëŠ” ê²½ë¡œì—ì„œ ì•„ë˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ë³µì¡í•œ ëª…ë ¹ ì—†ì´ë„ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```shell\n$ sudo docker-compose up -d\n```\n\n> -d ì˜µì…˜ì€ ì»¨í…Œì´ë„ˆê°€ ë°ëª¬ìœ¼ë¡œ ì‹¤í–‰ë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\n## ì  í‚¨ìŠ¤ ì„¤ì •\n\në„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆê°€ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì„±ê³µì ìœ¼ë¡œ ë„ì›Œì¡Œë‹¤ë©´, EC2ì˜ í¼ë¸”ë¦­ IPë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ì†í•  ìˆ˜ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤. localhost:8080ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ ë³´ì¼ ê²ƒ ì…ë‹ˆë‹¤.\n\n![](./unlock-jenkins.png)\n\n```shell\n$ sudo docker logs jenkins\n```\n\nìœ„ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´, `jenkins` ì»¨í…Œì´ë„ˆì— ì¶œë ¥ëœ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì  í‚¨ìŠ¤ë¥¼ ìµœì´ˆë¡œ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•˜ë©´ ì‚¬ì§„ì—ì„œ ìš”êµ¬í•˜ëŠ” initial admin passwordë¥¼ ì¶œë ¥í•´ì£¼ëŠ”ë°ìš”, ë¡œê·¸ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\n\n```\n*************************************************************\n*************************************************************\n*************************************************************\n\nJenkins initial setup is required. An admin user has been created and a password generated.\n\nPlease use the following password to proceed to installation:\n\n\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n\n\nThis may also be found at: /var/jenkins_home/secrets/initialAdminPassword\n\n*************************************************************\n*************************************************************\n*************************************************************\n```\n\nìœ„ì—ì„œ í‘œì‹œëœ `XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX` ë¥¼ ì›¹ì‚¬ì´íŠ¸ì— ë„£ì–´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.\n\ní˜¹ì€ ì•„ë˜ì˜ ëª…ë ¹ìœ¼ë¡œ `jenkins` ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì§ì ‘ ì ‘ì†í•˜ì—¬, `/var/jenkins_home/secrets/initialAdminPassword` íŒŒì¼ì˜ ë‚´ìš©ì„ ì¡°íšŒí•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.\n\n```shell\n$ sudo docker exec -it jenkins /bin/bash\n$ cat /var/jenkins_home/secrets/initialAdminPassword\n```\n\n![](./customize-jenkins.png)\n\nê·¸ ë‹¤ìŒ ìœ„ í™”ë©´ì—ì„œ Install suggested pluginsë¥¼ í´ë¦­í•˜ì—¬ ì¶”ì²œë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ê·¸ ì´í›„ ìš”êµ¬ë˜ëŠ” ì—¬ëŸ¬ ì •ë³´ì˜ ì…ë ¥ì„ ë ë§ˆì³ì£¼ì„¸ìš”.\n\n```\nSystem.setProperty('org.apache.commons.jelly.tags.fmt.timeZone\n```\n\nì´í›„ ëŒ€ì‹œë³´ë“œì—ì„œ **Jenkins ê´€ë¦¬ > Script Console** ì—ì„œ ìœ„ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì…ë ¥í•˜ì—¬ íƒ€ì„ì¡´ì„ ì„œìš¸ë¡œ ì„¤ì •í•˜ê¸°ë§Œ í•˜ë©´, ì  í‚¨ìŠ¤ ê¸°ë³¸ ì„¤ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤! ğŸ‰\n\n## ë§ˆì¹˜ë©°\n\në‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡ì´ ì  í‚¨ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì–´ë–»ê²Œ ë°°í¬ ìë™í™” í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì¶•í•˜ì˜€ëŠ”ì§€ ì‘ì„±í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ë§ì€ ê¸°ëŒ€ ë¶€íƒë“œë¦½ë‹ˆë‹¤ ğŸ™\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì›¹ì„œë¹„ìŠ¤ ê°œë°œíŒ€ì€ ìƒˆë¡­ê²Œ ê°œë°œí•œ ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í• ê¹Œìš”? ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ë  ë•Œ ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ë¸Œëœì¹˜ë¥¼ Pull í•˜ê³ , í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , í˜„ì¬ ë™ì‘ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³ , ìƒˆë¡­ê²Œ ë¹Œë“œëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš°ëŠ” ê³¼ì •... ë°°â€¦","fields":{"slug":"/deploy-automation-with-shell-script/"},"frontmatter":{"date":"July 19, 2022","title":"ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ë‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìë™í™”","tags":["DevOps"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nì›¹ì„œë¹„ìŠ¤ ê°œë°œíŒ€ì€ ìƒˆë¡­ê²Œ ê°œë°œí•œ ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í• ê¹Œìš”? ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ë  ë•Œ ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ë¸Œëœì¹˜ë¥¼ Pull í•˜ê³ , í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , í˜„ì¬ ë™ì‘ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³ , ìƒˆë¡­ê²Œ ë¹Œë“œëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš°ëŠ” ê³¼ì •...\n\në°°í¬ê°€ í•„ìš”í• ë•Œë§ˆë‹¤ ì´ëŸ° ëª…ë ¹ì„ ìˆ˜ë™ìœ¼ë¡œ ì¼ì¼íˆ ì…ë ¥í•œë‹¤ë©´, ê·¸ê±´ ë„ˆë¬´ ì§€ë£¨í•œ ì‘ì—…ì•„ë‹ê¹Œìš”? ğŸ˜« ì‹¤ìˆ˜ë¼ë„ í•˜ë©´ ì–´ì©Œì£ ? ğŸ˜°\n\nìš°í…Œì½” ë‹¬ë¡íŒ€ ë°±ì—”ë“œëŠ” ì´ëŸ° í•œê³„ì ì„ ê·¹ë³µí•˜ê³ ì ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë°°í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¬ë¡íŒ€ì€ ì–´ë–»ê²Œ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°°í¬ë¥¼ ìë™í™”í–ˆì„ê¹Œìš”?\n\n## ì‰˜ ìŠ¤í¬ë¦½íŠ¸\n\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ìœ ë‹‰ìŠ¤/ë¦¬ëˆ…ìŠ¤ ê¸°ë°˜ ìš´ì˜ì²´ì œì—ì„œì˜ ì¼ë ¨ì˜ ëª…ë ¹ìœ¼ë¡œ êµ¬ì„±ëœ ì‹¤í–‰ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸ íŒŒì¼ì…ë‹ˆë‹¤. ì›ë˜ë¼ë©´ ì¼ì¼íˆ í‚¤ë³´ë“œë¡œ ì…ë ¥í•´ì•¼í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ëª…ë ¹ì„ í•˜ë‚˜ì˜ íŒŒì¼ì— ëª¨ì•„ë‘ê³ , í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆì£ . ì‘ì„±ëœ ëª…ë ¹ì€ ì…¸ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ëª…ë ¹ì¤„ ì¸í„°í”„ë¦¬í„°ì—ì„œ ì‹¤í–‰ë˜ë©°, ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œ ì°¨ë¡€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•´ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në‹¬ë¡ì´ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ëŠ” í™˜ê²½ì€ Ubuntu 22 ë²„ì „ì´ë¯€ë¡œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## ìˆ˜ë™ìœ¼ë¡œ ë°°í¬í•˜ê¸°\n\në°°í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ë ¤ë©´ ìš°ì„  ìˆ˜ë™ìœ¼ë¡œ ì–´ë–¤ ëª…ë ¹ì„ ì‚¬ìš©í•´ì„œ ë°°í¬ë¥¼ í•˜ëŠ”ì§€ ì•Œì•„ì•¼í•©ë‹ˆë‹¤. ì–´ë–¤ê³¼ì •ì„ ê±°ì³ ë°°í¬ë˜ëŠ”ì§€ë¶€í„° ì•Œì•„ë³¼ê¹Œìš”?\n\n> ë ˆí¬ì§€í† ë¦¬ëŠ” ì´ë¯¸ Clone ë˜ì–´ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.\n\n### 1. Git Pull\n\n```shell\n$ cd 2022-dallog/backend\n$ git pull\n```\n\nìš°ì„  Githubì—ì„œ ê°€ì¥ ìµœì‹  ë²„ì „ì„ pull í•´ì™€ì•¼ê² ì£ ?\n\n### 2. ë¹Œë“œ\n\n```shell\n./gradlew bootJar\n```\n\n`gradlew` ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë°” í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•´ì„œ `.jar` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n### 3. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ\n\n```shell\n$ ps -ef | grep jar\n$ kill -15 XXXXX\n```\n\n`ps` ëª…ë ¹ì„ ì‚¬ìš©í•´ì„œ ì‹¤í–‰ì¤‘ì¸ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ PIDë¥¼ ì•Œì•„ë‚´ê³ , `kill` ëª…ë ¹ì„ í†µí•´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.\n\n### 4. í™˜ê²½ë³€ìˆ˜ ì„¤ì •\n\në‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì—¬ëŸ¬ ë¯¼ê°í•œ ì •ë³´ë¥¼ í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë  ë•Œ í™˜ê²½ë³€ìˆ˜ë„ í•¨ê»˜ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.\n\n```shell\n$ export GOOGLE_CLIENT_ID=\"XXXXX\"\n$ export GOOGLE_CLIENT_SECRET=\"XXXXX\"\n$ export GOOGLE_REDIRECT_URI=\"XXXXX\"\n$ export GOOGLE_TOKEN_URI=\"XXXXX\"\n$ export JWT_SECRET_KEY=\"XXXXX\"\n$ export JWT_EXPIRE_LENGTH=3600\n\n...\n```\n\n### 5. ë“œë””ì–´ ì‹¤í–‰\n\n```shell\n$ sudo -E nohup java -jar ./build/libs/backend-0.0.1-SNAPSHOT.jar\n```\n\në“œë””ì–´ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\nì´ ê·€ì°®ì€ ê³¼ì •ì„ ë°°í¬ í• ë•Œë§ˆë‹¤ í•´ì•¼í•œë‹¤ë‹ˆ ë²Œì¨ ë¨¸ë¦¬ê°€ ì–´ì§ˆì–´ì§ˆ í•˜ë„¤ìš”. ğŸ˜µâ€ğŸ’« ê·¸ë ‡ë‹¤ë©´ ì•ì„œ ì†Œê°œë“œë¦° ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ì„œ ì´ ê³¼ì •ì„ ìë™í™”í•´ë³¼ê¹Œìš”?\n\n## ë‹¬ë¡ì˜ ë°°í¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸\n\n```shell\n#! /bin/bash\n\nPROJECT_PATH=/home/ubuntu/2022-dallog\nPROJECT_NAME=backend\nPROJECT_BUILD_PATH=backend/build/libs\n\ncd $PROJECT_PATH/$PROJECT_NAME\n\nclear\n\necho \"ğŸŒˆ Githubì—ì„œ í”„ë¡œì íŠ¸ë¥¼ Pull í•©ë‹ˆë‹¤.\\n\"\n\ngit pull\n\necho \"\\nğŸŒˆ SpringBoot í”„ë¡œì íŠ¸ ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.\\n\"\n\n./gradlew bootJar\n\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\n\nif [ -z \"$CURRENT_PID\" ]; then\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\nelse\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\n\tkill -15 $CURRENT_PID\nfi\n\necho \"\\nğŸŒˆ SpringBoot í™˜ê²½ë³€ìˆ˜ ì„¤ì •\"\n\nexport GOOGLE_CLIENT_ID=\"XXXXX\"\nexport GOOGLE_CLIENT_SECRET=\"XXXXX\"\nexport GOOGLE_REDIRECT_URI=\"XXXXX\"\nexport GOOGLE_TOKEN_URI=\"XXXXX\"\nexport JWT_SECRET_KEY=\"XXXXX\"\nexport JWT_EXPIRE_LENGTH=3600\n\necho \"\\nğŸŒˆ SpringBoot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\\n\"\n\nJAR_PATH=$(ls $PROJECT_PATH/$PROJECT_BUILD_PATH/ | grep .jar | head -n 1)\nsudo -E nohup java -jar $PROJECT_PATH/$PROJECT_BUILD_PATH/$JAR_PATH &\n```\n\në‹¬ë¡ì´ ì‘ì„±í•œ ë°°í¬ ìë™í™” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì°¨ê·¼ì°¨ê·¼ ì•Œì•„ë³¼ê¹Œìš”?\n\n### #! /bin/bash\n\n`#! /bin/bash` ì€ í•´ë‹¹ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ë§ì€ ì‰˜ ì¤‘ **Bash Shell ë¡œ ì‹¤í–‰ë¨**ì„ ì•Œë¦½ë‹ˆë‹¤.\n\n### ë³€ìˆ˜ ì‚¬ìš©\n\n`PROJECT_PATH`, `PROJECT_NAME` ê³¼ ê°™ì´ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ëŠ” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ë³€ìˆ˜ ê¸°ëŠ¥ìœ¼ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë•Œ ì£¼ì˜í•  ì ì€ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•  ë•Œ `=` **ì•ë’¤ì— ê³µë°±ì´ ì™€ì„œëŠ” ì•ˆëœë‹¤ëŠ” ì ** ì…ë‹ˆë‹¤.\n\n### echo\n\n`echo` ëª…ë ¹ì„ í†µí•´ ë°°í¬ í”„ë¡œì„¸ìŠ¤ê°€ ì–´ë””ê¹Œì§€ ì§„í–‰ëëŠ”ì§€ ì‚¬ìš©ìì—ê²Œ ì•Œë ¤ì¤ë‹ˆë‹¤.\n\n### ì‹¤í–‰ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ PID ê°€ì ¸ì˜¤ê¸°\n\n```shell\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\n```\n\n#### pgrep\n\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì¤‘ ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ìœ„ ì½”ë“œëŠ” ìš°ì„  `pgrep` ì´ë¼ëŠ” ëª…ë ¹ì„ í†µí•´ì„œ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì˜ ì´ë¦„ìœ¼ë¡œ PID ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n\n#### pipeì™€ head\n\nê·¸ë¦¬ê³  íŒŒì´í”„(`|`)ëª…ë ¹ìœ¼ë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ PID ëª©ë¡ì„ ë³´ëƒ…ë‹ˆë‹¤. PID ëª©ë¡ì€ `head` ëª…ë ¹ìœ¼ë¡œ ì „ë‹¬ë˜ë©°, `head` ëª…ë ¹ì€ PID ëª©ë¡ì˜ ì²«ë²ˆì§¸ë§Œì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n\n#### ëª…ë ¹ì˜ ì‹¤í–‰ê²°ê³¼ë¥¼ ë³€ìˆ˜ì— ë‹´ê¸°\n\nì´ë ‡ê²Œ ê°€ì ¸ì˜¨ PIDëŠ” `$()` ë¬¸ë²•ì„ í†µí•´ `CURRENT_PID` ë³€ìˆ˜ì— ì €ì¥ë©ë‹ˆë‹¤. `$()` ëŠ” `$(command)` í˜•íƒœë¡œ ì‚¬ìš©ë˜ë©°, ê´„í˜¸ ë‚´ë¶€ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³€ìˆ˜ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\n### ì¡°ê±´ë¬¸\n\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ë„ `if` ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ìš°ë¦¬ì—ê²Œ ìµìˆ™í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œì˜ ifë¬¸ê³¼ëŠ” ì¡°ê¸ˆ ê´´ë¦¬ê°€ ì¡´ì¬í•´ì„œ ë³„ë„ë¡œ í•™ìŠµì´ í•„ìš”í• ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\n\n```shell\nif [ -z \"$CURRENT_PID\" ]; then\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\nelse\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\n\tkill -15 $CURRENT_PID\nfi\n```\n\nìœ„ ì½”ë“œëŠ” ì•„ê¹Œ PIDë¥¼ ë‹´ì€ `CURRENT_PID` ê°€ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸í•œ í›„ ì¡´ì¬í•˜ì§€ ì•Šë‹¤ë©´ ë©”ì‹œì§€ë§Œ ì¶œë ¥í•˜ê³ , ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ PIDë¥¼ `kill` ëª…ë ¹ìœ¼ë¡œ ì¢…ë£Œí•©ë‹ˆë‹¤.\n\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ì˜ `if` ë¬¸ì—ì„œ `-z` ëŠ” ì¡°ê±´ì‹ì˜ ì¢…ë¥˜ ì¤‘ í•˜ë‚˜ì´ë©°, ì£¼ì–´ì§„ ë¬¸ìì—´ì˜ ê¸¸ì´ê°€ 0ì´ë¼ë©´ Trueë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í™•ì‹¤íˆ ì¡°ê¸ˆ ë‚¯ì„¤ì£ ? ğŸ˜…\n\n### JARíŒŒì¼ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°\n\n```shell\nJAR_PATH=$(ls $PROJECT_PATH/$PROJECT_BUILD_PATH/ | grep .jar | head -n 1)\n```\n\n`ls` ëª…ë ¹ì„ í†µí•´ ë¹Œë“œ ë””ë ‰í† ë¦¬ì˜ íŒŒì¼ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê³ , `grep` ëª…ë ¹ì„ í†µí•´ `.jar` íŒŒì¼ë§Œì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ê·¸ë‹¤ìŒ `head` ëª…ë ¹ì„ í†µí•´ ë‹¨ í•˜ë‚˜ì˜ íŒŒì¼ë§Œì„ ê°€ì ¸ì˜¨ ë‹¤ìŒ, `JAR_PATH` ë³€ìˆ˜ì— ì €ì¥í•©ë‹ˆë‹¤.\n\n### ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰í•˜ê¸°\n\n```shell\nsudo -E nohup java -jar $PROJECT_PATH/$PROJECT_BUILD_PATH/$JAR_PATH &\n```\n\nì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n#### sudo -E\n\n`sudo` ëª…ë ¹ ë’¤ì— ë¶™ì€ `-E` ì˜µì…˜ì€ ìœ ì €ê°€ ì„¤ì •í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ `sudo` ëª…ë ¹ì—ì„œë„ ê³µìœ í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“œëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.\n\n#### nohup\n\n`nohup` ëª…ë ¹ì€ í˜„ì¬ **í„°ë¯¸ë„ ì„¸ì…˜ì´ ëŠì–´ì ¸ë„ í”„ë¡œì„¸ìŠ¤ê°€ ê³„ì† ì‚´ì•„ìˆë„ë¡** ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤.\n\n#### Background í”„ë¡œì„¸ìŠ¤\n\nê·¸ë¦¬ê³  ëª…ë ¹ ë§¨ ë’¤ì— `&` ê°€ ë¶™ì–´ìˆëŠ”ë°, í”„ë¡œì„¸ìŠ¤ë¥¼ Foregroundê°€ ì•„ë‹Œ **Backgroundì—ì„œ ì‹¤í–‰**í•˜ê¸° ìœ„í•´ ë¶™ì—¬ì¤ë‹ˆë‹¤.\n\n## í•œê³„ì \n\ní•˜ì§€ë§Œ, ì´ëŸ° ë°©ì‹ë„ ê²°êµ­ í•œê³„ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. íŠ¹íˆë‚˜ ë‹¬ë¡ê³¼ ê°™ì´ ì• ìì¼í•œ ì¡°ì§ì—ì„œëŠ” ìµœëŒ€í•œ ì‘ì€ ê¸°ëŠ¥ë‹¨ìœ„ë¡œ ê°œë°œì´ ë³‘ë ¬ì ìœ¼ë¡œ ì§„í–‰ë˜ì–´, ë©”ì¸ ë¸Œëœì¹˜ì— ë¨¸ì§€ë©ë‹ˆë‹¤. í•˜ë£¨ì— ëª‡ë²ˆì´ê³  ë°°í¬ë¥¼ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí• ìˆ˜ë„ ìˆì£ .\nê·¸ë ‡ì§€ ì•Šì•„ë„ ëª¨ë“  ê°œë°œìê°€ ë°”ì˜ê²Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ê°œë°œí•˜ê¸° ë°”ìœë°, ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ëœ ì‹œì ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•´ì„œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ì•¼í• ê¹Œìš”?\n\nì´ëŸ° í•œê³„ì ì„ ê·¹ë³µí•˜ê³ ì, ë‹¬ë¡íŒ€ì€ ì•ìœ¼ë¡œ CI/CD ë„êµ¬ë¥¼ ë„ì…í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„¸ìƒì—ëŠ” ì°¸ ë‹¤ì–‘í•œ CI/CD ë„êµ¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. Jenkins, Github Actions, Travis CI, Circle CI, Gitlab CI/CD ë“±ë“±...\n\në‹¬ë¡ì˜ ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì˜ ë°°í¬ íƒœìŠ¤í¬ì—ì„œëŠ” ì´ëŸ° ë‹¤ì–‘í•œ CI/CD ë„êµ¬ë“¤ì˜ ì¥ë‹¨ì„ ë¶„ì„í•˜ê³  ë„ì…í•  ì˜ˆì •ì…ë‹ˆë‹¤. ë§ì€ ê¸°ëŒ€ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ğŸ‘ğŸ‘\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. auditingì´ë€ ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ì´ë²¤íŠ¸(insert, update, delete)ë¥¼ ì¶”ì í•˜ê³  ê¸°ë¡í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì„ ì¶”ê°€í•˜ê³  ì‹¶ì€ ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì— ëŒ€í•œ í•„ë“œë¥¼ ì¼ì¼ì´ êµ¬í˜„í•´ì£¼ì–´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´â€¦","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"date":"July 18, 2022","title":"Spring Data JPAì˜ Auditing","tags":["Spring","Data JPA","Auditing"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n> auditingì´ë€ ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ì´ë²¤íŠ¸(insert, update, delete)ë¥¼ ì¶”ì í•˜ê³  ê¸°ë¡í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.\n\nëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì„ ì¶”ê°€í•˜ê³  ì‹¶ì€ ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì— ëŒ€í•œ í•„ë“œë¥¼ ì¼ì¼ì´ êµ¬í˜„í•´ì£¼ì–´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ëª¨ë“  ì—”í‹°í‹°ì— ì¤‘ë³µì´ ìƒê¸°ê³  ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§„ë‹¤. Spring Data JPAê°€ ì œê³µí•˜ëŠ” `Auditing` ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì´ëŸ° ê¸°ëŠ¥ì„ ì‰½ê³  ë¹ ë¥´ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.\n\n## Spring Data JPA Auditing ì ìš©í•˜ê¸°\n\n`Auditing`ì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„  ì–´ë…¸í…Œì´ì…˜ì„ ì ìš©í•´ì•¼ í•œë‹¤. `@Configuration` ì–´ë…¸í…Œì´ì…˜ì´ ì ìš©ëœ Config í´ë˜ìŠ¤ì— ì•„ë˜ì™€ ê°™ì´ `@EnableJpaAuditing`ì„ ì¶”ê°€í•œë‹¤.\n\n```java\n@Configuration\n@EnableJpaAuditing\npublic class JpaConfig {\n}\n```\n\nâš ï¸ ì£¼ì˜ : ì›í™œí•œ Slice í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ @SpringBootApplication ê³¼ @EnableJpaAuditing ì–´ë…¸í…Œì´ì…˜ ë¶„ë¦¬í•˜ê¸°\n\n[https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing)\n\n### Spring Entity Callback Listener ì ìš©í•˜ê¸°\n\nAuditing entity listener classë¡œ ì§€ì •í•˜ê¸° ìœ„í•´ `@EntityListeners` ì–´ë…¸í…Œì´ì…˜ì„ Entity í´ë˜ìŠ¤ì— ì¶”ê°€í•œë‹¤. ì¸ìë¡œëŠ” `AuditingEntityListener.class`ë¥¼ ë„˜ê¸´ë‹¤. ì´ ì„¤ì •ì„ í†µí•´ ì—”í‹°í‹°ì— ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ ì •ë³´ë¥¼ ìº¡ì²˜í•  ìˆ˜ ìˆë‹¤.\n\n```java\n@Entity\n@EntityListeners(AuditingEntityListener.class)\npublic class BaseEntity {\n    // ...\n}\n```\n\n### ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ ì¶”ì í•˜ê¸°\n\nìƒì„±ì¼ì‹œëŠ” `@CreatedDate`, ìˆ˜ì •ì¼ì‹œëŠ” `@LastModifiedDate` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì¶”ì í•  ìˆ˜ ìˆë‹¤. ìƒì„±ì¼ì‹œì˜ ê²½ìš° í•œ ë²ˆ ìƒì„±ë˜ë©´ ë³€ê²½ë˜ì–´ì„  ì•ˆ ë˜ë©°, í•­ìƒ ì¡´ì¬í•´ì•¼ í•˜ë¯€ë¡œ `nullable = false`, `updatable = false`ë¡œ ì§€ì •í•œë‹¤.\n\nì¶”ê°€ì ìœ¼ë¡œ BaseEntityë¥¼ ë‹¤ë¥¸ Entityë“¤ì´ ìƒì†ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `@MappedSuperclass` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ Entityê°€ ì•„ë‹Œ SuperClassë¡œ ì§€ì •í–ˆë‹¤.\n\n```java\n@MappedSuperclass\n@EntityListeners(AuditingEntityListener.class)\npublic abstract class BaseEntity {\n\n    @CreatedDate\n    @Column(name = \"created_at\", nullable = false, updatable = false)\n    private LocalDateTime createdAt;\n\n    @LastModifiedDate\n    @Column(name = \"updated_at\")\n    private LocalDateTime updatedAt;\n\n    // ...\n}\n```\n\n### ìƒì„±í•œ ì‚¬ëŒ, ìˆ˜ì •í•œ ì‚¬ëŒ ì¶”ì í•˜ê¸°\n\nìƒì„±í•œ ì‚¬ëŒì€ `@CreatedBy`, ìˆ˜ì •í•œ ì‚¬ëŒì€ `@LastModifiedBy` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì¶”ì í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ í•„ë“œëŠ” ìƒì„±ì, ìˆ˜ì •ìì˜ ì´ë¦„ìœ¼ë¡œ ì±„ì›Œì§„ë‹¤.\n\n```java\n@MappedSuperclass\n@EntityListeners(AuditingEntityListener.class)\npublic abstract class BaseEntity {\n\n    @CreatedBy\n    @Column(name = \"created_by\")\n    private String createdBy;\n\n    @LastModifiedBy\n    @Column(name = \"modified_by\")\n    private String modifiedBy;\n\n    // ...\n}\n```\n\nìœ ì €ì— ëŒ€í•œ ì •ë³´ëŠ” SecurityContext's Authentication ì¸ìŠ¤í„´ìŠ¤ë¡œë¶€í„° ê°€ì ¸ì˜¨ë‹¤. ì´ ê°’ì„ ì»¤ìŠ¤í…€í•˜ê³  ì‹¶ë‹¤ë©´ `AuditorAware<T>` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.\n\n```java\npublic class AuditorAwareImpl implements AuditorAware<String> {\n\n    @Override\n    public String getCurrentAuditor() {\n        // your custom logic\n    }\n}\n```\n\nì´ë ‡ê²Œ ë§Œë“  `AuditorAwareImpl`ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Config í´ë˜ìŠ¤ì— `AuditorAwareImpl` ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ˆê¸°í™”ë˜ëŠ” `AuditorAware` íƒ€ì…ì˜ ë¹ˆì„ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  `@EnableJpaAuditing` ì–´ë…¸í…Œì´ì…˜ì— `auditorAwareRef=\"auditorProvider\"` ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.\n\n```java\n@Configuration\n@EnableJpaAuditing(auditorAwareRef=\"auditorProvider\")\npublic class JpaConfig {\n    //...\n\n    @Bean\n    AuditorAware<String> auditorProvider() {\n        return new AuditorAwareImpl();\n    }\n\n    //...\n}\n```\n\n---\n\n### References\n\n[https://www.baeldung.com/database-auditing-jpa](https://www.baeldung.com/database-auditing-jpa)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Spring Data JPAì—ì„œëŠ” Paginationì„ ìœ„í•œ ë‘ ê°€ì§€ ê°ì²´ë¥¼ ì œê³µí•œë‹¤. ë°”ë¡œ Sliceì™€ Pageë‹¤. Repository ì½”ë“œë¥¼ ë¨¼ì € ë³´ì. ë©”ì„œë“œë¥¼ ë³´ë©´ íŒŒë¼ë¯¸í„°ë¡œ  ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤.  ê°ì²´ëŠ” Paginationì„ ìœ„í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ë‹¤.  ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ì¸ ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬â€¦","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"date":"July 18, 2022","title":"Spring Data JPAì˜ Slice & Page","tags":["Spring","Data JPA","Slice","Page"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nSpring Data JPAì—ì„œëŠ” Paginationì„ ìœ„í•œ ë‘ ê°€ì§€ ê°ì²´ë¥¼ ì œê³µí•œë‹¤. ë°”ë¡œ Sliceì™€ Pageë‹¤. Repository ì½”ë“œë¥¼ ë¨¼ì € ë³´ì.\n\n```java\npublic interface MemberRepository extends JpaRepository<Member, Long> {\n    Slice<Member> findSliceBy(final Pageable pageable);\n        Page<Member> findPageBy(final Pageable pageable);\n}\n\n// Controller\n// queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ëŠ”ë‹¤\n@GetMapping(\"/api/members\")\npublic List<MemberResponse> findAll(@RequestParam int page, @RequestParam int size) {\n    // ìƒëµ\n}\n\n// Service\nPageRequest pageRequest = PageRequest.of(page, size); // pageRequest ìƒì„±\nSlice<Member> slices = memberRepository.findSliceBy(pageRequest); // repositoryì—ì„œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°\nPage<Member> pages = memberRepository.findPageBy(pageRequest);\n```\n\në©”ì„œë“œë¥¼ ë³´ë©´ íŒŒë¼ë¯¸í„°ë¡œ `Pageable` ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤. **`Pageable` ê°ì²´ëŠ” Paginationì„ ìœ„í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´**ë‹¤. `Pageable` ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ì¸ `PageRequest`ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë©”ì„œë“œ ì¸ìë¡œ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.\n\n![PageRequest static constructor](pagerequest.png)\n\n`PageRequest`ëŠ” ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ `of`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. `PageRequest`ëŠ” ì¸ìë¡œ page, size, í•„ìš”í•˜ë‹¤ë©´ sortê¹Œì§€ ë°›ì„ ìˆ˜ ìˆë‹¤.\n\n- `page` : 0ë¶€í„° ì‹œì‘í•˜ëŠ” í˜ì´ì§€ ì¸ë±ìŠ¤ ë²ˆí˜¸\n- `size` : í•œ í˜ì´ì§€ì— ë°˜í™˜í•  ë°ì´í„°ì˜ ê°œìˆ˜\n- `sort` : ì •ë ¬ ë°©ì‹\n\npageì™€ sizeë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ `PageRequest`ë¥¼ ìƒì„±í•˜ì—¬ Repository ë©”ì„œë“œì— ë„˜ê²¨ì£¼ëŠ” ê²ƒìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ Paginationì„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.\n\n## Slice VS Page\n\n```java\npublic interface MemberRepository extends JpaRepository<Member, Long> {\n    Slice<Member> findSliceBy(final Pageable pageable);\n        Page<Member> findPageBy(final Pageable pageable);\n}\n```\n\nRepositoryì˜ ë©”ì„œë“œë¥¼ ë³´ë©´ ë°˜í™˜ ê°’ìœ¼ë¡œ `Slice` í˜¹ì€ `Page`ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ë‘˜ì€ ì–´ë–¤ ì°¨ì´ê°€ ìˆì„ê¹Œ?\n\n### Slice\n\n![slice](slice.png)\n\n`Slice`ëŠ” `Streamable`ì„ ìƒì†ë°›ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ Paginationê³¼ ê´€ë ¨ëœ ì—¬ëŸ¬ ë©”ì„œë“œë¥¼ ê°–ê³  ìˆë‹¤. ëŒ€í‘œì ì¸ ë©”ì„œë“œ ëª‡ ê°€ì§€ë§Œ ì‚´í´ë³´ì.\n\n![slice methods](slice_methods.png)\n\ní˜„ì¬ í˜ì´ì§€ì˜ ë‚´ìš©ì„ í™•ì¸í•˜ê±°ë‚˜ ë‹¤ìŒ í˜ì´ì§€, ì´ì „ í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ `Page`ëŠ” ë¬´ì—‡ì¼ê¹Œ?\n\n### Page\n\n![page](page.png)\n\n`Page`ëŠ” `Slice`ë¥¼ ìƒì†í•œë‹¤. ë”°ë¼ì„œ `Slice`ê°€ ê°€ì§„ ëª¨ë“  ë©”ì„œë“œë¥¼ `Page`ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ `Page`ê°€ ë‹¤ë¥¸ ì ì€ **ì¡°íšŒ ì¿¼ë¦¬ ì´í›„ ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ê°€ í•œ ë²ˆ ë” ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒ**ì´ë‹¤.\n\nPageê°€ ì¶”ê°€ì ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆëŠ” ë©”ì„œë“œ ë‘ ê°€ì§€ë§Œ ì‚´í´ë³´ì.\n\n![page methods](page_methods.png)\n\nPageì˜ ê²½ìš° ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ê°€ ì¶”ê°€ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ Sliceì™€ ë‹¤ë¥´ê²Œ ì „ì²´ ë°ì´í„° ê°œìˆ˜ë‚˜ ì „ì²´ í˜ì´ì§€ ìˆ˜ê¹Œì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\n\n> ì¶”ê°€ì ìœ¼ë¡œ..\n\n```java\npublic interface PagingAndSortingRepository<T, ID> extends CrudRepository<T, ID> {\n\n    Iterable<T> findAll(Sort sort);\n\n    Page<T> findAll(Pageable pageable);\n}\n```\n\n`Page`ë¥¼ ë°˜í™˜ë°›ì„ ê²½ìš° ì•„ë˜ì²˜ëŸ¼ **`Page`ë¥¼ ë°˜í™˜í•˜ëŠ” `findAll` ë©”ì„œë“œê°€ ì´ë¯¸ ì¡´ì¬**í•œë‹¤. ë”°ë¡œ Repository Interfaceì— ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ì£¼ì§€ ì•Šì•„ë„ `findAll` ë©”ì„œë“œì— `Pageable` ê°ì²´ë¥¼ ë„˜ê²¨ì£¼ë©´ Paginationì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (Sliceë¥¼ ë°˜í™˜í•˜ë ¤ë©´ ë©”ì„œë“œë¥¼ ì •ì˜í•´ì£¼ì–´ì•¼ í•œë‹¤.)\n\n### Slice VS Page ì–´ë–¤ ê±¸ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?\n\n`Slice`ëŠ” ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ì§€ ì•Šê³  ì´ì „ or ë‹¤ìŒ `Slice`ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ **`Slice`ëŠ” ë¬´í•œ ìŠ¤í¬ë¡¤ ë“±ì„ êµ¬í˜„í•˜ëŠ” ê²½ìš° ìœ ìš©**í•˜ë‹¤. `Page`ì— ë¹„í•´ ì¿¼ë¦¬ê°€ í•˜ë‚˜ ëœ ë‚ ì•„ê°€ë¯€ë¡œ **ë°ì´í„° ì–‘ì´ ë§ì„ìˆ˜ë¡ `Slice`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ìƒ ìœ ë¦¬**í•˜ë‹¤.\n\n`Page`ëŠ” ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ë¥¼ í•œ ë²ˆ ë” ì‹¤í–‰í•œë‹¤. ë”°ë¼ì„œ **ì „ì²´ í˜ì´ì§€ ê°œìˆ˜ë‚˜ ë°ì´í„° ê°œìˆ˜ê°€ í•„ìš”í•œ ê²½ìš° ìœ ìš©**í•˜ë‹¤.\n\n> ì•Œë¡ì—ì„œëŠ” ì¹´í…Œê³ ë¦¬ ì¡°íšŒë¥¼ ë¬´í•œ ìŠ¤í¬ë¡¤ë¡œ êµ¬í˜„í•˜ë¯€ë¡œ Sliceë¥¼ ì‚¬ìš©í–ˆë‹¤.\n\n## ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ queryParameterë¥¼ Pageable ê°ì²´ë¡œ ë°›ëŠ” ë°©ë²•\n\nì•ì—ì„  queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ì•„ PageRequestë¥¼ ë§Œë“¤ì–´ ë„˜ê²¨ì£¼ëŠ” ë°©ë²•ì„ ì„¤ëª…í–ˆë‹¤.\n\n```java\n// Controller\n// queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ëŠ”ë‹¤\n@GetMapping(\"/api/members\")\npublic List<MemberResponse> findAll(@RequestParam int page, @RequestParam int size) {\n    // ìƒëµ\n}\n```\n\ní•˜ì§€ë§Œ ì´ë ‡ê²Œ êµ¬í˜„í•˜ë‹ˆê¹Œ *â€œModelAttributeë¥¼ í†µí•´ queryParameterë¥¼ DTOë¡œ ë°›ëŠ” ê²ƒì²˜ëŸ¼, queryParameterë¥¼ Pageable ê°ì²´ë¡œ ë°›ì„ ìˆ˜ ì—†ì„ê¹Œ?â€*í•˜ëŠ” ì˜ë¬¸ì´ ìƒê²¼ë‹¤. ì§ì ‘ ArgumentResolverë¥¼ êµ¬í˜„í•  ë»”í–ˆì§€ë§Œ ì°¾ì•„ë³´ë‹ˆ ì—­ì‹œ ë˜‘ë˜‘í•œ JPA.. Pageable ê°ì²´ë¥¼ ì¸ìˆ˜ë¡œ ì„¤ì •í•˜ë©´ ì–´ë…¸í…Œì´ì…˜ ì—†ì´ë„ ìë™ìœ¼ë¡œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. `PageableHandlerMethodArgumentResolver` ê°€ ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.\n\n```java\n// Controller\n// Pageable ê°ì²´ë¥¼ ë°”ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.\n@GetMapping(\"/api/members\")\npublic List<MemberResponse> findAll(Pageable pagealbe) {\n    // ìƒëµ\n}\n\n// Service\nSlice<Member> slices = memberRepository.findSliceBy(pageable); // PageReqeustë¥¼ ìƒì„±í•  í•„ìš” ì—†ì´ ë°”ë¡œ ê°ì²´ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.\n```\n\nì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ PageReqeustë¥¼ ìƒì„±í•  í•„ìš” ì—†ì´ ë°”ë¡œ ê°ì²´ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆì–´ í›¨ì”¬ í¸í•˜ë‹¤. í•˜ì§€ë§Œ ë¬¸ì œê°€ í•œ ê°€ì§€ ë°œìƒí•œë‹¤. **í”„ë¡ íŠ¸ì—ì„œëŠ” page indexë¥¼ 1ë¶€í„° ê³„ì‚°í•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ Pageableì€ page indexë¥¼ 0ë¶€í„° ê³„ì‚°í•œë‹¤.** ë”°ë¼ì„œ pageì˜ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•  í•„ìš”ê°€ ìˆë‹¤.\n\n## page ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•˜ê¸°\n\n### ë°©ë²• 1. PageableHandlerMethodArgumentResolverCustomizer ì»¤ìŠ¤í„°ë§ˆì´ì§• í•˜ê¸°\n\n```java\n@Configuration\npublic class CustomPageableConfiguration {\n    @Bean\n    public PageableHandlerMethodArgumentResolverCustomizer customize() {\n        return p -> p.setOneIndexedParameters(true);\n    }\n}\n```\n\në”°ë¡œ `CustomPageableConfiguration` í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ `PageableHandlerMethodArgumentResolverCustomizer`ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•´ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤. ì—¬ê¸°ì„œ `setOneIndexedParameters` ë©”ì„œë“œë¥¼ í†µí•´ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.\n\n### ë°©ë²• 2. application-propertiesì— ì„¤ì • ì¶”ê°€í•˜ê¸°\n\n```java\nspring.data.web.pageable.one-indexed-parameters=true\n```\n\n### ìœ ì˜ì  1\n\nì´ë ‡ê²Œ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•˜ë©´ **ë‹¨ìˆœíˆ Controllerì—ì„œ ë°›ëŠ” Pageableì˜ page ê°’ì´ -1 ë˜ì–´ ì €ì¥ë  ë¿ì´ë‹¤.** Pageable ê°ì²´ë‚˜ ì´í›„ì— ë°˜í™˜ë°›ì€ Slice, Page ê°ì²´ì—ì„œëŠ” **page ì¸ë±ìŠ¤ê°€ ì—¬ì „íˆ 0ë¶€í„° ì‹œì‘**í•œë‹¤. \n\në”°ë¼ì„œ getNumber ë“±ì˜ ë©”ì„œë“œë¥¼ í†µí•´ page ë²ˆí˜¸ë¥¼ ë°›ìœ¼ë©´ -1ì”© ì°¨ì´ê°€ ë‚œë‹¤ëŠ” ì‚¬ì‹¤ì„ ìŠì–´ì„  ì•ˆ ëœë‹¤. **í˜„ì¬ í˜ì´ì§€ indexë¥¼ ë°˜í™˜í•˜ê³  ì‹¶ë‹¤ë©´ ë°˜ë“œì‹œ -1**ì„ í•´ì¤˜ì•¼ í•œë‹¤. ìœ ì˜í•´ì„œ ì‚¬ìš©í•˜ì.\n\n### ìœ ì˜ì  2\n\n**ë¬´í•œ ìŠ¤í¬ë¡¤ì„ Sliceë‚˜ Pageë¡œ êµ¬í˜„í•˜ë©´ ë°ì´í„°ê°€ ì¤‘ë³µìœ¼ë¡œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤.** \n\nì˜ˆë¥¼ ë“¤ì–´ ìƒê°í•´ë³´ì. 30ê°œì˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ê³  10ê°œì˜ ë°ì´í„°ë¥¼ ì¶”ê°€ë¡œ ìš”ì²­í•˜ë ¤ í•˜ëŠ”ë°, ê·¸ ì‚¬ì´ì— 10ê°œì˜ ë°ì´í„°ê°€ ì•ì— ì¶”ê°€ë˜ì—ˆë‹¤. ì´ ê²½ìš° ë°ì´í„°ê°€ 10ê°œì”© ë°€ë ¤ì„œ 21~30ë²ˆì§¸ ë°ì´í„°ê°€ ì¤‘ë³µìœ¼ë¡œ ë‚˜íƒ€ë‚˜ê²Œ ëœë‹¤.\në‹¬ë¡ì—ì„œëŠ” ì•„ì§ ì´ ê²½ìš°ê¹Œì§€ ê³ ë ¤í•´ì„œ í˜ì´ì§•ì„ êµ¬í˜„í•˜ì§€ ëª»í–ˆë‹¤. ì¢€ ë” ê³ ë¯¼í•´ë³´ì•„ì•¼ í•  ë¶€ë¶„ì¸ ê²ƒ ê°™ë‹¤.\n\n### References\n\n[https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/](https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/)\n\n[https://treasurebear.tistory.com/59](https://treasurebear.tistory.com/59)\n\n[https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html)\n\n[https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë§¤íŠ¸ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸° ìš°ë¦¬ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì–´ë– í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ êµ¬ì„±í• ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤. ë³´í†µ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ë‚˜ëˆ„ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ìœ¼ë¡œ , ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ê³„ì¸µë³„ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³„ì¸µí˜• êµ¬ì¡°ëŠ” ê° ê³„ì¸µì„ ëŒ€í‘œí•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í•œë‹¤. ê³„ì¸µí˜• êµ¬ì¡°ì˜ ê°€ì¥ í° ì¥ì ì€ í•´ë‹¹ í”„ë¡œâ€¦","fields":{"slug":"/package-structure/"},"frontmatter":{"date":"July 18, 2022","title":"ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°","tags":["íŒ¨í‚¤ì§€ êµ¬ì¡°"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë§¤íŠ¸](https://github.com/hyeonic)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°\n\nìš°ë¦¬ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì–´ë– í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ êµ¬ì„±í• ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤. ë³´í†µ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ë‚˜ëˆ„ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ìœ¼ë¡œ `ê³„ì¸µë³„`, `ê¸°ëŠ¥ë³„`ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.\n\n### ê³„ì¸µë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°\n\n```json\nâ””â”€â”€ src\n    â”œâ”€â”€ main\n    â”‚   â”œâ”€â”€ java\n    â”‚   â”‚   â””â”€â”€ com\n    â”‚   â”‚       â””â”€â”€ allog\n    â”‚   â”‚           â””â”€â”€ dallog\n    â”‚   â”‚               â”œâ”€â”€ application\n    â”‚   â”‚               â”œâ”€â”€ config\n    â”‚   â”‚               â”œâ”€â”€ domain\n    â”‚   â”‚               â”œâ”€â”€ dto\n    â”‚   â”‚               â”œâ”€â”€ exception\n    â”‚   â”‚               â”œâ”€â”€ presentation\n    â”‚   â”‚               â””â”€â”€ DallogApplication.java\n    â”‚   â””â”€â”€ resources\n    â”‚       â””â”€â”€ application.yml\n```\n\nê³„ì¸µí˜• êµ¬ì¡°ëŠ” ê° ê³„ì¸µì„ ëŒ€í‘œí•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í•œë‹¤. ê³„ì¸µí˜• êµ¬ì¡°ì˜ ê°€ì¥ í° ì¥ì ì€ í•´ë‹¹ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ì•„ë„ ê° ê³„ì¸µì— ëŒ€í•œ ì—­í• ì„ ì¶©ë¶„íˆ ìˆ™ì§€í•˜ê³  ìˆë‹¤ë©´ ì „ì²´ì ì¸ êµ¬ì¡°ë¥¼ ë¹ ë¥´ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.\n\ní•˜ì§€ë§Œ ë‹¨ì ë„ ì¡´ì¬í•œë‹¤. í•˜ë‚˜ì˜ íŒ¨í‚¤ì§€ì— ëª¨ë“  í´ë˜ìŠ¤ë“¤ì´ ëª¨ì´ê²Œ ë˜ê¸° ë•Œë¬¸ì— ê·œëª¨ê°€ ì»¤ì§€ë©´ í´ë˜ìŠ¤ì˜ ê°œìˆ˜ê°€ ë§ì•„ì ¸ êµ¬ë¶„ì´ ì–´ë ¤ì›Œì§„ë‹¤. ì•„ë˜ëŠ” ì´ì „ì— ê³„ì¸µí˜• êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ í”„ë¡œì íŠ¸ì´ë‹¤.\n\n```json\nâ””â”€â”€ presentation\n    â”œâ”€â”€ ChampionController.java\n    â”œâ”€â”€ CommentController.java\n    â”œâ”€â”€ PlaylistController.java\n    â”œâ”€â”€ RankingController.java\n    â”œâ”€â”€ SearchController.java\n    â”œâ”€â”€ UserController.java\n    â”œâ”€â”€ WardController.java\n    â””â”€â”€ ...\n```\n\në¹„êµì  ì ì€ ì½”ë“œì˜ ì–‘ì´ì§€ë§Œ ê·œëª¨ê°€ ì»¤ì§ˆìˆ˜ë¡ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ presentation ê³„ì¸µì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ê°ì²´ê°€ í•´ë‹¹ íŒ¨í‚¤ì§€ì— ëª¨ì´ê²Œ ë  ê²ƒì´ë‹¤.\n\n### ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°\n\nê¸°ëŠ¥ë³„ë¡œ íŒ¨í‚¤ì§€ë¥¼ ë‚˜ëˆ  êµ¬ì„±í•œë‹¤. ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°ì˜ ì¥ì ì€ í•´ë‹¹ ë„ë©”ì¸ì— ê´€ë ¨ëœ ì½”ë“œë“¤ì´ ì‘ì§‘ë˜ì–´ ìˆë‹¤ëŠ” ì ì´ë‹¤. ë•ë¶„ì— `ì§€ì—­ì„±ì˜ ì›ì¹™`ë¥¼ ì˜ ì§€í‚¬ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.\n\n> ì»´í“¨í„° ê³¼í•™ì—ì„œ, ì°¸ì¡°ì˜ ì§€ì—­ì„±, ë˜ëŠ” ì§€ì—­ì„±ì˜ ì›ì¹™ì´ë€ í”„ë¡œì„¸ì„œê°€ ì§§ì€ ì‹œê°„ ë™ì•ˆ ë™ì¼í•œ ë©”ëª¨ë¦¬ ê³µê°„ì— ë°˜ë³µì ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ê²½í–¥ì„ ì˜ë¯¸í•œë‹¤. ì°¸ì¡° ì§€ì—­ì„±ì—” ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤. ë°”ë¡œ ì‹œê°„ì  ì§€ì—­ì„±ê³¼ ê³µê°„ì  ì§€ì—­ì„±ì´ë‹¤. ì‹œê°„ì  ì§€ì—­ì„±ì´ë€ íŠ¹ì • ë°ì´í„° ë˜ëŠ” ë¦¬ì†ŒìŠ¤ê°€ ì§§ì€ ì‹œê°„ ë‚´ì— ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤. ê³µê°„ì  ì§€ì—­ì„±ì´ë€ ìƒëŒ€ì ìœ¼ë¡œ ê°€ê¹Œìš´ ì €ì¥ ê³µê°„ì— ìˆëŠ” ë°ì´í„° ìš”ì†Œë“¤ì´ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤.\n\nê°œë°œì ì—­ì‹œ ë³µì¡í•˜ê³  ê±°ëŒ€í•œ í”„ë¡œì íŠ¸ì˜ ì „ì²´ êµ¬ì¡°ë¥¼ ëª¨ë‘ ì¸ì§€í•˜ëŠ” ê²ƒì€ í˜ë“ ì¼ì´ë‹¤. ìš°ì„  íŠ¹ì • ì§€ì—­ì˜ íë¦„ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤ë©´ í•´ë‹¹ íŒ¨í‚¤ì§€ì— ëŒ€í•´ì„œëŠ” ë§ˆì¹˜ ìºì‹œì— ì ì¬ëœ ë°ì´í„°ì— ì ‘ê·¼ í•˜ë“¯ ë¹ ë¥´ê²Œ ì¸ì§€ê°€ ê°€ëŠ¥í•˜ë‹¤.\n\n```json\nâ””â”€â”€ src\n    â”œâ”€â”€ main\n    â”‚   â”œâ”€â”€ java\n    â”‚   â”‚   â””â”€â”€ com\n    â”‚   â”‚       â””â”€â”€ allog\n    â”‚   â”‚           â””â”€â”€ dallog\n    â”‚   â”‚               â”œâ”€â”€ auth\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\n    |   |               |   â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\n    â”‚   â”‚               â”œâ”€â”€ category\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\n    |   |               |   â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\n    â”‚   â”‚               â”œâ”€â”€ schedule\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\n    |   |               |   â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\n    â”‚   â”‚               â”œâ”€â”€ global\n    â”‚   â”‚               â”‚   â”œâ”€â”€ config\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”œâ”€â”€ error\n    â”‚   â”‚               â”‚   â””â”€â”€ exception\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\n    â”‚   â”‚               â”‚   â””â”€â”€ oauth\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\n    |   |\n    â”‚   â””â”€â”€ resources\n    â”‚       â””â”€â”€ application.yml\n```\n\ní•˜ì§€ë§Œ ê° ê³„ì¸µì´ ê¸°ëŠ¥ë³„ë¡œ ëª¨ì—¬ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ìœ¼ë©´ ì „ì²´ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.\n\n### ë” ë‚˜ì•„ê°€ê¸°\n\ní˜„ì¬ êµ¬ì¡°ì—ì„œëŠ” ë„ë©”ì¸ì— í•´ë‹¹í•˜ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì´ íŒ¨í‚¤ì§€ ì „ë°˜ì ìœ¼ë¡œ í¼ì ¸ ìˆë‹¤. ê°ê°ì˜ ë„ë©”ì¸ ê¸°ëŠ¥ì´ ë°€ì§‘ë˜ì–´ ìˆì§€ ì•Šì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.\n\n```json\nâ””â”€â”€ src\n    â”œâ”€â”€ main\n    â”‚   â”œâ”€â”€ java\n    â”‚   â”‚   â””â”€â”€ com\n    â”‚   â”‚       â””â”€â”€ allog\n    â”‚   â”‚           â””â”€â”€ dallog\n    â”‚   â”‚               â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”œâ”€â”€ auth\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ application\n    |   |               â”‚   |   â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ presentation\n    â”‚   â”‚               â”‚   â”œâ”€â”€ category\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ application\n    |   |               â”‚   |   â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ presentation\n    â”‚   â”‚               â”‚   â””â”€â”€ schedule\n    â”‚   â”‚               â”‚       â”œâ”€â”€ application\n    |   |               â”‚       â”œâ”€â”€ domain\n    â”‚   â”‚               â”‚       â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚       â”œâ”€â”€ exception\n    â”‚   â”‚               â”‚       â””â”€â”€ presentation\n    â”‚   â”‚               â”œâ”€â”€ global\n    â”‚   â”‚               â”‚   â”œâ”€â”€ config\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\n    â”‚   â”‚               â”‚   â”œâ”€â”€ error\n    â”‚   â”‚               â”‚   â””â”€â”€ exception\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\n    â”‚   â”‚               â”‚   â””â”€â”€ oauth\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\n    |   |\n    â”‚   â””â”€â”€ resources\n    â”‚       â””â”€â”€ application.properties\n```\n\n### domain\n\nì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ì´ ë˜ëŠ” ë„ë©”ì¸ ë¡œì§ì´ ëª¨ì—¬ ìˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ëª¨ì—¬ ìˆê¸° ë•Œë¬¸ì— `ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™”`í•´ì•¼ í•œë‹¤. ì¦‰ `ì™¸ë¶€ì˜ ë³€ê²½ì— ì˜í•´ ë„ë©”ì¸ ë‚´ë¶€ê°€ ë³€ê²½ë˜ëŠ” ê²ƒì„ ë§‰ì•„ì•¼ í•œë‹¤ëŠ” ê²ƒ`ì„ ì¸ì§€í•´ì•¼ í•œë‹¤.\n\n### global\n\n`global`ì€ í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë¡œ êµ¬ì„±í•œë‹¤. ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” dtoë‚˜ error, configì— ëŒ€í•œ ê²ƒë“¤ì´ ëª¨ì—¬ ìˆë‹¤.\n\n### infrastructure\n\n`infrasturcture`ëŠ” ì™¸ë¶€ì™€ì˜ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ë¡œì§ë“¤ì´ ë‹´ê²¨ ìˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” OAuthë¥¼ í™œìš©í•œ íšŒì› ê´€ë¦¬ë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— googleì˜ ì¸ì¦ ì„œë²„ì™€ í†µì‹ ì´ í•„ìš”í•´ì§„ë‹¤. ì´ íŒ¨í‚¤ì§€ëŠ” ìš°ë¦¬ì˜ ì˜ì§€ì™€ ë‹¤ë¥´ê²Œ ì™¸ë¶€ì˜ ë³€í™”ì— ë”°ë¼ ë³€ê²½ë  ì—¬ì§€ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì¦‰ ë³€í™”ì— ë§¤ìš° ì·¨ì•½í•œ êµ¬ì¡°ì´ë©° ì™¸ë¶€ ì„œë²„ì— ì˜ì¡´ì  ì´ê¸° ë•Œë¬¸ì— í•­ì‹œ ë³€í™”ì— ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ ëŒ€ë¹„í•´ì•¼ í•œë‹¤. ì´ê²ƒì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” ê²°êµ­ `ë„ë©”ì¸ ê´€ë ¨ íŒ¨í‚¤ì§€ì—ì„œ infrastructureë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì˜ì¡´í•˜ëŠ” ê²ƒ`ì€ ë„ë©”ì¸ ë¡œì§ì„ ì•ˆì „í•˜ê²Œ ì§€í‚¬ ìˆ˜ ì—†ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ë‚´í¬í•œë‹¤.\n\n## ì •ë¦¬\n\nê°ê°ì˜ ë°©ë²•ì€ ì„œë¡œ ë‹¤ë¥¸ ì¥ë‹¨ì ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µì€ ì—†ë‹¤ê³  ìƒê°í•œë‹¤. í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ê·œëª¨ì™€ ìš”êµ¬ì‚¬í•­ì„ ê³ ë ¤í•˜ì—¬ ì„ íƒí•´ì•¼ í•œë‹¤. ë‹¤ë§Œ ì„ íƒí•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ì— ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ê°€ì ¸ì•¼í•˜ê³ , ê°ì²´ì™€ íŒ¨í‚¤ì§€ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì— ëŒ€í•´ ì¶©ë¶„íˆ ê³ ë¯¼í•´ì•¼ í•œë‹¤.\n\në‹¬ë¡ì€ í˜„ì¬ ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¡œ ì§„í–‰ë˜ê³  ìˆë‹¤. ëª¨ë“  íŒ€ì›ë“¤ì´ ì²˜ìŒ ë¶€í„° ê¸°íšê³¼ ì„¤ê³„ì— ëŒ€í•œ ê³ ë¯¼ì„ ì§„í–‰í–ˆê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ì— ëŒ€í•´ ë¶„ì„ í•˜ëŠ” ì‹œê°„ì´ ë¶ˆí•„ìš”í–ˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ê°ê°ì˜ ê¸°ëŠ¥ë“¤ì´ ë‚œì¡í•˜ê²Œ í¼ì ¸ ìˆê¸° ë•Œë¬¸ì— [ë” ë‚˜ì•„ê°€ê¸°](#á„ƒá…¥-á„‚á…¡á„‹á…¡á„€á…¡á„€á…µ)ì—ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ì¢€ ë” ë°€ì ‘í•œ ê¸°ëŠ¥ë“¤ì„ ëª¨ì•„ë‘˜ í•„ìš”ê°€ ìˆë‹¤ê³  íŒë‹¨í•œë‹¤. ì´ê²ƒì€ ì¶”í›„ íŒ€ì›ë“¤ê³¼ ì¶©ë¶„í•œ ë…¼ì˜ë¥¼ í†µí•´ ê°œì„ í•´ê°ˆ ì˜ˆì •ì´ë‹¤.\n\n## References.\n\n[Spring Guide - Directory](https://cheese10yun.github.io/spring-guide-directory)<br>\n[ì§€ì—­ì„±ì˜ ì›ì¹™ì„ ê³ ë ¤í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°: ê¸°ëŠ¥ë³„ë¡œ ë‚˜ëˆ„ê¸°](https://ahnheejong.name/articles/package-structure-with-the-principal-of-locality-in-mind)\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë‚˜ì¸ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ğŸ¯ \"ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•´ë³´ì„¸ìš”!\" ì–´ë–»ê²Œ êµ¬í˜„í•˜ì‹¤ ê±´ê°€ìš”? ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì²˜ìŒ ë§ˆì£¼í–ˆì„ë•Œ ğŸ¤” ì €ëŠ” ì²˜ìŒ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í–ˆì–´ìš”. scroll event ì‚¬ìš©í•˜ê¸° ìš°í…Œì½” ë ˆë²¨1 ìœ íŠœë¸Œ ë¯¸ì…˜ ì²˜ìŒ ì œê°€ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í–ˆë˜ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë°”ë¡œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì™€ ofâ€¦","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"date":"July 18, 2022","title":"Reactì—ì„œ ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„í•˜ê¸°","tags":["react"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë‚˜ì¸](https://github.com/jhy979)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\nğŸ¯ \"ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•´ë³´ì„¸ìš”!\"\n\nì–´ë–»ê²Œ êµ¬í˜„í•˜ì‹¤ ê±´ê°€ìš”?\n\n## ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì²˜ìŒ ë§ˆì£¼í–ˆì„ë•Œ\n\nğŸ¤” ì €ëŠ” ì²˜ìŒ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í–ˆì–´ìš”.\n\n```\n1. scroll ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•œë‹¤.\n\n2. í˜„ì¬ ìŠ¤í¬ë¡¤ ì˜ì—­ì˜ `ìœ„ì¹˜ë¥¼ ê³„ì‚°`í•œë‹¤.\n\n3. ì˜ì—­ ê³„ì‚°ì„ í†µí•´ í˜ì´ì§€ ì•„ë˜ì— ìœ„ì¹˜í•˜ë©´ API ìš”ì²­ì„ ì§„í–‰í•œë‹¤.\n\n4. ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì—¬ ë‹¤ì‹œ ë Œë”ë§í•œë‹¤.\n\n5. ë¬´í•œ ë°˜ë³µ\n```\n\n---\n\n## scroll event ì‚¬ìš©í•˜ê¸°\n\n[ìš°í…Œì½” ë ˆë²¨1 ìœ íŠœë¸Œ ë¯¸ì…˜](https://github.dev/jhy979/javascript-youtube-classroom/tree/jhy979-step2)\n\nì²˜ìŒ ì œê°€ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í–ˆë˜ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\në°”ë¡œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì™€ offsetì„ ì´ìš©í•œ ë°©ì‹ì´ì£ !\n\n```js\n  scrollToBottom(callback) {\n    const isScrollBottom =\n      this.$videoList.scrollHeight - this.$videoList.scrollTop <=\n      this.$videoList.offsetHeight + EVENT.SCROLL.OFFSET;\n\n    if (isScrollBottom) {\n      callback(this.$searchInput.value);\n    }\n  }\n```\n\në©”ì„œë“œ ë„¤ì´ë°ì„ í†µí•´ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´, í™”ë©´ í•˜ë‹¨ê¹Œì§€ ë‚´ë ¤ê°”ì„ ê²½ìš° (offset ì •ë„ë¥¼ ê°ì•ˆí•˜ì—¬) ì¸ìë¡œ ë°›ì€ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ì—ˆìŠµë‹ˆë‹¤.\n\nì•„ ë¬¼ë¡ , ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ëŠ” ì›Œë‚™ ë§ì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— throttleì„ ê±¸ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤. (ì´ê±´ í•„ìˆ˜ì£ )\n\nğŸ˜¢ í•˜ì§€ë§Œ, `documentElement.scrollTop`, `documentElement.scrollHeight`, `documentElement.offsetHeight`ëŠ” ë¦¬í”Œë¡œìš°(Reflow)ê°€ ë°œìƒí•©ë‹ˆë‹¤.\n\ní™•ì‹¤íˆ ë¹„íš¨ìœ¨ì ì´ê² ì£ !\n\n---\n\n## IntersectionObserver ì‚¬ìš©í•˜ê¸°\n\në‹¬ë¡ì—ì„œëŠ” ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ [Intersection Observer](https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API)ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.\n\n> Intersection ObserverëŠ” ì‰½ê²Œ ë§í•´ ì§€ì •í•œ ëŒ€ìƒì´ í™”ë©´ì— ë³´ì´ëŠ”ì§€ ê°ì‹œí•˜ê³  íŒë‹¨í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.\n\në¸Œë¼ìš°ì € Viewportì™€ Targetìœ¼ë¡œ ì„¤ì •í•œ ìš”ì†Œì˜ êµì°¨ì ì„ ê´€ì°°í•˜ì—¬ ê·¸ Targetì´ Viewportì— í¬í•¨ë˜ëŠ”ì§€ êµ¬ë³„í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n<img src=\"https://velog.velcdn.com/images/jhy979/post/19500233-65fc-4ba9-b421-81516700c00b/image.png\" />\n\n### useIntersect ì»¤ìŠ¤í…€í›…\n\n> ê°€ì¥ ë¨¼ì € useIntersect ë¼ëŠ” ì»¤ìŠ¤í…€í›…ì„ ì œì‘í–ˆìŠµë‹ˆë‹¤.\n\nì´ ì»¤ìŠ¤í…€í›…ì€ `ì¸ìë¡œ intersectì‹œ ì‹¤í–‰í•  í•¨ìˆ˜`ë¥¼ ë°›ê³  `refë¥¼ ì œê³µ`í•˜ì—¬ ê´€ì°°í•  ëŒ€ìƒì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```ts\ntype IntersectHandler = (\n  entry: IntersectionObserverEntry,\n  observer: IntersectionObserver\n) => void;\n\n// ì¸ìë¡œ onIntersectì™€ optionsë¥¼ ë°›ìŠµë‹ˆë‹¤.\n// onIntersectëŠ” intersect ë°œìƒ ì‹œ ì‹¤í–‰í•˜ê³  ì‹¶ì€ í•¨ìˆ˜ì…ë‹ˆë‹¤.\nfunction useIntersect(\n  onIntersect: IntersectHandler,\n  options?: IntersectionObserverInit\n) {\n  // ê´€ì°°í•˜ê³  ì‹¶ì€ ì¹œêµ¬ë¥¼ ì¡ê¸° ìœ„í•´ refë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”.\n  const ref = useRef<HTMLDivElement>(null);\n\n  // intersect ì‹œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤ì‹œë‹¤.\n  const callback = useCallback(\n    (entries: IntersectionObserverEntry[], observer: IntersectionObserver) => {\n      entries.forEach((entry) => {\n        if (entry.isIntersecting) {\n          onIntersect(entry, observer);\n        }\n      });\n    },\n    [onIntersect]\n  );\n\n  // ğŸ”¨ ì˜µì €ë²„ì—ê²Œ ì¼ì„ ì‹œì¼œë´…ì‹œë‹¤.\n  useEffect(() => {\n    // ìš°ë¦¬ê°€ ê´€ì°°í•˜ê³  ì‹¶ì€ ì¹œêµ¬ê°€ ì—†ìœ¼ë©´ ê·¸ëƒ¥ return í•´ë²„ë ¤ìš”.\n    if (!ref.current) {\n      return;\n    }\n\n    // ê´€ì°°í•  ëŒ€ìƒì´ ìˆìœ¼ë©´ ì˜µì €ë²„ ë°ê¼¬ ì™€ì•¼ì£ !\n    const observer = new IntersectionObserver(callback, options);\n\n    // ì´ ì˜µì €ë²„í•œí…Œ ê°ì‹œë¥¼ ì‹œí‚µì‹œë‹¤.\n    observer.observe(ref.current);\n\n    // í•  ì¼ ëë‚˜ë©´ ê³ ìƒí•œ ì˜µì €ë²„ë„ ì‰¬ê²Œ í•´ì¤ì‹œë‹¤!\n    return () => {\n      observer.disconnect();\n    };\n  }, [ref, options, callback]);\n\n  return ref;\n}\n\nexport default useIntersect;\n```\n\n### ì‹¤ì œ ì‚¬ìš©\n\nuseIntersect ì»¤ìŠ¤í…€í›…ì„ ì˜ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì´ì œ ì´ ì»¤ìŠ¤í…€í›…ì„ ë¬´í•œ ìŠ¤í¬ë¡¤ì— ì‚¬ìš©í•´ ë´…ì‹œë‹¤.\n\n![](https://velog.velcdn.com/images/jhy979/post/4643727c-852d-4f23-ab4f-44ce79e2e3b2/image.gif)\n\në‹¤ìŒì€ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ê³„ì† ë¶ˆëŸ¬ì™€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.\n\n```tsx\nfunction CategoryList({\n  categoryList,\n  getMoreCategories,\n  hasNextPage,\n}: CategoryListProps) {\n  // useIntersect ì»¤ìŠ¤í…€í›…ì˜ ì¸ìë¡œ (êµì°¨ ì‹œ) ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤ì‹œë‹¤.\n  const ref = useIntersect(() => {\n    hasNextPage && getMoreCategories();\n  });\n\n  return (\n    <div css={categoryTable}>\n      <div css={categoryTableHeader}>\n        <span> ìƒì„± ë‚ ì§œ </span>\n        <span> ì¹´í…Œê³ ë¦¬ ì´ë¦„ </span>\n      </div>\n      {categoryList.map((category) => (\n        <CategoryItem key={category.id} category={category} />\n      ))}\n      // í˜ì´ì§€ í•˜ë‹¨ê¹Œì§€ ë‚´ë¦¬ë©´ ì´ ì¹œêµ¬ê°€ ë“±ì¥í•˜ì—¬ ì˜µì €ë²„ì—ê²Œ ê°ì§€ë  ê±°ì˜ˆìš”.\n      <div ref={ref} css={intersectTarget}></div>\n    </div>\n  );\n}\n```\n\nğŸ’ª ë¬´í•œ ìŠ¤í¬ë¡¤í•¨ì— ë”°ë¼ propsë¡œ ë°›ì•„ì˜¤ëŠ” categoryListê°€ ê¸¸ì–´ì§€ê²Œ ë í…ë°ìš”, ë‹¤í–‰íˆ Reactì—ì„œëŠ” keyê°’ìœ¼ë¡œ ë³€ê²½ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ë¦¬ìŠ¤íŠ¸ë“¤ë§Œ ë¦¬ë Œë”ë§í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë§¤íŠ¸ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Git-flow git ë¸Œëœì¹˜ ì „ëµ ì¤‘ í•˜ë‚˜ì´ë‹¤, ì´ê²ƒì€ ì–´ë– í•œ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë°©ë²•ë¡ ì´ë‹¤. ê°ê°ì˜ í”„ë¡œì íŠ¸ì™€ ê°œë°œ í™˜ê²½ì— ë”°ë¼ ì•Œë§ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ ê²Œì‹œê¸€ì€ gitì„ ì•Œê³  ì‚¬ìš©í•´ ë³¸ ê²½í—˜ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì „ì œë¡œ ì‘ì„±í•˜ì˜€ë‹¤. ë˜í•œ ì§ì ‘ í”„ë¡œì íŠ¸ì— ì ìš©í•˜ê³  ì—°ìŠµí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µâ€¦","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"date":"July 12, 2022","title":"ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤.","tags":["git","git-flow"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë§¤íŠ¸](https://github.com/hyeonic)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## Git-flow\n\ngit ë¸Œëœì¹˜ ì „ëµ ì¤‘ í•˜ë‚˜ì´ë‹¤, ì´ê²ƒì€ ì–´ë– í•œ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë°©ë²•ë¡ ì´ë‹¤. ê°ê°ì˜ í”„ë¡œì íŠ¸ì™€ ê°œë°œ í™˜ê²½ì— ë”°ë¼ ì•Œë§ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤.\n\nì´ ê²Œì‹œê¸€ì€ gitì„ ì•Œê³  ì‚¬ìš©í•´ ë³¸ ê²½í—˜ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì „ì œë¡œ ì‘ì„±í•˜ì˜€ë‹¤. ë˜í•œ ì§ì ‘ í”„ë¡œì íŠ¸ì— ì ìš©í•˜ê³  ì—°ìŠµí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µì´ ë  ìˆ˜ ì—†ê³ , ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•  ì˜ˆì •ì´ë‹¤.\n\n## Git Repository\n\ní”„ë¡œì íŠ¸ì— ì ìš©í•˜ê¸° ì•ì„œ ì–´ë– í•œ í˜•íƒœë¡œ Git Repositoryê°€ êµ¬ì„±ë˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ë‹¤.\n\n![](./git-repository.png)\n\n### Upstream Remote Repository\n\nê°œë°œìê°€ ê³µìœ í•˜ëŠ” ì €ì¥ì†Œë¡œ ìµœì‹  ì†ŒìŠ¤ì½”ë“œê°€ ì €ì¥ë˜ì–´ ìˆëŠ” ì›ê²© ì €ì¥ì†Œì´ë‹¤.\n\n#### ì ìš©í•˜ê¸°\n\nì´ëŸ¬í•œ Remote Repository ìƒì„±ì„ ìœ„í•˜ì—¬ githubì— New organizationì„ ì‚¬ìš©íˆì˜€ë‹¤.\n\n![](./new-organization.png)\n\në‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” Teamê³¼ EnterpriceëŠ” ì›”ë§ˆë‹¤ ì¼ì • ê¸ˆì•¡ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ ì§„í–‰ì„ ìœ„í•´ ìƒì„±í•˜ì˜€ê¸° ë•Œë¬¸ì— Freeë§Œ ì‚¬ìš©í•˜ì—¬ë„ ì¶©ë¶„í•œ ì‹¤ìŠµê³¼ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.\n\n![](./fare.png)\n\norganizationì„ ìƒì„±í•˜ê²Œ ë˜ë©´ ì†Œì†ëœ repositoryë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ `Upstream Remote Repository`ë¡œ ì ìš©í•œë‹¤.\n\n### A's, B's, C's Origin Remote Repository\n\n`Upstream Repository`ë¥¼ Forkí•œ ì›ê²© ê°œì¸ ì €ì¥ì†Œì´ë‹¤. Upstream Repositoryë¥¼ ì§ì ‘ cloneí•˜ì—¬ ì‘ì—…í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°ê°ì˜ íŒ€ì›ë“¤ì´ `Fork`ë¥¼ í•˜ì—¬ ì›ê²© ì €ì¥ì†Œë¥¼ ìƒì„±í•˜ê³  ê·¸ê²ƒì„ cloneí•˜ì—¬ `Local Repository`ë¥¼ ìƒì„±í•˜ì—¬ ì‘ì—…í•œë‹¤.\n\nì´ë ‡ê²Œ ë‘ ê°œì˜ remote repositoryë¡œ ë‚˜ëˆˆ ì´ìœ ëŠ” Upstream repositoryì˜ ê²½ìš° `íŒ€ì›ì´ ê³µìœ `í•˜ê³  ìˆëŠ” Repositoryì´ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í•˜ê¸°ì— í° ìœ„í—˜ ë¶€ë‹´ì„ ê°€ì§€ê³  ìˆë‹¤. ê°ìì˜ ê°œì¸ repositoryì—ì„œ `ì‘ì—…ì„ ì‹œë„`í•œ í›„ ì ì ˆí•œ ê¸°ëŠ¥ merge í•˜ê¸° ìœ„í•´ `Pull Request`ë¥¼ ìš”ì²­í•œë‹¤.\n\n### ìš´ì˜ ë°©ì‹\n\ngit-flowëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 5ê°€ì§€ì˜ ë¸Œëœì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš´ì˜í•œë‹¤.\n\n- `main`: ì œí’ˆìœ¼ë¡œ ì¶œì‹œë  ìˆ˜ ìˆëŠ” ë¸Œëœì¹˜\n- `develop`: ë‹¤ìŒ ì¶œì‹œ ë²„ì „ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜\n- `feature`: ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜\n- `release`: ì´ë²ˆ ì¶œì‹œ ë²„ì „ì„ ì¤€ë¹„í•˜ëŠ” ë¸Œëœì¹˜\n- `hotfix`: ì¶œì‹œ ë²„ì „ì—ì„œ ë°œìƒí•œ ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ëŠ” ë¸Œëœì¹˜\n\n![](./git-flow-dev.png)\n\n`main`ê³¼ `develop` ë¸Œëœì¹˜ì´ë‹¤. ë‘ ë¸Œëœì¹˜ëŠ” í•­ì‹œ ìš´ì˜ë˜ì–´ì•¼ í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. `develop`ëŠ” ê°œë°œì„ ìœ„í•œ ë¸Œëœì¹˜ì´ê³ , `main`ì€ ì œí’ˆìœ¼ë¡œ ì¶œì‹œë  ìˆ˜ ìˆëŠ” ë¸Œëœì¹˜ ì´ê¸° ë•Œë¬¸ì— `í•­ì‹œ ë°°í¬ ê°€ëŠ¥í•œ ìƒíƒœ`ì´ì–´ì•¼ í•œë‹¤.\n\n`main`ê³¼ `develop`ì€ `Upstream remote repository`ì—ì„œ ìš´ì˜í•œë‹¤.\n\n![](./git-flow-feature.png)\n\n`feature` ë¸Œëœì¹˜ëŠ” ë‹¨ìœ„ ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ê¸°ëŠ¥ ê°œë°œì´ ì™„ë£Œë˜ë©´ `develop` ë¸Œëœì¹˜ì™€ `merge` ëœë‹¤.\n\n`develop`ì€ ëª¨ë“  íŒ€ì›ì´ `ê³µìœ `í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. featureëŠ” ê°ì ë§¡ì•„ ì‘ì„±í•œ ì½”ë“œë“¤ì´ ë“¤ì–´ ìˆëŠ” ë¸Œëœì¹˜ì´ë‹¤. merge ì‘ì—… ì „ì— íŒ€ì›ë“¤ ê°„ì˜ `ì§€ì†ì ì¸ ì½”ë“œ ë¦¬ë·°`ê°€ í•„ìš”í•˜ë‹¤.\n\nê·¸ë ‡ê¸° ë•Œë¬¸ì— `Pull Request`ë¥¼ ì‚¬ìš©í•˜ì—¬ `merge` ì‘ì—… ì „ ë¦¬ë·°ì–´ë“¤ì—ê²Œ ì½”ë“œ ë¦¬ë·°ë¥¼ ë°›ê³  ë°˜ì˜ ì‚¬í•­ì„ ìˆ˜ì •í•˜ì—¬ commit í›„ merge í•œë‹¤. ì´ ê³¼ì •ì€ `í˜‘ì—…ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„`ì´ë¼ê³  ìƒê°ëœë‹¤.\n\n![](./git-flow-release.png)\n\n`release` ë¸Œëœì¹˜ëŠ” ë°°í¬ë¥¼ í•˜ê¸° ì „ì— ì¶©ë¶„í•œ ê²€ì¦ì„ ìœ„í•´ ìƒì„±í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ë°°í¬ ê°€ëŠ¥í•œ ìƒíƒœê°€ ë˜ë©´ `main` ë¸Œëœì¹˜ë¡œ `merge` ì‘ì—…ì„ ê±°ì¹œë‹¤. ë˜í•œ `develop`ì—ë„ ë°˜ì˜ì‚¬í•­ì„ ëª¨ë‘ `merge` ì‹œì¼œì•¼ í•œë‹¤.\n\n![](./git-flow-hotfix.png)\n\n`hotifx` ë¸Œëœì¹˜ëŠ” ë°°í¬ ì¤‘ ë²„ê·¸ê°€ ìƒê²¨ ê¸´ê¸‰í•˜ê²Œ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ë°°í¬ ì´í›„ì— ì´ë£¨ì–´ì§€ëŠ” ë¸Œëœì¹˜ì´ê³ , ë°˜ì˜ ì‚¬í•­ì„ `main`ê³¼ `develop`ì— ëª¨ë‘ ì ìš© ì‹œì¼œì•¼ í•œë‹¤.\n\nì•ì„œ ë§í–ˆë“¯ì´ `main`ê³¼ `develop`ëŠ” í•­ì‹œ ìš´ì˜ë˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ì´ ë‘˜ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¸Œëœì¹˜ ë“¤ì€ ì œ ì—­í• ì´ ë§ˆë¬´ë¦¬ ë˜ì–´ `merge` ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ë¸Œëœì¹˜ë¥¼ ì‚­ì œí•˜ì—¬ ì •ë¦¬í•œë‹¤.\n\n### ê°„ë‹¨íˆ ì ìš©í•´ë³´ê¸°\n\n`Upstream Remote Repository`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì›ê²© ê°œì¸ ì €ì¥ì†Œì— `Fork` í•´ì•¼ í•œë‹¤.\n\n![](./fork.png)\n\nOrganizationì— ìƒì„±í•œ repositoryì— Forkë¥¼ ëˆ„ë¥´ë©´ ì†ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤. Forkë¡œ ìƒì„±ëœ repositoryë¥¼ ê¸°ë°˜ìœ¼ë¡œ `Local Repository`ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤.\n\n```bash\ngit clone https://github.com/{ê°œì¸ github ì´ë¦„}/{repository ì´ë¦„}.git\n```\n\ngit cloneì„ ì‚¬ìš©í•˜ì—¬ ì›ê²© ì €ì¥ì†Œì— ìˆëŠ” repositoryë¥¼ ì†ì‰½ê²Œ cloneí•  ìˆ˜ ìˆë‹¤.\n\n```bash\n$ git remote -v\n\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (fetch)\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (push)\n```\n\nclone ë°›ì€ local repositoryë¥¼ git remote -vë¡œ í™•ì¸í•´ë³´ë©´ ì›ê²© ì €ì¥ì†Œê°€ ë“±ë¡ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ë§¤ë²ˆ ìµœì‹  ì½”ë“œë¥¼ `fetch` ë° `rebase` í•˜ê¸° ìœ„í•´ì„œëŠ” `Upstream`ì„ ë“±ë¡í•´ì•¼ í•œë‹¤.\n\n```bash\n$ git remote add upstream https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\n\n$ git remote -v\n\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (fetch)\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (push)\nupstream        https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\nupstream        https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\n```\n\n`git remote add upstream`ì„ í†µí•˜ì—¬ upstreamì„ ë“±ë¡í•œë‹¤. ì •ìƒì ìœ¼ë¡œ ë“±ë¡ ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ì œ ì‘ì—…í•  ë•Œ ë§ˆë‹¤ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ê³  ìµœì‹  ì½”ë“œë¥¼ pull ë°›ì•„ì•¼ í•œë‹¤.\n\nìš°ë¦¬ íŒ€ì›ì€ ê°ê° ê°œë°œí•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì„ github issueì— ë“±ë¡í•œ í›„ ë“±ë¡ ë²ˆí˜¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.\n\nìš°ì„  ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ìœ„í•˜ì—¬ ì´ìŠˆë¥¼ ë“±ë¡í•œë‹¤.\n\n![](./issue.png)\n\n3ë²ˆ ë²ˆí˜¸ê°€ ë¶€ì—¬ëœ ì´ìŠˆë¼ê³  ê°€ì •í•œë‹¤. í•´ë‹¹ ë²ˆí˜¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ `local repository`ì—ì„œ feature ë¸Œëœì¹˜ë¥¼ ìƒì„±í•œë‹¤.\n\n```bash\n$ git branch feature/3-init-setting\n$ git checkout feature/3-init-setting\n```\n\nì´ì œ Upstreamì— ìˆëŠ” remote repositoryì—ì„œ ìµœì‹  ì†ŒìŠ¤ì½”ë“œë¥¼ ë°›ì•„ ì™€ì•¼ í•œë‹¤.\n\n```bash\n$ git fetch upstream\n$ git rebase upstream/develop\n```\n\ngit pullì„ ì‚¬ìš©í•˜ì—¬ ë“±ë¡í•œ upstream developì—ì„œ commit ê¸°ë¡ì„ ë³‘í•©í•œë‹¤. ì´ì œ ì‹ ë‚˜ê²Œ ì‘ì—…ì„ ì§„í–‰í•˜ê³  ìì‹ ì˜ ì›ê²© ì €ì¥ì†Œì¸ `Origin remote repository`ì— pushí•œë‹¤.\n\n```bash\n$ git push origin feature/3-init-setting\n```\n\nê·¸ë ‡ê²Œ github repositoryë¥¼ ì‚´í´ë³´ë©´ `ë³€ê²½ì„ ê°ì§€`í•˜ê³  pull requestë¥¼ ìƒì„±í•  ê²ƒì¸ì§€ì— ëŒ€í•œ íƒ­ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\n\n![](./upstream-repository.png)\n\nì´ì œ forkí•œ ê°œì¸ ì›ê²© ì €ì¥ì†Œë¥¼ ì‚´í´ë³´ë©´ ìƒˆë¡­ê²Œ ì‘ì„±í•œ ë¸Œëœì¹˜ë¥¼ ê°ì§€í•˜ê³  pull request ì‘ì„±ì„ ìœ„í•œ ë²„íŠ¼ì´ ìƒì„±ëœë‹¤.\n\n![](./pull-request.png)\n\n`feature/3-init-setting` ë¸Œëœì¹˜ë¥¼ developì— mergeí•˜ê¸° ìœ„í•œ pull requestë¥¼ ì§„í–‰í•˜ëŠ” ì˜ˆì‹œì´ë‹¤. ì‘ì„±í•œ ì½”ë“œë¥¼ ë¦¬ë·°í•´ì¤„ íŒ€ì›ë“¤ì„ ì„ íƒí•˜ê³ , commití•œ ì½”ë“œì˜ ë‚´ìš©ì„ ê°„ë‹¨íˆ ìš”ì•½í•˜ì—¬ ì‘ì„±í•œë‹¤. ì´ì œ ìƒì„±í•œ PRì„ ê¸°ë°˜ìœ¼ë¡œ `ì½”ë“œë¦¬ë·°`ë¥¼ ì§„í–‰í•œë‹¤. ë³€ê²½ ì‚¬í•­ì´ ì ìš©ë˜ë©´ developì— ë°˜ì˜í•˜ê¸° ìœ„í•´ mergeí•œë‹¤.\n\n### ë‹¬ë¡ì— ë§ê²Œ ìˆ˜ì •í•˜ê¸°\n\ngit-flowëŠ” ë¹ ë¥´ê²Œ ê¸‰ë³€í•˜ëŠ” ì›¹ ì„œë¹„ìŠ¤ì—ëŠ” ë§ì§€ ì•Šì€ git ë¸Œëœì¹˜ ì „ëµì´ë‹¤. ê´€ë¦¬í•´ì•¼ í•  ë¸Œëœì¹˜ê°€ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ê°œë°œìë“¤ì´ ì‹ ê²½ì¨ì•¼ í•  í¬ì¸íŠ¸ê°€ ëŠ˜ì–´ë‚œë‹¤.\n\në¹ˆë²ˆí•œ ë°°í¬ë¡œ ì¸í•´ ê¸‰ì‘ìŠ¤ëŸ¬ìš´ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¦‰ ì˜ˆìƒì¹˜ ëª»í•œ ë¡¤ë°±ì´ ìì£¼ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤. ë˜í•œ ì›¹ ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±ìƒ ë‹¤ì–‘í•œ ë¦´ë¦¬ì¦ˆ ë²„ì „ì„ ìœ ì§€í•  í•„ìš”ê°€ ì—†ë‹¤. ì´ëŸ¬í•œ íŠ¹ì„±ë“¤ë¡œ ì¸í•´ ì›¹ ì„œë¹„ìŠ¤ì—ëŠ” ë‹¤ì†Œ ë³´ìˆ˜ì ì¸ git-flow ì „ëµì€ ë§ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.\n\nê·¸ëŸ¼ì—ë„ ìš°ë¦¬ ë‹¬ë¡íŒ€ì€ git-flowë¥¼ ì„ íƒí–ˆë‹¤. ìš°ë¦¬ëŠ” ì‹¤ì œ ìš´ì˜í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ë©° ë‹¤ì–‘í•œ ê²½í—˜ì„ ìŠµë“í•´ì•¼ í•œë‹¤. ë˜í•œ ëŒ€ë¶€ë¶„ì˜ íŒ€ì›ë“¤ì´ gitì— ìµìˆ™í•˜ì§€ ì•Šì•˜ìœ¼ë©° ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í†µí•´ ë¹ ë¥´ê²Œ í•™ìŠµí•´ì•¼ í•œë‹¤.\n\nëŒ€ì‹  git-flowë¥¼ ì •ì„ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  í•„ìš”í•œ ë¶€ë¶„ì„ ìˆ˜ì •í•˜ì—¬ ë°˜ì˜í•˜ë ¤ í•œë‹¤. í˜„ì¬ ìˆ˜ì¤€ì—ì„œ `develop`ì—ì„œ ëŒ€ë¶€ë¶„ì˜ ë¹Œë“œë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— `release` ë¸Œëœì¹˜ì˜ í•„ìš”ì„±ì´ ë‹¤ì†Œ ì˜…ì–´ì¡Œë‹¤. ê²°êµ­ `release`ë¥¼ ì œì™¸í•œ `main`, `develop`, `feature`, `hotfix`ë§Œ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ë‹¤.\n\n### ë‹¬ë¡ì´ ì§‘ì¤‘í•œ ê²ƒ\n\në‹¬ë¡ì˜ íŒ€ ê° êµ¬ì„±ì›ë“¤ì€ ë§¡ì€ ì´ìŠˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•œ ë’¤ ì‘ì—…ì„ ì§„í–‰í•  ê²ƒì´ë‹¤. ê²°êµ­ ë‹¤ìˆ˜ì˜ ë¸Œëœì¹˜ê°€ ì•„ë˜ì™€ ê°™ì´ ë³‘ë ¬ì ìœ¼ë¡œ ì»¤ë°‹ì´ ìŒ“ì´ê²Œ ëœë‹¤.\n\n![](./force-push.png)\n\në§Œì•½ íŒ€ì› ì¤‘ í•œëª…ì´ ì‘ì—…ì„ ëë‚´ì„œ PRì´ mergeëœ ìƒí™©ì´ë¼ê³  ê°€ì •í•˜ì. develop ë¸Œëœì¹˜ì˜ ì»¤ë°‹ ë² ì´ìŠ¤ëŠ” ë³€ê²½ë¬ìœ¼ë©° ì´ì „ì— ì‘ì—…ì„ ì§„í–‰í•˜ë˜ ë¸Œëœì¹˜ë“¤ì€ ì‹œì‘ì ì´ ë’¤ë¡œ ë°€ë ¤ë‚˜ê²Œ ëœë‹¤.\n\nì—¬ëŸ¬ ì‚¬ëŒì´ í•˜ë‚˜ì˜ ì €ì¥ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê³µê°„ì˜ ì½”ë“œë“¤ì€ ì¶©ëŒì„ ì•¼ê¸°í•  ê°€ëŠ¥ì„±ì´ í¬ë‹¤. ì¦‰ ì§€ì†ì ì¸ `fetch` + `rebase`ë¥¼ í†µí•´ ì‚¬ì „ì— ì¶©ëŒì— ëŒ€ë¹„í•˜ë©° í•­ìƒ `develop` ë¸Œëœì¹˜ì™€ ì»¤ë°‹ ì‹±í¬ë¥¼ ë§ì¶˜ë‹¤.\n\nì •ë¦¬í•˜ë©´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ í•­ì‹œ develop ë¸Œëœì¹˜ì˜ ë ë‹¨ì—ì„œ ì‹œì‘í•´ì•¼ í•œë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì€ ì½”ë“œì˜ ì¶©ëŒì„ ìµœì†Œí™”í•  ìˆ˜ ìˆìœ¼ë©° ìˆœì°¨ì ì¸ git ì»¤ë°‹ ëª©ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ ì‰½ê²Œ ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\n\n## ì •ë¦¬\n\nì§€ê¸ˆê¹Œì§€ ê°„ë‹¨íˆ `git-flowì˜ íë¦„`ê³¼ ì´ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ `ë‹¬ë¡ì— ì ìš©í•œ ê³¼ì •`ë“¤ì„ ì•Œì•„ë³´ì•˜ë‹¤. git-flowëŠ” ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ë¶€ê°€ì ì¸ ë¸Œëœì¹˜ë¡œ ì¸í•´ `ê´€ë¦¬ì— ëŒ€í•œ ë¶€ë‹´ê°`ì„ ëŠë‚„ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ `upstream`ê³¼ `origin`ì„ ë¶„ë¦¬í•œ í™˜ê²½ì€ ì¢€ ë” ë„ì „ì ì¸ ê³¼ì œë“¤ì„ ì ìš©í•˜ê¸°ì— ë§¤ìš° ì¢‹ì€ í™˜ê²½ì„ êµ¬ì„±í•´ì¤€ë‹¤. ë˜í•œ `pull request`ë¥¼ í†µí•œ ì½”ë“œ ë¦¬ë·°ë¥¼ í†µí•´ ë³´ë‹¤ ë” ì–‘ì§ˆì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì— í˜ì“¸ ìˆ˜ ìˆë‹¤.\n\n## References.\n\n[git flow; í™˜ìƒê³¼ í˜„ì‹¤ ê·¸ ì‚¬ì´ì— ì„œë¹„ìŠ¤](https://vallista.kr/git-flow;-%ED%99%98%EC%83%81%EA%B3%BC-%ED%98%84%EC%8B%A4-%EA%B7%B8-%EC%82%AC%EC%9D%B4%EC%97%90-%EC%84%9C%EB%B9%84%EC%8A%A4/)<br>\n[ìš°ë¦° Git-flowë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”](https://woowabros.github.io/experience/2017/10/30/baemin-mobile-git-branch-strategy.html)<br>\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë°°ê²½ ìš°í…Œì½” ë ˆë²¨3 ë‹¬ë¡ íŒ€ì—ì„œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ëŠ” ë°˜ë“œì‹œ  í‚¤ì›Œë“œë¥¼ ë¶™ì´ë„ë¡ ì»¨ë²¤ì…˜ì„ ì •í–ˆìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì¼ë°˜ì ìœ¼ë¡œ ê°€ë³€ì ì¸ ë³€ìˆ˜ëŠ” í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë”°ë¼ì„œ ë³€ìˆ˜ë¥¼ ê°€ë³€ì ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ìë°”ì—ì„œëŠ” ë³€ìˆ˜ì˜ ì¬í• ë‹¹ì„ ë§‰ê¸° ìœ„í•´  í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¬¼ë¡ â€¦","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"date":"July 12, 2022","title":"IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œí•œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì— final í‚¤ì›Œë“œ ìë™ ì¶”ê°€í•˜ê¸°","tags":["intellij"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## ë°°ê²½\n\nìš°í…Œì½” ë ˆë²¨3 ë‹¬ë¡ íŒ€ì—ì„œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ëŠ” ë°˜ë“œì‹œ `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ë„ë¡ ì»¨ë²¤ì…˜ì„ ì •í–ˆìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì¼ë°˜ì ìœ¼ë¡œ ê°€ë³€ì ì¸ ë³€ìˆ˜ëŠ” í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë”°ë¼ì„œ ë³€ìˆ˜ë¥¼ ê°€ë³€ì ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ìë°”ì—ì„œëŠ” ë³€ìˆ˜ì˜ ì¬í• ë‹¹ì„ ë§‰ê¸° ìœ„í•´ `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¬¼ë¡  `final` í‚¤ì›Œë“œ í•˜ë‚˜ë§Œìœ¼ë¡œ ì™„ì „í•œ ë¶ˆë³€ì„ ë³´ì¥í•˜ë„ë¡ ë§Œë“¤ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì–´ëŠì •ë„ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ë§Œë“œëŠ”ë°ì—ëŠ” ë„ì›€ì´ ë©ë‹ˆë‹¤.\n\nì´ëŠ” ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ë„ ì ìš©ë©ë‹ˆë‹¤. ì•„ë˜ì˜ ì½”ë“œëŠ” `Memo` ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ìƒì„±ìì…ë‹ˆë‹¤. `value` ë¼ëŠ” String ê°’ì„ ì „ë‹¬ë°›ì•„ ê°ì²´ í•„ë“œì— í• ë‹¹í•©ë‹ˆë‹¤.\n\n```java\npublic Memo(String value) {\n    validateLength(value);\n\n    value = \"hello\"; // ì˜ˆìƒì¹˜ ëª»í•œ ì½”ë“œ\n\n    this.value = value;\n}\n```\n\ní•˜ì§€ë§Œ ìœ„ì²˜ëŸ¼ ì˜ˆìƒì¹˜ ëª»í•œ ì½”ë“œê°€ ì¶”ê°€ë˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? `value` í•„ë“œì—ëŠ” ê°œë°œìê°€ ì˜ë„í•˜ì§€ ëª»í•œ ê°’ì´ í• ë‹¹ë  ê²ƒ ì…ë‹ˆë‹¤.\n\n```java\npublic Memo(final String value) {\n    validateLength(value);\n\n    value = 1; // error: final parameter value may not be assigned\n\n    this.value = value;\n}\n```\n\nì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ì„œ ìœ„ì²˜ëŸ¼ ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ë©´, ì¬í• ë‹¹ ì‹œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ì„ ì‚¬ì „ì— ë°©ì§€í•  ìˆ˜ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤.\n\n## IntelliJ ì„¤ì •í•˜ê¸°\n\ní•˜ì§€ë§Œ, ì €í¬ëŠ” ì•„ì§ ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ëŠ” ìŠµê´€ì´ ë“¤ì–´ìˆì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ IDEì˜ ë„ì›€ì´ í•„ìš”í•œë°ìš”, ë‹¤í–‰íˆë„ IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œ ë¦¬íŒ©í† ë§ì„ í•  ë•Œ ìƒì„±ë˜ëŠ” ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— ìë™ìœ¼ë¡œ `final` í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ì£¼ëŠ” ì˜µì…˜ì„ ë°œê²¬í•˜ì˜€ìŠµë‹ˆë‹¤.\n\n![IntelliJ ì„¤ì • í™”ë©´](./intellij.png)\n\në§¥ ê¸°ì¤€ìœ¼ë¡œ Preferences â†’ Editor â†’ Code Style â†’ Java í˜ì´ì§€ì—ì„œ Code Generation íƒ­ì„ í´ë¦­í•©ë‹ˆë‹¤. í•´ë‹¹ íƒ­ì˜ í•˜ë‹¨ì— â€˜Final Modifierâ€™ ì—ì„œ â€˜Make generated parameters finalâ€™ ì„ ì²´í¬í•´ì¤ë‹ˆë‹¤. ìœ„ì™€ ê°™ì´ ì˜µì…˜ì„ ë³€ê²½í•˜ë©´ ë©”ì†Œë“œ ì¶”ì¶œ ì‹œ íŒŒë¼ë¯¸í„°ì— ìë™ìœ¼ë¡œ `final` í‚¤ì›Œë“œê°€ ìƒì„±ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ˜Š\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë¦¬ë²„ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. JPA ë“±ì¥ë°°ê²½ 1990ë…„ëŒ€ ì¸í„°ë„·ì´ ë³´ê¸‰ë˜ë©´ì„œ ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ê°€ í™œì„±í™” ë˜ì—ˆë‹¤.\nìì—°ìŠ¤ëŸ½ê²Œ, ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ì—ì„œ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ë•Œ ì‚¬ìš©í•  Connection Connectorì— ëŒ€í•œ ë‹ˆì¦ˆê°€ ë†’ì•„ì¡Œë‹¤.\nê·¸ë˜ì„œ ê° ì–¸ì–´ë“¤ì—ì„œ DB Connectionì„ ì§€ì›í•˜ëŠ” API ê¸°ìˆ ë“¤ì´ ë“±ì¥í•˜ì˜€ë‹¤. ì´â€¦","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"date":"July 07, 2022","title":"JPA ë“±ì¥ë°°ê²½","tags":["JPA"]},"rawMarkdownBody":"\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë¦¬ë²„](https://github.com/gudonghee2000)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\n\n## JPA ë“±ì¥ë°°ê²½\n\n1990ë…„ëŒ€ ì¸í„°ë„·ì´ ë³´ê¸‰ë˜ë©´ì„œ ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ê°€ í™œì„±í™” ë˜ì—ˆë‹¤.\nìì—°ìŠ¤ëŸ½ê²Œ, ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ì—ì„œ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ë•Œ ì‚¬ìš©í•  Connection Connectorì— ëŒ€í•œ ë‹ˆì¦ˆê°€ ë†’ì•„ì¡Œë‹¤.\nê·¸ë˜ì„œ ê° ì–¸ì–´ë“¤ì—ì„œ DB Connectionì„ ì§€ì›í•˜ëŠ” API ê¸°ìˆ ë“¤ì´ ë“±ì¥í•˜ì˜€ë‹¤. ì´í›„ì— Springì—ì„œëŠ” DB Connectionì„ ì¢€ ë” ì‰½ê²Œ ê´€ë¦¬í•˜ëŠ” Spring JDBC APIë¥¼ ë§Œë“¤ê³  ì§€ì›í•˜ì˜€ë‹¤. (ì´ì™¸ì—ë„ Queryë¬¸ì„ XMLíŒŒì¼ì„ í†µí•´ ê´€ë¦¬í•˜ê²Œë” ë„ì™€ì£¼ëŠ” Mybatisë„ ë“±ì¥í•˜ì˜€ìŒ)\ní•˜ì§€ë§Œ, ì—¬ì „íˆ ì¿¼ë¦¬ë¬¸ì„ ê°œë°œìê°€ ì§ì ‘ ì‘ì„±í•´ì•¼í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ê°€ì§€ê³  ìˆì—ˆë‹¤.\nê·¸ë˜ì„œ JAVA ì§„ì˜ì—ì„œëŠ” ê°œë°œìê°€ ì¿¼ë¦¬ë¬¸ì„ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ í”„ë ˆì„ì›Œí¬ ë‚´ë¶€ì—ì„œ ì§€ì›í•´ì£¼ëŠ” ORM(Object Relational Model)ê¸°ìˆ ì¸ JPAê°€ ë“±ì¥í•˜ì˜€ë‹¤.\nê·¸ë ‡ë‹¤ë©´, JPA ì´ì „ì— ê°œë°œìë“¤ì´ ì§ì ‘ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ë˜ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë‹¨ì ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?\nì•„ë˜ì—ì„œ ì‚´í´ë³´ì.\n\n## SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë‹¨ì \n\n#### 1. ì¿¼ë¦¬ë¬¸ ë¬´í•œ ë°˜ë³µê³¼ ì§€ë£¨í•œ ì½”ë”©\n\nJDBC APIëŠ” ì¿¼ë¦¬ë¬¸ì„ ê°œë°œìë“¤ì´ ì§ì ‘ ì‘ì„± í•´ì•¼í•œë‹¤.\nê·¸ë˜ì„œ ê°œë°œìë“¤ì€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ëŠ” ì§€ë£¨í•œ ì‘ì—…ì„ ê°œë°œ ê³¼ì •ì—ì„œ ë¬´í•œë°˜ë³µí•´ì•¼í•œë‹¤.\n\n#### 2. ê°ì²´ì˜ í•„ë“œê°€ ì¶”ê°€ë˜ë©´ ëª¨ë“  ì¿¼ë¦¬ë¬¸ì„ ìˆ˜ì •í•´ì•¼í•œë‹¤.\n\n![](https://velog.velcdn.com/images/gudonghee2000/post/488a7899-d55b-4447-aafc-bada8d840192/image.jpg)\nìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì—ì„œëŠ” ê°ì²´ì˜ í•„ë“œê°€ ë³€ê²½ë˜ë©´ í•´ë‹¹í•˜ëŠ” ëª¨ë“  ì¿¼ë¦¬ë¬¸ì„ ì°¾ì•„ ê°œë°œìê°€ ìˆ˜ì •í•´ì•¼í•œë‹¤.\n\n#### 3. ê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜\n\nê°ì²´ë¼ê³  í•˜ë©´ ë– ì˜¤ë¥´ëŠ” í‚¤ì›Œë“œëŠ” ë¬´ì—‡ì´ ìˆì„ê¹Œ?\nìº¡ìŠí™”, í˜‘ë ¥, ì˜ì¡´, ìƒì†, ì°¸ì¡° ë“±ì˜ ê¸°ìˆ ì´ ìˆë‹¤. ê·¸ëŸ°ë°, DBì—ì„œëŠ” ì´ëŸ¬í•œ ê¸°ìˆ ë“¤ì´ ì—†ë‹¤.\nì ìš©ë˜ëŠ” ê¸°ìˆ ë“¤ì˜ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ë¡œ ì¸í•´ ê°œë°œìë“¤ì€ SQL ì§€í–¥ì ì¸ ê°œë°œì„ í•  ìˆ˜ ë°–ì— ì—†ë‹¤.\nì•„ë˜ì—ì„œ ìì„¸íˆ ì‚´í´ë³´ì.\n\n## ê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ ì°¨ì´\n\nê°ì²´ì™€ ê´€ê³„í˜• DBëŠ” ì—°ê´€ê´€ê³„ë¥¼ í†µí•´ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ëŠ” ê³µí†µì ì„ ê°€ì§„ë‹¤.\ní•˜ì§€ë§Œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¥¼ ê°€ì§„ë‹¤.\n\nê°ì²´ëŠ” ìƒì†, ì°¸ì¡°ë¥¼ í†µí•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.\në°˜ë©´ ê´€ê³„í˜• DBëŠ” PK, FKë¥¼ í†µí•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.\nì´ë•Œ, ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ë°©ì‹ì˜ ì°¨ì´ë¡œ ë°œìƒí•˜ëŠ” ë¬¸ì œì ì„ ì½”ë“œì™€ í•¨ê»˜ ì‚´í´ë³´ì.\n\n```java\npublic class Crew {\n   private Long id;\n    private String name;\n    private String nickName;\n    private Team team;\n}\n\npublic class Team {\n   private Long id;\n    private String team_name;\n}\n```\n\nìœ„ì™€ ê°™ì´ `Crew` ê°ì²´ê°€ `Team` ê°ì²´ë¥¼ í•„ë“œë¡œ ê°€ì§€ê³  ì°¸ì¡°í•œë‹¤ê³  í•˜ì.\nê°ì²´ì§€í–¥ì ì¸ ê´€ì ì—ì„œ, `Crew`ì™€ `Team`ì˜ ê´€ê³„ë¥¼ ìœ„ì™€ ê°™ì´ í‘œí˜„í•˜ëŠ”ê²ƒì€ ìì—°ìŠ¤ëŸ½ë‹¤.\n\ní•˜ì§€ë§Œ, DBì—ì„œëŠ” `Crew`ê°€ `Team`ì„ ì°¸ì¡°í•œë‹¤ëŠ” ê°œë…ì´ ì—†ë‹¤.\nê·¸ë˜ì„œ ìœ„ ê°ì²´ë“¤ì„ ê°€ì§€ê³  DBì˜ `Crew`í…Œì´ë¸”ê³¼ `Team`í…Œì´ë¸”ì˜ ê´€ê³„ë¥¼ ë§ºì„ë•Œ, ì•„ë˜ì™€ ê°™ì´ `PK` ê°’ì¸ idë¥¼ `FK`ë¡œ ê°€ì§€ë„ë¡ êµ¬í˜„ í•˜ì—¬ì•¼í•œë‹¤.\n![ERD](./erd.png)\n\nì—°ê´€ê´€ê³„ì— ëŒ€í•´ì„œ ê°ì²´ì˜ êµ¬ì¡°ì™€ DBì˜ êµ¬ì¡°ê°€ ë‹¬ë¼ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤.\n\nê·¸ë ‡ë‹¤ë©´ ê°ì²´ì§€í–¥ì ì¸ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§„ ê°ì²´ë“¤ì„ DBì— ì €ì¥ í•  ë•Œ,\nDBì˜ ì—°ê´€ê´€ê³„ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì™œ ë¬¸ì œê°€ ë ê¹Œ?\n\n## ê°ì²´ì™€ RDBì˜ ì—°ê´€ê´€ê³„ ì°¨ì´ê°€ ê°€ì ¸ì˜¤ëŠ” ë¬¸ì œ\n\nìœ„ì—ì„œ ë´¤ë˜ `Crew`ì™€ `Team`ì˜ ê°ì²´ ëª¨ë¸ë§ì„ ë‹¤ì‹œí•œë²ˆ ì‚´í´ë³´ì.\n\n```java\npublic class Crew {\n   private Long id;\n    private String name;\n    private String nickName;\n    private Team team;\n}\n\npublic class Team {\n   private Long id;\n    private String team_name;\n}\n```\n\nìœ„ì™€ ê°™ì´ ëª¨ë¸ë§ëœ `Crew`ì™€ `Team`ì„ DBì— ì €ì¥í•œë‹¤ê³  í•œë‹¤ë©´ ë‹¤ìŒì˜ ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.\nDBì— ì ‘ê·¼í•˜ê³ ì í•˜ëŠ” Dao ê°ì²´ëŠ” `Crew`ê°ì²´ë¥¼ ë¶„í•´í•˜ê³  ê°ì `Crew` í…Œì´ë¸”ê³¼ `Team` í…Œì´ë¸”ì— ëŒ€í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤. ë‹¨ìˆœíˆ `Crew`ì˜ ê°ì²´ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ”ë° 3ê°€ì§€ ê³¼ì •ì„ ê±°ì³ì•¼í•œë‹¤.\n\nì´ëŸ¬í•œ ë³µì¡í•œ ê³¼ì •ì„ í”¼í•˜ëŠ” ë°©ë²•ì€ ì—†ì„ê¹Œ?\nì•„ë˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì.\n\n```java\npublic class Crew {\n   private Long id;\n    private String name;\n    private String nickName;\n    private Long team_id;\n}\n\npublic class Team {\n   private Long id;\n    private String team_name;\n}\n```\n\nìœ„ì™€ ê°™ì´ DB í…Œì´ë¸” êµ¬ì¡°ì— ë§ì¶”ì–´ `Crew`ì™€ `Team` ê°ì²´ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì´ìˆë‹¤.\nì´ëŸ¬í•œ ê°ì²´ ëª¨ë¸ë§ì€ Dao ê°ì²´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ DBì— ì €ì¥ í•  ë•Œ, `Crew` ê°ì²´ë¥¼ ë¶„í•´í•˜ëŠ” ê³¼ì •ì„ ì‚­ì œ í•  ìˆ˜ ìˆë‹¤.\nê°ì²´ê°€ DB êµ¬ì¡°ì— ë§ì¶”ì–´ ì„¤ê³„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.\n\n**í•˜ì§€ë§Œ, ê°ì²´ ëª¨ë¸ë§ì„ í•  ë•Œ ê°ì²´ê°€ ì„œë¡œ ì°¸ì¡°í•˜ëŠ” ê°ì²´ì§€í–¥ì ì¸ ê°œë°œì´ ì•„ë‹Œ\nDB í…Œì´ë¸”êµ¬ì¡°ì— ë§ì¶”ì–´ ê°œë°œí•˜ëŠ” SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê²Œ ëœë‹¤ëŠ” ë¬¸ì œë¥¼ ê°€ì§„ë‹¤.**\n\nê°ì²´ì™€ ê´€ê³„í˜• DBì˜ ì—°ê´€ê´€ê³„ì˜ íŒ¨ëŸ¬ë‹¤ì„ ì°¨ì´ëŠ” ê°ì²´ë¥¼ ê°ì²´ë‹µì§€ ëª»í•˜ê²Œ ë§Œë“ ë‹¤ëŠ” ê²ƒì´ë‹¤.\nê·¸ë ‡ë‹¤ë©´, íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ì—†ì„ê¹Œ?\n\n## JPA\n\nê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¡œ ì¸í•´ ìš°ë¦¬ëŠ” ê°ì²´ì§€í–¥ì ì¸ í”„ë¡œê·¸ë˜ë°ì„ í•˜ì§€ëª»í•˜ê³  DBì— ì¢…ì†ì ì¸ ê°œë°œì„ í•˜ê²Œëœë‹¤.\nì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ JAVAì§„ì˜ì—ì„œëŠ” JPAë¥¼ ì œê³µí•œë‹¤.\n\nJPAë¥¼ í†µí•´ ê°œë°œìëŠ” ë”ì´ìƒ ì¿¼ë¦¬ë¬¸ì„ ë°˜ë³µì ìœ¼ë¡œ ì‘ì„±í•˜ê±°ë‚˜ ìœ ì§€ë³´ìˆ˜í•˜ëŠ” ê²ƒì„ ì‹ ê²½ì“°ì§€ ì•Šì•„ë„ ëœë‹¤.\nì™œëƒí•˜ë©´ JPAê°€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.\nê·¸ë¦¬ê³  SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì—ì„œ ë²—ì–´ë‚˜ ê°ì²´ì§€í–¥ì ì¸ ê°œë°œì„ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.\nì™œëƒí•˜ë©´ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ë¥¼ JPAê°€ ë‚´ë¶€ì ìœ¼ë¡œ ë§µí•‘í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.\n\në‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” JPAì˜ ì‘ë™ ë©”ì»¤ë‹ˆì¦˜ì„ ìì„¸íˆ ì‚´í´ë³´ì.\n"}]}},"pageContext":{}},"staticQueryHashes":[]}
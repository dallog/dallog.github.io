{"componentChunkName":"component---src-pages-search-jsx","path":"/search/","result":{"data":{"allMarkdownRemark":{"nodes":[{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë‚˜ì¸ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. React-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. Stale ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. react queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ â€¦","fields":{"slug":"/query-invalidation/"},"frontmatter":{"date":"August 01, 2022","title":"React-Queryì—ì„œì˜ ë°ì´í„° ìµœì‹ í™” (Query Invalidation)","tags":["react","react-query"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë‚˜ì¸](https://github.com/jhy979)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nReact-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.\r\n\r\n## Stale\r\n> ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.\r\n\r\nreact queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ë³¼ ìˆ˜ ìˆê² ì£ ?)\r\n\r\n### staleTime\r\n> ë°ì´í„°ê°€ freshí•œ ìƒíƒœì—ì„œ staleí•œ ìƒíƒœë¡œ ë³€í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.\r\n\r\n- fresh ìƒíƒœì¼ë•ŒëŠ” ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒˆë¡­ê²Œ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. \r\n\r\n- ë°ì´í„°ê°€ fetch ë˜ê³  ë‚˜ì„œ staleTimeì´ ì§€ë‚˜ì§€ ì•Šì•˜ë‹¤ë©´ unmount í›„ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\r\n\r\n### cacheTime\r\n> ë°ì´í„°ê°€ inactive ìƒíƒœì¼ ë•Œ ìºì‹±ëœ ìƒíƒœë¡œ ë‚¨ì•„ìˆëŠ” ì‹œê°„ì…ë‹ˆë‹¤.\r\n\r\n- ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ unmount ë˜ë©´ ë°ì´í„°ëŠ” inactive ìƒíƒœë¡œ ë³€ê²½ë˜ë©°, ìºì‹œëŠ” cacheTimeë§Œí¼ ìœ ì§€ë©ë‹ˆë‹¤.\r\n\r\n- cacheTimeì€ staleTimeê³¼ ê´€ê³„ì—†ì´, ë¬´ì¡°ê±´ `inactiveëœ ì‹œì `ì„ ê¸°ì¤€ìœ¼ë¡œ ìºì‹±ì„ ê²°ì •í•©ë‹ˆë‹¤.\r\n\r\n---\r\n## ë‹¬ë¡ì—ì„œì˜ ë°ì´í„° ìµœì‹ í™”\r\n\r\n> ë‹¬ë¡ì€ ì¼ì •, ì¹´í…Œê³ ë¦¬, êµ¬ë… ë“±ì˜ ì‘ì—…ìœ¼ë¡œ ì¸í•´ ë°ì´í„°ì˜ ë³€í™”ê°€ ì¦ì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ íŒ€ì€ staleTimeì„ ì§€ì •í•´ì£¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\r\n\r\nê·¸ë ‡ë‹¤ë©´ staleí•œ ë°ì´í„°ëŠ” ëŠ˜ ìµœì‹ í™”ê°€ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.\r\n\r\nê·¸ë˜ì„œ ì €ëŠ” ë§¤ë²ˆ ìƒˆë¡œìš´ ë°ì´í„°ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ `useQueryì˜ refetch`ë¥¼ ê°•ì œì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ë°©ì‹ì„ ìƒê°í–ˆì—ˆìŠµë‹ˆë‹¤.\r\n\r\nì˜ˆë¥¼ ë“¤ë©´ ì¼ì •ì„ ì¶”ê°€(post)í•œ í›„ì— ì¼ì •ì„ ë‹¤ì‹œ ì¡°íšŒ(get)í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ê²ë‹ˆë‹¤.\r\n\r\n![](https://velog.velcdn.com/images/jhy979/post/287f66a2-8b7e-49c8-b623-c05a491db600/image.png)\r\n\r\n```tsx\r\n// refetch í•¨ìˆ˜ë¥¼ ë¶€ëª¨ë¡œ ë¶€í„° ì£¼ì… ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.\r\nfunction ScheduleAddModal({ closeModal, refetch }: ScheduleAddModalProps) {\r\n  const onSuccessPostSchedule = () => {\r\n    refetch();\r\n  };\r\n\r\n```\r\n\r\nğŸ˜¢ í•˜ì§€ë§Œ ì´ ë°©ì‹ì´ ìš°ì•„í•˜ì§€ëŠ” ì•Šë”ë¼êµ¬ìš”. \r\n\r\në§Œì•½ ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ propsì „ë‹¬ì´ ì•„ë‹ˆë¼ ì¡°ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ props ì „ë‹¬ì´ë¼ë©´ ì–´ë–¨ê¹Œìš”? ë²Œì¨ ë¨¸ë¦¬ê°€ ì•„íŒŒì˜µë‹ˆë‹¤. (props hell)\r\n\r\n\r\n## Query Invalidation ë„ì…\r\nğŸ¤” ë‹¤ë¥¸ ë°©ë²•ì´ ìˆì„í…ë°.. ì–´ë–¤ ë°©ë²•ì´ ìˆì„ê¹Œ? ê³ ë¯¼í•˜ë©° ê³µì‹ë¬¸ì„œë¥¼ ì½ë˜ ë„ì¤‘ `Query Invalidation`ì„ ë°œê²¬í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\r\n\r\n```tsx\r\n// Invalidate every query in the cache\r\nqueryClient.invalidateQueries()\r\n// Invalidate every query with a key that starts with `todos`\r\nqueryClient.invalidateQueries(['todos'])\r\n```\r\n> The QueryClient has an invalidateQueries method that lets you intelligently mark queries as stale and potentially refetch them too!\r\n\r\nâ— ìºì‹±í‚¤ë¡œ ê´€ë ¨ëœ stale ì¿¼ë¦¬ë“¤ì„ ì²´í¬í•˜ê³  refetchí•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤.\r\n\r\n```tsx\r\nfunction ScheduleAddModal({ closeModal }: ScheduleAddModalProps) {\r\n  const queryClient = useQueryClient();\r\n\r\n  const onSuccessPostSchedule = () => {\r\n    // ì¼ì • post ì„±ê³µ ì‹œ ë°ì´í„° ìµœì‹ í™”ë¥¼ invalidateQueriesë©”ì„œë“œë¥¼ í†µí•´ ìˆ˜í–‰í•©ë‹ˆë‹¤.\r\n    queryClient.invalidateQueries(CACHE_KEY.SCHEDULES);\r\n  };\r\n```\r\nğŸ’ª ì´ë¡œì¨ useQueryì˜ refetchí•¨ìˆ˜ë¥¼ ë„˜ê²¨ì¤„ í•„ìš”ì—†ì´ ì–´ë””ì„œë“  ìºì‹±í‚¤ë¡œ freshí•œ ë°ì´í„°ë¥¼ ë³´ì¥í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\r\n\r\n\r\n\r\n#### ì°¸ê³ ìë£Œ\r\nhttps://tanstack.com/query/v4/docs/guides/query-invalidation"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ @SpringBootTest  ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ë’¤ ê°„í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ë¹ˆì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì€ ë‹¨ì ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ë¹„êµì  ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤. ëª¨ë“  ë¹ˆâ€¦","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"date":"August 01, 2022","title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸","tags":["í†µí•© í…ŒìŠ¤íŠ¸","ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n# í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸\r\n\r\n## @SpringBootTest\r\n\r\n`@SpringBootTest` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ë’¤ ê°„í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ë¹ˆì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì€ ë‹¨ì ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.\r\n\r\n- ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ë¹„êµì  ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.\r\n- ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— ì˜ì¡´ì„±ì„ ê³ ë ¤í•˜ì§€ ì•Šê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. ì¦‰ í…ŒìŠ¤íŠ¸ í•˜ê³ ì í•˜ëŠ” ê°ì²´ì˜ ì˜ì¡´ì„±ì„ ë¬´ì‹œí•œì±„ í…ŒìŠ¤íŠ¸í•˜ê²Œ ëœë‹¤.\r\n- ë„ë©”ì¸ í˜¹ì€ ì˜ì† ê³„ì¸µì˜ ê²½ìš° application ê³„ì¸µ, presentation ê³„ì¸µì— ëŒ€í•´ ì˜ì¡´í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í•„ìš” ì—†ëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì†Œëª¨ê°€ ëŠ˜ì–´ë‚œë‹¤.\r\n\r\nì´ëŸ¬í•œ `@SpringBootTest`ëŠ” ëª¨ë“  ë¹ˆì„ ë“±ë¡í•œ ì±„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” `í†µí•© í…ŒìŠ¤íŠ¸`ì— ì í•©í•œ ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\r\n\r\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤. \r\n\r\n```java\r\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\r\n@Import(TestConfig.class)\r\nclass AcceptanceTest {\r\n\r\n    @LocalServerPort\r\n    private int port;\r\n\r\n    @Autowired\r\n    private DatabaseCleaner databaseCleaner;\r\n\r\n    @BeforeEach\r\n    void setUp() {\r\n        RestAssured.port = port;\r\n        databaseCleaner.execute();\r\n    }\r\n}\r\n```\r\n\r\n```java\r\n@DisplayName(\"êµ¬ë… ê´€ë ¨ ê¸°ëŠ¥\")\r\n@Import(TestConfig.class)\r\npublic class SubscriptionAcceptanceTest extends AcceptanceTest {\r\n\r\n    @DisplayName(\"ì¸ì¦ëœ íšŒì›ì´ ì¹´í…Œê³ ë¦¬ë¥¼ êµ¬ë…í•˜ë©´ 201ì„ ë°˜í™˜í•œë‹¤.\")\r\n    @Test\r\n    void ì¸ì¦ëœ_íšŒì›ì´_ì¹´í…Œê³ ë¦¬ë¥¼_êµ¬ë…í•˜ë©´_201ì„_ë°˜í™˜í•œë‹¤() {\r\n        // given\r\n        String accessToken = ìì²´_í† í°ì„_ìƒì„±í•˜ê³ _í† í°ì„_ë°˜í™˜í•œë‹¤(GOOGLE_PROVIDER, ì¸ì¦_ì½”ë“œ);\r\n        CategoryResponse ê³µí†µ_ì¼ì • = ìƒˆë¡œìš´_ì¹´í…Œê³ ë¦¬ë¥¼_ë“±ë¡í•œë‹¤(accessToken, ê³µí†µ_ì¼ì •_ìƒì„±_ìš”ì²­);\r\n\r\n        // when\r\n        ExtractableResponse<Response> response = RestAssured.given().log().all()\r\n                .auth().oauth2(accessToken)\r\n                .contentType(MediaType.APPLICATION_JSON_VALUE)\r\n                .body(ë¹¨ê°„ìƒ‰_êµ¬ë…_ìƒì„±_ìš”ì²­)\r\n                .when().post(\"/api/members/me/categories/{categoryId}/subscriptions\", ê³µí†µ_ì¼ì •.getId())\r\n                .then().log().all()\r\n                .statusCode(HttpStatus.CREATED.value())\r\n                .extract();\r\n\r\n        // then\r\n        ìƒíƒœì½”ë“œ_201ì´_ë°˜í™˜ëœë‹¤(response);\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\nì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° ì‚¬ìš©ìì˜ ì‹œë‚˜ë¦¬ì˜¤ì— ë§ì¶° ìˆ˜í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— ì‹¤ì œ ìš´ì˜ í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒ ë³´ë‹¤ ëª¨ë“  ë¹ˆë“¤ì„ ë“±ë¡í•˜ì—¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì ì ˆíˆ ìˆ˜í–‰í•˜ëŠ”ì§€ ì§‘ì¤‘í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— `@SpringBootTest`ë¥¼ í™œìš©í•œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì•¼ í•œë‹¤.\r\n\r\n## ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸\r\n\r\nì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ íŠ¹ì • ê³„ì¸µì€ ë‹¤ë¥¸ ê³„ì¸µì— ì˜ì¡´í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì…ë°›ì•„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ê³„ì¸µë³„ë¡œ í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì…ë°›ê¸° ìœ„í•´ì„œ Springì€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ê´€ë ¨ ì• ë…¸í…Œì´ì…˜ì„ ì œê³µí•œë‹¤.\r\n\r\nìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë€? ë ˆì´ì–´ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë¹ˆë“¤ë§Œ ì£¼ì… ë°›ì•„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.. ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ì ì ˆíˆ í™œìš©í•˜ë©´ ëª¨ë“  ë¹ˆë“¤ì„ ApplicationContextì— ë“±ë¡í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë³´ë‹¤ ë” í˜¸ìœ¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤.\r\n\r\n### @WebMvcTest\r\n\r\n`@WebMvcTest`ëŠ” ì›¹ ê³„ì¸µ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ë¹ˆë“¤ì´ ì£¼ì…ëœë‹¤. ì£¼ì… ë˜ëŠ” ë¹ˆì˜ í•­ëª©ì€ ì•„ë˜ì™€ ê°™ë‹¤.\r\n\r\n- `@Controller`\r\n- `@ControllerAdvice`\r\n- `@JsonComponent`\r\n- `Converter`\r\n- `Filter`\r\n- `WebMvcConfigurer`\r\n- `HandlerMethodArgumentResolver`\r\n- `MockMvc`\r\n- ë“±\r\n\r\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì¤‘ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\r\n\r\n```java\r\n@AutoConfigureRestDocs\r\n@WebMvcTest(SubscriptionController.class)\r\nclass SubscriptionControllerTest {\r\n\r\n    private static final String AUTHORIZATION_HEADER_NAME = \"Authorization\";\r\n    private static final String AUTHORIZATION_HEADER_VALUE = \"Bearer aaaaa.bbbbb.ccccc\";\r\n\r\n    @Autowired\r\n    private MockMvc mockMvc;\r\n\r\n    @Autowired\r\n    private ObjectMapper objectMapper;\r\n\r\n    @MockBean\r\n    private AuthService authService;\r\n\r\n    @MockBean\r\n    private SubscriptionService subscriptionService;\r\n\r\n    @DisplayName(\"íšŒì›ê³¼ ì¹´í…Œê³ ë¦¬ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ë…í•œë‹¤.\")\r\n    @Test\r\n    void íšŒì›ê³¼_ì¹´í…Œê³ ë¦¬_ì •ë³´ë¥¼_ê¸°ë°˜ìœ¼ë¡œ_êµ¬ë…í•œë‹¤() throws Exception {\r\n        // given\r\n        CategoryResponse ê³µí†µ_ì¼ì •_ì‘ë‹µ = ê³µí†µ_ì¼ì •_ì‘ë‹µ(ê´€ë¦¬ì_ì‘ë‹µ);\r\n        SubscriptionResponse ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ = ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ(ê³µí†µ_ì¼ì •_ì‘ë‹µ);\r\n\r\n        given(authService.extractMemberId(any())).willReturn(ë§¤íŠ¸_ì‘ë‹µ.getId());\r\n        given(subscriptionService.save(any(), any(), any())).willReturn(ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ);\r\n\r\n        // when & then\r\n        mockMvc.perform(post(\"/api/members/me/categories/{categoryId}/subscriptions\", ë¹¨ê°„ìƒ‰_êµ¬ë…_ì‘ë‹µ.getId())\r\n                        .header(AUTHORIZATION_HEADER_NAME, AUTHORIZATION_HEADER_VALUE)\r\n                        .accept(MediaType.APPLICATION_JSON).contentType(MediaType.APPLICATION_JSON)\r\n                        .content(objectMapper.writeValueAsString(ë¹¨ê°„ìƒ‰_êµ¬ë…_ìƒì„±_ìš”ì²­)))\r\n                .andDo(print())\r\n                .andDo(document(\"subscription/save\",\r\n                        preprocessRequest(prettyPrint()),\r\n                        preprocessResponse(prettyPrint()),\r\n                        pathParameters(\r\n                                parameterWithName(\"categoryId\").description(\"ì¹´í…Œê³ ë¦¬ id\")\r\n                        ),\r\n                        requestHeaders(\r\n                                headerWithName(\"Authorization\").description(\"JWT í† í°\")\r\n                        ),\r\n                        requestFields(\r\n                                fieldWithPath(\"color\").type(JsonFieldType.STRING).description(\"êµ¬ë… ìƒ‰ ì •ë³´\")\r\n                        )))\r\n                .andExpect(status().isCreated());\r\n    }\r\n    ...\r\n]\r\n```\r\n\r\nì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° ì‹¤ì œ ë™ì‘í•˜ëŠ” ë¡œì§ì„ í™œìš©í•˜ëŠ” ê²ƒ ë³´ë‹¤ APIì˜ ë¬¸ì„œí™”ì— ì§‘ì¤‘í–ˆê¸° ë•Œë¬¸ì— ì›¹ ê³„ì¸µì— ëŒ€í•œ ì˜ì¡´ì„±ë§Œ ì¶”ê°€í•œ ë’¤ ì˜ì¡´í•˜ëŠ” ê°ì²´ëŠ” Mockingì„ í†µí•´ ì§„í–‰í•˜ì˜€ë‹¤.\r\n\r\n### @DataJpaTest\r\n\r\nSpring Data JPAë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ê°„ë‹¨íˆ `@DataJpaTest`ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. `@Entity` ê°ì²´, `JpaRepository` ë“± JPA ì‚¬ìš©ì— í•„ìš”í•œ ë¹ˆë“¤ì„ ë“±ë¡í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ `@DataJpaTest`ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\r\n\r\n```java\r\n@Target(ElementType.TYPE)\r\n@Retention(RetentionPolicy.RUNTIME)\r\n@Documented\r\n@Inherited\r\n@BootstrapWith(DataJpaTestContextBootstrapper.class)\r\n@ExtendWith(SpringExtension.class)\r\n@OverrideAutoConfiguration(enabled = false)\r\n@TypeExcludeFilters(DataJpaTypeExcludeFilter.class)\r\n@Transactional\r\n@AutoConfigureCache\r\n@AutoConfigureDataJpa\r\n@AutoConfigureTestDatabase\r\n@AutoConfigureTestEntityManager\r\n@ImportAutoConfiguration\r\npublic @interface DataJpaTest {\r\n\t...\r\n}\r\n```\r\n\r\nì£¼ì˜ ê¹Šê²Œ ë´ì•¼í•  ì• ë…¸í…Œì´ì…˜ë“¤ì´ ë§ë‹¤. ëª‡ ê°€ì§€ ì˜ˆì‹œë¡œ `@AutoConfigureTestDatabase`, `@Transactional`ì— ëŒ€í•´ ê°„ë‹¨íˆ ì‚´í´ë³´ì.\r\n\r\n#### @AutoConfigureTestDatabase\r\n\r\n```java\r\n...\r\n@AutoConfigureTestDatabase\r\n...\r\npublic @interface DataJpaTest {\r\n\t...\r\n}\r\n```\r\n\r\nì• í”Œë¦¬ì¼€ì´ì…˜ì— ì •ì˜ë˜ì–´ ìˆê±°ë‚˜ ìë™ìœ¼ë¡œ ì„¤ì •ëœ DataSoruceë¥¼ ëŒ€ì‹ í•˜ì—¬ í…ŒìŠ¤íŠ¸ìš© DBë¥¼ ì •ì˜í•  ë•Œ ì‚¬ìš©ëœë‹¤. ì•„ë˜ ì‹¤ì œ ì½”ë“œë¥¼ ì‚´í´ë³´ì.\r\n\r\n```java\r\n@Target({ ElementType.TYPE, ElementType.METHOD })\r\n@Retention(RetentionPolicy.RUNTIME)\r\n@Documented\r\n@Inherited\r\n@ImportAutoConfiguration\r\n@PropertyMapping(\"spring.test.database\")\r\npublic @interface AutoConfigureTestDatabase {\r\n\r\n\t@PropertyMapping(skip = SkipPropertyMapping.ON_DEFAULT_VALUE)\r\n\tReplace replace() default Replace.ANY;\r\n\r\n\tEmbeddedDatabaseConnection connection() default EmbeddedDatabaseConnection.NONE;\r\n\r\n\tenum Replace {\r\n\t\tANY,\r\n\t\tAUTO_CONFIGURED,\r\n\t\tNONE\r\n\t}\r\n}\r\n```\r\n\r\n- `replace()`:  ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ê¸°ì¡´ DataSource ë¹ˆì˜ ìœ í˜•ì„ ê²°ì •í•œë‹¤.\r\n    - `Replace.ANY`: ìë™ êµ¬ì„± ë˜ëŠ” ìˆ˜ë™ ì •ì˜ì˜ ì—¬ë¶€ì— ìƒê´€ ì—†ì´ DataSourceë¥¼ êµì²´í•œë‹¤. default ì„¤ì • ì´ê¸° ë•Œë¬¸ì— `@DataJpaTest`ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ `in-memory embedded database`ë¥¼ í™œìš©í•œë‹¤.\r\n    - `Replace.AUTO_CONFIGURED`: ìë™ ì„¤ì •ëœ ê²½ìš°ì—ë§Œ DataSourceë¥¼ êµì²´í•œë‹¤.\r\n    - `Replace.NONE`: ê¸°ë³¸ DataSourceë¥¼ êµì²´í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰ ìš°ë¦¬ê°€ ì§ì ‘ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê±°ë‚˜ ëª…ì‹œí•œ DataSourceë¥¼ ì‚¬ìš©í•œë‹¤. ë§Œì•½ `in-memory embedded database`ê°€ ì•„ë‹Œ ì™¸ë¶€ DBë‚˜ í…ŒìŠ¤íŠ¸ ìš© DBë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ `@AutoConfigureTestDatabase(replace = Replace.NONE)`ìœ¼ë¡œ ì„¤ì •ì„ ë®ì–´ì•¼ í•œë‹¤.\r\n\r\n#### @Transactional\r\n\r\n```java\r\n...\r\n@Transactional\r\n...\r\npublic @interface DataJpaTest {\r\n\t...\r\n}\r\n```\r\n\r\nì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ `@DataJpaTest`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `@Transactional` ì• ë…¸í…Œì´ì…˜ì„ ë“¤ê³  ìˆê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ë¡¤ë°±ëœë‹¤.\r\n\r\nì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\r\n\r\n```java\r\n@DataJpaTest\r\n@Import(JpaConfig.class)\r\nclass ScheduleRepositoryTest {\r\n\r\n    @Autowired\r\n    private ScheduleRepository scheduleRepository;\r\n\r\n    @DisplayName(\"ì‹œì‘ì¼ì‹œì™€ ì¢…ë£Œì¼ì‹œë¥¼ ì „ë‹¬í•˜ë©´ ê·¸ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì¼ì •ì„ ì¡°íšŒí•œë‹¤.\")\r\n    @Test\r\n    void ì‹œì‘ì¼ì‹œì™€_ì¢…ë£Œì¼ì‹œë¥¼_ì „ë‹¬í•˜ë©´_ê·¸_ì‚¬ì´ì—_í•´ë‹¹í•˜ëŠ”_ì¼ì •ì„_ì¡°íšŒí•œë‹¤() {\r\n        // given\r\n        Schedule schedule1 = new Schedule(TITLE, LocalDateTime.of(2022, 7, 14, 14, 20),\r\n                LocalDateTime.of(2022, 7, 15, 16, 20), MEMO);\r\n\r\n        Schedule schedule2 = new Schedule(TITLE, LocalDateTime.of(2022, 8, 15, 14, 20),\r\n                LocalDateTime.of(2022, 8, 15, 16, 20), MEMO);\r\n\r\n        scheduleRepository.save(schedule1);\r\n        scheduleRepository.save(schedule2);\r\n\r\n        // when\r\n        List<Schedule> schedules = scheduleRepository.findByBetween(START_DAY_OF_MONTH, END_DAY_OF_MONTH);\r\n\r\n        // then\r\n        assertThat(schedules).hasSize(1);\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\n## ì •ë¦¬\r\n\r\nì´ ë°–ì—ë„ `@JdbcTest`, `@DataMongoTest`, `@RestClientTest` ë“± ë‹¤ì–‘í•œ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• ë…¸í…Œì´ì…˜ì´ ì œê³µëœë‹¤. ì–´ë– í•œ ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•˜ê¸° ë³´ë‹¤ `í…ŒìŠ¤íŠ¸ì˜ ëª©ì `ì— ëŒ€í•´ ê³ ë¯¼í•´ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸í•˜ê³ ì í•˜ëŠ” ê²ƒì— ì§‘ì¤‘í•˜ì—¬ ì˜ì¡´í•˜ê±°ë‚˜ í•„ìš”í•œ ë¹ˆë“¤ì— ëŒ€í•´ ê³ ë¯¼í•œ ë’¤ ì ì ˆí•œ ì• ë…¸í…Œì´ì…˜ì„ ì ìš©í•˜ë©´ ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìœ¼ë©° ë³´ë‹¤ ë” ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ í”¼ë“œë°±ì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ íŒë‹¨í•œë‹¤.\r\n\r\n## References.\r\n[Spring Boot Test](https://meetup.toast.com/posts/124)<br>\r\n[8. Testing](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing)<br>\r\n[Spring Boot ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸](https://tecoble.techcourse.co.kr/post/2021-05-18-slice-test/)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸° ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ í†µì‹ ì— SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ì—¬ HTTPS í†µì‹ ì„ í•˜ë„ë¡ í•˜ì˜€ë‹¤.\nHTTPSì˜ í†µì‹ ê³¼ì •ì— ëŒ€í•œ ì´í•´ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤. HTTPS ëŠ” SSL(Secure Sokect Layer) ìœ„ì— ë¥¼ ì–¹ì–´ì„œ ë³´ì•ˆì´â€¦","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"date":"July 31, 2022","title":"SSLì„ í†µí•œ HTTPSí†µì‹  ê³¼ì •","tags":["HTTPS"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸°\r\nìš°ì•„í•œí…Œí¬ì½”ìŠ¤ ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ í†µì‹ ì— SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ì—¬ HTTPS í†µì‹ ì„ í•˜ë„ë¡ í•˜ì˜€ë‹¤.\r\nHTTPSì˜ í†µì‹ ê³¼ì •ì— ëŒ€í•œ ì´í•´ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤.\r\n\r\n\r\n## HTTPS\r\n`HTTPS`ëŠ” SSL(Secure Sokect Layer) ìœ„ì— `HTTP`ë¥¼ ì–¹ì–´ì„œ ë³´ì•ˆì´ ë³´ì¥ëœ í†µì‹ ì„ í•˜ê³ ìí•˜ëŠ” í”„ë¡œí† ì½œì´ë‹¤.\r\n\r\n## SSL ì¸ì¦ì„œ\r\ní´ë¼ì´ì–¸íŠ¸ì™€ ì›¹ ì„œë²„ê°„ì˜ í†µì‹ ì„ ì œ3ìê°€ ë³´ì¦í•´ì£¼ëŠ” ì „ìë¬¸ì„œì´ë‹¤.\r\ní´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í•œ ì§í›„ì— ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ `SLL ì¸ì¦ì„œ`ë¥¼ ì „ë‹¬í•œë‹¤.\r\ní´ë¼ì´ì–¸íŠ¸ëŠ” ì‹ ë¢° í•  ìˆ˜ ìˆëŠ” ì¸ì¦ì„œì¸ì§€ ê²€ì¦í•œ í›„ ì„œë²„ì™€ í†µì‹ ì„ ì§„í–‰í•œë‹¤.\r\n(ë°‘ì—ì„œ ìì„¸íˆ ì„¤ëª…)\r\n\r\n## SSL ì¸ì¦ì„œ ì‚¬ìš©ì´ìœ \r\nì™œ HTTP í†µì‹ ì— êµ³ì´ SSL ì¸ì¦ ê³¼ì •ì„ ë¶™í˜“ì„ê¹Œ? ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\r\n- í†µì‹  ë‚´ìš©ì´ ì•…ì˜ì ì¸ ëª©ì ì„ ê°€ì§„ ì‚¬ëŒì—ê²Œ ë…¸ì¶œë˜ëŠ” ê²ƒ ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.\r\n- í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•˜ëŠ” ì„œë²„ê°€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„œë²„ì¸ì§€ íŒë‹¨ í•  ìˆ˜ ìˆë‹¤.\r\n- í†µì‹  ë‚´ìš©ì˜ ì•…ì˜ì ì¸ ë³€ê²½ì„ ë°©ì§€ í•  ìˆ˜ ìˆë‹¤.\r\n\r\n\r\nSSL í†µì‹ ê³¼ì •ì€ ê½¤ë‚˜ ë³µì¡í•˜ë‹¤. \r\nê·¸ë˜ì„œ SSL í”„ë¡œí† ì½œì„ ì´í•´í•˜ë ¤ë©´ ìš°ì„  `ì•”í˜¸í™”/ë³µí˜¸í™”`ì™€ `í‚¤(ëŒ€ì¹­í‚¤, ê³µê°œí‚¤)`ì— ëŒ€í•´ ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.\r\n\r\n## ì•”í˜¸í™”, ë³µí˜¸í™”, í‚¤\r\nì–´ë–¤ ì •ë³´ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê¸° ìœ„í•´ ë³€í˜•í•˜ëŠ” ê²ƒì„ `ì•”í˜¸í™”` ë¼ê³ í•œë‹¤.\r\në°˜ëŒ€ë¡œ ì•”í˜¸í™”ëœ ë°ì´í„°ë¥¼ ì›ë³¸ìœ¼ë¡œ ë³µì›í•˜ëŠ”ê²ƒì„ `ë³µí˜¸í™”`ë¼ê³  í•œë‹¤.\r\nì•”í˜¸í™”ì™€ ë³µí˜¸í™”ì—ì„œ ë°ì´í„° ë³€í˜•ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ”ê²ƒì„ `í‚¤`ë¼ê³  í•œë‹¤.\r\n\r\nì´ë ‡ê²Œ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ `ì•”í˜¸í™”/ë³µí˜¸í™”` í•˜ëŠ” ë°©ì‹ì—ëŠ” `ëŒ€ì¹­í‚¤ ë°©ì‹`ê³¼ `ê³µê°œí‚¤ ë°©ì‹`ì´ ìˆë‹¤. \r\në‘ ë°©ì‹ ëª¨ë‘ `SSL í†µì‹ `ì— ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.\r\n\r\n\r\n## ëŒ€ì¹­í‚¤ ë°©ì‹\r\nëŒ€ì¹­í‚¤ëŠ” ë™ì¼í•œ í‚¤ë¡œ `ì•”í˜¸í™”`ì™€ `ë³µí˜¸í™”`ë¥¼ ê°™ì´ í•  ìˆ˜ ì‡ëŠ” ë°©ì‹ì˜ ì•”í˜¸í™” ê¸°ë²•ì„ ì˜ë¯¸í•œë‹¤.\r\n`ì•”í˜¸í™”`ì™€ `ë³µí˜¸í™”`ë¥¼ ìœ„í•´ ì–‘ìª½ì´ ê°™ì€ í‚¤ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤ëŠ” ì ì—ì„œ ì´ í‚¤ë¥¼ `ëŒ€ì¹­í‚¤`ë¼ê³  í•œë‹¤.\r\n\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/01b1f9b4-66ed-46d6-87d4-b18948611b80/image.JPG)\r\n\r\nì „ìŸìƒí™©ì„ ê°€ì •í•´ì„œ ì‚´í´ë³´ì. `Aì§„ì˜`ê³¼ `Bì§„ì˜`ì´ ì „ìŸ ì¤‘ì¼ ë•Œ, ì êµ°ì—ê²Œ ì •ë³´ë¥¼ ë…¸ì¶œí•˜ì§€ ì•Šìœ¼ë ¤ë©´ `ì„œë¡œ ê°™ì€ í‚¤(ëŒ€ì¹­í‚¤)`ë¥¼ ê°€ì§€ê³  ì •ë³´ë¥¼ ì•”í˜¸í™” í•´ì„œ ì „ë‹¬ í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.\r\n\r\nê·¸ëŸ°ë°, `ëŒ€ì¹­í‚¤`ëŠ” í•˜ë‚˜ì˜ í° ë‹¨ì ì„ ê°€ì§„ë‹¤. ë°”ë¡œ `ëŒ€ì¹­í‚¤`ë¥¼ `Aì§„ì˜`ì—ì„œ `Bì§„ì˜` ë˜ëŠ” `Bì§„ì˜`ì—ì„œ `Aì§„ì˜`ìœ¼ë¡œ ì „ë‹¬ í•  ë•Œ, \r\n`ëŒ€ì¹­í‚¤`ê°€ íƒˆì·¨ ëœë‹¤ë©´ ì êµ°ë„ ì •ë³´ë¥¼ ë³µí˜¸í™” í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.\r\n\r\nì´ëŸ° ë°°ê²½ì—ì„œ ë‚˜ì˜¨ ì•”í˜¸í™” ë°©ì‹ì´ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.\r\n\r\n## ê³µê°œí‚¤ ë°©ì‹\r\n`ê³µê°œí‚¤`ëŠ” í‚¤ê°€ ë‘ê°œê°€ ìˆë‹¤.\r\nAí‚¤ë¡œ ì•”í˜¸í™” í•˜ë©´ Bí‚¤ë¡œ ë³µí˜¸í™” í•  ìˆ˜ ìˆê³  Bí‚¤ë¡œ ì•”í˜¸í™” í•˜ë©´ Aí‚¤ë¡œ ë³µí˜¸í™” í•˜ëŠ” ë°©ì‹ì´ë‹¤.\r\n\r\nì´ ë°©ì‹ì— ì°©ì•ˆí•´ì„œ ë‘ê°œì˜ í‚¤ ì¤‘ í•˜ë‚˜ë¥¼ ê³µê°œí‚¤, í•˜ë‚˜ë¥¼ ë¹„ê³µê°œ í‚¤ë¡œ ì§€ì •í•œë‹¤. \r\n\r\nê·¸ë¦¼ì„ í†µí•´ ìì„¸íˆ ì‚´í´ë³´ì.\r\n\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/58d5be37-7ee5-4d8f-aacb-8ea66c23ecda/image.JPG)\r\n\r\n`Aì§„ì˜`ì€ `ê³µê°œí‚¤`ë¥¼ `Bì§„ì˜`ì—ê²Œ ì „ë‹¬í•œë‹¤.\r\nê·¸ë¦¬ê³  `Bì§„ì˜`ì€ `Aì§„ì˜`ì˜ `ê³µê°œí‚¤`ë¥¼ í†µí•´ ì •ë³´ë¥¼ ì•”í˜¸í™” í•œ í›„ `Aì§„ì˜`ì— ì „ë‹¬í•œë‹¤.\r\n`Aì§„ì˜`ì€ `ë¹„ê³µê°œí‚¤`ë¥¼ í†µí•´ ì „ë‹¬ ë°›ì€ ì •ë³´ë¥¼ ë³µí˜¸í™”í•œë‹¤.\r\n\r\n`Aì§„ì˜`ì˜ ê³µê°œí‚¤ê°€ íƒˆì·¨ë˜ê±°ë‚˜ `Bì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ê°€ íƒˆì·¨ë˜ì–´ë„ `ë¹„ê³µê°œí‚¤`ê°€ ì—†ìœ¼ë©´ ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥ í•˜ê¸° ë•Œë¬¸ì— `ëŒ€ì¹­í‚¤ ë°©ì‹`ì˜ ë‹¨ì ì„ ê·¹ë³µ í•  ìˆ˜ ìˆë‹¤.\r\n\r\n`ê³µê°œí‚¤ ë°©ì‹`ì€ ì´ë ‡ê²Œ ì‘ìš© í•  ìˆ˜ ìˆë‹¤.\r\n`Aì§„ì˜`ì´ `ë¹„ê³µê°œí‚¤`ë¥¼ ì´ìš©í•´ì„œ ì •ë³´ë¥¼ ì•”í˜¸í™” í•œ í›„ì— ê³µê°œí‚¤ì™€ í•¨ê»˜ ì•”í˜¸í™”ëœ ì •ë³´ë¥¼ `Bì§„ì˜`ì— ì „ë‹¬í•œë‹¤.\r\n\r\nê·¸ëŸ°ë°, ì´ëŸ° ì‘ìš©ë°©ì‹ì€ ì¤‘ê°„ì— `ê³µê°œí‚¤`ì™€ `ì•”í˜¸í™”ëœ ì •ë³´`ë¥¼ íƒˆì·¨ ë‹¹í•˜ë©´ ì êµ°ì—ê²Œ ì •ë³´ë¥¼ ë…¸ì¶œ ë‹¹í•  ìˆ˜ ìˆëŠ” ë¬¸ì œë¥¼ ê°€ì ¸ì˜¨ë‹¤.\r\n\r\nê·¸ëŸ°ë° `SSL í†µì‹ `ì—ì„œëŠ” ì´ëŸ° ì‘ìš©ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. ê·¸ ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œ?\r\n\r\n## SSL í†µì‹ ì´ ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ \r\nê·¸ ì´ìœ ëŠ” `ê³µê°œí‚¤ ì‘ìš©ë°©ì‹`ì´ ë°ì´í„° ë³´í˜¸ ëª©ì ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.\r\n\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/bdfe5ab8-c202-4d3a-bd6a-34b1e46b37c3/image.JPG)\r\n\r\n`Aì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ë¥¼ `Aì§„ì˜ì˜ ê³µê°œí‚¤`ë¡œ ë³µí˜¸í™” í•  ìˆ˜ ìˆë‹¤ë©´, ì •ë³´ê°€ `Aì§„ì˜`ì´ ì „ë‹¬í•œ ì •ë³´ì„ì„ ì‹ ë¢° í•  ìˆ˜ ìˆë‹¤.\r\n\r\nì¦‰, ê³µê°œí‚¤ê°€ ì •ë³´ë¥¼ ì „ë‹¬í•œ ì‚¬ëŒì˜ ì‹ ì›ì„ ë³´ì¥í•´ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ê²ƒì„ ì „ì ì„œëª…ì´ë¼ê³  í•˜ê³  `SSL í†µì‹ `ì—ì„œ ì„œë²„ì˜ ì‹ ì› í™•ì¸ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤.\r\n\r\n\r\n## SSL ìš©ì–´ ì •ë¦¬\r\n\r\nì´ì œ SSL í†µì‹ ì— ì‚¬ìš©ë˜ëŠ” `ëŒ€ì¹­í‚¤ ë°©ì‹`, `ê³µê°œí‚¤ ë°©ì‹`, `ê³µê°œí‚¤ ì‘ìš©ë°©ì‹`ì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ SSLì„ í†µí•œ í†µì‹ ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë³´ì. \r\nìš°ì„ , SSLê³¼ ê´€ë ¨ëœ ìš©ì–´ë¥¼ ì •ë¦¬í•´ë³´ì.\r\n\r\n### CA\r\nSSL ì¸ì¦ì„œì˜ ì—­í• ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•œ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ë„í•œ ì„œë²„ê°€ ë§ëŠ”ì§€ë¥¼ ë³´ì¥í•˜ëŠ” ì—­í• ì„ í•œë‹¤. \r\nì´ ì—­í• ì„ í•˜ëŠ” ë¯¼ê°„ê¸°ì—…ë“¤ì´ ìˆëŠ”ë° ì´ëŸ° ê¸°ì—…ë“¤ì„ `CA(Certificate authority)` ë¼ê³ í•œë‹¤.\r\n\r\n\r\n### SSL ì¸ì¦ì„œ ë‚´ìš©\r\n`SSL ì¸ì¦ì„œ`ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.\r\n\r\n- ì„œë¹„ìŠ¤ì˜ ì •ë³´ (ì¸ì¦ì„œë¥¼ ë°œê¸‰í•œ CA, ì„œë¹„ìŠ¤ì˜ ë„ë©”ì¸ ë“±ë“±)\r\n- ì„œë²„ ì¸¡ ê³µê°œí‚¤ (ê³µê°œí‚¤ì˜ ë‚´ìš©, ê³µê°œí‚¤ì˜ ì•”í˜¸í™” ë°©ë²•)\r\n\r\n## SSL í†µì‹  ê³¼ì •\r\nì´ì œ `í‚¤ë¥¼ ì‚¬ìš©í•œ 3ê°€ì§€ í†µì‹  ë°©ë²•`ì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ SSL í†µì‹ ê³¼ì •ì„ ì´í•´í•´ë³´ì.\r\n\r\n`SSL í†µì‹ ê³¼ì •`ì—ì„œ ê°€ì¥ ì´ìƒì ì¸ ë°©ë²•ì€ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.(ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ ì•„ë‹˜)\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/b528a5c7-9515-4a8b-a4d8-f1341abf57d2/image.JPG)\r\n\r\n\r\n`í´ë¼ì´ì–¸íŠ¸`ì™€ `ì„œë²„`ëŠ” ê°ê°ì˜ `ë¹„ê³µê°œí‚¤, ê³µê°œí‚¤`ë¥¼ ê°€ì§€ê³ \r\nìì‹ ì˜ `ê³µê°œí‚¤`ë¥¼ ì„œë¡œì—ê²Œ ì „ë‹¬í•œë‹¤. ì´ë•Œ, `ê³µê°œí‚¤`ëŠ” íƒˆì·¨ë˜ì–´ë„ `ë¹„ê³µê°œí‚¤`ê°€ ì—†ìœ¼ë©´ ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆì— ì·¨ì•½ì ì´ ì—†ë‹¤.\r\n\r\nê·¸ë¦¬ê³ , `í´ë¼ì´ì–¸íŠ¸`ëŠ” `ì„œë²„`ì˜ `ê³µê°œí‚¤`ë¡œ ì •ë³´ë¥¼ ì•”í˜¸í™” í•´ì„œ ì „ë‹¬í•˜ê³  `ì„œë²„`ëŠ” ì „ë‹¬ ë°›ì€ ì •ë³´ë¥¼ ìì‹ ì˜ `ë¹„ê³µê°œí‚¤(ì„œë²„ ë¹„ê³µê°œí‚¤)`ë¡œ ë³µí˜¸í™”í•œ ë’¤ ì •ë³´ë¥¼ ì²˜ë¦¬í•œë‹¤.\r\n\r\në§ˆì§€ë§‰ìœ¼ë¡œ `ì„œë²„`ëŠ” `í´ë¼ì´ì–¸íŠ¸ì˜ ê³µê°œí‚¤`ë¡œ ì‘ë‹µí•´ì¤„ ì •ë³´ë¥¼ ì•”í˜¸í™”í•´ì„œ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•œë‹¤.\r\n\r\nê·¸ëŸ°ë°, `ê³µê°œí‚¤ ë°©ì‹`ì€ ì»´í“¨íŒ… íŒŒì›Œë¥¼ ë§ì´ ì“´ë‹¤ê³ í•œë‹¤.(ì»´í“¨íŒ… íŒŒì›Œë¥¼ ë§ì´ì“°ëŠ” ì •í™•í•œ ì´ìœ ëŠ” ëª¨ë¦„) ê·¸ë˜ì„œ ì„±ëŠ¥ì¸¡ë©´ì—ì„œ ë¹„íš¨ìœ¨ì ì´ë‹¤.\r\n\r\nê²°ë¡ ì ìœ¼ë¡œ, `SSL í†µì‹ `ì€ `ê³µê°œí‚¤ ë°©ì‹ + ëŒ€ì¹­í‚¤ ë°©ì‹`ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì•ˆê³¼ì„±ëŠ¥ ë‘ê°€ì§€ ì¸¡ë©´ì„ ë³´ì¥í•œë‹¤.\r\n\r\nì´ì œ SSL í†µì‹ ê³¼ì •ì„ ì²œì²œíˆ ìì„¸í•˜ê²Œ ì‚´í´ë³´ì.\r\n\r\n> HandShake -> í†µì‹  -> í†µì‹ ì¢…ë£Œ\r\n\r\nê°„ë‹¨í•˜ê²Œ, SSL í†µì‹ ì€ ìœ„ ì„¸ê°€ì§€ ê³¼ì •ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤.\r\nìˆœì„œëŒ€ë¡œ í•˜ë‚˜ì”© ì‚´í´ë³´ì.\r\n\r\n### HandShake(ì•…ìˆ˜)\r\nSSL í†µì‹ ì€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ê¸°ì „ì— `ì–´ë–»ê²Œ ë°ì´í„°ë¥¼ ì•”í˜¸í™” í• ì§€`, `ë¯¿ì„ ë§Œí•œ ì„œë²„ì¸ì§€` ë“±ì— ëŒ€í•´ ì´ ê³¼ì •ì—ì„œ í™•ì¸í•œë‹¤.\r\n\r\n1. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í•œë‹¤. ì´ ë‹¨ê³„ë¥¼ `Client Hello`ë¼ê³  í•œë‹¤. ì´ ë‹¨ê³„ì—ì„œ ì£¼ê³  ë°›ëŠ” ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\r\n  \r\n  1) í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ìƒì„±í•œ `ëœë¤ ë°ì´í„°` (ë°‘ì—ì„œ ì„¤ëª…)\r\n  \r\n  2) í´ë¼ì´ì–¸íŠ¸ê°€ ì§€ì›í•˜ëŠ” ì•”í˜¸í™” ë°©ì‹ë“¤ => í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ëŠ¥í•œ ì•”í˜¸í™” ë°©ì‹ì„ ì„œë²„ì— ì•Œë ¤ì£¼ê¸° ìœ„í•¨\r\n  \r\n2. ì„œë²„ëŠ” `Client Hello`ì— ëŒ€í•œ ì‘ë‹µìœ¼ë¡œ `Server Hello`ë¥¼ í•˜ê²Œ ëœë‹¤. ì´ ë‹¨ê³„ì—ì„œ ì£¼ê³  ë°›ëŠ” ì •ë³´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\r\n  \r\n  1) ì„œë²„ ì¸¡ì—ì„œ ìƒì„±í•œ ëœë¤ ë°ì´í„° (ë°‘ì—ì„œ ì„¤ëª…)\r\n  \r\n  2) ì„œë²„ê°€ ì„ íƒí•œ í´ë¼ì´ì–¸íŠ¸ì˜ ì•”í˜¸í™” ë°©ì‹ => ì„ íƒí•œ ì•”í˜¸í™” ë°©ì‹ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì£¼ê¸° ìœ„í•¨\r\n  \r\n  3) ì¸ì¦ì„œ\r\n  \r\n  \r\n3. `í´ë¼ì´ì–¸íŠ¸`ëŠ” `ì„œë²„ì˜ ì¸ì¦ì„œ`ê°€ `CA`ì— ì˜í•´ ë°œê¸‰ëœ ê²ƒì¸ì§€ í™•ì¸í•œë‹¤.\r\n  ì´ë•Œ, `í´ë¼ì´ì–¸íŠ¸`ì— ë‚´ì¥ëœ `CAë¦¬ìŠ¤íŠ¸ì™€ CAì˜ ê³µê°œí‚¤`ë¥¼ ì‚¬ìš©í•´ì„œ ì¸ì¦ì„œë¥¼ ë³µí˜¸í™” í•œë‹¤. \r\n>   ğŸ’¡ ì°¸ê³ \r\n  ìœ„ì—ì„œ ë§í•œ ê³µê°œí‚¤ ì‘ìš©ë°©ì‹ì˜ í™œìš©\r\n  ê·¸ë¦¬ê³ , í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ëŠ” CA ì¢…ë¥˜ì™€ CAì˜ ê³µê°œí‚¤ê°€ ë‚´ì¥ë˜ìˆìŒ\r\n  \r\n  ì„±ê³µì ìœ¼ë¡œ ì¸ì¦ì„œê°€ ë³µí˜¸í™” ë¬ë‹¤ë©´, `ì„œë²„`ê°€ ì „ë‹¬í•œ ì¸ì¦ì„œê°€ `CAì˜ ê°œì¸í‚¤`ë¡œ ì•”í˜¸í™”ëœ ë¬¸ì„œì„ì´ ë³´ì¦ëœ ê²ƒì´ë‹¤.\r\n**  ì¦‰, ì˜¬ë°”ë¥¸ ì„œë²„ì„ì„ ì‹ ë¢° í• ìˆ˜ ìˆê²Œëœë‹¤.**\r\n  \r\n  ì„œë²„ë¥¼ ì‹ ë¢°í• ìˆ˜ ìˆìœ¼ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ëŠ” `ì„œë²„ê°€ ìƒì„±í•œ ëœë¤ ë°ì´í„°`ì™€ `í´ë¼ì´ì–¸íŠ¸ê°€ ìƒì„±í•œ ëœë¤ ë°ì´í„°`ë¥¼ ì¡°í•©í•˜ì—¬ `pre master secret`ì´ë¼ëŠ” í‚¤ë¥¼ ìƒì„±í•œë‹¤. \r\n  \r\n ì´ë•Œ, `pre master secret`í‚¤ëŠ” ëŒ€ì¹­í‚¤ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš© í•  ê²ƒì´ë‹¤.\r\n í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ë™ì¼í•˜ê²Œ ê°€ì§€ê³  ë°ì´í„°ë¥¼ ì•”í˜¸í™”/ë³µí˜¸í™” í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì´ë‹¤.\r\n \r\n ê·¸ëŸ°ë° ëŒ€ì¹­í‚¤ ë°©ì‹ì˜ ë‹¨ì ì—ì„œ ì‚´í´ë´¤ë“¯ì´ `pre master secret`ë¥¼ ê·¸ëŒ€ë¡œ ì„œë²„ì— ì „ë‹¬í•˜ë©´ ì¤‘ê°„ì— íƒˆì·¨ë‹¹í•´ ì•…ìš©ë ìˆ˜ ìˆë‹¤.\r\n \r\n ì´ë•Œ, ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ `ê³µê°œí‚¤ ë°©ì‹`ì´ë‹¤.\r\n `ì„œë²„ì˜ ê³µê°œí‚¤(ì„œë²„ê°€ ì „ë‹¬í•´ì¤€ ì¸ì¦ì„œ ë‚´ë¶€ì— ë“¤ì–´ìˆì—ˆìŒ)`ë¡œ `pre master secret`ë¥¼ ì•”í˜¸í™”í•´ì„œ `ì„œë²„`ë¡œ ì „ì†¡í•œë‹¤.\r\n\r\n\r\n \r\n 4. `ì„œë²„`ëŠ” ìì‹ ì˜ ë¹„ê³µê°œí‚¤ë¥¼ í†µí•´ `pre master secret`ë¥¼ ë³µí˜¸í™”í•œë‹¤.\r\n \r\n ì´ë¥¼ í†µí•´, í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì•ˆì „í•˜ê²Œ ê°™ì€ `pre master secret`ë¥¼ ê°€ì§„ë‹¤.\r\n ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì„ í†µí•´ `pre master secret`ì„ `master secret`ë¼ëŠ” `session key`ë¥¼ ìƒì„±í•œë‹¤.\r\n`master secret`ì€ ì‹¤ì œë¡œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì£¼ê³ ë°›ëŠ” ë°ì´í„°ë¥¼ `ì•”í˜¸í™”/ë³µí˜¸í™”` í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤.\r\n\r\n5. í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” `HandShake`ê°€ ì¢…ë£Œë¬ìŒì„ ì„œë¡œì—ê²Œ ì•Œë¦°ë‹¤.\r\n\r\n\r\n### í†µì‹ \r\nì´ì œ `master secret`ì„ í†µí•´ `í´ë¼ì´ì–¸íŠ¸`ì™€ `ì„œë²„`ëŠ” ë°ì´í„°ë¥¼ `ì•”í˜¸í™”/ë³µí˜¸í™”`í•˜ë©´ì„œ ì£¼ê³  ë°›ëŠ”ë‹¤. \r\n\r\n### í†µì‹ ì¢…ë£Œ\r\në°ì´í„°ì˜ ì „ì†¡ì´ ëë‚˜ë©´ SSL í†µì‹ ì´ ëë‚¬ìŒì„ ì„œë¡œì—ê²Œ ì•Œë ¤ì¤€ë‹¤.\r\nê·¸ë¦¬ê³  ì‚¬ìš©í•œ ëŒ€ì¹­í‚¤ì¸ `master secret`ì€ íê¸°í•œë‹¤.\r\n \r\n \r\n## ë§ˆì¹˜ë©´ì„œ\r\nì´ìƒ SSLí†µì‹ ì— ëŒ€í•´ì„œ ìì„¸í•˜ê²Œ ì‚´í´ë³´ì•˜ë‹¤.\r\nSSL í†µì‹ ì€ `ê³µê°œí‚¤ ë°©ì‹`, `ëŒ€ì¹­í‚¤ ë°©ì‹`ì„ í•©ì³ì„œ ì‚¬ìš©í•˜ëŠ” ë§Œí¼ ê½¤ë‚˜ ë³µì¡í•˜ë‹¤. \r\nì‘ì„±í•œ ê¸€ì´ ë§ì€ í¬ë£¨ë“¤ì—ê²Œ HTTPSì™€ SSL í†µì‹ ì— ëŒ€í•œ ì´í•´ì— ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.\r\n\r\n## ì°¸ì¡°\r\nhttps://opentutorials.org/course/228/4894"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸° ìš°í…Œì½” ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ, HTTPS í†µì‹ ì„ ì ìš©í•˜ê¸° ìœ„í•´ NGINXì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í–ˆë‹¤.\nê·¸ë˜ì„œ NGINXì— ëŒ€í•œ ì´í•´ë¥¼ ë•ê¸°ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤. NGINXë€? NginxëŠ” WS(Web Server)ì˜ ì¼ì¢…ì´ë‹¤. ì£¼ë¡œ ì •ì  ì»¨í…ì¸ ë¥¼ ì œê³µí•˜ê±°ë‚˜ ReversePrâ€¦","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"date":"July 30, 2022","title":"NGINX ë€?","tags":["WS","NGINX"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ê¸€ì„ ì“°ê²Œ ëœ ê³„ê¸°\r\nìš°í…Œì½” ë ˆë²¨3 í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ, HTTPS í†µì‹ ì„ ì ìš©í•˜ê¸° ìœ„í•´ NGINXì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í–ˆë‹¤.\r\nê·¸ë˜ì„œ NGINXì— ëŒ€í•œ ì´í•´ë¥¼ ë•ê¸°ìœ„í•´ ê¸€ì„ ì‘ì„±í•˜ê³ ì í•œë‹¤.\r\n\r\n<br>\r\n\r\n## NGINXë€?\r\n> _NginxëŠ” WS(Web Server)ì˜ ì¼ì¢…ì´ë‹¤. ì£¼ë¡œ ì •ì  ì»¨í…ì¸ ë¥¼ ì œê³µí•˜ê±°ë‚˜ ReverseProxy, LoadBalancerì˜ ì—­í• ì„ í•œë‹¤._\r\n\r\n<br>\r\n\r\n## NGINXì˜ ë“±ì¥ ë°°ê²½\r\nNGINXë¥¼ ì‚´í´ë³´ê¸°ì „ì—, ë¬´ìŠ¨ ì´ìœ ë¡œ NGINXê°€ ë“±ì¥í–ˆëŠ”ì§€ë¥¼ ë¨¼ì € ì‚´í´ë³¼ í•„ìš”ê°€ ìˆë‹¤. ìš°ì„  NGINXì˜ ë“±ì¥ë°°ê²½ì„ ì‚´í´ë³´ì.\r\n\r\n<br>\r\n\r\nNGINX ë“±ì¥ì´ì „ Apacheê°€ ì›¹ì„œë²„ë¡œì¨ì˜ ë†’ì€ ì¸ê¸°ë¥¼ ê°€ì¡Œë‹¤.\r\nì˜ ì‚¬ìš©ë˜ë˜ Apache ì›¹ì„œë²„ëŠ” ì–´ëŠìˆœê°„ ì–´ë– í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤. Apacheì˜ ìš”ì²­ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ê³¼ í•¨ê»˜ ì–´ë– í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì™”ëŠ”ì§€ ì‚´í´ë³´ì. \r\n![](https://velog.velcdn.com/images/gudonghee2000/post/4c31d7af-155b-4998-9ef3-93559914949e/image.JPG)\r\n\r\n\r\nì´ˆê¸°ì˜ ApacheëŠ” ê·¸ë¦¼ê³¼ ê°™ì´ ìš”ì²­(Request)ì´ ë“¤ì–´ì˜¬ ë–„ ë§ˆë‹¤ ìƒˆë¡œìš´ Processë¥¼ ìƒì„±í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í•˜ê³  ìš”ì²­ì„ ì²˜ë¦¬í–ˆë‹¤.(ì´ëŸ¬í•œ ì²˜ë¦¬ë°©ì‹ì„ `prefork`ë¼ê³  í•¨)\r\n\r\nê·¸ëŸ°ë°, 2000ë…„ì— ì ‘ì–´ ë“¤ê³  ì¸í„°ë„· íŠ¸ë˜í”½ì´ ì¦ê°€í•˜ë©´ì„œ ì•„íŒŒì¹˜ì˜ ìš”ì²­ ì²˜ë¦¬ë°©ì‹ì€ `C10K` ë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤.\r\n> \r\nC10K ë¬¸ì œë€ Connection 10000 Problemì˜ ì¤„ì„ë§ë¡œ ì›¹ì„œë²„ê°€ 1ë§Œê°œì˜ ë™ì‹œ Connectionì„ ì²˜ë¦¬í•˜ê¸° ì–´ë µë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.\r\n\r\n\r\n\r\nì¼ë‹¨ ë™ì‹œ Connectionì„ ìì„¸íˆ ì‚´í´ë³´ì.\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/954a297f-e564-43b1-acfa-0f2452854647/image.JPG)\r\n\r\n\r\n`ì›¹ì„œë²„`ëŠ” `í´ë¼ì´ì–¸íŠ¸`ë¡œ ë¶€í„° ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `Connection`ì„ ìƒì„±í•˜ê³  ìœ ì§€í•œë‹¤.\r\nê·¸ë¦¬ê³  ê·¸ë¦¼ê³¼ ê°™ì´ `í´ë¼ì´ì–¸íŠ¸`ëŠ” ìƒì„±ëœ `Connection`ì„ í†µí•´ ë˜ë‹¤ë¥¸ ìš”ì²­ì„ `ì„œë²„`ì—ê²Œ ì „ë‹¬í•œë‹¤. \r\n\r\nì´ë ‡ê²Œ `Connection` í•˜ë‚˜ë¡œ ì—¬ëŸ¬ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” `Connection`ì„ ìƒì„±í•˜ëŠ”ë° ì—¬ëŸ¬ê°€ì§€ ì ˆì°¨ê°€ í•„ìš”í•˜ë‹¤. \r\nê·¸ë˜ì„œ ë§¤ ìš”ì²­ë§ˆë‹¤ `Connection`ì„ ìƒì„±í•˜ëŠ”ê²ƒì€ ë¹„íš¨ìœ¨ì ì´ê³  ëŠë ¸ë‹¤. \r\n\r\në¹„íš¨ìœ¨ì„±ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ëŒë“¤ì€ ì´ë¯¸ ë§Œë“¤ì–´ì§„ `Connection`ì´ ìˆë‹¤ë©´ ì´ë¥¼ í™œìš©í•˜ì—¬ ìš”ì²­ì„ ë³´ë‚´ê³ ì í•˜ì˜€ë‹¤.\r\n\r\nì´ë ‡ê²Œ ìœ ì§€ë˜ëŠ” `Connection`ë“¤ì„ `ë™ì‹œ Connection`ì´ë¼ê³  í•œë‹¤.\r\n\r\n> ğŸ’¡ ì—¬ë‹´ìœ¼ë¡œ HTTP í”„ë¡œí† ì½œ `Header`ë¶€ë¶„ì˜ `Keep-Alive`ê°€ ë°”ë¡œ `Connection`ì„ ì–¼ë§ˆë‚˜ ìœ ì§€í•  ê²ƒì¸ì§€ì— ëŒ€í•œ í†µì‹  ê·œì•½ì´ë‹¤.\r\n\r\nì´ë•Œ, Apache ì„œë²„ëŠ” C10Kë¬¸ì œë¥¼ ê°€ì ¸ì™”ë‹¤.\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/fa69475a-0326-4652-b1da-616e60164dea/image.JPG)\r\n\r\nê·¸ë¦¼ê³¼ ê°™ì´ `Apache`ì„œë²„ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ ë§ˆë‹¤, `Process`ë¥¼ ìƒì„±í–ˆëŠ”ë° ìš”ì²­ì´ ë§Œë‹¨ìœ„ë¥¼ ë„˜ì–´ê°€ë©´ì„œ ì–´ëŠìˆœê°„ ë¶€í„° ìš”ì²­ì— ëŒ€í•œ `Connection`ì„ ìƒì„±í•˜ì§€ ëª»í•œê²ƒì´ë‹¤. \r\n\r\nì´ëŸ¬í•œ ë¬¸ì œë¥¼ ê°€ì ¸ì˜¨ ì›ì¸ì€ ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.\r\n-  ë©”ëª¨ë¦¬ ë¶€ì¡±\r\nApacheì„œë²„ëŠ” `Connection`ì´ ìƒì„±ë  ë•Œë§ˆë‹¤ `Process`ë¥¼ ìƒì„±í•´ì•¼í–ˆëŠ”ë° ë™ì‹œì— ìœ ì§€í•´ì•¼í•  `Connection`ì´ ë§ì•„ì§€ë©´ì„œ ìœ ì§€í•´ì•¼í•  `Process`ê°€ ì¦ê°€í–ˆê³  ë©”ëª¨ë¦¬ ë¶€ì¡±ì„ ë°œìƒì‹œì¼°ë‹¤.\r\n\r\n- CPU ê³¼ë¶€í•˜\r\në˜í•œ, ì‹¤í–‰ì¤‘ì¸ `Process`ê°€ ë§ì•„ì§€ë©´ì„œ CPUëŠ” `Process`ë¥¼ ì²˜ë¦¬ í•  ë•Œ, `ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­`ì„ êµ‰ì¥íˆ ë§ì´í•´ì•¼í–ˆë‹¤. ê·¸ë˜ì„œ CPUì˜ ë¶€í•˜ê°€ ì¦ê°€í–ˆë‹¤.\r\n\r\nê²°êµ­, ìˆ˜ë§ì€ ë™ì‹œ ì»¤ë„¥ì…˜ì„ ì²˜ë¦¬í•˜ê¸°ì—” Apacheì˜ ìš”ì²­ ì²˜ë¦¬êµ¬ì¡°ëŠ” ë¶€ì í•©í–ˆë‹¤.\r\n\r\nê·¸ë˜ì„œ Apacheì˜ ë‹¨ì ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ 2004ë…„ NGINXê°€ ë“±ì¥í–ˆë‹¤.\r\n\r\n<br>\r\n\r\n## NGINX ìì„¸íˆ ì•Œì•„ë³´ê¸°\r\n\r\nìš°ì„ , NGINXì˜ ìš”ì²­ ì²˜ë¦¬ ë°©ì‹ì„ ì‚´í´ë³´ì.![](https://velog.velcdn.com/images/gudonghee2000/post/93b0890b-c015-46d0-9165-5cf6a7b4d9f6/image.JPG)\r\n\r\nNGINXëŠ” `MasterProcess`ë¥¼ í†µí•´ ì„¤ì • íŒŒì¼ì„ ì½ê³  `WorkerProcess`ì™€ ê°™ì€ ìì‹ `Process` 3ì¢…ë¥˜ë¥¼ ìƒì„±í•œë‹¤. (`cache loader`, `cache manager`ê°€ ìˆìŒ)\r\n\r\nê·¸ë¦¬ê³  ìƒì„±ëœ `WorkerProcess`ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `Connection`ì„ í˜•ì„±í•˜ê³  ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\r\nìš”ì²­ì— ë”°ë¼ì„œ ë§¤ë²ˆ `Process`ë¥¼ ìƒì„±í•˜ë˜ Apacheì™€ ë‹¬ë¦¬, NGINXëŠ” `MasterProcess`ì— ë”°ë¼ `WorkerProcess`ë¥¼ ìƒì„±í•˜ê³  ê³ ì •ëœ ê°œìˆ˜ì˜ `WorkerProcess` ë“¤ì´ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\r\n\r\nì´ë ‡ê²Œ ê³ ì •ëœ `Process`ì˜ ê°œìˆ˜ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ NGINXëŠ” `Event-Driven` ë°©ì‹ìœ¼ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.\r\n\r\n> ğŸ’¡ Event-Drivenì´ë€?\r\nNGINXëŠ” í˜•ì„±ëœ Connectionì— ì•„ë¬´ëŸ° ìš”ì²­ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ìš”ì²­ì— ëŒ€í•œ Connectionì„ í˜•ì„±í•˜ì—¬ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤. \r\në˜ëŠ” ì´ë¯¸ ë§Œë“¤ì–´ì§„ ë‹¤ë¥¸ Connectionìœ¼ë¡œë¶€í„° ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤. \r\nNginxì—ì„œì˜ Conneciton í˜•ì„±, Connection ì œê±°, ìƒˆë¡œìš´ ìš”ì²­ ì²˜ë¦¬ë¥¼ Eventë¼ê³  ë¶€ë¥¸ë‹¤.\r\në˜í•œ, Eventë¥¼ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ Event-Drivenì´ë¼ê³  í•œë‹¤.\r\n\r\n<br>\r\n\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/f1b98399-de8f-4f10-bbba-050ca377c4be/image.JPG)\r\n\r\nNGINXëŠ” ê·¸ë¦¼ê³¼ ê°™ì´ íí˜•íƒœì˜ ì €ì¥ì†Œì— Eventë“¤ì„ ë‹´ì•„ `WorkerProcess`ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•œë‹¤.\r\n\r\n<br>\r\n\r\n## NGINXì˜ Apacheì˜ ì°¨ì´ì \r\nApacheëŠ” ë™ê¸°ë°©ì‹ìœ¼ë¡œ í•˜ë‚˜ì˜ `Connection`ì´ ëë‚  ë•Œ ê¹Œì§€ `Process`ë¥¼ ìœ ì§€í–ˆë‹¤. \r\n\r\në°˜ë©´, NGINXëŠ” ê³ ì •ëœ `WokerProcess`ë¥¼ ìƒì„±í•˜ê³  `Event`ê°€ ë°œìƒ í•  ë•Œë§ˆë‹¤ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¹„ë™ê¸° `Event-Driven` ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì´ ì°¨ì´ì ì´ë‹¤.\r\n\r\në³´í†µ `WorkerProcess`ëŠ” CPUì˜ ì½”ì–´ ê°œìˆ˜ë§Œí¼ ìƒì„±í•˜ëŠ”ê²ƒì´ ì¼ë°˜ì ì´ë¼ê³  í•œë‹¤. **(ì´ìœ : ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ íšŒìˆ˜ë¥¼ ìµœì†Œí•˜ í•˜ê¸° ìœ„í•¨.)**\r\n\r\n<br>\r\n\r\n## NGINXì˜ ì¥ì \r\nNGINXëŠ” Apacheì— ë¹„í•´ ì„±ëŠ¥ ì¸¡ë©´ì—ì„œ ë‘ê°€ì§€ ì¥ì ì´ìˆë‹¤.\r\n\r\n1. ì²˜ë¦¬í• ìˆ˜ ìˆëŠ” ë™ì‹œ ì»¤ë„¥ì…˜ ê°œìˆ˜ê°€ í›¨ì”¬ ë§ë‹¤.\r\n\r\n2. ë™ì¼í•œ ê°œìˆ˜ì˜ ì»¤ë„¥ì…˜ ì²˜ë¦¬ ì†ë„ê°€ ë” ë¹ ë¥´ë‹¤.\r\n\r\nì´ëŸ¬í•œ ì¥ì ì„ ê°€ì§€ê³  ì˜¤ëŠ” ì´ìœ ë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ ì •ë¦¬í•´ë³´ì.\r\n- ê³ ì •ëœ `Process` ê°œìˆ˜ ë§Œì„ ì‚¬ìš©í•˜ê¸°ì— `Process` ìƒì„± ë¹„ìš©ì´ ì—†ë‹¤.\r\n- ë˜í•œ, `Process` ê°œìˆ˜ê°€ ì œí•œë˜ì–´ CPUì˜ ë¶€ë‹´ì´ ì¤„ì–´ë“ ë‹¤. (ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ì´ ì ì–´ì§€ê¸° ë•Œë¬¸)\r\n- ë¹„ë™ê¸° ë°©ì‹ì´ê¸°ì— `Process`ê°€ ì‰¬ì§€ì•Šê³  ì¼ì„ í•  ìˆ˜ ìˆë‹¤.\r\n\r\n<br>\r\n\r\n## NGINX í™œìš© ë°©ë²•\r\në„ì…ë¶€ì—ì„œ ì´ì•¼ê¸°í–‡ë“¯ì´ NGINXëŠ” ì •ì íŒŒì¼ì²˜ë¦¬, ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ, ë¡œë“œë°¸ëŸ°ì„œì˜ ì—­í• ë¡œì¨ WASì˜ ë¶€ë‹´ì„ ì¤„ì—¬ì£¼ëŠ” ì—­í• ë¡œ ë‹¤ì–‘í•˜ê²Œ í™œìš© í•  ìˆ˜ ìˆë‹¤.\r\n\r\n<br>\r\n\r\n## ë§ˆì¹˜ë©´ì„œ\r\nì´ìƒ NGINXì˜ ë“±ì¥ ë°°ê²½ê³¼ ì‘ë™ ë°©ì‹ì„ ì‚´í´ë³´ì•˜ë‹¤.\r\në§ì€ í¬ë£¨ë“¤ì´ ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì‚¬ìš©í•˜ëŠ” NGINXì— ëŒ€í•œ ì´í•´ì— ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.\r\n\r\n<br>\r\n\r\n### ì°¸ì¡°\r\nhttps://livlikwav.github.io/study/NGINX-inside/\r\nhttps://jizard.tistory.com/306\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë¬¸ì œ ì—ì„œ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ í„°ì¡Œë‹¤.  ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ idë¥¼ ë„£ìœ¼ë©´ ì´ ë°œìƒí•´ì•¼ í•˜ëŠ”ë° ì•„ë¬´ëŸ° ì˜ˆì™¸ë„ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤. ë” ì´ìƒí•œ ì ì€ ë‹¨ë…ìœ¼ë¡œ ëŒë ¸ì„ ë•ŒëŠ” ì˜ ëŒì•„ê°€ì§€ë§Œ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ í„°ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œê°€ ìˆì–´ ë³´ì˜€ë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ì•˜ë‹¤.  MEMBERê¹Œì§€ ì €â€¦","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"date":"July 27, 2022","title":"í…ŒìŠ¤íŠ¸ì—ì„œ Entity ê°ì²´ë¥¼ ìƒìˆ˜ë¡œ ë‘ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ","tags":["Spring","test fixture","ìƒìˆ˜"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ë¬¸ì œ\r\n\r\n```java\r\n// MemberFixtures\r\n\r\npublic static final Member MEMBER \r\n\t\t= new Member(\"example@email.com\", \"/image.png\", \"example\", SocialType.GOOGLE);\r\npublic static final Member CREATOR \r\n\t\t= new Member(\"creator@email.com\", \"/image.png\", \"creator\", SocialType.GOOGLE);\r\n```\r\n\r\n```java\r\n// CategoryServiceTest\r\n\r\n@DisplayName(\"ìì‹ ì´ ë§Œë“¤ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ë¥¼ ìˆ˜ì •í•  ê²½ìš° ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.\")\r\n@Test\r\nvoid ìì‹ ì´_ë§Œë“¤ì§€_ì•Šì€_ì¹´í…Œê³ ë¦¬ë¥¼_ìˆ˜ì •í• _ê²½ìš°_ì˜ˆì™¸ë¥¼_ë˜ì§„ë‹¤() {\r\n    // given\r\n    Member member = memberRepository.save(MEMBER);\r\n    Member creator = memberRepository.save(CREATOR);\r\n    CategoryResponse savedCategory = categoryService.save(creator.getId(),\r\n            new CategoryCreateRequest(CATEGORY_NAME));\r\n\r\n    CategoryUpdateRequest categoryUpdateRequest = new CategoryUpdateRequest(MODIFIED_CATEGORY_NAME);\r\n\r\n    // when & then\r\n    assertThatThrownBy(\r\n            () -> categoryService.update(member.getId(), savedCategory.getId(), categoryUpdateRequest))\r\n            .isInstanceOf(NoPermissionException.class);\r\n}\r\n```\r\n\r\n`CategoryServiceTest`ì—ì„œ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ê¸°ëŠ¥ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ í„°ì¡Œë‹¤. `update` ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ idë¥¼ ë„£ìœ¼ë©´ `NoPermissionException`ì´ ë°œìƒí•´ì•¼ í•˜ëŠ”ë° ì•„ë¬´ëŸ° ì˜ˆì™¸ë„ ë°œìƒí•˜ì§€ ì•Šì•˜ë‹¤. ë” ì´ìƒí•œ ì ì€ ë‹¨ë…ìœ¼ë¡œ ëŒë ¸ì„ ë•ŒëŠ” ì˜ ëŒì•„ê°€ì§€ë§Œ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ í„°ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œê°€ ìˆì–´ ë³´ì˜€ë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ì•˜ë‹¤.\r\n\r\n![member ê°ì²´](debug1.png)\r\n\r\nMEMBERê¹Œì§€ ì €ì¥í–ˆì„ ë•ŒëŠ” ë¶„ëª… ê°’ë“¤ì´ ì˜ ë“¤ì–´ê°€ìˆëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.\r\n\r\n![í•„ë“œê°€ ë³€ê²½ëœ member ê°ì²´](debug2.png)\r\n\r\nê·¼ë° CREATORë¥¼ ì €ì¥í•˜ëŠ” ìˆœê°„!? memberì˜ ê°’ì´ ê°‘ìê¸° CREATORì˜ ê°’ìœ¼ë¡œ ì „ë¶€ ë³€ê²½ë˜ì—ˆë‹¤. ì™œ ì´ëŸ° ê±¸ê¹Œ.\r\n\r\n## ì›ì¸\r\n\r\n> ê°€ë³€ê°ì²´ì¸ íšŒì›ì˜ Entityë¥¼ ìƒìˆ˜ë¡œ ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì´ ë¬¸ì œì˜€ë‹¤.\r\n\r\nì•„ë˜ ê·¸ë¦¼ì„ í†µí•´ ì•Œì•„ë³´ì.\r\n\r\n![](img1.png)\r\n\r\ní…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ MEMBERì™€ CREATORëŠ” idë¥¼ ê°€ì§€ì§€ ì•Šì€ ìƒíƒœì´ë‹¤. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë„ ë¹„ì–´ìˆë‹¤.\r\n\r\nì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ MEMBERì™€ CREATORëŠ” ìƒìˆ˜ì´ë¯€ë¡œ ì˜¨ê°– í…ŒìŠ¤íŠ¸ì—ì„œ ë‘ ê°œì˜ ìƒìˆ˜ë¥¼ ê°€ì ¸ë‹¤ ì“°ê²Œ ëœë‹¤. ê·¸ ê³¼ì •ì—ì„œ MEMBERê°€ ì €ì¥ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤.\r\n\r\n![](img2.png)\r\n\r\nê·¸ëŸ¼ ìƒìˆ˜ MEMBERì˜ id ê°’ì´ 1ë¡œ ë°”ë€Œê²Œ ëœë‹¤. ì´í›„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” CREATORê°€ ì €ì¥ëœë‹¤. ì´ ë•Œ ê°ê°ì˜ í…ŒìŠ¤íŠ¸ëŠ” ê²©ë¦¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë¹ˆ ìƒíƒœì´ë‹¤. ë”°ë¼ì„œ CREATORì˜ idë„ 1ë¡œ ì €ì¥ëœë‹¤.\r\n\r\n![](img3.png)\r\n\r\nì´ë ‡ê²Œ ìƒìˆ˜ MEMBERì™€ CREATORì˜ idê°€ ëª¨ë‘ 1ë¡œ ë°”ë€Œì—ˆë‹¤. ë””ë²„ê¹…ì„ í•´ë³´ë‹ˆ ì‹¤ì œë¡œ ìƒìˆ˜ì˜ id ê°’ì´ ëª¨ë‘ 1ë¡œ ë°”ë€ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.\r\n\r\n![](debug3.png)\r\n\r\nì´ ìƒíƒœì—ì„œ ì²˜ìŒ ë´¤ë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ëŒì•„ê°€ë³´ì.\r\n\r\n```java\r\n// CategoryServiceTest\r\n\r\n@DisplayName(\"ìì‹ ì´ ë§Œë“¤ì§€ ì•Šì€ ì¹´í…Œê³ ë¦¬ë¥¼ ìˆ˜ì •í•  ê²½ìš° ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.\")\r\n@Test\r\nvoid ìì‹ ì´_ë§Œë“¤ì§€_ì•Šì€_ì¹´í…Œê³ ë¦¬ë¥¼_ìˆ˜ì •í• _ê²½ìš°_ì˜ˆì™¸ë¥¼_ë˜ì§„ë‹¤() {\r\n    // given\r\n    Member member = memberRepository.save(MEMBER);\r\n    Member creator = memberRepository.save(CREATOR); // ë¬¸ì œ ë°œìƒ !!!\r\n    CategoryResponse savedCategory = categoryService.save(creator.getId(),\r\n            new CategoryCreateRequest(CATEGORY_NAME));\r\n\r\n    CategoryUpdateRequest categoryUpdateRequest = new CategoryUpdateRequest(MODIFIED_CATEGORY_NAME);\r\n\r\n    // when & then\r\n    assertThatThrownBy(\r\n            () -> categoryService.update(member.getId(), savedCategory.getId(), categoryUpdateRequest))\r\n            .isInstanceOf(NoPermissionException.class);\r\n}\r\n```\r\n\r\ní…ŒìŠ¤íŠ¸ë¥¼ ë³´ë©´ ì²˜ìŒìœ¼ë¡œ MEMBERë¥¼ ì €ì¥í•œë‹¤. ì´ê¹Œì§€ëŠ” ì•„ë¬´ ë¬¸ì œê°€ ì—†ë‹¤. ë¬¸ì œëŠ” ë‘ ë²ˆì§¸ë¡œ CREATORë¥¼ ì €ì¥í•  ë•Œ ë°œìƒí•œë‹¤.\r\n\r\n![](img4.png)\r\n\r\nCREATORë¥¼ ì €ì¥í•˜ë ¤ê³  í•˜ëŠ”ë° ì €ì¥ëœ MEMBERì˜ idë„ 1ì´ê³ , CREATORì˜ idë„ 1ì´ë‹¤. CREATORë¥¼ ì €ì¥í•  ë•Œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê°™ì€ idë¥¼ ê°€ì§„ entityê°€ ìˆìœ¼ë¯€ë¡œ CREATORë¥¼ ìƒˆë¡­ê²Œ ì €ì¥í•˜ì§€ ì•Šê³ , ê¸°ì¡´ì˜ idê°€ 1ë²ˆì¸ entityë¥¼ ìˆ˜ì •í•˜ê²Œ ëœë‹¤.\r\n\r\n![](img5.png)\r\n\r\nê¸°ì¡´ì˜ ê°’ì´ ìˆ˜ì •ë˜ë‹ˆ idê°€ 1ë²ˆì¸, MEMBERë¥¼ ì €ì¥í•œ member instanceì˜ ê°’ê¹Œì§€ ë³€ê²½ë˜ëŠ” ê²ƒì´ë‹¤.\r\n\r\n## í•´ê²°\r\n\r\nEntity ê°ì²´ì— ëŒ€í•œ fixtureê°€ í•„ìš”í•œ ê²½ìš° ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ë„ë¡ í–ˆë‹¤.\r\n\r\n```java\r\npublic static Member íŒŒë‘() {\r\n    return new Member(íŒŒë‘_ì´ë©”ì¼, íŒŒë‘_í”„ë¡œí•„, íŒŒë‘_ì´ë¦„, SocialType.GOOGLE);\r\n}\r\n```\r\n\r\n## ê²°ë¡ \r\n\r\nìƒìˆ˜ë€ ë³€í•˜ì§€ ì•Šê³  ê³ ì •ëœ ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” í•„ë“œê°€ ë³€í•˜ëŠ” ê°ì²´ì¸ Member Entityë¥¼ ìƒìˆ˜ë¡œ ì„ ì–¸í–ˆë‹¤. í…ŒìŠ¤íŠ¸ ê²©ë¦¬ë¥¼ ì•„ë¬´ë¦¬ ì˜ í•´ë„ ìƒìˆ˜ê¹Œì§€ ê³„ì† ë¦¬í”„ë ˆì‰¬ í•´ì£¼ì§„ ì•Šê¸° ë•Œë¬¸ì— ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•œ ê²ƒì´ë‹¤.\r\n\r\n**ë³€í•˜ì§€ ì•ŠëŠ” ë¶ˆë³€ ê°ì²´ë§Œ ìƒìˆ˜ë¡œ ì§€ì •í•˜ì!!**\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸° Springì—ì„œ ì´ë‚˜ ì— ì¡´ì¬í•˜ëŠ” ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì—ëŠ” ëŒ€í‘œì ìœ¼ë¡œ  ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ ë°©ë²•ê³¼ ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. ë‘ ë°©ì‹ì„ ì§ì ‘ ì ìš©í•´ ë³¸ ë’¤ ì°¨ì´ì™€ ì´ì ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤ í•œë‹¤. @Value ì‚¬ìš©í•˜ê¸° ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì • ì •ë³´ë¥¼ ë‹¨ì¼ê°’ìœ¼ë¡œ ì£¼ì… ë°›ê¸° ìœ„í•´ ì‚¬â€¦","fields":{"slug":"/properties-to-object/"},"frontmatter":{"date":"July 27, 2022","title":"properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°","tags":["properties","Value","ConfigurationProperties"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°\r\n\r\nSpringì—ì„œ `application.yml`ì´ë‚˜ `application.properties`ì— ì¡´ì¬í•˜ëŠ” ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì—ëŠ” ëŒ€í‘œì ìœ¼ë¡œ `@Value` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ ë°©ë²•ê³¼ `@ConfigurationProperties`ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. ë‘ ë°©ì‹ì„ ì§ì ‘ ì ìš©í•´ ë³¸ ë’¤ ì°¨ì´ì™€ ì´ì ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤ í•œë‹¤.\r\n\r\n## @Value ì‚¬ìš©í•˜ê¸°\r\n\r\n`@Value`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì • ì •ë³´ë¥¼ ë‹¨ì¼ê°’ìœ¼ë¡œ ì£¼ì… ë°›ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ ë‹¬ë¡ í”„ë¡œì íŠ¸ì—ì„œ ì ìš©í•œ ì˜ˆì‹œì´ë‹¤.\r\n\r\n```java\r\n@Component\r\npublic class GoogleOAuthClient implements OAuthClient {\r\n\r\n    private static final String JWT_DELIMITER = \"\\\\.\";\r\n\r\n    private final String clientId;\r\n    private final String clientSecret;\r\n    private final String grantType;\r\n    private final String redirectUri;\r\n    private final String tokenUri;\r\n    private final RestTemplate restTemplate;\r\n    private final ObjectMapper objectMapper;\r\n\r\n    public GoogleOAuthClient(@Value(\"${oauth.google.client-id}\") final String clientId,\r\n                             @Value(\"${oauth.google.client-secret}\") final String clientSecret,\r\n                             @Value(\"${oauth.google.grant-type}\") final String grantType,\r\n                             @Value(\"${oauth.google.redirect-uri}\") final String redirectUri,\r\n                             @Value(\"${oauth.google.token-uri}\") final String tokenUri,\r\n                             final RestTemplateBuilder restTemplateBuilder, final ObjectMapper objectMapper) {\r\n        this.clientId = clientId;\r\n        this.clientSecret = clientSecret;\r\n        this.grantType = grantType;\r\n        this.redirectUri = redirectUri;\r\n        this.tokenUri = tokenUri;\r\n        this.restTemplate = restTemplateBuilder.build();\r\n        this.objectMapper = objectMapper;\r\n    }\r\n\t\t...\r\n}\r\n```\r\n\r\nê°„ë‹¨í•˜ê²Œ ì ìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ê³µí†µìœ¼ë¡œ ë¬¶ì¸ í”„ë¡œí¼í‹°ê°€ ë§ì•„ì§ˆ ê²½ìš° ì½”ë“œê°€ ì§€ì €ë¶„í•´ì§„ë‹¤. ì´ëŸ¬í•œ í”„ë¡œí¼í‹° ê°’ë“¤ì„ ê°ì²´ë¡œ ë§¤í•‘í•˜ì—¬ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ `@ConfigurationProperties`ê°€ ì¡´ì¬í•œë‹¤.\r\n\r\n## @ConfigurationProperties\r\n\r\nìš°ë¦¬ëŠ” ë•Œë•Œë¡œ DB ì„¤ì •ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ `application.yml`ì„ í†µí•´ ê´€ë ¨ ì •ë³´ë¥¼ ì‘ì„±í•˜ê³¤ í•œë‹¤. ì•„ë˜ëŠ” ê°„ë‹¨í•œ h2 DBë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•œ ì„¤ì •ì„ ì ì€ ì˜ˆì‹œì´ë‹¤.\r\n\r\n```yaml\r\nspring:\r\n  datasource:\r\n    url: jdbc:h2:~/dallog;MODE=MYSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE\r\n    username: sa\r\n```\r\n\r\nì´ëŸ¬í•œ ì„¤ì •ë“¤ì€ ì–´ë””ì„œ ì–´ë–»ê²Œ í™œìš©ë˜ê³  ìˆì„ê¹Œ? ì‹¤ì œ ë°”ì¸ë”© ë˜ê³  ìˆëŠ” ê°ì²´ë¥¼ ë”°ë¼ê°€ë³´ì.\r\n\r\n```java\r\n@ConfigurationProperties(prefix = \"spring.datasource\")\r\npublic class DataSourceProperties implements BeanClassLoaderAware, InitializingBean {\r\n\t\r\n    private ClassLoader classLoader;\r\n    private boolean generateUniqueName = true;\r\n\tprivate String name;\r\n\tprivate Class<? extends DataSource> type;\r\n\tprivate String driverClassName;\r\n\tprivate String url;\r\n    ...\r\n}\r\n```\r\n\r\nìœ„ `DataSourceProperties`ëŠ” ìš°ë¦¬ê°€ `application.yml`ì— ì‘ì„±í•œ ì„¤ì • ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°ì²´ë¡œ ì¶”ì¶œí•˜ê³  ìˆë‹¤. ì´ê²ƒì€ Spring Bootì˜ ìë™ì„¤ì •ìœ¼ë¡œ `DataSource`ê°€ ë¹ˆìœ¼ë¡œ ì£¼ì…ë˜ëŠ” ì‹œì ì— ì„¤ì • ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ìƒì„±ëœë‹¤. \r\n\r\nê°„ë‹¨íˆ ë””ë²„ê¹…ì„ ì§„í–‰í•´ë³´ë©´ Beanì´ ì£¼ì…ë˜ëŠ” ì‹œì ì— ì•„ë˜ì™€ ê°™ì´ `application.yml`ì— ëª…ì‹œí•œ ê°’ë“¤ì„ ì¶”ì¶œí•œ `DataSourceProperties`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±í•˜ê³  ìˆë‹¤.\r\n\r\n![](debug-1.png)\r\n\r\n![](debug-2.png)\r\n\r\nì •ë¦¬í•˜ë©´ ìš°ë¦¬ëŠ” Spring Bootë¥¼ ì‚¬ìš©í•˜ë©° ìì—°ìŠ¤ëŸ½ê²Œ `@ConfigurationProperties`ë¥¼ í™œìš©í•˜ì—¬ ë§Œë“  ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.\r\n\r\nì´ì œ ìš°ë¦¬ê°€ ì‘ì„±í•œ ì„¤ì • ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ í™œìš©í•´ë³´ì. ì•„ë˜ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” `application.yml`ì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\r\n\r\n```yaml\r\n...\r\noauth:\r\n  google:\r\n    client-id: ${GOOGLE_CLIENT_ID}\r\n    client-secret: ${GOOGLE_CLIENT_SECRET}\r\n    redirect-uri: ${GOOGLE_REDIRECT_URI}\r\n    oauth-end-point: https://accounts.google.com/o/oauth2/v2/auth\r\n    response-type: code\r\n    scopes:\r\n        - https://www.googleapis.com/auth/userinfo.profile\r\n        - https://www.googleapis.com/auth/userinfo.email\r\n    token-uri: ${GOOGLE_TOKEN_URI}\r\n    grant-type: authorization_code\r\n...\r\n```\r\n\r\nì´ê²ƒì„ ê°ì²´ë¡œ ì¶”ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì•¼ í•œë‹¤.\r\n\r\n```java\r\n@ConfigurationProperties(\"oauth.google\")\r\n@ConstructorBinding\r\npublic class GoogleProperties {\r\n\r\n    private final String clientId;\r\n    private final String clientSecret;\r\n    private final String redirectUri;\r\n    private final String oAuthEndPoint;\r\n    private final String responseType;\r\n    private final List<String> scopes;\r\n    private final String tokenUri;\r\n    private final String grantType;\r\n\r\n    public GoogleProperties(final String clientId, final String clientSecret, final String redirectUri,\r\n                            final String oAuthEndPoint, final String responseType, final List<String> scopes,\r\n                            final String tokenUri, final String grantType) {\r\n        this.clientId = clientId;\r\n        this.clientSecret = clientSecret;\r\n        this.redirectUri = redirectUri;\r\n        this.oAuthEndPoint = oAuthEndPoint;\r\n        this.responseType = responseType;\r\n        this.scopes = scopes;\r\n        this.tokenUri = tokenUri;\r\n        this.grantType = grantType;\r\n    }\r\n\r\n    public String getClientId() {\r\n        return clientId;\r\n    }\r\n\r\n    public String getClientSecret() {\r\n        return clientSecret;\r\n    }\r\n\r\n    public String getRedirectUri() {\r\n        return redirectUri;\r\n    }\r\n\r\n    public String getoAuthEndPoint() {\r\n        return oAuthEndPoint;\r\n    }\r\n\r\n    public String getResponseType() {\r\n        return responseType;\r\n    }\r\n\r\n    public List<String> getScopes() {\r\n        return scopes;\r\n    }\r\n\r\n    public String getTokenUri() {\r\n        return tokenUri;\r\n    }\r\n\r\n    public String getGrantType() {\r\n        return grantType;\r\n    }\r\n}\r\n```\r\n\r\n- `@ConfigurationProperties`: í”„ë¡œí¼í‹°ì— ìˆëŠ” ê°’ì„ í´ë˜ìŠ¤ë¡œ ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤. `@ConfigurationProperties`ëŠ” ê°’ì„ ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ `Setter`ê°€ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ `Setter`ë¥¼ ì—´ì–´ë‘˜ ê²½ìš° ë¶ˆë³€ì„±ì„ ë³´ì¥í•  ìˆ˜ ì—†ë‹¤. ì´ë•Œ ìƒì„±ìë¥¼ í†µí•´ ë°”ì¸ë”© í•˜ê¸° ìœ„í•´ì„œëŠ” `@ConstructorBinding`ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.\r\n- `@ConstructorBinding`: ì•ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ìƒì„±ìë¥¼ í†µí•´ ë°”ì¸ë”©í•˜ê¸° ìœ„í•œ ëª©ì ì˜ ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\r\n\r\n```java\r\n@Configuration\r\n@EnableConfigurationProperties(GoogleProperties.class)\r\npublic class PropertiesConfig {\r\n}\r\n```\r\n\r\n- `@EnableConfigurationProperties`: í´ë˜ìŠ¤ë¥¼ ì§€ì •í•˜ì—¬ ìŠ¤ìºë‹ ëŒ€ìƒì— í¬í•¨ì‹œí‚¨ë‹¤.\r\n\r\n### ê°œì„ í•˜ê¸°\r\n\r\n```java\r\n@Component\r\npublic class GoogleOAuthClient implements OAuthClient {\r\n\r\n    private static final String JWT_DELIMITER = \"\\\\.\";\r\n\r\n    private final GoogleProperties googleProperties;\r\n    private final RestTemplate restTemplate;\r\n    private final ObjectMapper objectMapper;\r\n\r\n    public GoogleOAuthClient(final GoogleProperties googleProperties, final RestTemplateBuilder restTemplateBuilder,\r\n                             final ObjectMapper objectMapper) {\r\n        this.googleProperties = googleProperties;\r\n        this.restTemplate = restTemplateBuilder.build();\r\n        this.objectMapper = objectMapper;\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\nì´ì „ ë³´ë‹¤ ì ì€ ìˆ˜ì˜ í•„ë“œë¥¼ í™œìš©í•˜ì—¬ ì„¤ì • ì •ë³´ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ ê°œì„ ë˜ì—ˆë‹¤.\r\n\r\n### ì •ë¦¬\r\n\r\n ìš°ë¦¬ëŠ” `application.yml` í˜¹ì€ `application.properties`ì— ì‘ì„±í•˜ì—¬ ë©”íƒ€ ì •ë³´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ê´€ë¦¬í•  ê²½ìš° ìˆ˜ì •í•˜ê¸° ìœ„í•´ì„œëŠ” í•´ë‹¹ í´ë˜ìŠ¤ì— ì§ì ‘ ì ‘ê·¼í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ì„¤ì • íŒŒì¼ë¡œ ë¶„ë¦¬í•  ê²½ìš° ìš°ë¦¬ëŠ” í™˜ê²½ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ê°’ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ë˜í•œ `@ConfigurationProperties` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ê²½ìš° í´ë˜ìŠ¤ë¡œ ê°’ì„ ë°”ì¸ë”©í•˜ê¸° ë•Œë¬¸ì— ì—°ê´€ëœ ê°’ì„ í•œ ë²ˆì— ë°”ì¸ë”©í•  ìˆ˜ ìˆë‹¤.\r\n\r\n## References.\r\n\r\n[ë‹¬ë¡ repository](https://github.com/woowacourse-teams/2022-dallog)<br>\r\n[[Spring] @Valueì™€ @ConfigurationPropertiesì˜ ì‚¬ìš©ë²• ë° ì°¨ì´ - (2/2)](https://mangkyu.tistory.com/207)<br>\r\n[appendix.configuration-metadata.annotation-processor](https://docs.spring.io/spring-boot/docs/2.7.1/reference/html/configuration-metadata.html#appendix.configuration-metadata.annotation-processor)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Rest Docs Spring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ Rest API ë¬¸ì„œë¥¼ ì‘ì„± í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”„ë ˆì„ ì›Œí¬ì´ë‹¤. Rest Docsì™€ Swagger ìë°” ë¬¸ì„œ ìë™í™”ì—ëŠ” ì£¼ë¡œ Rest Docsì™€ Swaggerê°€ ì‚¬ìš©ëœë‹¤.\nê° ìë™í™” í”„ë ˆì„ ì›Œí¬ì˜ ì¥ë‹¨ì ì„ ì‚´í´ë³´ì.\nâ€¦","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"date":"July 26, 2022","title":"MockMvcë¥¼ ì‚¬ìš©í•œ Spring RestDocs","tags":["Spring","Rest API"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## Rest Docs\r\nSpring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ Rest API ë¬¸ì„œë¥¼ ì‘ì„± í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”„ë ˆì„ ì›Œí¬ì´ë‹¤.\r\n\r\n## Rest Docsì™€ Swagger\r\nìë°” ë¬¸ì„œ ìë™í™”ì—ëŠ” ì£¼ë¡œ Rest Docsì™€ Swaggerê°€ ì‚¬ìš©ëœë‹¤.\r\nê° ìë™í™” í”„ë ˆì„ ì›Œí¬ì˜ ì¥ë‹¨ì ì„ ì‚´í´ë³´ì.\r\n![](./compare.png)\r\n\r\nSwaggerëŠ” API ë¬¸ì„œì˜ ì‘ì„±ì„ ìœ„í•´ í”„ë¡œë•ì…˜ ì½”ë“œì— ì¶”ê°€ì ì¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤. \r\nê·¸ë˜ì„œ Swaggerì˜ ì‚¬ìš©ì€ í”„ë¡œë•ì…˜ ì½”ë“œì˜ ê°€ë…ì„±ì„ ë–¨ì–´íŠ¸ë¦°ë‹¤ê³  ìƒê°í•œë‹¤.\r\n\r\në°˜ëŒ€ë¡œ, Spring Rest DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì˜ì¡´ì ì´ê¸° ë•Œë¬¸ì— Spring Rest Docsë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤ê³  ìƒê°í•œë‹¤.\r\n\r\n## MockMvc vs Rest Assured\r\nSpring Rest Docsë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì„œë¥¼ ì‘ì„± í•˜ë ¤ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤.\r\ní…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„± í•  ë•Œ, ëŒ€í‘œì ìœ¼ë¡œ MockMvcì™€ Rest Assuredë¥¼ ì‚¬ìš©í•œë‹¤.\r\n\r\nMockMvcë¥¼ ì‚¬ìš©í•˜ë©´  `@WebMvcTest`ë¡œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆë‹¤.\r\nê·¸ë˜ì„œ Controller Layerë§Œìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ë¹ ë¥´ë‹¤.\r\n\r\në°˜ë©´, RestAssuredëŠ” `@SpringBootTest`ë¡œ ìˆ˜í–‰í•´ì•¼í•œë‹¤. ê·¸ëŸ¬ë©´ ì „ì²´ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¡œë“œí•˜ì—¬ ë¹ˆì„ ì£¼ì…í•˜ê¸°ì— í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ëŠë¦¬ë‹¤.\r\ní•˜ì§€ë§Œ, ì‹¤ì œ ê°ì²´ë¥¼ í†µí•œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ì˜ ì‹ ë¢°ì„±ì´ ë†’ë‹¤.\r\n\r\ní†µí•© í…ŒìŠ¤íŠ¸, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš° RestAssuerdê°€ ì¢‹ì„ ìˆ˜ ìˆì§€ë§Œ, ë¬¸ì„œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ í…ŒìŠ¤íŠ¸ì—ëŠ” MockMvcê°€ ë” ì ì ˆí•˜ë‹¤ê³  ìƒê°í•œë‹¤.\r\n\r\n**_ğŸ’¡ @WebMvcTestì™€ @SpringBootTest_**\r\n@WebMvcTestëŠ” Application Contextë¥¼ ì™„ì „í•˜ê²Œ Startí•˜ì§€ ì•Šê³  Present Layer ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ë§Œ ìŠ¤ìº”í•˜ì—¬ ë¹ˆ ë“±ë¡í•œë‹¤.\r\në°˜ë©´, @SpringBootTestì˜ ê²½ìš° ëª¨ë“  ë¹ˆì„ ë¡œë“œí•˜ì—¬ ë“±ë¡í•œë‹¤.\r\n\r\n\r\n## AsciiDoc\r\n\r\nSpring Boot Rest DocsëŠ” Asciidocë¥¼ ë¬¸ì„œ ë²ˆì—­ì„ ìœ„í•œ í…ìŠ¤íŠ¸ í”„ë¡œì„¸ì„œë¡œ ì‚¬ìš©í•œë‹¤.\r\n\r\n## Rest Docs API ë¬¸ì„œ ìƒì„± ë§¤ì»¤ë‹ˆì¦˜\r\nìš°ì„ , Rest Docsì˜ ë¬¸ì„œ ìƒì„± ë§¤ì»¤ë‹ˆì¦˜ì„ ì‚´í´ë³´ì.\r\n\r\n1. MockMvcë¡œ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.\r\n\r\n2. í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ `build/generated-snippets` í•˜ìœ„ì— ìŠ¤ë‹ˆí«(ë¬¸ì„œì¡°ê°)ë“¤ì´ ìƒì„±ëœë‹¤. \r\n![](./first.png)\r\n\r\n   _â—â— gradleì€ build/generated-snippetsì— ìŠ¤ë‹ˆí«ì´ ìƒì„±ëœë‹¤._\r\n\r\n3. `build/generated-snippets` í•˜ìœ„ì— ìƒì„±ëœ ìŠ¤ë‹ˆí«ë“¤ì„ ë¬¶ì–´ì„œ HTML ë¬¸ì„œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ”, gradleì˜ ê²½ìš° ì•„ë˜ì™€ ê°™ì´`src/docs/asciidoc` í•˜ìœ„ì— ìŠ¤ë‹ˆí«ë“¤ì„ ë¬¶ì€ adocë¬¸ì„œë¥¼ ë§Œë“ ë‹¤.![](./second.png)\r\n\r\n4. ìŠ¤ë‹ˆí«ì„ ì´ìš©í•´ì„œ `src/docs/asciidoc` í•˜ìœ„ì— adoc íŒŒì¼ì„ ìƒì„±í–ˆë‹¤ë©´, `./gradlew build` ëª…ë ¹ì–´ë¥¼ í†µí•´ ë¹Œë“œë¥¼ í•´ì¤€ë‹¤.\r\n![](./third.png)\r\në¹Œë“œê°€ ì™„ë£Œë˜ë©´ ìœ„ì™€ ê°™ì´ `resources - static - docs` í•˜ìœ„ì— HTML ë¬¸ì„œê°€ ìƒì„±ëœë‹¤.\r\n\r\n5. ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ í•œ í›„, `http://localhost:8080/docs/{HTML íŒŒì¼ëª…}` ì„ ì›¹ë¸Œë¼ìš°ì €ì— ê²€ìƒ‰í•˜ë©´ ìƒì„±í•œ REST API ë¬¸ì„œë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. \r\n\r\n\t**â—â— APIë¬¸ì„œ urlì€ ì½”ë“œë¥¼ í†µí•´ ë³€ê²½ ê°€ëŠ¥í•˜ë‹¤.**\r\n    \r\n### â—ìœ ì˜í•  ì \r\nresources - static - docs í•˜ìœ„ì˜ HTML íŒŒì¼ì€ ì‹¤ì œë¡œëŠ” build.gradleì˜ ì„¤ì •íŒŒì¼ì— ë”°ë¼ì„œ ìœ„ì™€ê°™ì´ build - docs - asciidoc í•˜ìœ„ì˜ HTML íŒŒì¼ì„ ë³µì‚¬í•´ì˜¨ íŒŒì¼ì´ë‹¤.\r\n![](./four.png)\r\n\r\n### ì•„ì´ë””ì–´\r\nREST API ë¬¸ì„œë¥¼ í™•ì¸í•  ë•Œ, `http://localhost:8080/docs/{HTML íŒŒì¼ëª…}` ì„ í†µí•´ì„œ ì›¹ë¸Œë¼ìš°ì €ì— ì ‘ê·¼í•˜ì§€ ì•Šì•„ë„ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.\r\n![](./five.png)\r\nAsciiDoc í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë©´ ìœ„ì™€ê°™ì´, ì¸í…”ë¦¬ì œì´ ìƒì—ì„œë„ REST API ë¬¸ì„œë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í• ìˆ˜ ìˆë‹¤.  (âœ”ì„¤ì¹˜ ì¶”ì²œ)\r\n\r\n## Rest Docs ì‚¬ìš©ì„ ìœ„í•œ ë¹Œë“œíŒŒì¼ ì„¤ì •\r\n``` java\r\nplugins {\r\n    id 'org.asciidoctor.jvm.convert' version '3.3.2' // 1\r\n}\r\n\r\next {\r\n    snippetsDir = file('build/generated-snippets') // 2\r\n}\r\n\r\ntest { \r\n    outputs.dir snippetsDir // 3\r\n    useJUnitPlatform()\r\n}\r\n\r\nconfigurations {\r\n    asciidoctorExtensions\r\n}\r\n\r\nasciidoctor { // 4\r\n    configurations 'asciidoctorExtensions' \r\n    inputs.dir snippetsDir \r\n    dependsOn test\r\n}\r\n\r\ndependencies {\r\n    testImplementation 'org.springframework.restdocs:spring-restdocs-mockmvc' // 5\r\n    asciidoctorExtensions 'org.springframework.restdocs:spring-restdocs-asciidoctor' // 6\r\n}\r\n\r\ntask copyDocument(type: Copy) { // 7\r\n    dependsOn asciidoctor\r\n    \r\n    from file(\"build/docs/asciidoc\")\r\n    into file(\"src/main/resources/static/docs\")\r\n}\r\n\t\r\nbootJar { \r\n    dependsOn copyDocument // 8\r\n}\r\n  ```\r\n\r\n\r\n1. gradle7ë¶€í„° ì‚¬ìš©í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ asciidoc íŒŒì¼ ë³€í™˜, build ë””ë ‰í† ë¦¬ì— ë³µì‚¬í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ë‹¤.\r\n\r\n2. ìƒì„±ëœ ìŠ¤ë‹ˆí«ì„ ì €ì¥í•  ìœ„ì¹˜ë¥¼ ì •ì˜í•œë‹¤. gradleì€ `build/generated-snippets`ì— ìŠ¤ë‹ˆí«ì´ ìƒì„±ëœë‹¤.\r\n\r\n3. í…ŒìŠ¤íŠ¸ Taskì˜ ê²°ê³¼ ì•„ì›ƒí’‹ ë””ë ‰í† ë¦¬ë¥¼ `build/generated-snippets`ë¡œ ì§€ì •í•œë‹¤.\r\n\r\n4. asciidoctor Taskê°€ ì‚¬ìš©í•  ì¸í’‹ ë””ë ‰í† ë¦¬ë¥¼ `build/generated-snippets`ë¡œ ì§€ì •í•œë‹¤.\r\n\tdependsOn testë¡œ ë¬¸ì„œê°€ ì‘ì„±ë˜ê¸° ì „ì— í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤.\r\n    \r\n5. MockMvcë¥¼ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì˜ì¡´ì„±ì„ ì¶”ê°€ í•´ì¤€ë‹¤.\r\n\r\n6. ì¼ë°˜ í…ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³  HTML íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ì˜ì¡´ì„±ì„ ì¶”ê°€ í•´ì¤€ë‹¤.\r\n\r\n7. asciidoctor Taskë¡œ ìƒì„±í•œ `build/docs/asciidoc`íŒŒì¼ì„ `src/main/resources/static/docs`ë¡œ ë³µì‚¬í•œë‹¤.\r\n\r\n8. bootJar ì‹¤í–‰ì‹œ copyDocumentë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ë„ë¡ í•œë‹¤.\r\n\r\n\r\n--- \r\n\r\nâœ…MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs í…ŒìŠ¤íŠ¸ ì‘ì„±ì„ ì•Œì•„ë³´ê¸° ì „ì— ìš°ì„  MockMvcì— ëŒ€í•´ ì•Œì•„ë³´ì.\r\n\r\n##MockMvc ê¸°ë³¸ ë©”ì„œë“œ\r\nì–´ë– í•œ ê²ƒë“¤ì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ê³  ë°‘ì—ì„œ ìì„¸íˆ ì•Œì•„ë³´ì.\r\n\r\n### perform()\r\nê°€ìƒì˜ requestë¥¼ ì²˜ë¦¬í•œë‹¤.\r\n\r\n```java\r\nmockMvc.perform(get(\"/api/schedules/?year=2022&month=7\"))\r\n```\r\n\r\n### andExpert()\r\nandExpert()\r\n\r\nì˜ˆìƒê°’ì„ ê²€ì¦í•œë‹¤. \r\n\r\n```java\r\n.andExpect(status().isOk())\r\n// status ê°’ì´ ì •ìƒì¸ ê²½ìš°ë¥¼ ê¸°ëŒ€í•˜ê³  ë§Œë“  ì²´ì´ë‹ ë©”ì†Œë“œì˜ ì¼ë¶€\r\n\r\n.andExpect(content().contentType(\"application/json;charset=utf-8\"))\r\n//contentTypeì„ ê²€ì¦\r\n```\r\n\r\n### andDo()\r\nìš”ì²­ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë§¡ëŠ”ë‹¤. print() ë©”ì†Œë“œê°€ ì¼ë°˜ì ì´ë‹¤.\r\n\r\n```java\r\n.andDo(print())\r\n```\r\n\r\n### andReturn()\r\ní…ŒìŠ¤íŠ¸í•œ ê²°ê³¼ ê°ì²´ë¥¼ ë°›ì„ ë•Œ ì‚¬ìš©í•œë‹¤.\r\n\r\n```java\r\nMvcResult result = mockMvc.perform(get(\"/\"))\r\n.andDo(print())\r\n.andExpect(status().isOk())\r\n.andReturn();\r\n```\r\n\r\n## MockMvc ìš”ì²­ ë§Œë“¤ê¸°\r\nìš”ì²­ì„ ë§Œë“¤ ë•ŒëŠ” static ë©”ì„œë“œì¸ get, post, put, delete, fileUpload ë“±ì„ ì´ìš©í•´ì„œ MockHttpServletRequestBuilder ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì—ì„œ ì‹œì‘í•œë‹¤.\r\n\r\nMockHttpServletRequestBuilderëŠ” ServletRequestë¥¼ êµ¬ì„±í•˜ê¸°ì— í•„ìš”í•œ ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.\r\n![](./six.png)\r\nìœ„ ë©”ì„œë“œë“¤ì€ ë©”ì„œë“œ ì²´ì´ë‹ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì—, ì•„ë˜ì™€ ê°™ì´ ìš”ì²­ ë°ì´í„°ë¥¼ ì—°ê²°í•´ì„œ ì‘ì„±í•˜ë©´ëœë‹¤.\r\n\r\n\r\n```java \r\n@Test\r\n    void test() throws Exception {\r\n        MockHttpServletRequestBuilder builder = get(\"/api/schedules\")\r\n                .param(\"year\", \"2022\")\r\n                .param(\"month\", \"7\")\r\n                .accept(MediaType.APPLICATION_JSON)\r\n                .header(\"sessionId\", \"ì„¸ì…˜ì•„ì´ë””ì…ë‹ˆë‹¤.\");\r\n\r\n        mockMvc.perform(builder)\r\n                .andExpect(status().isOk());\r\n    }\r\n\r\n```\r\n_**â—â— ìœ ì˜ í•  ì **_\r\nMockMvc.perform() ì˜ íŒŒë¼ë¯¸í„° ê°’ì´ MockHttpServletRequestBuilderì˜ ìƒìœ„ ê°ì²´ì´ë‹¤. \r\n\r\nê·¸ë˜ì„œ perform() íŒŒë¼ë¯¸í„°ë¡œ ì•„ë˜ì™€ ê°™ì´ ë„£ì–´ì£¼ì–´ë„ ì‘ë™ëœë‹¤.\r\n```java\r\n@Test\r\n    void test() throws Exception {\r\n        mockMvc.perform(get(\"/api/schedules\")\r\n                .param(\"year\", \"2022\")\r\n                .param(\"month\", \"7\")\r\n                .accept(MediaType.APPLICATION_JSON)\r\n                .header(\"sessionId\", \"ì„¸ì…˜ì•„ì´ë””ì…ë‹ˆë‹¤.\"))\r\n                .andExpect(status().isOk());\r\n    }\r\n```\r\n\r\n## MockMvc ì‹¤í–‰ ê²°ê³¼ ê²€ì¦\r\nperform()ì€ ë°˜í™˜ ê°’ìœ¼ë¡œ ResultActionsê°€ ë°˜í™˜ëœë‹¤.\r\nResultActionsì˜ andExpectëŠ” ìš”ì²­ ì‹¤í–‰ ê²°ê³¼ë¥¼ ê²€ì¦ í•˜ë ¤ë©´ ResultMatcherë¥¼ ë„˜ê²¨ì¤˜ì„œ ê²€ì¦í•´ì•¼í•œë‹¤.\r\nResultMatcherëŠ” ë‹¤ìŒì˜ MockMvcResultMatchersê°€ ê°€ì§€ëŠ” static ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì–»ëŠ”ë‹¤.\r\n\r\nMockMvcResultMatchersëŠ” ë‹¤ìŒì˜ static ë©”ì„œë“œë¥¼ í†µí•´ ë‹¤ì–‘í•œ ResultMatcherë¥¼ ì œê³µí•œë‹¤.\r\n\r\n![](./seven.png)\r\n\r\nì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ì.\r\n```java\r\n\t@Test\r\n    void test() throws Exception {\r\n        mockMvc.perform(builder)\r\n                .andExpect(handler().handlerType(ScheduleController.class))\r\n                .andExpect(handler().methodName(\"save\"))\r\n                .andExpect(forwardedUrl(\"index\"))\r\n                .andExpect(header().stringValues(\"Content-Language\", \"en\"))\r\n                .andExpect(model().attribute(\"message\", \"ì €ì¥ì´ ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.\"))\r\n                .andExpect(status().isOk());\r\n    }\r\n```\r\n\r\n## MockMvc ì‹¤í–‰ ê²°ê³¼ ì²˜ë¦¬\r\nì‹¤í–‰ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë–„ëŠ” andDo ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.\r\nandDo ë©”ì„œë“œ ì˜ ì¸ìˆ˜ì—ëŠ” ì‹¤í–‰ ê²°ê³¼ë¥¼ ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” ResultHandlerë¥¼ ì§€ì •í•œë‹¤.\r\nMockMvcResultHandlersëŠ” ë‹¤ì–‘í•œ ResultHandlerë¥¼ ì œê³µí•˜ì§€ë§Œ print()ë¥¼ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.\r\n\r\n\r\n## MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs ìƒì„±\r\ní…ŒìŠ¤íŠ¸ ì½”ë“œì™€ í•¨ê»˜ MockMvcë¥¼ ì‚¬ìš©í•œ Rest Docs ìƒì„±ì„ ì•Œì•„ë³´ì.\r\n\r\n```java\r\n@WebMvcTest(ScheduleController.class)\r\n@AutoConfigureRestDocs // 1\r\nclass ScheduleControllerTest {\r\n\r\n    @Autowired\r\n    private MockMvc mockMvc;\r\n\r\n    @Autowired\r\n    private ObjectMapper objectMapper;\r\n\r\n    @MockBean // 2\r\n    private ScheduleService scheduleService;\r\n\r\n    @Test\r\n    void save() throws Exception {\r\n        // given\r\n        ScheduleCreateRequest request = new ScheduleCreateRequest(\"ì œëª©\", LocalDateTime.now(), LocalDateTime.now(), \"ë©”ëª¨\");\r\n\r\n        given(scheduleService.save(request))\r\n                .willReturn(1L); // 3\r\n\r\n        // when & then\r\n        mockMvc.perform(post(\"/api/schedules\")\r\n                        .content(objectMapper.writeValueAsString(request))\r\n                        .contentType(MediaType.APPLICATION_JSON)\r\n                        .accept(MediaType.APPLICATION_JSON))\r\n                .andExpect(status().isOk())\r\n                .andDo(document(\"schedule-save\", // 4\r\n                        requestFields(\r\n                                fieldWithPath(\"title\").type(JsonFieldType.STRING).description(\"ì œëª©\"),\r\n                                fieldWithPath(\"startDateTime\").type(JsonFieldType.STRING)\r\n                                        .description(\"2022-07-04T13:00\"),\r\n                                fieldWithPath(\"endDateTime\").type(JsonFieldType.STRING).description(\"2022-07-05T07:00\"),\r\n                                fieldWithPath(\"memo\").type(JsonFieldType.STRING).description(\"ë©”ëª¨ì…ë‹ˆë‹¤.\")\r\n                        )\r\n                ));\r\n    }\r\n}\r\n```\r\n\r\n1. target/generated-snippets dir ìƒì„±í•˜ê³  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ í†µí•´ snippetsë¥¼ ì¶”ê°€í•´ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤.\r\n\r\n2. `ScheduleService`ë¥¼ mockingì„ í•˜ê¸°ìœ„í•´ì„œ `@MockBean` ì„ ì„ ì–¸í•œë‹¤.\r\n\r\n3. mockingì„ í†µí•´ `ScheduleService` ë¥¼ í†µí•´ ë°›ì„ ì‘ë‹µê°’ì„ ì„¤ì •í•œë‹¤.\r\n\r\n4. test ìˆ˜í–‰ì‹œ `andDo(document(\"xxx\"))`ë¥¼ í†µí•´ì„œ `./build/generated-snippets` í•˜ìœ„ì— ë¬¸ì„œê°€ ì‘ì„±ëœë‹¤.\r\n\r\n\r\n---\r\n## ëë‚´ë©´ì„œ \r\nì´ìƒ Rest Docsì˜ ë§¤ì»¤ë‹ˆì¦˜, ì„¤ì • ê·¸ë¦¬ê³  MockMvcë¥¼ í™œìš©í•œ Rest Docs ìƒì„± ë°©ë²•ì„ ì‚´í´ë³´ì•˜ë‹¤.\r\ní”„ë¡œì íŠ¸ì— RestAssueredë¥¼ ì‚¬ìš©í•œ Rest Docsë¥¼ ì ìš©í•˜ë©´ì„œ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ë¬¸ì œë¥¼ ê²½í—˜í•˜ì˜€ëŠ”ë°,\r\ní…ŒìŠ¤íŠ¸ ê²©ë¦¬ì— ëŒ€í•´ì„œ ì¶”í›„ì— í¬ìŠ¤íŒ… í•´ë´ì•¼ê² ë‹¤.\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë¦¬ë²„'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë“¤ì–´ê°€ê¸°ì— ì•ì„œ ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë¬¸ì œì ì„ ì‚´í´ë³´ê³  ê°ì²´ ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê¸°ìœ„í•œ JAVAì˜ JPAë¥¼ ê°€ë³ê²Œ ì–¸ê¸‰í•´ë³´ì•˜ë‹¤. ê·¸ë ‡ë‹¤ë©´, JPAëŠ” ì–´ë– í•œ ë§¤ì»¤ë‹ˆì¦˜ìœ¼ë¡œ JAVAì—ì„œ ì‘ë™í• ê¹Œ?\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ JPAì˜ êµ¬ë™ë°©ì‹ì„ ìì„¸íˆ ì•Œì•„ë³´ì.   JPA êµ¬ë™ë°©ì‹ ìš°ì„ , ì•„ë˜ì˜ ê·¸ë¦¼ì„ â€¦","fields":{"slug":"/mechanism-of-jpa/"},"frontmatter":{"date":"July 26, 2022","title":"JPA ì‘ë™ ë©”ì»¤ë‹ˆì¦˜","tags":["JPA"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë¦¬ë²„](https://github.com/gudonghee2000)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n### ë“¤ì–´ê°€ê¸°ì— ì•ì„œ\r\nì´ì „ í¬ìŠ¤íŒ…ì—ì„œ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë¬¸ì œì ì„ ì‚´í´ë³´ê³  ê°ì²´ ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê¸°ìœ„í•œ JAVAì˜ JPAë¥¼ ê°€ë³ê²Œ ì–¸ê¸‰í•´ë³´ì•˜ë‹¤.\r\n\r\nê·¸ë ‡ë‹¤ë©´, JPAëŠ” ì–´ë– í•œ ë§¤ì»¤ë‹ˆì¦˜ìœ¼ë¡œ JAVAì—ì„œ ì‘ë™í• ê¹Œ?\r\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ JPAì˜ êµ¬ë™ë°©ì‹ì„ ìì„¸íˆ ì•Œì•„ë³´ì.  \r\n\r\n\r\n### JPA êµ¬ë™ë°©ì‹\r\nìš°ì„ , ì•„ë˜ì˜ ê·¸ë¦¼ì„ í†µí•´ JPAì˜ êµ¬ë™ë°©ì‹ì„ ê°€ë³ê²Œ ì‚´í´ë³´ì.\r\n\r\n![](./jpa-mechanism.png)\r\n\r\n\r\në¨¼ì €, JPAëŠ” Build íŒŒì¼ì„ í†µí•´ì„œ JPA ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•  **êµ¬í˜„ì²´ í´ë˜ìŠ¤ì¸** `Persistence` ìƒì„±í•œë‹¤. \r\n**(JPAëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë©° êµ¬í˜„ì²´ë¡œëŠ” Hibernate, EclipseLink ë“±ì´ ìˆìŒ)**\r\n\r\nê·¸ë¦¬ê³  ìƒì„±í•œ `Persistence`ë¡œ `META-INF/Persistence.xml`ë¼ëŠ” ì„¤ì •íŒŒì¼ì˜ ì •ë³´ë¥¼ ì½ì–´ì„œ `EntityManagerFactory`ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.\r\n\r\n`EntityManagerFactory`ëŠ” í•„ìš”í• ë•Œ ë§ˆë‹¤ `EntityManager` ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤. \r\n\r\nê°œë°œìëŠ” `EntityManager`ë¥¼ í†µí•´ì„œ DBì— ì ‘ê·¼í•˜ê³  CRUD ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.\r\n\r\nìœ„ì™€ ê°™ì€ ê³¼ì •ì„ í†µí•´ JPAë¥¼ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.\r\n\r\nê·¸ë ‡ë‹¤ë©´, `Persistence.xml`, `EntityManagerFactory`, `EntityManager`ë€ ë¬´ì—‡ì¼ê¹Œ?\r\nì•„ë˜ì—ì„œ ìì„¸íˆ ì‚´í´ë³´ì.\r\n\r\n### Persistence.xmlë€?\r\n`Persistence.xml`ì€ JPAê°€ ì—‘ì„¸ìŠ¤í•˜ë ¤ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë“¤ì— ëŒ€í•´ í•„ìš”í•œ ì„¤ì •ì •ë³´ ë“¤ì„ ê¸°ìˆ í•´ë‘” íŒŒì¼ì´ë‹¤.\r\nJPAëŠ” ì´ íŒŒì¼ì˜ ì„¤ì •ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì ‘ê·¼í•  DBì˜ ì •ë³´ë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ìˆë‹¤.\r\n\r\n`Persistence.xml` íŒŒì¼ì— ëŒ€í•´ ì•„ë˜ ê·¸ë¦¼ê³¼ í•¨ê»˜ ìì„¸íˆ ì‚´í´ë³´ì.\r\n\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<persistence version=\"2.2\"\r\n \txmlns=\"http://xmlns.jcp.org/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n    xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd\">\r\n\t<persistence-unit name=\"hello\">\r\n \t\t<properties>\r\n \t\t\t<!-- í•„ìˆ˜ ì†ì„± -->\r\n \t\t\t<property name=\"javax.persistence.jdbc.driver\" value=\"org.h2.Driver\"/>\r\n \t\t\t<property name=\"javax.persistence.jdbc.user\" value=\"sa\"/>\r\n \t\t\t<property name=\"javax.persistence.jdbc.password\" value=\"\"/>\r\n\t\t\t<property name=\"javax.persistence.jdbc.url\" value=\"jdbc:h2:tcp://localhost/~/test\"/>\r\n \t\t\t<property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.H2Dialect\"/>\r\n\r\n \t\t\t<!-- ì˜µì…˜ -->\r\n \t\t\t<property name=\"hibernate.show_sql\" value=\"true\"/>\r\n \t\t\t<property name=\"hibernate.format_sql\" value=\"true\"/>\r\n \t\t\t<property name=\"hibernate.use_sql_comments\" value=\"true\"/>\r\n \t\t\t<!--<property name=\"hibernate.hbm2ddl.auto\" value=\"create\" />-->\r\n \t\t</properties>\r\n\t</persistence-unit>\r\n</persistence> \r\n```\r\n\r\nì²«ë²ˆì§¸ë¡œ `<persistence version=\"2.2\" ...>`íƒœê·¸ëŠ” ì‚¬ìš©í•  JPAì˜ ë²„ì „ê³¼ ë²„ì „ì— ëŒ€í•œ Persistence.XML ë¬¸ì„œí˜•ì‹ ë§í¬ë¥¼ ë‹´ê³  ìˆë‹¤.\r\n\r\n`<persistence-unit name=\"hello\">`íƒœê·¸ëŠ” í•˜ë‚˜ì˜ ì§€ì†ì„± ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•œë‹¤. ì„œìˆ ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´, `hello`ë¼ëŠ” ì´ë¦„ì„ ê°€ì§€ëŠ” `EntityManagerFactory`ë¥¼ í•˜ìœ„ ì„¤ì •ì— ë”°ë¼ ë§Œë“¤ê²ƒì´ë¼ëŠ” ì˜ë¯¸ì´ë‹¤. \r\n\r\n`<properties>`ëŠ” `<persistence-unit>`ì´ ì—‘ì„¸ìŠ¤í•  DBì˜ ì •ë³´ì™€ ì¶”ê°€ì ì¸ ì˜µì…˜ ì •ë³´ë“¤ì„ ë‹´ëŠ”ë‹¤.\r\n\r\n`<property>`ëŠ” ì˜µì…˜ ì •ë³´ë¥¼ í•˜ë‚˜ì”© ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.\r\nìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ `í•„ìˆ˜ ì†ì„±` ë¶€ë¶„ì€ ì—‘ì„¸ìŠ¤í•  DBì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤.\r\n\r\nì¶”ê°€ë¡œ `ì˜µì…˜` ë¶€ë¶„ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ì.\r\n`hibernate.show_sql`ëŠ” DBì— ë‚ ë¦¬ëŠ” ì¿¼ë¦¬ë¬¸ì„ í™•ì¸ í• ê²ƒì¸ì§€ì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.\r\n`hibernate.format_sql`ëŠ” ë³´ì—¬ì§€ëŠ” ì¿¼ë¦¬ë¬¸ì„ í¬ë§·íŒ…í•˜ëŠ” ì„¤ì •ì´ë‹¤.\r\n`hibernate.use_sql_comments`ëŠ” ì¶”ê°€ì ì¸ `/* */` ì£¼ì„ì„ ì¿¼ë¦¬ë¬¸ì— ë³´ì—¬ì£¼ëŠ” ì„¤ì •ì´ë‹¤.\r\n\r\n`hibernate.hbm2ddl.auto` ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ìƒì„±ì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.\r\n`hibernate.hbm2ddl.auto`ê°€ ê°€ì§€ëŠ” ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ë‹¤.\r\n\r\n```\r\ncreate: ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ë‹¤ì‹œ ìƒì„± (DROP + CREATE)\r\ncreate-drop: createì™€ ê°™ìœ¼ë‚˜ ì¢…ë£Œì‹œì ì— í…Œì´ë¸” DROP\r\nupdate: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ë°˜ì˜ (ìš´ì˜ DBì— ì‚¬ìš©í•˜ë©´ ì•ˆëŒ)\r\nvalidate: entityì™€ tableì´ ì •ìƒ ë§¤í•‘ë˜ì—ˆëŠ”ì§€ë§Œ í™•ì¸\r\nnone: ì‚¬ìš©í•˜ì§€ ì•ŠìŒ\r\n```\r\n\r\n#### **ì£¼ì˜ì â—**\r\n**create, create-drop, updateëŠ” ìš´ì˜ DBì— ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.  \r\ncreate, create-dropì€ ìš´ì˜ DBì˜ ë°ì´í„°ë¥¼ ì „ì²´ ì‚­ì œ ì‹œí‚¤ê¸° ë•Œë¬¸ì´ë‹¤.\r\nupdateëŠ” ì•„ì§ ì•Œì•„ë³¼í•„ìš”ê°€ìˆìŒ**\r\n\r\nì´ì œ ì„¤ì •íŒŒì¼ì„ í†µí•´ ìƒì„±í•˜ëŠ” `EntityManagerFactory`ë¥¼ ì‚´í´ë³´ì.\r\n\r\n\r\n### EntityManagerFactoryë€?\r\n`EntityManagerFactory`ëŠ” `EntityManager`(Entityë¥¼ ê´€ë¦¬í•˜ê³  DB ê´€ë ¨ì‘ì—…ì„ ìˆ˜í–‰ í•¨)ì„ ìƒì„±í•˜ëŠ” ì¼ì„í•œë‹¤.\r\n\r\n**ğŸ’¡ `Entity` ëŠ” DB í…Œì´ë¸”ì— ëŒ€ì‘í•˜ëŠ” í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ì˜ë¯¸í•œë‹¤.**\r\n\r\nìš°ë¦¬ëŠ” `Persistence.xml` ì„¤ì •ì •ë³´ë¥¼ í†µí•´ì„œ `EntityManagerFactory`ë¥¼ ìƒì„±í• ìˆ˜ ìˆë‹¤.\r\n\r\nì•„ë˜ì˜ ì˜ˆì‹œì½”ë“œë¡œ ì‚´í´ë³´ì.\r\n``` java\r\npublic class JpaMain {\r\n\r\n    public static void main(String[] args) {\r\n        EntityManagerFactory emf = \r\n        \t\t\tPersistence.createEntityManagerFactory(\"hello\");\r\n        // íŒŒë¼ë¯¸í„°ë¡œ Persistence.xmlì— ì„¤ì •í•œ persistence-unitì˜ name ì†ì„±ê°’ì„ ë„£ëŠ”ë‹¤.\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\nì „ ì¥ì—ì„œ ì„¤ì •í–ˆë˜ `Persistence.xml` íŒŒì¼ì„ í†µí•´ \r\nìš°ë¦¬ëŠ” `hello`ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ `<persistence-unit>`ì´ ì–´ë–¤ DBì— ì—‘ì„¸ìŠ¤ í•  ê²ƒì¸ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ì„¤ì •í–ˆì—ˆë‹¤.\r\n\r\nìœ„ ì½”ë“œê°€ ë°”ë¡œ `Persistence.xml`ì— ì‘ì„±í•œ Persistence Unit(ì§€ì†ì„± ë‹¨ìœ„)ì„ ë°”íƒ•ìœ¼ë¡œ `EntityManagerFactory`ë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œì´ë‹¤.\r\n\r\n`EntityManagerFactory`ë¥¼ í†µí•´ì„œ ìš°ë¦¬ëŠ” DB ê´€ë ¨ ì‘ì—…ì„ ì‹¤ì œë¡œ ìˆ˜í–‰í•  `EntityManager`ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë‹¤.\r\n\r\n#### ğŸ”`EntityManagerFactory`ê°€ ê°€ì§€ëŠ” íŠ¹ì§•\r\n**1. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” í•˜ë‚˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— í•˜ë‚˜ë§Œ ìƒì„±í•œë‹¤. (ìƒì„± ë¹„ìš©ì´ ë¹„ì‹¸ê¸° ë•Œë¬¸)**\r\n\r\n**2. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•´ë„ ì•ˆì „í•˜ë‹¤.**\r\n\r\n  \r\n### EntityManagerë€?\r\n\r\nì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” íŠ¹ì • ì‘ì—…ì„ ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤ í•˜ëŠ” ì—­í• ì„ í•œë‹¤.\r\në˜í•œ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— CRUD í•  ìˆ˜ ìˆë‹¤.\r\nì¦‰, ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ëª¨ë“  ì¼ì„ ì²˜ë¦¬í•˜ê¸°ì— ì´ë¦„ ê·¸ëŒ€ë¡œ ì—”í‹°í‹°ë¥¼ ê´€ë¦¬í•˜ëŠ” ê´€ë¦¬ìë‹¤.\r\n\r\n``` java\r\npublic class JpaMain {\r\n\r\n    public static void main(String[] args) {\r\n        EntityManagerFactory emf = \r\n        \t\t\tPersistence.createEntityManagerFactory(\"hello\");\r\n        // íŒŒë¼ë¯¸í„°ë¡œ Persistence.xmlì— ì„¤ì •í•œ persistence-unitì˜ name ì†ì„±ê°’ì„ ë„£ëŠ”ë‹¤.\r\n        \r\n        EntityManager em = emf.createEntityManager();\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\nìœ„ì™€ ê°™ì´ `EntityManagerFactory`ë¥¼ í†µí•´ì„œ `EntityManager`ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë‹¤.\r\n\r\n#### ğŸ”`EntityManager`ê°€ ê°€ì§€ëŠ” íŠ¹ì§•\r\n**1. ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” DB connectionê³¼ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì—, ìŠ¤ë ˆë“œ ê°„ì— ê³µìœ í•˜ê±°ë‚˜ ì¬ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.**\r\n\r\n**2. ì—”í‹°í‹° ë§¤ë‹ˆì €ì˜ CRUD ì‘ì—…ì€ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì²˜ë¦¬ í•´ì•¼í•œë‹¤.**\r\n\r\n#### **ì£¼ì˜ì â—**\r\n**EntityManagerì˜ ì‘ì—…ì€ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì§„í–‰ë˜ì–´ì•¼í•œë‹¤.\r\nì™œëƒí•˜ë©´, CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ë‹¤ê°€ ì¤‘ê°„ì— ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš° íŠ¸ëœì­ì…˜ ì´ì „ì˜ ìƒíƒœë¡œ ëŒì•„ê°€ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.**\r\n\r\n\r\në§ˆì§€ë§‰ìœ¼ë¡œ ì½”ë“œë¥¼ í†µí•´ `EntityManagerFactory` ìƒì„±ë¶€í„° DBì— ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì„ ì‚´í´ë³´ì.\r\n\r\n### JPAì˜ êµ¬ë™ê³¼ì •\r\nJAVA ì½”ë“œìƒì—ì„œ `JPA`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ëŠ” ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ë‹¤.\r\n\r\n```java\r\npublic class JpaMain {\r\n\r\n    public static void main(String[] args) {\r\n        EntityManagerFactory emf = \r\n        \t\t\tPersistence.createEntityManagerFactory(\"hello\"); \r\n                    // ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±\r\n        EntityManager em = emf.createEntityManager(); // ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±\r\n        \r\n        EntityTransaction tx = em.getTransaction(); // íŠ¸ëœì­ì…˜ ìƒì„±\r\n        tx.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘\r\n\r\n        try {\r\n        \tMember member = new Member() // ë©¤ë²„ ì—”í‹°í‹° ìƒì„±\r\n            member.setId(100L)\r\n            member.setName(\"JPA\")\r\n            \r\n            em.persist(member) // ë©¤ë²„ ì—”í‹°í‹° ë°ì´í„°ë¥¼ ì €ì¥\r\n        \r\n            tx.commit(); // íŠ¸ëœì­ì…˜ ì»¤ë°‹\r\n        } catch (Exception e) {\r\n            tx.rollback(); // íŠ¸ëœì­ì…˜ ë¡¤ë°±\r\n        } finally {\r\n            em.close(); // ì—”í‹°í‹° ë§¤ë‹ˆì € ì—°ê²° ì¢…ë£Œ\r\n        }\r\n        emf.close();\r\n    }\r\n}\r\n```\r\n1. Persistence.xml ì„¤ì •íŒŒì¼ì˜ Persistence Unitì„ í†µí•´ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ìƒì„±í•œë‹¤.\r\n\r\n2. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¡œ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±í•œë‹¤. \r\n\r\n3. ì—”í‹°í‹° ë§¤ë‹ˆì €ì— ëŒ€í•œ íŠ¸ëœì­ì…˜ì„ ìƒì„±í•œë‹¤.\r\n\r\n4. íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤.\r\n\r\n5. DBì— ì €ì¥í•  ë©¤ë²„ ì—”í‹°í‹°ë¥¼ ìƒì„±í•œë‹¤.\r\n\r\n6. em.persist(member)ë¥¼ í†µí•´ ì—”í‹°í‹° ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.\r\n\r\n7. íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•œë‹¤.\r\n\r\n8. ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ë‹«ëŠ”ë‹¤.\r\n\r\n9. ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ë‹«ëŠ”ë‹¤.\r\n\r\n\r\nìœ„ì™€ ê°™ì€ ê³¼ì •ì„ í†µí•´ DBì— ë°ì´í„°ë¥¼ ì €ì¥ í•  ìˆ˜ ìˆë‹¤.\r\n\r\n`em.persist()` ë©”ì„œë“œëŠ” íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ì˜¨ ì—”í‹°í‹°ì— ëŒ€í•œ insert ì¿¼ë¦¬ë¬¸ì„ JPAê°€ ì‘ì„±í•˜ì—¬ DBì— ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.\r\n\r\nì–¼í• ë³´ë©´, `em.persist(member)`ë¥¼ ì‹¤í–‰í• ë•Œ ë°ì´í„°ê°€ ë°”ë¡œ DBì— ì €ì¥ ë  ê²ƒ ê°™ë‹¤.\r\n\r\ní•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” `Member` ì—”í‹°í‹°ê°€ `EntityManager`ì˜ ì˜ì† ì»¨í…ìŠ¤íŠ¸ë¼ëŠ” ê³µê°„ì— ì €ì¥ë˜ê³  íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë˜ëŠ” ì‹œì ì— DBì— `Member` ì—”í‹°í‹°ì— ëŒ€í•œ insert ì¿¼ë¦¬ë¬¸ì´ ë‚ ë¼ê°„ë‹¤.\r\n\r\nì™œ ë°”ë¡œ, DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ì§€ ì•Šê³  ì˜ì† ì»¨í…ìŠ¤íŠ¸ì— ë°ì´í„°ë¥¼ ì €ì¥í• ê¹Œ? ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ì•Œì•„ë³´ì.\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ë°”ë¡œ ì§ì „ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ ë°±ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œí•´ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì„±ì„ ì†Œê°œí•´ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë°”ë¡œ ì‹œì‘í• ê¹Œìš”? í”„ë¡ íŠ¸ì—”ë“œ CD ë‹¤ì´ì–´ê·¸ë¨  í”„ë¡ íŠ¸ì—”ë“œì˜ ì§€ì†ì  ë°°í¬ ê³¼ì •â€¦","fields":{"slug":"/continuous-deploy-with-jenkins-2-frontend/"},"frontmatter":{"date":"July 24, 2022","title":"ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸° (2) - í”„ë¡ íŠ¸ì—”ë“œí¸","tags":["DevOps"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ë°”ë¡œ [ì§ì „ í¬ìŠ¤íŒ…](https://dallog.github.io/continuous-deploy-with-jenkins-1-backend/)ìœ¼ë¡œ ë‹¬ë¡íŒ€ ë°±ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œí•´ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œì˜ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì„±ì„ ì†Œê°œí•´ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë°”ë¡œ ì‹œì‘í• ê¹Œìš”?\r\n\r\n## í”„ë¡ íŠ¸ì—”ë“œ CD ë‹¤ì´ì–´ê·¸ë¨\r\n\r\n![í”„ë¡ íŠ¸ì—”ë“œ ì§€ì†ì  ë°°í¬ í™˜ê²½](./fe.png)\r\n\r\ní”„ë¡ íŠ¸ì—”ë“œì˜ ì§€ì†ì  ë°°í¬ ê³¼ì •ì€ ì‚¬ì‹¤ ë°±ì—”ë“œê³¼ í¬ê²Œ ë‹¤ë¥¸ì ì´ ì—†ìŠµë‹ˆë‹¤. PRì´ ìƒì„±ë˜ê³ , ë³‘í•©ë˜ê³ , ì´ ì´ë²¤íŠ¸ê°€ Webhookì„ í†µí•´ ì  í‚¨ìŠ¤ ì„œë²„ì— ì „ë‹¬ë©ë‹ˆë‹¤.\r\n\r\nì  í‚¨ìŠ¤ ì„œë²„ëŠ” Webpackì„ ì´ìš©í•˜ì—¬ ë¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , `index.html`ê³¼ `bundle.js`ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë‹¬ë¡ì˜ í”„ë¡ íŠ¸ì—”ë“œ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” **NGINXê°€ ë„ì»¤ ì»¨í…Œì´ë„ˆ**ë¡œ ë„ì›Œì ¸ ìˆëŠ”ë°ìš”, ìƒì„±ëœ ì •ì íŒŒì¼ì€ ì´ NGINX ë””ë ‰í† ë¦¬ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.\r\n\r\n## íŒŒì´í”„ë¼ì¸ ì…‹ì—…\r\n\r\n### ì‚¬ì „ ì‘ì—…\r\n\r\në‹¬ë¡íŒ€ í”„ë¡ íŠ¸ì—”ë“œ íŒ€ì€ ë¦¬ì•¡íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ë‹¬ë¡íŒ€ì€ ëª¨ë“ˆ ë²ˆë“¤ëŸ¬ë¡œ **ì›¹íŒ©(Webpack)**ì„ ì±„íƒí•˜ì—¬ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì›¹íŒ©ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œëŠ” ë¹Œë“œ ì„œë²„ì— **node.js**ê°€ ì„¤ì¹˜ë˜ì–´ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\r\n\r\nì´ë¥¼ ìœ„í•´ì„œ ë‹¬ë¡íŒ€ì€ ì  í‚¨ìŠ¤ì— `NodeJS` í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•œ ì´í›„ ì‚¬ìš©í•  node.jsì˜ ë²„ì „ì„ ì„ íƒí•´ì•¼í•©ë‹ˆë‹¤. **Jenkins ê´€ë¦¬ > Global Tool Configuration > NodeJS > NodeJS Installation** ì— ë“¤ì–´ê°€ ì‚¬ìš©í•  node.js ë²„ì „ì„ ì„ íƒí•˜ê³  ì´ë¦„ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤.\r\n\r\në‹¬ë¡íŒ€ì€ ê°œë°œ í™˜ê²½ì—ì„œ node.js 16.14.0ì„ ì‚¬ìš©í•˜ë¯€ë¡œ 16.14.0 ë²„ì „ì„ ì„ íƒí•˜ê³  ì´ë¦„ì„ `NodeJS 16.14.0`ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\r\n\r\n### íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸\r\n\r\n```groovy\r\npipeline {\r\n   agent any\r\n   stages {\r\n       stage('Github') {\r\n           steps {\r\n               git branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\r\n           }\r\n       }\r\n       stage('Build') {\r\n           steps {\r\n               dir('frontend') {\r\n                   nodejs(nodeJSInstallationName: 'NodeJS 16.14.0') {\r\n                        sh 'npm install && npm run build'\r\n                    }\r\n               }\r\n           }\r\n       }\r\n       stage('Deploy') {\r\n           steps {\r\n               dir('frontend/dist') {\r\n                   sshagent(credentials: ['key-dallog']) {\r\n                        sh 'ls'\r\n                        sh 'scp ./index.html ubuntu@192.168.XXX.XXX:/home/ubuntu/'\r\n                        sh 'scp ./bundle.js ubuntu@192.168.XXX.XXX:/home/ubuntu/'\r\n                        sh 'ssh ubuntu@192.168.XXX.XXX \"sudo mv ./index.html ./html && sudo mv ./bundle.js ./html\"'\r\n                   }\r\n               }\r\n           }\r\n       }\r\n   }\r\n}\r\n```\r\n\r\n#### Build stage\r\n\r\n`nodejs` Directiveë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©í•  NodeJS Installationì˜ ì´ë¦„ì„ ì…ë ¥í•˜ê³ , ì‹¤í–‰í•  ëª…ë ¹ì„ ì…ë ¥í•©ë‹ˆë‹¤. `npm install` ë¡œ í•„ìš”í•œ ëª¨ë“ˆì„ ì„¤ì¹˜í•˜ê³ , `npm run build` ëª…ë ¹ìœ¼ë¡œ ë¹Œë“œí•©ë‹ˆë‹¤.\r\n\r\n#### Deploy stage\r\n\r\në°±ì—”ë“œì™€ ë§ˆì°¬ê°€ì§€ë¡œ `sshagent` ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ ì„œë²„ì— SSHë¡œ ì ‘ì†í•©ë‹ˆë‹¤. ë¹Œë“œëœ ë‘ê°œì˜ íŒŒì¼ `index.html`ê³¼ `bundle.js` ì„ ì „ì†¡í•©ë‹ˆë‹¤.\r\n\r\nì´í›„ ì „ì†¡ëœ íŒŒì¼ì„ ì›ê²©ì§€ì˜ sudo ê¶Œí•œìœ¼ë¡œ `html` ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•©ë‹ˆë‹¤. ì´ `html` ë””ë ‰í† ë¦¬ëŠ” ì´í›„ ì„¤ëª…í•˜ê² ì§€ë§Œ, NGINX ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ ë””ë ‰í† ë¦¬ì™€ ë§ˆìš´íŒ…ëœ ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ë°°í¬ ì„œë²„ì˜ Dockerê°€ sudo ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆìœ¼ë¯€ë¡œ, íŒŒì¼ì„ í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™ì‹œí‚¬ ë•Œì—ë„ sudo ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\r\n\r\n## ë„ì»¤ ë° NGINX ì„¤ì •\r\n\r\n### docker-compose\r\n\r\në§¨ ìœ„ì˜ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ê°™ì´ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ ì„œë²„ëŠ” NGINXê°€ ë„ì»¤ë¡œ ë„ì›Œì ¸ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•œ **docker-compose.yml** ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\r\n\r\n```yaml\r\nversion: \"3\"\r\nservices:\r\n  dallog-front:\r\n    image: nginx\r\n    volumes:\r\n      - ./html:/usr/share/nginx/html\r\n    ports:\r\n      - 80:80\r\n```\r\n\r\n`/usr/share/nginx/html` ë””ë ‰í† ë¦¬ëŠ” NGINXê°€ ì„œë¹™í•  ì •ì  íŒŒì¼ì´ ìœ„ì¹˜ë  ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ì´ë¥¼ ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì˜ `./html` ë””ë ‰í† ë¦¬ì™€ ë³¼ë¥¨ ë§ˆìš´íŒ… ì„¤ì •ì„ í•´ë‘ì—ˆìŠµë‹ˆë‹¤.\r\n\r\n### í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ… ëŒ€ì‘\r\n\r\në‹¬ë¡ì€ ë¦¬ì•¡íŠ¸ ë¼ìš°í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ…ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë¥¼ ìœ„í•´ì„œ NGINXì— ë³„ë„ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. `index.html` ë¡œ ì ‘ì†í•˜ë©´ html íŒŒì¼ì„ ì˜ ì°¾ì„ ìˆ˜ ìˆì§€ë§Œ, ê·¸ ì™¸ì˜ ë¼ìš°íŠ¸ë¡œ ì ‘ì†í•œë‹¤ë©´ html íŒŒì¼ ìì²´ë¥¼ ì°¾ì§€ ëª»í•´ 404 ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\r\n\r\në„ì»¤ ë‚´ë¶€ì˜ `/etc/nginx/conf.d/default.conf` íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.\r\n\r\n```\r\n...\r\n\r\nlocation / {\r\n\t    root   /usr/share/nginx/html;\r\n\t    index  index.html index.htm;\r\n\t    try_files $uri $uri/ /index.html;\r\n}\r\n\r\n...\r\n```\r\n\r\nì•Œ ìˆ˜ ì—†ëŠ” ë¼ìš°íŠ¸ë¡œ ì ‘ì†í–ˆì„ ë•Œ ìë™ìœ¼ë¡œ `index.html` ë¡œ Fallback ë˜ë„ë¡ `try_files` ì„¤ì •ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ìˆ˜ì •í•˜ê³  ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•´ì£¼ë©´ ì„¤ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤.\r\n\r\n## íŠ¸ëŸ¬ë¸” ìŠˆíŒ…\r\n\r\n### ë¹Œë“œ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ\r\n\r\në¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•  ë•Œ ì•„ë˜ì™€ ê°™ì€ ë©”ëª¨ë¦¬ ì´ìŠˆë¥¼ ë§ˆì£¼í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\r\n\r\n```\r\n<--- Last few GCs --->\r\n\r\n[21854:0x147b3960]    21931 ms: Scavenge 456.7 (469.5) -> 456.4 (470.7) MB, 3.2 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure\r\n[21854:0x147b3960]    21939 ms: Scavenge 457.4 (470.7) -> 457.2 (475.2) MB, 4.5 / 0.0 ms  (average mu = 0.381, current mu = 0.228) allocation failure\r\n\r\n\r\n<--- JS stacktrace --->\r\n\r\nFATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory\r\n 1: 0xaf9c78 node::Abort() [webpack]\r\n 2: 0xa21a88 node::FatalError(char const*, char const*) [webpack]\r\n 3: 0xccdec8 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [webpack]\r\n```\r\n\r\n**Jenkins ê´€ë¦¬ > ì‹œìŠ¤í…œ ì„¤ì • > Global Properties** ì—ì„œ `NODE_OPTIONS` í™˜ê²½ë³€ìˆ˜ë¥¼ `-max-old-space-size=3072` ë¡œ ì„¤ì •í•˜ì—¬ ë©”ëª¨ë¦¬ ì´ìŠˆë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.\r\n\r\n## ë§ˆì¹˜ë©°\r\n\r\ní˜„ì¬ ìƒì„±ëœ PRì— ëŒ€í•œ ì½”ë“œë¥¼ ê²€ì‚¬í•˜ê³  ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ì§€ ì•Šì€ PRì˜ ë³‘í•©ì„ ë§‰ê¸° ìœ„í•´ Github Actionsë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ ì¡°ê¸ˆ ë” í•™ìŠµí•˜ì—¬ ì´í›„ ì´ëŸ° ì‘ì—…ê¹Œì§€ ì  í‚¨ìŠ¤ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ í•  ê³„íšì´ ìˆìŠµë‹ˆë‹¤.\r\n\r\në˜í•œ í˜„ì¬ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œ ëª¨ë‘ `develop` ì´ë¼ëŠ” í•˜ë‚˜ì˜ ë¸Œëœì¹˜ì—ì„œ ì‘ì—…ì„ í•˜ë‹¤ë³´ë‹ˆ ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ ì–´ëŠ í•œìª½ì˜ ì½”ë“œë§Œ ë³‘í•©ë˜ì–´ë„ ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ ë‘ê°œì˜ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ” ì´ìŠˆê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì´í›„ì—ëŠ” ë¹Œë“œ íŠ¸ë¦¬ê±°ë¥¼ ì¡°ê¸ˆ ë” ì„¸ë¶„í™”í•˜ì—¬ Githubì˜ ë¼ë²¨ì„ ê¸°ë°˜ìœ¼ë¡œ íŠ¸ë¦¬ê±° ë˜ë„ë¡ ê°œì„ í•  ê³„íšì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.\r\n\r\nì—¬ê¸°ê¹Œì§€ ë‹¬ë¡íŒ€ì˜ ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸°ë¥¼ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ™‚\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¬ë¡íŒ€ì´ ë„ì»¤ë¥¼ í™œìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ë„ì»¤ë¥¼ ì„¤ì¹˜í•œ ê³¼ì •ì„ ì´ì•¼ê¸° ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•´ì„œ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œì— ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì„±í•œ ê³¼ì •ì— ëŒ€í•´ ì´ì•¼ê¸° ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ë‹¬ë¡íŒ€ ì§€ì†ì  ë°°í¬ í™˜ê²½ ì¼ë‹¨ í˜„ì¬ êµ¬ì„±ëœ ë‹¬ë¡íŒ€ì˜ â€¦","fields":{"slug":"/continuous-deploy-with-jenkins-1-backend/"},"frontmatter":{"date":"July 24, 2022","title":"ì  í‚¨ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶•ê¸° (1) - ë°±ì—”ë“œí¸","tags":["DevOps"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì•ˆë…•í•˜ì„¸ìš”, ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¬ë¡íŒ€ì´ ë„ì»¤ë¥¼ í™œìš©í•˜ì—¬ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ë„ì»¤ë¥¼ ì„¤ì¹˜í•œ ê³¼ì •ì„ ì´ì•¼ê¸° ë“œë ¸ì—ˆì£ . ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•´ì„œ ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œì— ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì„±í•œ ê³¼ì •ì— ëŒ€í•´ ì´ì•¼ê¸° ë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤.\r\n\r\n## ë‹¬ë¡íŒ€ ì§€ì†ì  ë°°í¬ í™˜ê²½\r\n\r\nì¼ë‹¨ í˜„ì¬ êµ¬ì„±ëœ ë‹¬ë¡íŒ€ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ ê°„ë‹¨í•œ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.\r\n\r\n![ë°±ì—”ë“œ ì§€ì†ì  ë°°í¬ í™˜ê²½](./be.png)\r\n\r\nìš°ì„ , ë‹¬ë¡ì˜ ë°±ì—”ë“œ ê°œë°œìê°€ ì—´ì‹¬íˆ ê¸°ëŠ¥ì„ ê°œë°œí•˜ì—¬ Githubì— PRì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ë•Œ PR ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ê³ , ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ”ì§€ **Github Actions**ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš°ì„ ì ìœ¼ë¡œ ê²€ì‚¬í•©ë‹ˆë‹¤. ì´ë•Œ, PR ë¸Œëœì¹˜ì˜ ì½”ë“œê°€ ë¬¸ì œê°€ ìˆë‹¤ë©´ develop ë¸Œëœì¹˜ë¡œ ë³‘í•©ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\r\n\r\n> ë‹¬ë¡íŒ€ì˜ ë¸Œëœì¹˜ ì „ëµì— ëŒ€í•´ì„œëŠ” ë‹¬ë¡íŒ€ ë§¤íŠ¸ê°€ ì‘ì„±í•œ '[ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤.](https://dallog.github.io/git-branch-strategy/)' í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”!\r\n\r\nì •ìƒì ìœ¼ë¡œ ë¹Œë“œê°€ ë˜ëŠ” ì½”ë“œëŠ” ì´í›„ ë‹¬ë¡ ê°œë°œìë“¤ë¼ë¦¬ ì½”ë“œë¦¬ë·°ê°€ ì§„í–‰ë˜ê³ , develop ë¸Œëœì¹˜ì— ë³‘í•©ì´ ë©ë‹ˆë‹¤. ì´ë•Œ, GithubëŠ” ë‹¬ë¡íŒ€ì´ êµ¬ì¶•í•œ ì  í‚¨ìŠ¤ ì„œë²„ì— **Webhook**ì„ í†µí•´ ë³‘í•© ì‚¬ì‹¤ì„ ì•Œë¦½ë‹ˆë‹¤.\r\n\r\nWebhookì´ë€, íŠ¹ì •í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ **ì´ë²¤íŠ¸ ë°œìƒ ì •ë³´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œê³µí•˜ê¸° ìœ„í•œ ë°©ë²•**ì…ë‹ˆë‹¤. ì  í‚¨ìŠ¤ëŠ” ì™¸ë¶€ì— Webhook URLì„ ì—´ì–´ë‘ê³ , Githubìœ¼ë¡œë¶€í„° ì´ Webhook URLë¡œ ìš”ì²­ì„ ë°›ì•„ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ì¦‰ì‹œ ê·¸ ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\nWebhookì„ í†µí•´ ì‹ í˜¸ë¥¼ ë°›ì€ ì  í‚¨ìŠ¤ëŠ” ë¯¸ë¦¬ ì§€ì •ëœ ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹Œë“œí•˜ì—¬ `jar` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.\r\n\r\nìƒì„±í•œ `jar` íŒŒì¼ì€ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìŠ¤í”„ë§ë¶€íŠ¸ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ `jar` íŒŒì¼ì´ ì‹¤í–‰ë˜ì–´ ë°°í¬ê°€ ì™„ë£Œë©ë‹ˆë‹¤.\r\n\r\n## í”„ë¦¬ìŠ¤íƒ€ì¼ê³¼ íŒŒì´í”„ë¼ì¸\r\n\r\nì  í‚¨ìŠ¤ì—ì„œ ì¡(Job)ì„ ìƒì„±í•˜ëŠ” ë°©ì‹ì€ í¬ê²Œ **í”„ë¦¬ìŠ¤íƒ€ì¼ê³¼ íŒŒì´í”„ë¼ì¸** ë‘ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\r\n\r\n### í”„ë¦¬ìŠ¤íƒ€ì¼\r\n\r\ní”„ë¦¬ìŠ¤íƒ€ì¼ì€ **GUIê¸°ë°˜**ìœ¼ë¡œ ì  í‚¨ìŠ¤ ì¡ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê°„ë‹¨í•œ ì‘ì—…ì— ì í•©í•˜ê³ , **ë³µì¡í•œ ì‘ì—…ì—ëŠ” ë‹¤ì†Œ ì ì ˆì¹˜ ì•ŠìŠµë‹ˆë‹¤.** ë˜í•œ GUI ê¸°ë°˜ì´ë¯€ë¡œ ì„¤ì • ê³¼ì •ì´ ë‹¤ì†Œ ë‚œì¡í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n### íŒŒì´í”„ë¼ì¸\r\n\r\në°˜ë©´ ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì€ ì¼ë ¨ì˜ ë°°í¬ ê³¼ì •ì„ **ì½”ë“œë¡œ ì‘ì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì½”ë“œëŠ” **Jenkinsfile** ë¼ê³  ë¶ˆë¦¬ëŠ” íŒŒì¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆì–´, Git ë“±ì„ í†µí•œ **ë²„ì „ê´€ë¦¬**ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë˜í•œ íŒŒì´í”„ë¼ì¸ì„ ì‚¬ìš©í•˜ë©´ ìŠ¤í…Œì´ì§€(Stage)ë¼ëŠ” ë‹¨ìœ„ë¡œ ê° ì‘ì—…ì— ì†Œìš”ë˜ëŠ” ì‹œê°„, ì‹¤íŒ¨ì—¬ë¶€ë¥¼ **ì‹œê°í™”**í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\në‹¬ë¡ì€ í”„ë¦¬ìŠ¤íƒ€ì¼ ëŒ€ì‹  ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì„ ì´ìš©í•˜ì—¬ ì¡(Job)ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ê°œë°œì ì…ì¥ì—ì„œëŠ” ì•„ë¬´ë˜ë„ GUIë³´ë‹¤ëŠ” ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ì‘ì—… ê³¼ì •ì„ ì‘ì„±í•˜ëŠ” ê²ƒì´ í¸í•˜ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤. ë˜í•œ ì¶”í›„ ë°°í¬ í”„ë¡œì„¸ìŠ¤ ìì²´ë¥¼ Github ì €ì¥ì†Œì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ í° ì¥ì ìœ¼ë¡œ ë‹¤ê°€ì™”ìŠµë‹ˆë‹¤.\r\n\r\n#### Scripted vs Declarative\r\n\r\níŒŒì´í”„ë¼ì¸ë„ ë¬¸ë²•ì— ë”°ë¼ í¬ê²Œ **Scripted Pipeline**ê³¼ **Declarative Pipeline** ë‘ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.\r\n\r\nScriptedëŠ” Groovyë¼ëŠ” ì–¸ì–´ë¡œ ì‘ì„±ë˜ë©°, ë³€ìˆ˜ ì„ ì–¸ë“±ì´ ì§€ì›ë˜ì–´ í”„ë¡œê·¸ë˜ë°ì„ í•  ìˆ˜ ìˆë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤. ë°˜ë©´, DeclarativeëŠ” Scriptedì— ë¹„í•´ ê°„ë‹¨í•˜ë©°, Groovyë¥¼ ì•Œì§€ ì•Šì•„ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. **Scripted ë¬¸ë²•ì€ Declarativeì— ë¹„í•´ ìœ ì—°ì„±ì´ë‚˜ í™•ì¥ì„±ì´ ë†’ì§€ë§Œ, ë³µì¡ë„ì™€ ìœ ì§€ë³´ìˆ˜ ë‚œì´ë„ê°€ ë” ë†’ìŠµë‹ˆë‹¤**.\r\n\r\nìµœê·¼ CI/CD ê¸°ì¡°ëŠ” Declarative ìŠ¤íƒ€ì¼ë¡œ ë§ì´ ì´ë™ë˜ê³  ìˆë‹¤ê³  í•©ë‹ˆë‹¤ ([ì°¸ê³ ](https://www.theserverside.com/answer/Declarative-vs-scripted-pipelines-Whats-the-difference)). ë‹¹ì¥ ë¹„êµì  ìµœê·¼ì— ì¶œì‹œëœ Github Actions ë„ YAML ê¸°ë°˜ì˜ Declarative ìŠ¤íƒ€ì¼ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¬ë¡íŒ€ì€ Declarative ë¬¸ë²•ì„ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ì¡(Job) ìƒì„± ë° ì„¸íŒ…\r\n\r\n### íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ìƒì„±\r\n\r\n![](./pipeline.png)\r\n\r\nì  í‚¨ìŠ¤ ë©”ë‰´ì—ì„œ 'ìƒˆë¡œìš´ Item'ì„ í´ë¦­í•˜ê³ , 'Pipeline'ì„ ì„ íƒí•˜ì—¬ ìƒˆë¡œìš´ ì¡ì„ ìƒì„±í•©ë‹ˆë‹¤.\r\n\r\n### Github URL ì„¤ì •\r\n\r\n**General > GitHub project > Project url** ì— ì €í¬ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ì£¼ì†Œì¸ **https://github.com/woowacourse-teams/2022-dallog** ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.\r\n\r\n### ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ\r\n\r\në¹Œë“œ ì´ë ¥ì„ ì˜¤ë˜ ê°€ì§€ê³  ìˆì–´ë´¤ì í° ì˜ë¯¸ê°€ ì—†ì„ ê²ƒ ê°™ê¸°ë„ í•˜ê³ , ì•„ë¬´ë˜ë„ **t4g.micro** ì—ì„œ ëŒë¦¬ë‹¤ë³´ë‹ˆ ìš©ëŸ‰ì´ ë„‰ë„‰ì¹˜ ì•Šê¸°ë„ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ **General > ì˜¤ë˜ëœ ë¹Œë“œ ì‚­ì œ** ì˜µì…˜ì„ í´ë¦­í•˜ì—¬ í™œì„±í™”í•˜ê³ , ë³´ê´€í•  ìµœëŒ€ ê°¯ìˆ˜ë¥¼ 3ìœ¼ë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\r\n\r\n> ë‚˜ì¤‘ì— ë¹Œë“œ ì´ë ¥ ë³´ê´€ ê°œìˆ˜ê°€ ë„ˆë¬´ ì ë‹¤ê³  íŒë‹¨ë˜ë©´ ì¡°ê¸ˆ ë” ëŠ˜ë¦´ ìƒê°ì…ë‹ˆë‹¤ ğŸ™‚\r\n\r\n### ë¹Œë“œ íŠ¸ë¦¬ê±° ì„¤ì •\r\n\r\n**Build Triggers > GitHub hook trigger for GITScm polling** ì„ ì²´í¬í•´ì¤ë‹ˆë‹¤. Githubì˜ Webhookì„ í†µí•´ ë¹Œë“œê°€ íŠ¸ë¦¬ê±°ë˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.\r\n\r\n> ì´ ê¸°ëŠ¥ì€ **GitHub plugin**ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ìµœì´ˆ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í–ˆì„ ë•Œ Install suggested plugins ë¥¼ ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì´ í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ì–´ìˆì§€ ì•Šì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\r\n\r\n#### Github ì €ì¥ì†Œì— Webhook ë“±ë¡í•˜ê¸°\r\n\r\nWebhookì„ ì‚¬ìš©í•˜ë ¤ë©´ Github ì €ì¥ì†Œì˜ Settings > Webhooks ì—ì„œ Webhook URLì„ ë“±ë¡í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.\r\n\r\n```\r\nhttp://{ì„œë¹„ìŠ¤ IP í˜¹ì€ ë„ë©”ì¸ ì£¼ì†Œ}/github-webhook/\r\n```\r\n\r\nìœ„ì™€ ê°™ì´ URLì„ ë“±ë¡í•´ì¤ë‹ˆë‹¤. ì´ë•Œ URLì˜ ë§ˆì§€ë§‰ì— `/`ê°€ ë“¤ì–´ê°€ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë‹ˆ ê¼­ ì¶”ê°€í•©ë‹ˆë‹¤.\r\n\r\n## íŒŒì´í”„ë¼ì¸ ì‘ì„±\r\n\r\nì´ì œ ë¹Œë“œê°€ íŠ¸ë¦¬ê±° ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë  íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ì°¨ë¡€ì…ë‹ˆë‹¤.\r\n\r\n```groovy\r\npipeline {\r\n   agent any\r\n   stages {\r\n       stage('Github') {\r\n           steps {\r\n               git branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\r\n           }\r\n       }\r\n       stage('Build') {\r\n           steps {\r\n               dir('backend') {\r\n                   sh \"./gradlew bootJar\"\r\n               }\r\n           }\r\n       }\r\n       stage('Deploy') {\r\n           steps {\r\n               dir('backend/build/libs') {\r\n                   sshagent(credentials: ['key-dallog']) {\r\n                        sh 'scp backend-0.0.1-SNAPSHOT.jar ubuntu@192.168.XXX.XXX:/home/ubuntu'\r\n                        sh 'ssh ubuntu@192.168.XXX.XXX \"sh run.sh\" &'\r\n                   }\r\n               }\r\n           }\r\n       }\r\n   }\r\n}\r\n```\r\n\r\n### Github stage\r\n\r\nGithub stageì—ì„œëŠ” ì‚¬ìš©í•  ê¹ƒí—ˆë¸Œì˜ ì €ì¥ì†Œ ì£¼ì†Œì™€ ë¸Œëœì¹˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì  í‚¨ìŠ¤ëŠ” ì´ ìŠ¤í…Œì´ì§€ì— ëª…ì‹œëœ ì €ì¥ì†Œì™€ ë¸Œëœì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\n\r\n### Build stage\r\n\r\n`gradlew` íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë¹Œë“œí•©ë‹ˆë‹¤. ì´ë•Œ, `dir` ì§€ì‹œì–´(Directive)ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª…ë ¹ì„ ìˆ˜í–‰í•  ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n### Deploy stage\r\n\r\n> ì´ ì‘ì—…ì„ ìœ„í•´ì„œ ì‚¬ì „ì— Jenkins ê´€ë¦¬ > Manage Credentials ì—ì„œ 'SSH Username with private key' ë¡œ AWSì—ì„œ ë°œê¸‰ ë°›ì€ PEM í‚¤ë¥¼ ë¨¼ì € ë“±ë¡í•´ì•¼í•©ë‹ˆë‹¤.\r\n\r\në‹¬ë¡íŒ€ì€ SSH Agent í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ ì„œë²„ì— ì›ê²©ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤. SSH Agent í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì´í”„ë¼ì¸ì—ì„œ ì  í‚¨ìŠ¤ì— ë“±ë¡í•´ë‘” SSH ìê²©ì¦ëª…ì„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë©´ `sshagent` ë¼ëŠ” Directiveë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì¸ìë¡œ ì‚¬ì „ì— ì  í‚¨ìŠ¤ Credentialë¡œ ë“±ë¡í•œ PEMí‚¤ì˜ ì´ë¦„ì„ ë„£ì–´ì¤ë‹ˆë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ `sshagent` Directive Block ë‚´ë¶€ì—ì„œ `sh` ë¥¼ í†µí•´ `ssh` ê´€ë ¨ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n#### jar íŒŒì¼ ì „ì†¡\r\n\r\nSCP(Secure Copy)ëŠ” SSH í†µì‹  ê¸°ë°˜ìœ¼ë¡œ ì›ê²©ì§€ì— íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆëŠ” í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” `scp` ëª…ë ¹ì„ í†µí•´ SCP í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¬ë¡íŒ€ì€ ì´ `scp` ëª…ë ¹ì„ í†µí•´ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¹Œë“œëœ `jar` íŒŒì¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.\r\n\r\n> ì—¬ê¸°ì„œ IPì£¼ì†Œê°€ í”„ë¼ì´ë¹— IPë¡œ ì í˜€ìˆìŠµë‹ˆë‹¤. ìš°í…Œì½”ì—ì„œ ì œê³µë˜ëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ë³´ì•ˆê·¸ë£¹ ì„¤ì •ìƒ ì ì‹¤ ë° ì„ ë¦‰ ìº í¼ìŠ¤ì˜ IPë¡œë§Œ SSH(22ë²ˆ í¬íŠ¸) ì¸ë°”ìš´ë“œê°€ í—ˆìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í¼ë¸”ë¦­ IP ëŒ€ì‹  í”„ë¼ì´ë¹— IPë¡œ ì§€ì •í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. í”„ë¼ì´ë¹— IPë¥¼ ì‚¬ìš©í•´ë„ ë‘ EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ì€ VPCì— ì¡´ì¬í•˜ë¯€ë¡œ ì •ìƒì ìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\r\n\r\n#### ì›ê²©ì§€ì˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰\r\n\r\nìŠ¤í”„ë§ë¶€íŠ¸ ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” ì‚¬ì „ì— `run.sh` ë¼ëŠ” ì´ë¦„ì˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì œê±°í•˜ê³ , í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ê³ , ê°™ì€ ë””ë ‰í† ë¦¬ì— ìˆëŠ” `jar` íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\r\n\r\n```shell\r\n#! /bin/bash\r\n\r\nPROJECT_NAME=backend\r\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\r\n\r\nif [ -z \"$CURRENT_PID\" ]; then\r\n    echo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\r\nelse\r\n    echo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\r\n    kill -15 $CURRENT_PID\r\nfi\r\n\r\necho \"\\nğŸŒˆ SpringBoot í™˜ê²½ë³€ìˆ˜ ì„¤ì •\"\r\n\r\nexport GOOGLE_CLIENT_ID=\"XXXXXXXXXXXXXX\"\r\nexport GOOGLE_CLIENT_SECRET=\"XXXXXXXXXXXXXX\"\r\nexport GOOGLE_REDIRECT_URI=\"XXXXXXXXXXXXXX\"\r\nexport GOOGLE_TOKEN_URI=\"XXXXXXXXXXXXXX\"\r\nexport JWT_EXPIRE_LENGTH=86400000\r\nexport JWT_SECRET_KEY=\"XXXXXXXXXXXXXX\"\r\n\r\necho \"\\nğŸŒˆ SpringBoot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\\n\"\r\n\r\nJAR_NAME=$(ls | grep .jar | head -n 1)\r\nsudo -E nohup java -jar /home/ubuntu/$JAR_NAME &\r\n```\r\n\r\nì§€ë‚œ í¬ìŠ¤íŒ…ì¸ **[ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ë‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìë™í™”](/deploy-automation-with-shell-script)** ì—ì„œ ì†Œê°œë“œë¦° ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì†ŒìŠ¤ì½”ë“œë¥¼ Pull í•´ì˜¤ê³  ë¹Œë“œí•˜ëŠ” ê³¼ì •ë§Œ ì‚¬ë¼ì§„ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.\r\n\r\nì´ ì›ê²©ì§€ì— ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ `ssh` ëª…ë ¹ì„ í†µí•´ ì‹¤í–‰í•˜ê²Œë˜ë©´ ë°°í¬ê³¼ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤.\r\n\r\n## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…\r\n\r\n### Webhook íŠ¸ë¦¬ê±° ì´ìŠˆ\r\n\r\nì²˜ìŒ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì •í•  ë•Œ ì•„ë¬´ë¦¬ Webhook ì„¤ì •ì„ ê±´ë“œë ¤ë´ë„ ë¹Œë“œê°€ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ë°œìƒí–ˆì—ˆìŠµë‹ˆë‹¤.\r\n\r\në¨¼ì € ìœ„ íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì˜ Github ìŠ¤í…Œì´ì§€ì—ì„œ ì‚¬ìš©ëœ `git` Directiveë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.\r\n\r\n```\r\ngit branch: 'develop', url: 'https://github.com/woowacourse-teams/2022-dallog.git'\r\n```\r\n\r\në˜í•œ ìµœì´ˆë¡œ 'ì§€ê¸ˆ ë¹Œë“œ' ë²„íŠ¼ì„ í´ë¦­í•´ì•¼ì§€ ê·¸ ì´í›„ Webhook ìš”ì²­ì„ ìˆ˜ì‹ í•  ìˆ˜ ìˆê²Œë©ë‹ˆë‹¤.\r\n\r\n### SSH ìê²© ì¦ëª… ì´ìŠˆ\r\n\r\n```\r\nHost key verification failed.\r\nlost connection\r\n```\r\n\r\nì  í‚¨ìŠ¤ ì„œë²„ì—ì„œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì— ìµœì´ˆë¡œ SSH ì—°ê²°ì„ ì‹œë„í•  ê²½ìš° ì  í‚¨ìŠ¤ì—ì„œ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë“¤ SSHë¡œ ìµœì´ˆ ì›ê²©ì ‘ì† ì‹œ ì•„ë˜ì™€ ê°™ì€ ë©”ì‹œì§€ë¥¼ ë³¸ ì ì´ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤.\r\n\r\n```\r\nroot@XXXXXXXX:/home# ssh -i key.pem ubuntu@192.168.XXX.XXX\r\nThe authenticity of host '192.168.XXX.XXX (192.168.XXX.XXX)' can't be established.\r\nECDSA key fingerprint is SHA256:XXXXXXXXXXXXXXXX\r\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\r\n```\r\n\r\ní„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì ‘ì†í•  ë•Œì—ëŠ” yes ë¥¼ ì…ë ¥í•˜ë©´, ê³§ë°”ë¡œ ì ‘ì†ë í…ë°ìš”. ì  í‚¨ìŠ¤ íŒŒì´í”„ë¼ì¸ì—ì„œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë¯¸ë¦¬ ì  í‚¨ìŠ¤ ì¸¡ì˜ `known_hosts` ì— ì›ê²©ì§€ì˜ ê³µê°œí‚¤ë¥¼ ë“±ë¡í•´ì•¼í•©ë‹ˆë‹¤.\r\n\r\n`keyscan` ëª…ë ¹ì„ í†µí•´ì„œ í˜¸ìŠ¤íŠ¸ì˜ ê³µê°œí‚¤ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª…ë ¹ì„ í†µí•´ì„œ `~/.ssh/known_hosts` ì— ì ‘ì†í•  í˜¸ìŠ¤íŠ¸ì˜ ê³µê°œí‚¤ë¥¼ ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.\r\n\r\n## ë§ˆì¹˜ë©°\r\n\r\nì´ë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì  í‚¨ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ìŠ¤í”„ë§ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì§€ì†ì  ë°°í¬ í™˜ê²½ì„ êµ¬ì¶•í•œ ë°©ë²•ì„ ì†Œê°œë“œë ¸ìŠµë‹ˆë‹¤. ì´ì–´ì§€ëŠ” ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡íŒ€ì˜ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ í™˜ê²½ê³¼ ì§€ì†ì  ë°°í¬ í™˜ê²½ êµ¬ì¶• ë°©ë²•ì„ ì†Œê°œë“œë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ˜„\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ 'ë§¤íŠ¸'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸° ë„ë©”ì¸ ë¡œì§ì€ ìš°ë¦¬ê°€ ì§€ì¼œì•¼í•  ë§¤ìš° ì†Œì¤‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë“¤ì´ ë‹´ê²¨ìˆë‹¤. ì´ëŸ¬í•œ ë„ë©”ì¸ ë¡œì§ë“¤ì€ ë³€ê²½ì´ ìµœì†Œí™”ë˜ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™” í•´ì•¼ í•œë‹¤.  ì¸í„°í˜ì´ìŠ¤ í™œìš©í•˜ê¸° ìš°ì„  ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ê²ƒ ì¤‘ ê°ì²´ ê°„ì˜ ì˜ì¡´ì„±ì„ ì•½í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆëŠ” ìˆ˜â€¦","fields":{"slug":"/separated-interface/"},"frontmatter":{"date":"July 24, 2022","title":"ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°","tags":["ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤","ì˜ì¡´ì„± ë¶„ë¦¬"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ '[ë§¤íŠ¸](https://github.com/hyeonic)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°\r\n\r\në„ë©”ì¸ ë¡œì§ì€ ìš°ë¦¬ê°€ ì§€ì¼œì•¼í•  ë§¤ìš° ì†Œì¤‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë“¤ì´ ë‹´ê²¨ìˆë‹¤. ì´ëŸ¬í•œ ë„ë©”ì¸ ë¡œì§ë“¤ì€ ë³€ê²½ì´ ìµœì†Œí™”ë˜ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™” í•´ì•¼ í•œë‹¤. \r\n\r\n### ì¸í„°í˜ì´ìŠ¤ í™œìš©í•˜ê¸°\r\n\r\nìš°ì„  ìš°ë¦¬ê°€ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ê²ƒ ì¤‘ ê°ì²´ ê°„ì˜ ì˜ì¡´ì„±ì„ ì•½í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ `JpaRepository`ë¥¼ ì‚´í´ë³´ì.\r\n\r\n```java\r\npublic interface MemberRepository extends JpaRepository<Member, Long> {\r\n\r\n    Optional<Member> findByEmail(final String email);\r\n\r\n    boolean existsByEmail(final String email);\r\n}\r\n```\r\n\r\nì´ëŸ¬í•œ ì¸í„°í˜ì´ìŠ¤ ë•ë¶„ì— ìš°ë¦¬ëŠ” ì‹¤ì œ DBì— ì ‘ê·¼í•˜ëŠ” ë‚´ë¶€ êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë°ì´í„°ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤. í•µì‹¬ì€ `ì‹¤ì œ DBì— ì ‘ê·¼í•˜ëŠ” í–‰ìœ„`ì´ë‹¤.\r\n\r\nì•„ë˜ëŠ” `Spring Data`ê°€ ë§Œë“  `JpaRepositoryì˜ êµ¬í˜„ì²´` `SimpleJpaRepository`ì˜ ì¼ë¶€ë¥¼ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤.\r\n\r\n```java\r\n@Repository\r\n@Transactional(readOnly = true)\r\npublic class SimpleJpaRepository<T, ID> implements JpaRepositoryImplementation<T, ID> {\r\n\r\n\tprivate static final String ID_MUST_NOT_BE_NULL = \"The given id must not be null!\";\r\n\r\n\tprivate final JpaEntityInformation<T, ?> entityInformation;\r\n\tprivate final EntityManager em;\r\n\tprivate final PersistenceProvider provider;\r\n\r\n\tprivate @Nullable CrudMethodMetadata metadata;\r\n\tprivate EscapeCharacter escapeCharacter = EscapeCharacter.DEFAULT;\r\n\r\n\tpublic SimpleJpaRepository(JpaEntityInformation<T, ?> entityInformation, EntityManager entityManager) {\r\n\r\n\t\tAssert.notNull(entityInformation, \"JpaEntityInformation must not be null!\");\r\n\t\tAssert.notNull(entityManager, \"EntityManager must not be null!\");\r\n\r\n\t\tthis.entityInformation = entityInformation;\r\n\t\tthis.em = entityManager;\r\n\t\tthis.provider = PersistenceProvider.fromEntityManager(entityManager);\r\n\t}\r\n  ...\r\n}\r\n```\r\n\r\ní•´ë‹¹ êµ¬í˜„ì²´ëŠ” `entityManger`ë¥¼ í†µí•´ ê°ì²´ë¥¼ ì˜ì† ì‹œí‚¤ëŠ” í–‰ìœ„ë¥¼ ì§„í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— `ì˜ì† ê³„ì¸µ`ì— ê°€ê¹ë‹¤ê³  íŒë‹¨í–ˆë‹¤. ì¦‰ ë„ë©”ì¸ì˜ ì…ì¥ì—ì„œ `MemberRepository`ë¥¼ ë°”ë¼ë³¼ ë•Œ ë‹¨ìˆœíˆ `JpaRepository`ë¥¼ ìƒì†í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— `ì˜ì† ê³„ì¸µ`ì— ëŒ€í•œ ì§ì ‘ì ì¸ ì˜ì¡´ì„±ì€ ì—†ë‹¤ê³  ë´ë„ ë¬´ë°©í•˜ë‹¤. ì •ë¦¬í•˜ë©´ ìš°ë¦¬ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì‹¤ì œ êµ¬í˜„ì²´ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ëœë‹¤. \r\n\r\n### ê´€ì  ë³€ê²½í•˜ê¸°\r\n\r\nì´ëŸ¬í•œ ì‚¬ë¡€ë¥¼ ì™¸ë¶€ ì„œë²„ì™€ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“  ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient`ì— ëŒ€ì…í•´ë³¸ë‹¤. `OAuthClient`ì˜ ê°€ì¥ í° ì—­í• ì€ nì˜ ì†Œì…œì—ì„œ `OAuth 2.0`ì„ í™œìš©í•œ ì¸ì¦ì˜ í–‰ìœ„ë¥¼ ì •ì˜í•œ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. google, github ë“± ê°ìì— ë§ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ `OAuthClient`ë¥¼ êµ¬í˜„í•œ ë’¤ ë¡œì§ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ googleì˜ ì¸ê°€ ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í† í° ì •ë³´ì—ì„œ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë¡œì§ì„ ë‹´ê³  ìˆë‹¤.\r\n\r\n```java\r\npublic interface OAuthClient {\r\n\r\n    OAuthMember getOAuthMember(final String code);\r\n}\r\n```\r\n\r\n```java\r\n@Component\r\npublic class GoogleOAuthClient implements OAuthClient {\r\n\r\n    private static final String JWT_DELIMITER = \"\\\\.\";\r\n\r\n    private final String googleRedirectUri;\r\n    private final String googleClientId;\r\n    private final String googleClientSecret;\r\n    private final String googleTokenUri;\r\n    private final RestTemplate restTemplate;\r\n    private final ObjectMapper objectMapper;\r\n\r\n    public GoogleOAuthClient(@Value(\"${oauth.google.redirect_uri}\") final String googleRedirectUri,\r\n                             @Value(\"${oauth.google.client_id}\") final String googleClientId,\r\n                             @Value(\"${oauth.google.client_secret}\") final String googleClientSecret,\r\n                             @Value(\"${oauth.google.token_uri}\") final String googleTokenUri,\r\n                             final RestTemplate restTemplate, final ObjectMapper objectMapper) {\r\n        this.googleRedirectUri = googleRedirectUri;\r\n        this.googleClientId = googleClientId;\r\n        this.googleClientSecret = googleClientSecret;\r\n        this.googleTokenUri = googleTokenUri;\r\n        this.restTemplate = restTemplate;\r\n        this.objectMapper = objectMapper;\r\n    }\r\n\r\n    @Override\r\n    public OAuthMember getOAuthMember(final String code) {\r\n        GoogleTokenResponse googleTokenResponse = requestGoogleToken(code);\r\n        String payload = getPayloadFrom(googleTokenResponse.getIdToken());\r\n        String decodedPayload = decodeJwtPayload(payload);\r\n\r\n        try {\r\n            return generateOAuthMemberBy(decodedPayload);\r\n        } catch (JsonProcessingException e) {\r\n            throw new IllegalArgumentException();\r\n        }\r\n    }\r\n\r\n    private GoogleTokenResponse requestGoogleToken(final String code) {\r\n        HttpHeaders headers = new HttpHeaders();\r\n        headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);\r\n        MultiValueMap<String, String> params = generateRequestParams(code);\r\n\r\n        HttpEntity<MultiValueMap<String, String>> request = new HttpEntity<>(params, headers);\r\n        return restTemplate.postForEntity(googleTokenUri, request, GoogleTokenResponse.class).getBody();\r\n    }\r\n\r\n    private MultiValueMap<String, String> generateRequestParams(final String code) {\r\n        MultiValueMap<String, String> params = new LinkedMultiValueMap<>();\r\n        params.add(\"client_id\", googleClientId);\r\n        params.add(\"client_secret\", googleClientSecret);\r\n        params.add(\"code\", code);\r\n        params.add(\"grant_type\", \"authorization_code\");\r\n        params.add(\"redirect_uri\", googleRedirectUri);\r\n        return params;\r\n    }\r\n\r\n    private String getPayloadFrom(final String jwt) {\r\n        return jwt.split(JWT_DELIMITER)[1];\r\n    }\r\n\r\n    private String decodeJwtPayload(final String payload) {\r\n        return new String(Base64.getUrlDecoder().decode(payload), StandardCharsets.UTF_8);\r\n    }\r\n\r\n    private OAuthMember generateOAuthMemberBy(final String decodedIdToken) throws JsonProcessingException {\r\n        Map<String, String> userInfo = objectMapper.readValue(decodedIdToken, HashMap.class);\r\n        String email = userInfo.get(\"email\");\r\n        String displayName = userInfo.get(\"name\");\r\n        String profileImageUrl = userInfo.get(\"picture\");\r\n\r\n        return new OAuthMember(email, displayName, profileImageUrl);\r\n    }\r\n}\r\n```\r\n\r\në³´í†µì˜ ìƒê°ì€ ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient`ì™€ êµ¬í˜„ì²´ì¸ `GoogleOAuthClient`ë¥¼ ê°™ì€ íŒ¨í‚¤ì§€ì— ë‘ë ¤ê³  í•  ê²ƒì´ë‹¤. `GoogleOAuthClient`ëŠ” ì™¸ë¶€ ì˜ì¡´ì„±ì„ ê°•í•˜ê²Œ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— `domain` íŒ¨í‚¤ì§€ì™€ ë³„ë„ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ `infrastructure` íŒ¨í‚¤ì§€ê°€ ì í•©í•  ê²ƒì´ë‹¤. ê²°êµ­ ì¸í„°í˜ì´ìŠ¤ì¸ `OAuthClient` ë˜í•œ `infrastructure`ì— ìœ„ì¹˜í•˜ê²Œ ë  ê²ƒì´ë‹¤. ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ìƒê°ì—ì„œ ë²—ì–´ë‚˜ ìƒˆë¡œìš´ ê´€ì ì—ì„œ ì‚´í´ë´ì•¼ í•œë‹¤.\r\n\r\nì•ì„œ ì–¸ê¸‰í•œ ì˜ì¡´ì„±ì— ëŒ€í•´ ìƒê°í•´ë³´ì. ìœ„ `OAuthClient`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ì²´ëŠ” ëˆ„êµ¬ì¼ê¹Œ? ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ì£¼ì²´ë¥¼ `domain` ë‚´ì— ì¸ì¦ì„ ë‹´ë‹¹í•˜ëŠ” `auth` íŒ¨í‚¤ì§€ ë‚´ë¶€ì˜ `Authservice`ë¡œ ê²°ì • í–ˆë‹¤. ì•„ë˜ëŠ” ì‹¤ì œ `OAuthClient`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì£¼ì²´ì¸ `AuthService`ì´ë‹¤.\r\n\r\n```java\r\n@Transactional(readOnly = true)\r\n@Service\r\npublic class AuthService {\r\n\r\n    private final OAuthEndpoint oAuthEndpoint;\r\n    private final OAuthClient oAuthClient;\r\n    private final MemberService memberService;\r\n    private final JwtTokenProvider jwtTokenProvider;\r\n\r\n    public AuthService(final OAuthEndpoint oAuthEndpoint, final OAuthClient oAuthClient,\r\n                       final MemberService memberService, final JwtTokenProvider jwtTokenProvider) {\r\n        this.oAuthEndpoint = oAuthEndpoint;\r\n        this.oAuthClient = oAuthClient;\r\n        this.memberService = memberService;\r\n        this.jwtTokenProvider = jwtTokenProvider;\r\n    }\r\n\r\n    public String generateGoogleLink() {\r\n        return oAuthEndpoint.generate();\r\n    }\r\n\r\n    @Transactional\r\n    public TokenResponse generateTokenWithCode(final String code) {\r\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\r\n        String email = oAuthMember.getEmail();\r\n\r\n        if (!memberService.existsByEmail(email)) {\r\n            memberService.save(generateMemberBy(oAuthMember));\r\n        }\r\n\r\n        Member foundMember = memberService.findByEmail(email);\r\n        String accessToken = jwtTokenProvider.createToken(String.valueOf(foundMember.getId()));\r\n\r\n        return new TokenResponse(accessToken);\r\n    }\r\n\r\n    private Member generateMemberBy(final OAuthMember oAuthMember) {\r\n        return new Member(oAuthMember.getEmail(), oAuthMember.getProfileImageUrl(), oAuthMember.getDisplayName(), SocialType.GOOGLE);\r\n    }\r\n}\r\n```\r\n\r\nì§€ê¸ˆ ê¹Œì§€ ì„¤ëª…í•œ êµ¬ì¡°ì˜ íŒ¨í‚¤ì§€ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.\r\n\r\n```\r\nâ””â”€â”€ src\r\n    â”œâ”€â”€ main\r\n    â”‚   â”œâ”€â”€ java\r\n    â”‚   â”‚   â””â”€â”€ com\r\n    â”‚   â”‚       â””â”€â”€ allog\r\n    â”‚   â”‚           â””â”€â”€ dallog\r\n    â”‚   â”‚               â”œâ”€â”€ auth\r\n    â”‚   â”‚               â”‚   â””â”€â”€ application\r\n    â”‚   â”‚               â”‚       â””â”€â”€ AuthService.java\r\n    â”‚   â”‚               ...\r\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ oauth\r\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ client\r\n    â”‚   â”‚               â”‚   â”‚       â”œâ”€â”€ OAuthClient.java\r\n    â”‚   â”‚               â”‚   â”‚       â””â”€â”€ GoogleOAuthClient.java\r\n    â”‚   â”‚               â”‚   â””â”€â”€ dto\r\n    â”‚   â”‚               â”‚       â””â”€â”€ OAuthMember.java     \r\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\r\n    |   |\r\n    â”‚   â””â”€â”€ resources\r\n    â”‚       â””â”€â”€ application.yml\r\n```\r\n\r\nê²°êµ­ ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì´ `domain` íŒ¨í‚¤ì§€ì—ì„œ `infrastructure`ì— ì˜ì¡´í•˜ê²Œ ëœë‹¤.\r\n  \r\n```java\r\n...\r\nimport com.allog.dallog.infrastructure.dto.OAuthMember; // ì˜ì¡´ì„± ë°œìƒ!\r\nimport com.allog.dallog.infrastructure.oauth.client.OAuthClient; // ì˜ì¡´ì„± ë°œìƒ!\r\n...\r\n\r\n@Transactional(readOnly = true)\r\n@Service\r\npublic class AuthService {\r\n\t...\r\n    private final OAuthClient oAuthClient;\r\n    ...\r\n\r\n    @Transactional\r\n    public TokenResponse generateTokenWithCode(final String code) {\r\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\r\n        ...\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\n### Separated Interface Pattern\r\n\r\n`ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤`ë¥¼ í™œìš©í•˜ì. ì¦‰ `ì¸í„°í˜ì´ìŠ¤`ì™€ `êµ¬í˜„ì²´`ë¥¼ ê°ê°ì˜ íŒ¨í‚¤ì§€ë¡œ ë¶„ë¦¬í•œë‹¤. ë¶„ë¦¬ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ `domain` íŒ¨í‚¤ì§€ì—ì„œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³  `infrastructure` íŒ¨í‚¤ì§€ì— êµ¬í˜„ì²´ë¥¼ ë‘”ë‹¤. ì´ë ‡ê²Œ êµ¬ì„±í•˜ë©´ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ì¢…ì†ì„±ì„ ê°€ì§„ ì£¼ì²´ê°€ êµ¬í˜„ì²´ì— ëŒ€í•´ ì¸ì‹í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.\r\n\r\nì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ë¥¼ ë¶„ë¦¬í–ˆë‹¤ê³  ê°€ì •í•œë‹¤.\r\n\r\n```\r\nâ””â”€â”€ src\r\n    â”œâ”€â”€ main\r\n    â”‚   â”œâ”€â”€ java\r\n    â”‚   â”‚   â””â”€â”€ com\r\n    â”‚   â”‚       â””â”€â”€ allog\r\n    â”‚   â”‚           â””â”€â”€ dallog\r\n    â”‚   â”‚               â”œâ”€â”€ auth\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ AuthService.java\r\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ OAuthClient.java\r\n    â”‚   â”‚               â”‚   â””â”€â”€ dto\r\n    â”‚   â”‚               â”‚       â””â”€â”€ OAuthMember.java         \r\n    â”‚   â”‚               ...\r\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ oauth\r\n    â”‚   â”‚               â”‚       â””â”€â”€ client\r\n    â”‚   â”‚               â”‚           â””â”€â”€ GoogleOAuthClient.java\r\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\r\n    |   |\r\n    â”‚   â””â”€â”€ resources\r\n    â”‚       â””â”€â”€ application.yml\r\n```\r\n\r\nìì—°ìŠ¤ëŸ½ê²Œ `domain` ë‚´ì— ìˆë˜ `infrastructure` íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì˜ì¡´ì„±ë„ ì œê±°ëœë‹¤. ì¦‰ ì™¸ë¶€ ì„œë²„ì™€ì˜ í†µì‹ ì„ ìœ„í•œ ì˜ì¡´ì„±ì´ ì™„ì „íˆ ë¶„ë¦¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\r\n\r\n```java\r\n...\r\nimport com.allog.dallog.auth.dto.OAuthMember; // auth íŒ¨í‚¤ì§€ ë‚´ë¶€ë¥¼ ì˜ì¡´\r\n...\r\n@Transactional(readOnly = true)\r\n@Service\r\npublic class AuthService {\r\n\t...\r\n    private final OAuthClient oAuthClient;\r\n    ...\r\n\r\n    @Transactional\r\n    public TokenResponse generateTokenWithCode(final String code) {\r\n        OAuthMember oAuthMember = oAuthClient.getOAuthMember(code);\r\n        ...\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\n## References.\r\n\r\n[Separated Interface](https://www.martinfowler.com/eaaCatalog/separatedInterface.htmlhttps://www.martinfowler.com/eaaCatalog/separatedInterface.html)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì—ì„œëŠ” ì €ëŠ” ë°°í¬ì™€ CI/CDì™€ ê°™ì´ ì¸í”„ë¼ì™€ ê´€ë ¨ëœ íƒœìŠ¤í¬ì— ì§‘ì¤‘í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë°°í¬ ìë™í™”ë¥¼ êµ¬ì¶•í•œ ì´ì•¼ê¸°ë¥¼ í–ˆì—ˆì£ . í•˜ì§€ë§Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë³‘í•©ë  ë•Œ ë§ˆë‹¤ SSHë¡œ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼â€¦","fields":{"slug":"/install-jenkins-with-docker-on-ec2/"},"frontmatter":{"date":"July 21, 2022","title":"EC2 í™˜ê²½ì—ì„œ ë„ì»¤ë¥¼ í™œìš©í•œ ì  í‚¨ìŠ¤ ì„¤ì¹˜í•˜ê¸°","tags":["DevOps","Jenkins"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì•ˆë…•í•˜ì„¸ìš”, ìš°í…Œì½” ë‹¬ë¡íŒ€ í›„ë””ì…ë‹ˆë‹¤. ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì—ì„œëŠ” ì €ëŠ” ë°°í¬ì™€ CI/CDì™€ ê°™ì´ ì¸í”„ë¼ì™€ ê´€ë ¨ëœ íƒœìŠ¤í¬ì— ì§‘ì¤‘í•˜ê³  ìˆìŠµë‹ˆë‹¤.\r\n\r\nì§€ë‚œë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‹¬ë¡íŒ€ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë°°í¬ ìë™í™”ë¥¼ êµ¬ì¶•í•œ ì´ì•¼ê¸°ë¥¼ í–ˆì—ˆì£ . í•˜ì§€ë§Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë³‘í•©ë  ë•Œ ë§ˆë‹¤ SSHë¡œ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ **ë§¤ë²ˆ ì‹¤í–‰í•´ì•¼í•œë‹¤ëŠ” ë‹¨ì **ì´ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ íŒ€ì€ ë©”ì¸ ë¸Œëœì¹˜ì— ê¸°ëŠ¥ì´ ìƒˆë¡œ ë³‘í•© ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê³ , ìŠ¤í”„ë§ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ `jar` íŒŒì¼ë¡œ ë¹Œë“œí•˜ì—¬ ë°°í¬í•˜ëŠ” í™˜ê²½ì´ í•„ìš”í•˜ë‹¤ê³  ëŠê¼ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ **CI/CD ë„êµ¬ë¥¼ ë„ì…**í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡ì´ EC2 í™˜ê²½ì—ì„œ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•œ ë°©ë²•ì— ëŒ€í•´ì„œ ì •ë¦¬í•©ë‹ˆë‹¤.\r\n\r\n## ì  í‚¨ìŠ¤ ë„ì… ë°°ê²½\r\n\r\n![ìœ ëª…í•œ CI/CD ë„êµ¬ë“¤ì˜ êµ¬ê¸€ íŠ¸ë Œë“œ ê²°ê³¼](./google-trends.png)\r\n\r\në‹¬ë¡ì€ CI/CD ë„êµ¬ë¡œ **Jenkins**ë¥¼ ì„ ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ìœ„ ì‚¬ì§„ì€ ì‹œì¤‘ì— ë°°í¬ë˜ì–´ìˆëŠ” ì—¬ëŸ¬ CI/CD ë„êµ¬ì˜ êµ¬ê¸€ íŠ¸ë Œë“œ ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤. íŒŒë€ìƒ‰ì´ Jenkins ì¸ë°ìš”, **ì••ë„ì ìœ¼ë¡œ ë†’ì€ ê´€ì‹¬ë„**ë¥¼ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.\r\n\r\nì•„ë¬´ë˜ë„ ë‹¬ë¡íŒ€ ëª¨ë‘ê°€ CI/CDì— ìµìˆ™í•˜ì§€ ì•Šì•„ ê°€ì¥ ì‚¬ëŒë“¤ì´ ë§ì´ ì‚¬ìš©í•˜ê³ , ê·¸ì— ë”°ë¼ **ìƒíƒœê³„ê°€ ë„“ê³  ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ì€ ë„êµ¬**ë¥¼ ì„ ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤. **ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ì•„** ì´ˆê¸° í•™ìŠµ ë¹„ìš©ì´ ì ê²Œ ë“¤ê³ , ì´ìŠˆê°€ ë°œìƒí–ˆì„ë•Œì—ë„ **íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì´ ë¹„êµì  ì‰½ë‹¤**ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ë„ì»¤\r\n\r\në‹¬ë¡íŒ€ì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì— **ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬** ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ë„ì› ìŠµë‹ˆë‹¤. ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì  í‚¨ìŠ¤ë¥¼ ìš°ë¶„íˆ¬ì— ì§ì ‘ ì„¤ì¹˜í•œë‹¤ë©´ í•´ì£¼ì–´ì•¼í•  í™˜ê²½ ì„¤ì •ì´ ê°€ë“í•©ë‹ˆë‹¤. ì  í‚¨ìŠ¤ë¥¼ ëŒë¦¬ê¸° ìœ„í•œ JDK ì„¤ì¹˜, ì  í‚¨ìŠ¤ ì„¤ì¹˜, ì  í‚¨ìŠ¤ í¬íŠ¸ ì„¤ì •, ë°©í™”ë²½ ì„¤ì • ë“±ë“±...\r\n\r\ní•˜ì§€ë§Œ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ° **í™˜ê²½ ì„¤ì • ì—†ì´ ê°„ë‹¨í•œ ëª…ë ¹ì–´ ëª‡ê°€ì§€ë¡œ ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•˜ê³  ì„œë²„ì— ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**\r\n\r\në„ì»¤ëŠ” ì„œë¹„ìŠ¤ë¥¼ ìš´ìš©í•˜ëŠ”ë° í•„ìš”í•œ ì‹¤í–‰í™˜ê²½, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì†Œí”„íŠ¸ì›¨ì–´, ì½”ë“œ ë“±ì„ ì»¨í…Œì´ë„ˆë¼ëŠ” ë‹¨ìœ„ë¡œ ê°€ìƒí™”í•˜ëŠ” ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ê°€ìƒí™” í”Œë«í¼ì…ë‹ˆë‹¤. ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” ë¯¸ë¦¬ **ë„ì»¤ë¼ì´ì§•(Dockerizing)**ëœ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ê³  ë„ì»¤ë¥¼ í†µí•´ ì‹¤í–‰í•˜ê¸°ë§Œ í•˜ë©´ë˜ë©°, í•´ë‹¹ ì»¨í…Œì´ë„ˆê°€ ì–´ë–¤ í™˜ê²½ì„ í•„ìš”ë¡œ í•˜ëŠ”ì§€ ì „í˜€ ì•Œ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.\r\n\r\n> ë” ìì„¸í•œ ë‚´ìš©ì€ ì œê°€ ì‘ì„±í•œ [ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì´í•´í•˜ëŠ” Docker ê¸°ì´ˆ](https://hudi.blog/about-docker/)ë¥¼ ì½ì–´ë³´ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ ğŸ¤­\r\n\r\n### ìš°ë¶„íˆ¬ì— ë„ì»¤ ì„¤ì¹˜\r\n\r\n> ë‹¬ë¡íŒ€ì€ EC2 t4g.micro ì¸ìŠ¤í„´ìŠ¤ì— ìš°ë¶„íˆ¬ 22.04 (ARM 64) í™˜ê²½ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.\r\n\r\n> ì•„ë˜ ì„¤ì¹˜ ë°©ë²•ì€ [ë„ì»¤ ê³µì‹ ë„íë¨¼íŠ¸](https://docs.docker.com/engine/install/ubuntu/)ì—ì„œ ì œê³µë˜ëŠ” ë‚´ìš©ì…ë‹ˆë‹¤.\r\n\r\n#### ë ˆí¬ì§€í† ë¦¬ ì…‹ì—…\r\n\r\nì•„ë˜ ëª…ë ¹ì„ í†µí•´ì„œ ìš°ë¶„íˆ¬ì˜ `apt`ì˜ íŒ¨í‚¤ì§€ ì¸ë±ìŠ¤ë¥¼ ìµœì‹ í™”í•˜ê³ , `apt`ê°€ HTTPSë¥¼ í†µí•´ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.\r\n\r\n```shell\r\n$ sudo apt-get update\r\n$ sudo apt-get install \\\r\n    ca-certificates \\\r\n    curl \\\r\n    gnupg \\\r\n    lsb-release\r\n```\r\n\r\n#### ë„ì»¤ì˜ ê³µì‹ GPG í‚¤ ì¶”ê°€\r\n\r\n```shell\r\n$ sudo mkdir -p /etc/apt/keyrings\r\n$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\r\n```\r\n\r\n#### ë ˆí¬ì§€í† ë¦¬ ì…‹ì—…\r\n\r\n```shell\r\n$ echo \\\r\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\r\n  $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\r\n```\r\n\r\n#### ë„ì»¤ ì—”ì§„ ì„¤ì¹˜\r\n\r\nì•„ë˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ê°€ì¥ ìµœì‹ ë²„ì „ì˜ ë„ì»¤ ì—”ì§„ì´ ì„¤ì¹˜ë©ë‹ˆë‹¤.\r\n\r\n```shell\r\n$ sudo apt-get update\r\n$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\r\n```\r\n\r\n#### ë„ì»¤ ì„¤ì¹˜ í™•ì¸\r\n\r\n```shell\r\n$ sudo docker run hello-world\r\n\r\nHello from Docker!\r\nThis message shows that your installation appears to be working correctly.\r\n...\r\n```\r\n\r\nìœ„ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ìœ„ì™€ ê°™ì´ `Hello from Docker!` ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ë©´ ì„±ê³µì ìœ¼ë¡œ ë„ì»¤ ì„¤ì¹˜ê°€ ì™„ë£Œëœ ê²ƒ ì…ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ë³¼ê¹Œìš”? ğŸ¤—\r\n\r\n## ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰\r\n\r\n### ì  í‚¨ìŠ¤ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ\r\n\r\n```shell\r\n$ docker pull jenkins/jenkins:lts\r\n```\r\n\r\nìœ„ ëª…ë ¹ì„ í†µí•´ Jenkins LTS(Long Term Support) ë²„ì „ì˜ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.\r\n\r\n### ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆ ë„ìš°ê¸°\r\n\r\n```shell\r\n$ sudo docker run -d -p 8080:8080 -v /jenkins:/var/jenkins_home --name jenkins -u root jenkins/jenkins:lts\r\n```\r\n\r\nìœ„ ëª…ë ¹ì„ í†µí•´ ë‹¤ìš´ë¡œë“œ ë°›ì€ ì  í‚¨ìŠ¤ ì´ë¯¸ì§€ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ëœ ê° ì˜µì…˜ì„ ê°„ë‹¨íˆ ì•Œì•„ë³¼ê¹Œìš”?\r\n\r\n- **-d** : ì»¨í…Œì´ë„ˆë¥¼ **ë°ëª¬**ìœ¼ë¡œ ë„ì›ë‹ˆë‹¤.\r\n- **-p 8080:8080** : ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì™€ ë‚´ë¶€ í¬íŠ¸ë¥¼ **í¬ì›Œë”©**í•©ë‹ˆë‹¤. ì¢Œì¸¡ì´ í˜¸ìŠ¤íŠ¸ í¬íŠ¸, ìš°ì¸¡ì´ ì»¨í…Œì´ë„ˆ í¬íŠ¸ì…ë‹ˆë‹¤.\r\n- **-v /jenkins:/var/jenkins_home** : ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„°ëŠ” **ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë˜ë©´ íœ˜ë°œ**ë©ë‹ˆë‹¤. ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ë°©ë²•ì´ ì¡´ì¬í•˜ëŠ”ë°, ê·¸ ì¤‘ í•œ ë°©ë²•ì´ **ë³¼ë¥¨ ë§ˆìš´íŠ¸**ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆì˜ `/var/jenkins_home` ì´ë¼ëŠ” ë””ë ‰í† ë¦¬ë¥¼ í˜¸ìŠ¤íŠ¸ì˜ `/jenkins` ì™€ ë§ˆìš´íŠ¸í•˜ê³  ë°ì´í„°ë¥¼ ë³´ì¡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n- **--name jenkins** : ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ì´ë¦„ì„ ì„¤ì •í•©ë‹ˆë‹¤.\r\n- **-u root** : ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë¦¬ëˆ…ìŠ¤ì˜ ì‚¬ìš©ì ê³„ì •ì„ root ë¡œ ëª…ì‹œí•©ë‹ˆë‹¤.\r\n\r\n### docker-compose ì‚¬ìš©í•˜ê¸°\r\n\r\ní•˜ì§€ë§Œ ìœ„ì™€ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ëª¨ë‘ ì™¸ìš°ê³  ìˆë‹¤ê°€, ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ë§ˆë‹¤ ì…ë ¥í•˜ê²Œ ëœë‹¤ë©´ êµ‰ì¥íˆ ë²ˆê±°ë¡­ê² ì£ . ë”°ë¼ì„œ ë„ì»¤ëŠ” docker-compose ë¼ëŠ” ê²ƒì„ ì§€ì›í•©ë‹ˆë‹¤. ë„ì»¤ ì»´í¬ì¦ˆëŠ” ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆì˜ ì‹¤í–‰ì„ í•œë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ë„ì»¤ì˜ ë„êµ¬ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì €í¬ì™€ ê°™ì´ í•˜ë‚˜ì˜ ì»¨í…Œì´ë„ˆë§Œ í•„ìš”í•œ ìƒí™©ì—ì„œë„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì£ .\r\n\r\n```shell\r\n$ sudo apt install docker-compose\r\n```\r\n\r\nìœ„ ëª…ë ¹ì„ ì´ìš©í•˜ì—¬ `docker-compose` ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\r\n\r\nê·¸ë¦¬ê³  ë„ì»¤ë¥¼ ì‹¤í–‰í•  ê²½ë¡œì— `docker-compose.yml` ì´ë€ íŒŒì¼ì„ ë§Œë“¤ê³ , ì•„ë˜ì˜ ë‚´ìš©ì„ ì‘ì„±í•´ì¤ë‹ˆë‹¤.\r\n\r\n```yaml\r\nversion: \"3\"\r\nservices:\r\n  jenkins:\r\n    image: jenkins/jenkins:lts\r\n    user: root\r\n    volumes:\r\n      - ./jenkins:/var/jenkins_home\r\n    ports:\r\n      - 8080:8080\r\n```\r\n\r\nìƒì„±í•œ `docker-compose.yml` ì´ ì¡´ì¬í•˜ëŠ” ê²½ë¡œì—ì„œ ì•„ë˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ë³µì¡í•œ ëª…ë ¹ ì—†ì´ë„ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n```shell\r\n$ sudo docker-compose up -d\r\n```\r\n\r\n> -d ì˜µì…˜ì€ ì»¨í…Œì´ë„ˆê°€ ë°ëª¬ìœ¼ë¡œ ì‹¤í–‰ë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\r\n\r\n## ì  í‚¨ìŠ¤ ì„¤ì •\r\n\r\në„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì  í‚¨ìŠ¤ ì»¨í…Œì´ë„ˆê°€ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì„±ê³µì ìœ¼ë¡œ ë„ì›Œì¡Œë‹¤ë©´, EC2ì˜ í¼ë¸”ë¦­ IPë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ì†í•  ìˆ˜ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤. localhost:8080ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ ë³´ì¼ ê²ƒ ì…ë‹ˆë‹¤.\r\n\r\n![](./unlock-jenkins.png)\r\n\r\n```shell\r\n$ sudo docker logs jenkins\r\n```\r\n\r\nìœ„ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´, `jenkins` ì»¨í…Œì´ë„ˆì— ì¶œë ¥ëœ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì  í‚¨ìŠ¤ë¥¼ ìµœì´ˆë¡œ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•˜ë©´ ì‚¬ì§„ì—ì„œ ìš”êµ¬í•˜ëŠ” initial admin passwordë¥¼ ì¶œë ¥í•´ì£¼ëŠ”ë°ìš”, ë¡œê·¸ë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤.\r\n\r\n```\r\n*************************************************************\r\n*************************************************************\r\n*************************************************************\r\n\r\nJenkins initial setup is required. An admin user has been created and a password generated.\r\n\r\nPlease use the following password to proceed to installation:\r\n\r\n\r\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\r\n\r\n\r\nThis may also be found at: /var/jenkins_home/secrets/initialAdminPassword\r\n\r\n*************************************************************\r\n*************************************************************\r\n*************************************************************\r\n```\r\n\r\nìœ„ì—ì„œ í‘œì‹œëœ `XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX` ë¥¼ ì›¹ì‚¬ì´íŠ¸ì— ë„£ì–´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.\r\n\r\ní˜¹ì€ ì•„ë˜ì˜ ëª…ë ¹ìœ¼ë¡œ `jenkins` ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì§ì ‘ ì ‘ì†í•˜ì—¬, `/var/jenkins_home/secrets/initialAdminPassword` íŒŒì¼ì˜ ë‚´ìš©ì„ ì¡°íšŒí•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.\r\n\r\n```shell\r\n$ sudo docker exec -it jenkins /bin/bash\r\n$ cat /var/jenkins_home/secrets/initialAdminPassword\r\n```\r\n\r\n![](./customize-jenkins.png)\r\n\r\nê·¸ ë‹¤ìŒ ìœ„ í™”ë©´ì—ì„œ Install suggested pluginsë¥¼ í´ë¦­í•˜ì—¬ ì¶”ì²œë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ê·¸ ì´í›„ ìš”êµ¬ë˜ëŠ” ì—¬ëŸ¬ ì •ë³´ì˜ ì…ë ¥ì„ ë ë§ˆì³ì£¼ì„¸ìš”.\r\n\r\n```\r\nSystem.setProperty('org.apache.commons.jelly.tags.fmt.timeZone\r\n```\r\n\r\nì´í›„ ëŒ€ì‹œë³´ë“œì—ì„œ **Jenkins ê´€ë¦¬ > Script Console** ì—ì„œ ìœ„ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì…ë ¥í•˜ì—¬ íƒ€ì„ì¡´ì„ ì„œìš¸ë¡œ ì„¤ì •í•˜ê¸°ë§Œ í•˜ë©´, ì  í‚¨ìŠ¤ ê¸°ë³¸ ì„¤ì •ì´ ì™„ë£Œë©ë‹ˆë‹¤! ğŸ‰\r\n\r\n## ë§ˆì¹˜ë©°\r\n\r\në‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‹¬ë¡ì´ ì  í‚¨ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì–´ë–»ê²Œ ë°°í¬ ìë™í™” í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì¶•í•˜ì˜€ëŠ”ì§€ ì‘ì„±í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ë§ì€ ê¸°ëŒ€ ë¶€íƒë“œë¦½ë‹ˆë‹¤ ğŸ™\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ì›¹ì„œë¹„ìŠ¤ ê°œë°œíŒ€ì€ ìƒˆë¡­ê²Œ ê°œë°œí•œ ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í• ê¹Œìš”? ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ë  ë•Œ ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ë¸Œëœì¹˜ë¥¼ Pull í•˜ê³ , í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , í˜„ì¬ ë™ì‘ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³ , ìƒˆë¡­ê²Œ ë¹Œë“œëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš°ëŠ” ê³¼ì •... ë°°â€¦","fields":{"slug":"/deploy-automation-with-shell-script/"},"frontmatter":{"date":"July 19, 2022","title":"ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ë‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìë™í™”","tags":["DevOps"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì›¹ì„œë¹„ìŠ¤ ê°œë°œíŒ€ì€ ìƒˆë¡­ê²Œ ê°œë°œí•œ ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í• ê¹Œìš”? ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ë  ë•Œ ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ë¸Œëœì¹˜ë¥¼ Pull í•˜ê³ , í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³ , í˜„ì¬ ë™ì‘ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³ , ìƒˆë¡­ê²Œ ë¹Œë“œëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ìš°ëŠ” ê³¼ì •...\r\n\r\në°°í¬ê°€ í•„ìš”í• ë•Œë§ˆë‹¤ ì´ëŸ° ëª…ë ¹ì„ ìˆ˜ë™ìœ¼ë¡œ ì¼ì¼íˆ ì…ë ¥í•œë‹¤ë©´, ê·¸ê±´ ë„ˆë¬´ ì§€ë£¨í•œ ì‘ì—…ì•„ë‹ê¹Œìš”? ğŸ˜« ì‹¤ìˆ˜ë¼ë„ í•˜ë©´ ì–´ì©Œì£ ? ğŸ˜°\r\n\r\nìš°í…Œì½” ë‹¬ë¡íŒ€ ë°±ì—”ë“œëŠ” ì´ëŸ° í•œê³„ì ì„ ê·¹ë³µí•˜ê³ ì ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë°°í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¬ë¡íŒ€ì€ ì–´ë–»ê²Œ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°°í¬ë¥¼ ìë™í™”í–ˆì„ê¹Œìš”?\r\n\r\n## ì‰˜ ìŠ¤í¬ë¦½íŠ¸\r\n\r\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ìœ ë‹‰ìŠ¤/ë¦¬ëˆ…ìŠ¤ ê¸°ë°˜ ìš´ì˜ì²´ì œì—ì„œì˜ ì¼ë ¨ì˜ ëª…ë ¹ìœ¼ë¡œ êµ¬ì„±ëœ ì‹¤í–‰ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸ íŒŒì¼ì…ë‹ˆë‹¤. ì›ë˜ë¼ë©´ ì¼ì¼íˆ í‚¤ë³´ë“œë¡œ ì…ë ¥í•´ì•¼í•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ëª…ë ¹ì„ í•˜ë‚˜ì˜ íŒŒì¼ì— ëª¨ì•„ë‘ê³ , í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆì£ . ì‘ì„±ëœ ëª…ë ¹ì€ ì…¸ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ëª…ë ¹ì¤„ ì¸í„°í”„ë¦¬í„°ì—ì„œ ì‹¤í–‰ë˜ë©°, ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œ ì°¨ë¡€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•´ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\në‹¬ë¡ì´ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ëŠ” í™˜ê²½ì€ Ubuntu 22 ë²„ì „ì´ë¯€ë¡œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n## ìˆ˜ë™ìœ¼ë¡œ ë°°í¬í•˜ê¸°\r\n\r\në°°í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•˜ë ¤ë©´ ìš°ì„  ìˆ˜ë™ìœ¼ë¡œ ì–´ë–¤ ëª…ë ¹ì„ ì‚¬ìš©í•´ì„œ ë°°í¬ë¥¼ í•˜ëŠ”ì§€ ì•Œì•„ì•¼í•©ë‹ˆë‹¤. ì–´ë–¤ê³¼ì •ì„ ê±°ì³ ë°°í¬ë˜ëŠ”ì§€ë¶€í„° ì•Œì•„ë³¼ê¹Œìš”?\r\n\r\n> ë ˆí¬ì§€í† ë¦¬ëŠ” ì´ë¯¸ Clone ë˜ì–´ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.\r\n\r\n### 1. Git Pull\r\n\r\n```shell\r\n$ cd 2022-dallog/backend\r\n$ git pull\r\n```\r\n\r\nìš°ì„  Githubì—ì„œ ê°€ì¥ ìµœì‹  ë²„ì „ì„ pull í•´ì™€ì•¼ê² ì£ ?\r\n\r\n### 2. ë¹Œë“œ\r\n\r\n```shell\r\n./gradlew bootJar\r\n```\r\n\r\n`gradlew` ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë°” í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•´ì„œ `.jar` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.\r\n\r\n### 3. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ\r\n\r\n```shell\r\n$ ps -ef | grep jar\r\n$ kill -15 XXXXX\r\n```\r\n\r\n`ps` ëª…ë ¹ì„ ì‚¬ìš©í•´ì„œ ì‹¤í–‰ì¤‘ì¸ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ PIDë¥¼ ì•Œì•„ë‚´ê³ , `kill` ëª…ë ¹ì„ í†µí•´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤.\r\n\r\n### 4. í™˜ê²½ë³€ìˆ˜ ì„¤ì •\r\n\r\në‹¬ë¡ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì—¬ëŸ¬ ë¯¼ê°í•œ ì •ë³´ë¥¼ í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë  ë•Œ í™˜ê²½ë³€ìˆ˜ë„ í•¨ê»˜ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.\r\n\r\n```shell\r\n$ export GOOGLE_CLIENT_ID=\"XXXXX\"\r\n$ export GOOGLE_CLIENT_SECRET=\"XXXXX\"\r\n$ export GOOGLE_REDIRECT_URI=\"XXXXX\"\r\n$ export GOOGLE_TOKEN_URI=\"XXXXX\"\r\n$ export JWT_SECRET_KEY=\"XXXXX\"\r\n$ export JWT_EXPIRE_LENGTH=3600\r\n\r\n...\r\n```\r\n\r\n### 5. ë“œë””ì–´ ì‹¤í–‰\r\n\r\n```shell\r\n$ sudo -E nohup java -jar ./build/libs/backend-0.0.1-SNAPSHOT.jar\r\n```\r\n\r\në“œë””ì–´ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\r\n\r\nì´ ê·€ì°®ì€ ê³¼ì •ì„ ë°°í¬ í• ë•Œë§ˆë‹¤ í•´ì•¼í•œë‹¤ë‹ˆ ë²Œì¨ ë¨¸ë¦¬ê°€ ì–´ì§ˆì–´ì§ˆ í•˜ë„¤ìš”. ğŸ˜µâ€ğŸ’« ê·¸ë ‡ë‹¤ë©´ ì•ì„œ ì†Œê°œë“œë¦° ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ì„œ ì´ ê³¼ì •ì„ ìë™í™”í•´ë³¼ê¹Œìš”?\r\n\r\n## ë‹¬ë¡ì˜ ë°°í¬ ì‰˜ ìŠ¤í¬ë¦½íŠ¸\r\n\r\n```shell\r\n#! /bin/bash\r\n\r\nPROJECT_PATH=/home/ubuntu/2022-dallog\r\nPROJECT_NAME=backend\r\nPROJECT_BUILD_PATH=backend/build/libs\r\n\r\ncd $PROJECT_PATH/$PROJECT_NAME\r\n\r\nclear\r\n\r\necho \"ğŸŒˆ Githubì—ì„œ í”„ë¡œì íŠ¸ë¥¼ Pull í•©ë‹ˆë‹¤.\\n\"\r\n\r\ngit pull\r\n\r\necho \"\\nğŸŒˆ SpringBoot í”„ë¡œì íŠ¸ ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.\\n\"\r\n\r\n./gradlew bootJar\r\n\r\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\r\n\r\nif [ -z \"$CURRENT_PID\" ]; then\r\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\r\nelse\r\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\r\n\tkill -15 $CURRENT_PID\r\nfi\r\n\r\necho \"\\nğŸŒˆ SpringBoot í™˜ê²½ë³€ìˆ˜ ì„¤ì •\"\r\n\r\nexport GOOGLE_CLIENT_ID=\"XXXXX\"\r\nexport GOOGLE_CLIENT_SECRET=\"XXXXX\"\r\nexport GOOGLE_REDIRECT_URI=\"XXXXX\"\r\nexport GOOGLE_TOKEN_URI=\"XXXXX\"\r\nexport JWT_SECRET_KEY=\"XXXXX\"\r\nexport JWT_EXPIRE_LENGTH=3600\r\n\r\necho \"\\nğŸŒˆ SpringBoot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\\n\"\r\n\r\nJAR_PATH=$(ls $PROJECT_PATH/$PROJECT_BUILD_PATH/ | grep .jar | head -n 1)\r\nsudo -E nohup java -jar $PROJECT_PATH/$PROJECT_BUILD_PATH/$JAR_PATH &\r\n```\r\n\r\në‹¬ë¡ì´ ì‘ì„±í•œ ë°°í¬ ìë™í™” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì°¨ê·¼ì°¨ê·¼ ì•Œì•„ë³¼ê¹Œìš”?\r\n\r\n### #! /bin/bash\r\n\r\n`#! /bin/bash` ì€ í•´ë‹¹ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ë§ì€ ì‰˜ ì¤‘ **Bash Shell ë¡œ ì‹¤í–‰ë¨**ì„ ì•Œë¦½ë‹ˆë‹¤.\r\n\r\n### ë³€ìˆ˜ ì‚¬ìš©\r\n\r\n`PROJECT_PATH`, `PROJECT_NAME` ê³¼ ê°™ì´ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ëŠ” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” ë³€ìˆ˜ ê¸°ëŠ¥ìœ¼ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë•Œ ì£¼ì˜í•  ì ì€ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•  ë•Œ `=` **ì•ë’¤ì— ê³µë°±ì´ ì™€ì„œëŠ” ì•ˆëœë‹¤ëŠ” ì ** ì…ë‹ˆë‹¤.\r\n\r\n### echo\r\n\r\n`echo` ëª…ë ¹ì„ í†µí•´ ë°°í¬ í”„ë¡œì„¸ìŠ¤ê°€ ì–´ë””ê¹Œì§€ ì§„í–‰ëëŠ”ì§€ ì‚¬ìš©ìì—ê²Œ ì•Œë ¤ì¤ë‹ˆë‹¤.\r\n\r\n### ì‹¤í–‰ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ PID ê°€ì ¸ì˜¤ê¸°\r\n\r\n```shell\r\nCURRENT_PID=$(pgrep -f ${PROJECT_NAME}-.*.jar | head -n 1)\r\n```\r\n\r\n#### pgrep\r\n\r\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì¤‘ ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ìœ„ ì½”ë“œëŠ” ìš°ì„  `pgrep` ì´ë¼ëŠ” ëª…ë ¹ì„ í†µí•´ì„œ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì˜ ì´ë¦„ìœ¼ë¡œ PID ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\n\r\n#### pipeì™€ head\r\n\r\nê·¸ë¦¬ê³  íŒŒì´í”„(`|`)ëª…ë ¹ìœ¼ë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ PID ëª©ë¡ì„ ë³´ëƒ…ë‹ˆë‹¤. PID ëª©ë¡ì€ `head` ëª…ë ¹ìœ¼ë¡œ ì „ë‹¬ë˜ë©°, `head` ëª…ë ¹ì€ PID ëª©ë¡ì˜ ì²«ë²ˆì§¸ë§Œì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\n\r\n#### ëª…ë ¹ì˜ ì‹¤í–‰ê²°ê³¼ë¥¼ ë³€ìˆ˜ì— ë‹´ê¸°\r\n\r\nì´ë ‡ê²Œ ê°€ì ¸ì˜¨ PIDëŠ” `$()` ë¬¸ë²•ì„ í†µí•´ `CURRENT_PID` ë³€ìˆ˜ì— ì €ì¥ë©ë‹ˆë‹¤. `$()` ëŠ” `$(command)` í˜•íƒœë¡œ ì‚¬ìš©ë˜ë©°, ê´„í˜¸ ë‚´ë¶€ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³€ìˆ˜ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\r\n\r\n### ì¡°ê±´ë¬¸\r\n\r\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ì—ë„ `if` ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ìš°ë¦¬ì—ê²Œ ìµìˆ™í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œì˜ ifë¬¸ê³¼ëŠ” ì¡°ê¸ˆ ê´´ë¦¬ê°€ ì¡´ì¬í•´ì„œ ë³„ë„ë¡œ í•™ìŠµì´ í•„ìš”í• ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\r\n\r\n```shell\r\nif [ -z \"$CURRENT_PID\" ]; then\r\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì¢…ë£Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\"\r\nelse\r\n\techo \"ğŸŒˆ êµ¬ë™ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤. (pid : $CURRENT_PID)\"\r\n\tkill -15 $CURRENT_PID\r\nfi\r\n```\r\n\r\nìœ„ ì½”ë“œëŠ” ì•„ê¹Œ PIDë¥¼ ë‹´ì€ `CURRENT_PID` ê°€ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸í•œ í›„ ì¡´ì¬í•˜ì§€ ì•Šë‹¤ë©´ ë©”ì‹œì§€ë§Œ ì¶œë ¥í•˜ê³ , ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ PIDë¥¼ `kill` ëª…ë ¹ìœ¼ë¡œ ì¢…ë£Œí•©ë‹ˆë‹¤.\r\n\r\nì‰˜ ìŠ¤í¬ë¦½íŠ¸ì˜ `if` ë¬¸ì—ì„œ `-z` ëŠ” ì¡°ê±´ì‹ì˜ ì¢…ë¥˜ ì¤‘ í•˜ë‚˜ì´ë©°, ì£¼ì–´ì§„ ë¬¸ìì—´ì˜ ê¸¸ì´ê°€ 0ì´ë¼ë©´ Trueë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í™•ì‹¤íˆ ì¡°ê¸ˆ ë‚¯ì„¤ì£ ? ğŸ˜…\r\n\r\n### JARíŒŒì¼ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°\r\n\r\n```shell\r\nJAR_PATH=$(ls $PROJECT_PATH/$PROJECT_BUILD_PATH/ | grep .jar | head -n 1)\r\n```\r\n\r\n`ls` ëª…ë ¹ì„ í†µí•´ ë¹Œë“œ ë””ë ‰í† ë¦¬ì˜ íŒŒì¼ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê³ , `grep` ëª…ë ¹ì„ í†µí•´ `.jar` íŒŒì¼ë§Œì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ê·¸ë‹¤ìŒ `head` ëª…ë ¹ì„ í†µí•´ ë‹¨ í•˜ë‚˜ì˜ íŒŒì¼ë§Œì„ ê°€ì ¸ì˜¨ ë‹¤ìŒ, `JAR_PATH` ë³€ìˆ˜ì— ì €ì¥í•©ë‹ˆë‹¤.\r\n\r\n### ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰í•˜ê¸°\r\n\r\n```shell\r\nsudo -E nohup java -jar $PROJECT_PATH/$PROJECT_BUILD_PATH/$JAR_PATH &\r\n```\r\n\r\nì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\r\n\r\n#### sudo -E\r\n\r\n`sudo` ëª…ë ¹ ë’¤ì— ë¶™ì€ `-E` ì˜µì…˜ì€ ìœ ì €ê°€ ì„¤ì •í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ `sudo` ëª…ë ¹ì—ì„œë„ ê³µìœ í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“œëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.\r\n\r\n#### nohup\r\n\r\n`nohup` ëª…ë ¹ì€ í˜„ì¬ **í„°ë¯¸ë„ ì„¸ì…˜ì´ ëŠì–´ì ¸ë„ í”„ë¡œì„¸ìŠ¤ê°€ ê³„ì† ì‚´ì•„ìˆë„ë¡** ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤.\r\n\r\n#### Background í”„ë¡œì„¸ìŠ¤\r\n\r\nê·¸ë¦¬ê³  ëª…ë ¹ ë§¨ ë’¤ì— `&` ê°€ ë¶™ì–´ìˆëŠ”ë°, í”„ë¡œì„¸ìŠ¤ë¥¼ Foregroundê°€ ì•„ë‹Œ **Backgroundì—ì„œ ì‹¤í–‰**í•˜ê¸° ìœ„í•´ ë¶™ì—¬ì¤ë‹ˆë‹¤.\r\n\r\n## í•œê³„ì \r\n\r\ní•˜ì§€ë§Œ, ì´ëŸ° ë°©ì‹ë„ ê²°êµ­ í•œê³„ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤. íŠ¹íˆë‚˜ ë‹¬ë¡ê³¼ ê°™ì´ ì• ìì¼í•œ ì¡°ì§ì—ì„œëŠ” ìµœëŒ€í•œ ì‘ì€ ê¸°ëŠ¥ë‹¨ìœ„ë¡œ ê°œë°œì´ ë³‘ë ¬ì ìœ¼ë¡œ ì§„í–‰ë˜ì–´, ë©”ì¸ ë¸Œëœì¹˜ì— ë¨¸ì§€ë©ë‹ˆë‹¤. í•˜ë£¨ì— ëª‡ë²ˆì´ê³  ë°°í¬ë¥¼ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒí• ìˆ˜ë„ ìˆì£ .\r\nê·¸ë ‡ì§€ ì•Šì•„ë„ ëª¨ë“  ê°œë°œìê°€ ë°”ì˜ê²Œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ê°œë°œí•˜ê¸° ë°”ìœë°, ë©”ì¸ ë¸Œëœì¹˜ì— ë³‘í•©ëœ ì‹œì ë§ˆë‹¤ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•´ì„œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ì•¼í• ê¹Œìš”?\r\n\r\nì´ëŸ° í•œê³„ì ì„ ê·¹ë³µí•˜ê³ ì, ë‹¬ë¡íŒ€ì€ ì•ìœ¼ë¡œ CI/CD ë„êµ¬ë¥¼ ë„ì…í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì„¸ìƒì—ëŠ” ì°¸ ë‹¤ì–‘í•œ CI/CD ë„êµ¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. Jenkins, Github Actions, Travis CI, Circle CI, Gitlab CI/CD ë“±ë“±...\r\n\r\në‹¬ë¡ì˜ ì´ë²ˆ ìŠ¤í”„ë¦°íŠ¸ì˜ ë°°í¬ íƒœìŠ¤í¬ì—ì„œëŠ” ì´ëŸ° ë‹¤ì–‘í•œ CI/CD ë„êµ¬ë“¤ì˜ ì¥ë‹¨ì„ ë¶„ì„í•˜ê³  ë„ì…í•  ì˜ˆì •ì…ë‹ˆë‹¤. ë§ì€ ê¸°ëŒ€ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ğŸ‘ğŸ‘\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. auditingì´ë€ ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ì´ë²¤íŠ¸(insert, update, delete)ë¥¼ ì¶”ì í•˜ê³  ê¸°ë¡í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì„ ì¶”ê°€í•˜ê³  ì‹¶ì€ ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì— ëŒ€í•œ í•„ë“œë¥¼ ì¼ì¼ì´ êµ¬í˜„í•´ì£¼ì–´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´â€¦","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"date":"July 18, 2022","title":"Spring Data JPAì˜ Auditing","tags":["Spring","Data JPA","Auditing"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n> auditingì´ë€ ì—”í‹°í‹°ì™€ ê´€ë ¨ëœ ì´ë²¤íŠ¸(insert, update, delete)ë¥¼ ì¶”ì í•˜ê³  ê¸°ë¡í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.\r\n\r\nëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì„ ì¶”ê°€í•˜ê³  ì‹¶ì€ ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. ëª¨ë“  ì—”í‹°í‹°ì— ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ, ìƒì„±í•œ ì‚¬ëŒì— ëŒ€í•œ í•„ë“œë¥¼ ì¼ì¼ì´ êµ¬í˜„í•´ì£¼ì–´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ëª¨ë“  ì—”í‹°í‹°ì— ì¤‘ë³µì´ ìƒê¸°ê³  ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§„ë‹¤. Spring Data JPAê°€ ì œê³µí•˜ëŠ” `Auditing` ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì´ëŸ° ê¸°ëŠ¥ì„ ì‰½ê³  ë¹ ë¥´ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.\r\n\r\n## Spring Data JPA Auditing ì ìš©í•˜ê¸°\r\n\r\n`Auditing`ì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„  ì–´ë…¸í…Œì´ì…˜ì„ ì ìš©í•´ì•¼ í•œë‹¤. `@Configuration` ì–´ë…¸í…Œì´ì…˜ì´ ì ìš©ëœ Config í´ë˜ìŠ¤ì— ì•„ë˜ì™€ ê°™ì´ `@EnableJpaAuditing`ì„ ì¶”ê°€í•œë‹¤.\r\n\r\n```java\r\n@Configuration\r\n@EnableJpaAuditing\r\npublic class JpaConfig {\r\n}\r\n```\r\n\r\nâš ï¸ ì£¼ì˜ : ì›í™œí•œ Slice í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ @SpringBootApplication ê³¼ @EnableJpaAuditing ì–´ë…¸í…Œì´ì…˜ ë¶„ë¦¬í•˜ê¸°\r\n\r\n[https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing.spring-boot-applications.user-configuration-and-slicing)\r\n\r\n### Spring Entity Callback Listener ì ìš©í•˜ê¸°\r\n\r\nAuditing entity listener classë¡œ ì§€ì •í•˜ê¸° ìœ„í•´ `@EntityListeners` ì–´ë…¸í…Œì´ì…˜ì„ Entity í´ë˜ìŠ¤ì— ì¶”ê°€í•œë‹¤. ì¸ìë¡œëŠ” `AuditingEntityListener.class`ë¥¼ ë„˜ê¸´ë‹¤. ì´ ì„¤ì •ì„ í†µí•´ ì—”í‹°í‹°ì— ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ ì •ë³´ë¥¼ ìº¡ì²˜í•  ìˆ˜ ìˆë‹¤.\r\n\r\n```java\r\n@Entity\r\n@EntityListeners(AuditingEntityListener.class)\r\npublic class BaseEntity {\r\n    // ...\r\n}\r\n```\r\n\r\n### ìƒì„±ì¼ì‹œ, ìˆ˜ì •ì¼ì‹œ ì¶”ì í•˜ê¸°\r\n\r\nìƒì„±ì¼ì‹œëŠ” `@CreatedDate`, ìˆ˜ì •ì¼ì‹œëŠ” `@LastModifiedDate` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì¶”ì í•  ìˆ˜ ìˆë‹¤. ìƒì„±ì¼ì‹œì˜ ê²½ìš° í•œ ë²ˆ ìƒì„±ë˜ë©´ ë³€ê²½ë˜ì–´ì„  ì•ˆ ë˜ë©°, í•­ìƒ ì¡´ì¬í•´ì•¼ í•˜ë¯€ë¡œ `nullable = false`, `updatable = false`ë¡œ ì§€ì •í•œë‹¤.\r\n\r\nì¶”ê°€ì ìœ¼ë¡œ BaseEntityë¥¼ ë‹¤ë¥¸ Entityë“¤ì´ ìƒì†ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `@MappedSuperclass` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ Entityê°€ ì•„ë‹Œ SuperClassë¡œ ì§€ì •í–ˆë‹¤.\r\n\r\n```java\r\n@MappedSuperclass\r\n@EntityListeners(AuditingEntityListener.class)\r\npublic abstract class BaseEntity {\r\n\r\n    @CreatedDate\r\n    @Column(name = \"created_at\", nullable = false, updatable = false)\r\n    private LocalDateTime createdAt;\r\n\r\n    @LastModifiedDate\r\n    @Column(name = \"updated_at\")\r\n    private LocalDateTime updatedAt;\r\n\r\n    // ...\r\n}\r\n```\r\n\r\n### ìƒì„±í•œ ì‚¬ëŒ, ìˆ˜ì •í•œ ì‚¬ëŒ ì¶”ì í•˜ê¸°\r\n\r\nìƒì„±í•œ ì‚¬ëŒì€ `@CreatedBy`, ìˆ˜ì •í•œ ì‚¬ëŒì€ `@LastModifiedBy` ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì¶”ì í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ í•„ë“œëŠ” ìƒì„±ì, ìˆ˜ì •ìì˜ ì´ë¦„ìœ¼ë¡œ ì±„ì›Œì§„ë‹¤.\r\n\r\n```java\r\n@MappedSuperclass\r\n@EntityListeners(AuditingEntityListener.class)\r\npublic abstract class BaseEntity {\r\n\r\n    @CreatedBy\r\n    @Column(name = \"created_by\")\r\n    private String createdBy;\r\n\r\n    @LastModifiedBy\r\n    @Column(name = \"modified_by\")\r\n    private String modifiedBy;\r\n\r\n    // ...\r\n}\r\n```\r\n\r\nìœ ì €ì— ëŒ€í•œ ì •ë³´ëŠ” SecurityContext's Authentication ì¸ìŠ¤í„´ìŠ¤ë¡œë¶€í„° ê°€ì ¸ì˜¨ë‹¤. ì´ ê°’ì„ ì»¤ìŠ¤í…€í•˜ê³  ì‹¶ë‹¤ë©´ `AuditorAware<T>` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.\r\n\r\n```java\r\npublic class AuditorAwareImpl implements AuditorAware<String> {\r\n\r\n    @Override\r\n    public String getCurrentAuditor() {\r\n        // your custom logic\r\n    }\r\n}\r\n```\r\n\r\nì´ë ‡ê²Œ ë§Œë“  `AuditorAwareImpl`ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Config í´ë˜ìŠ¤ì— `AuditorAwareImpl` ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ˆê¸°í™”ë˜ëŠ” `AuditorAware` íƒ€ì…ì˜ ë¹ˆì„ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  `@EnableJpaAuditing` ì–´ë…¸í…Œì´ì…˜ì— `auditorAwareRef=\"auditorProvider\"` ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.\r\n\r\n```java\r\n@Configuration\r\n@EnableJpaAuditing(auditorAwareRef=\"auditorProvider\")\r\npublic class JpaConfig {\r\n    //...\r\n\r\n    @Bean\r\n    AuditorAware<String> auditorProvider() {\r\n        return new AuditorAwareImpl();\r\n    }\r\n\r\n    //...\r\n}\r\n```\r\n\r\n---\r\n\r\n### References\r\n\r\n[https://www.baeldung.com/database-auditing-jpa](https://www.baeldung.com/database-auditing-jpa)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ íŒŒë‘ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Spring Data JPAì—ì„œëŠ” Paginationì„ ìœ„í•œ ë‘ ê°€ì§€ ê°ì²´ë¥¼ ì œê³µí•œë‹¤. ë°”ë¡œ Sliceì™€ Pageë‹¤. Repository ì½”ë“œë¥¼ ë¨¼ì € ë³´ì. ë©”ì„œë“œë¥¼ ë³´ë©´ íŒŒë¼ë¯¸í„°ë¡œ  ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤.  ê°ì²´ëŠ” Paginationì„ ìœ„í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ë‹¤.  ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ì¸ ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬â€¦","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"date":"July 18, 2022","title":"Spring Data JPAì˜ Slice & Page","tags":["Spring","Data JPA","Slice","Page"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [íŒŒë‘](https://github.com/summerlunaa)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nSpring Data JPAì—ì„œëŠ” Paginationì„ ìœ„í•œ ë‘ ê°€ì§€ ê°ì²´ë¥¼ ì œê³µí•œë‹¤. ë°”ë¡œ Sliceì™€ Pageë‹¤. Repository ì½”ë“œë¥¼ ë¨¼ì € ë³´ì.\r\n\r\n```java\r\npublic interface MemberRepository extends JpaRepository<Member, Long> {\r\n    Slice<Member> findSliceBy(final Pageable pageable);\r\n        Page<Member> findPageBy(final Pageable pageable);\r\n}\r\n\r\n// Controller\r\n// queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ëŠ”ë‹¤\r\n@GetMapping(\"/api/members\")\r\npublic List<MemberResponse> findAll(@RequestParam int page, @RequestParam int size) {\r\n    // ìƒëµ\r\n}\r\n\r\n// Service\r\nPageRequest pageRequest = PageRequest.of(page, size); // pageRequest ìƒì„±\r\nSlice<Member> slices = memberRepository.findSliceBy(pageRequest); // repositoryì—ì„œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°\r\nPage<Member> pages = memberRepository.findPageBy(pageRequest);\r\n```\r\n\r\në©”ì„œë“œë¥¼ ë³´ë©´ íŒŒë¼ë¯¸í„°ë¡œ `Pageable` ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤. **`Pageable` ê°ì²´ëŠ” Paginationì„ ìœ„í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´**ë‹¤. `Pageable` ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ì¸ `PageRequest`ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë©”ì„œë“œ ì¸ìë¡œ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.\r\n\r\n![PageRequest static constructor](pagerequest.png)\r\n\r\n`PageRequest`ëŠ” ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ `of`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. `PageRequest`ëŠ” ì¸ìë¡œ page, size, í•„ìš”í•˜ë‹¤ë©´ sortê¹Œì§€ ë°›ì„ ìˆ˜ ìˆë‹¤.\r\n\r\n- `page` : 0ë¶€í„° ì‹œì‘í•˜ëŠ” í˜ì´ì§€ ì¸ë±ìŠ¤ ë²ˆí˜¸\r\n- `size` : í•œ í˜ì´ì§€ì— ë°˜í™˜í•  ë°ì´í„°ì˜ ê°œìˆ˜\r\n- `sort` : ì •ë ¬ ë°©ì‹\r\n\r\npageì™€ sizeë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ `PageRequest`ë¥¼ ìƒì„±í•˜ì—¬ Repository ë©”ì„œë“œì— ë„˜ê²¨ì£¼ëŠ” ê²ƒìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ Paginationì„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.\r\n\r\n## Slice VS Page\r\n\r\n```java\r\npublic interface MemberRepository extends JpaRepository<Member, Long> {\r\n    Slice<Member> findSliceBy(final Pageable pageable);\r\n        Page<Member> findPageBy(final Pageable pageable);\r\n}\r\n```\r\n\r\nRepositoryì˜ ë©”ì„œë“œë¥¼ ë³´ë©´ ë°˜í™˜ ê°’ìœ¼ë¡œ `Slice` í˜¹ì€ `Page`ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ë‘˜ì€ ì–´ë–¤ ì°¨ì´ê°€ ìˆì„ê¹Œ?\r\n\r\n### Slice\r\n\r\n![slice](slice.png)\r\n\r\n`Slice`ëŠ” `Streamable`ì„ ìƒì†ë°›ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ Paginationê³¼ ê´€ë ¨ëœ ì—¬ëŸ¬ ë©”ì„œë“œë¥¼ ê°–ê³  ìˆë‹¤. ëŒ€í‘œì ì¸ ë©”ì„œë“œ ëª‡ ê°€ì§€ë§Œ ì‚´í´ë³´ì.\r\n\r\n![slice methods](slice_methods.png)\r\n\r\ní˜„ì¬ í˜ì´ì§€ì˜ ë‚´ìš©ì„ í™•ì¸í•˜ê±°ë‚˜ ë‹¤ìŒ í˜ì´ì§€, ì´ì „ í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ `Page`ëŠ” ë¬´ì—‡ì¼ê¹Œ?\r\n\r\n### Page\r\n\r\n![page](page.png)\r\n\r\n`Page`ëŠ” `Slice`ë¥¼ ìƒì†í•œë‹¤. ë”°ë¼ì„œ `Slice`ê°€ ê°€ì§„ ëª¨ë“  ë©”ì„œë“œë¥¼ `Page`ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ `Page`ê°€ ë‹¤ë¥¸ ì ì€ **ì¡°íšŒ ì¿¼ë¦¬ ì´í›„ ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ê°€ í•œ ë²ˆ ë” ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒ**ì´ë‹¤.\r\n\r\nPageê°€ ì¶”ê°€ì ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆëŠ” ë©”ì„œë“œ ë‘ ê°€ì§€ë§Œ ì‚´í´ë³´ì.\r\n\r\n![page methods](page_methods.png)\r\n\r\nPageì˜ ê²½ìš° ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ê°€ ì¶”ê°€ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ Sliceì™€ ë‹¤ë¥´ê²Œ ì „ì²´ ë°ì´í„° ê°œìˆ˜ë‚˜ ì „ì²´ í˜ì´ì§€ ìˆ˜ê¹Œì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\r\n\r\n> ì¶”ê°€ì ìœ¼ë¡œ..\r\n\r\n```java\r\npublic interface PagingAndSortingRepository<T, ID> extends CrudRepository<T, ID> {\r\n\r\n    Iterable<T> findAll(Sort sort);\r\n\r\n    Page<T> findAll(Pageable pageable);\r\n}\r\n```\r\n\r\n`Page`ë¥¼ ë°˜í™˜ë°›ì„ ê²½ìš° ì•„ë˜ì²˜ëŸ¼ **`Page`ë¥¼ ë°˜í™˜í•˜ëŠ” `findAll` ë©”ì„œë“œê°€ ì´ë¯¸ ì¡´ì¬**í•œë‹¤. ë”°ë¡œ Repository Interfaceì— ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ì£¼ì§€ ì•Šì•„ë„ `findAll` ë©”ì„œë“œì— `Pageable` ê°ì²´ë¥¼ ë„˜ê²¨ì£¼ë©´ Paginationì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (Sliceë¥¼ ë°˜í™˜í•˜ë ¤ë©´ ë©”ì„œë“œë¥¼ ì •ì˜í•´ì£¼ì–´ì•¼ í•œë‹¤.)\r\n\r\n### Slice VS Page ì–´ë–¤ ê±¸ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?\r\n\r\n`Slice`ëŠ” ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ì§€ ì•Šê³  ì´ì „ or ë‹¤ìŒ `Slice`ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ **`Slice`ëŠ” ë¬´í•œ ìŠ¤í¬ë¡¤ ë“±ì„ êµ¬í˜„í•˜ëŠ” ê²½ìš° ìœ ìš©**í•˜ë‹¤. `Page`ì— ë¹„í•´ ì¿¼ë¦¬ê°€ í•˜ë‚˜ ëœ ë‚ ì•„ê°€ë¯€ë¡œ **ë°ì´í„° ì–‘ì´ ë§ì„ìˆ˜ë¡ `Slice`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ìƒ ìœ ë¦¬**í•˜ë‹¤.\r\n\r\n`Page`ëŠ” ì „ì²´ ë°ì´í„° ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ë¥¼ í•œ ë²ˆ ë” ì‹¤í–‰í•œë‹¤. ë”°ë¼ì„œ **ì „ì²´ í˜ì´ì§€ ê°œìˆ˜ë‚˜ ë°ì´í„° ê°œìˆ˜ê°€ í•„ìš”í•œ ê²½ìš° ìœ ìš©**í•˜ë‹¤.\r\n\r\n> ì•Œë¡ì—ì„œëŠ” ì¹´í…Œê³ ë¦¬ ì¡°íšŒë¥¼ ë¬´í•œ ìŠ¤í¬ë¡¤ë¡œ êµ¬í˜„í•˜ë¯€ë¡œ Sliceë¥¼ ì‚¬ìš©í–ˆë‹¤.\r\n\r\n## ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ queryParameterë¥¼ Pageable ê°ì²´ë¡œ ë°›ëŠ” ë°©ë²•\r\n\r\nì•ì—ì„  queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ì•„ PageRequestë¥¼ ë§Œë“¤ì–´ ë„˜ê²¨ì£¼ëŠ” ë°©ë²•ì„ ì„¤ëª…í–ˆë‹¤.\r\n\r\n```java\r\n// Controller\r\n// queryParameterë¥¼ í†µí•´ page, sizeë¥¼ ë°›ëŠ”ë‹¤\r\n@GetMapping(\"/api/members\")\r\npublic List<MemberResponse> findAll(@RequestParam int page, @RequestParam int size) {\r\n    // ìƒëµ\r\n}\r\n```\r\n\r\ní•˜ì§€ë§Œ ì´ë ‡ê²Œ êµ¬í˜„í•˜ë‹ˆê¹Œ *â€œModelAttributeë¥¼ í†µí•´ queryParameterë¥¼ DTOë¡œ ë°›ëŠ” ê²ƒì²˜ëŸ¼, queryParameterë¥¼ Pageable ê°ì²´ë¡œ ë°›ì„ ìˆ˜ ì—†ì„ê¹Œ?â€*í•˜ëŠ” ì˜ë¬¸ì´ ìƒê²¼ë‹¤. ì§ì ‘ ArgumentResolverë¥¼ êµ¬í˜„í•  ë»”í–ˆì§€ë§Œ ì°¾ì•„ë³´ë‹ˆ ì—­ì‹œ ë˜‘ë˜‘í•œ JPA.. Pageable ê°ì²´ë¥¼ ì¸ìˆ˜ë¡œ ì„¤ì •í•˜ë©´ ì–´ë…¸í…Œì´ì…˜ ì—†ì´ë„ ìë™ìœ¼ë¡œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. `PageableHandlerMethodArgumentResolver` ê°€ ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.\r\n\r\n```java\r\n// Controller\r\n// Pageable ê°ì²´ë¥¼ ë°”ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.\r\n@GetMapping(\"/api/members\")\r\npublic List<MemberResponse> findAll(Pageable pagealbe) {\r\n    // ìƒëµ\r\n}\r\n\r\n// Service\r\nSlice<Member> slices = memberRepository.findSliceBy(pageable); // PageReqeustë¥¼ ìƒì„±í•  í•„ìš” ì—†ì´ ë°”ë¡œ ê°ì²´ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.\r\n```\r\n\r\nì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ PageReqeustë¥¼ ìƒì„±í•  í•„ìš” ì—†ì´ ë°”ë¡œ ê°ì²´ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆì–´ í›¨ì”¬ í¸í•˜ë‹¤. í•˜ì§€ë§Œ ë¬¸ì œê°€ í•œ ê°€ì§€ ë°œìƒí•œë‹¤. **í”„ë¡ íŠ¸ì—ì„œëŠ” page indexë¥¼ 1ë¶€í„° ê³„ì‚°í•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ Pageableì€ page indexë¥¼ 0ë¶€í„° ê³„ì‚°í•œë‹¤.** ë”°ë¼ì„œ pageì˜ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•  í•„ìš”ê°€ ìˆë‹¤.\r\n\r\n## page ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•˜ê¸°\r\n\r\n### ë°©ë²• 1. PageableHandlerMethodArgumentResolverCustomizer ì»¤ìŠ¤í„°ë§ˆì´ì§• í•˜ê¸°\r\n\r\n```java\r\n@Configuration\r\npublic class CustomPageableConfiguration {\r\n    @Bean\r\n    public PageableHandlerMethodArgumentResolverCustomizer customize() {\r\n        return p -> p.setOneIndexedParameters(true);\r\n    }\r\n}\r\n```\r\n\r\në”°ë¡œ `CustomPageableConfiguration` í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ `PageableHandlerMethodArgumentResolverCustomizer`ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•´ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤. ì—¬ê¸°ì„œ `setOneIndexedParameters` ë©”ì„œë“œë¥¼ í†µí•´ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.\r\n\r\n### ë°©ë²• 2. application-propertiesì— ì„¤ì • ì¶”ê°€í•˜ê¸°\r\n\r\n```java\r\nspring.data.web.pageable.one-indexed-parameters=true\r\n```\r\n\r\n### ìœ ì˜ì  1\r\n\r\nì´ë ‡ê²Œ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •í•˜ë©´ **ë‹¨ìˆœíˆ Controllerì—ì„œ ë°›ëŠ” Pageableì˜ page ê°’ì´ -1 ë˜ì–´ ì €ì¥ë  ë¿ì´ë‹¤.** Pageable ê°ì²´ë‚˜ ì´í›„ì— ë°˜í™˜ë°›ì€ Slice, Page ê°ì²´ì—ì„œëŠ” **page ì¸ë±ìŠ¤ê°€ ì—¬ì „íˆ 0ë¶€í„° ì‹œì‘**í•œë‹¤. \r\n\r\në”°ë¼ì„œ getNumber ë“±ì˜ ë©”ì„œë“œë¥¼ í†µí•´ page ë²ˆí˜¸ë¥¼ ë°›ìœ¼ë©´ -1ì”© ì°¨ì´ê°€ ë‚œë‹¤ëŠ” ì‚¬ì‹¤ì„ ìŠì–´ì„  ì•ˆ ëœë‹¤. **í˜„ì¬ í˜ì´ì§€ indexë¥¼ ë°˜í™˜í•˜ê³  ì‹¶ë‹¤ë©´ ë°˜ë“œì‹œ -1**ì„ í•´ì¤˜ì•¼ í•œë‹¤. ìœ ì˜í•´ì„œ ì‚¬ìš©í•˜ì.\r\n\r\n### ìœ ì˜ì  2\r\n\r\n**ë¬´í•œ ìŠ¤í¬ë¡¤ì„ Sliceë‚˜ Pageë¡œ êµ¬í˜„í•˜ë©´ ë°ì´í„°ê°€ ì¤‘ë³µìœ¼ë¡œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤.** \r\n\r\nì˜ˆë¥¼ ë“¤ì–´ ìƒê°í•´ë³´ì. 30ê°œì˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ê³  10ê°œì˜ ë°ì´í„°ë¥¼ ì¶”ê°€ë¡œ ìš”ì²­í•˜ë ¤ í•˜ëŠ”ë°, ê·¸ ì‚¬ì´ì— 10ê°œì˜ ë°ì´í„°ê°€ ì•ì— ì¶”ê°€ë˜ì—ˆë‹¤. ì´ ê²½ìš° ë°ì´í„°ê°€ 10ê°œì”© ë°€ë ¤ì„œ 21~30ë²ˆì§¸ ë°ì´í„°ê°€ ì¤‘ë³µìœ¼ë¡œ ë‚˜íƒ€ë‚˜ê²Œ ëœë‹¤.\r\në‹¬ë¡ì—ì„œëŠ” ì•„ì§ ì´ ê²½ìš°ê¹Œì§€ ê³ ë ¤í•´ì„œ í˜ì´ì§•ì„ êµ¬í˜„í•˜ì§€ ëª»í–ˆë‹¤. ì¢€ ë” ê³ ë¯¼í•´ë³´ì•„ì•¼ í•  ë¶€ë¶„ì¸ ê²ƒ ê°™ë‹¤.\r\n\r\n### References\r\n\r\n[https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/](https://tecoble.techcourse.co.kr/post/2021-08-15-pageable/)\r\n\r\n[https://treasurebear.tistory.com/59](https://treasurebear.tistory.com/59)\r\n\r\n[https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Slice.html)\r\n\r\n[https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë§¤íŠ¸ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸° ìš°ë¦¬ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì–´ë– í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ êµ¬ì„±í• ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤. ë³´í†µ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ë‚˜ëˆ„ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ìœ¼ë¡œ , ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ê³„ì¸µë³„ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³„ì¸µí˜• êµ¬ì¡°ëŠ” ê° ê³„ì¸µì„ ëŒ€í‘œí•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í•œë‹¤. ê³„ì¸µí˜• êµ¬ì¡°ì˜ ê°€ì¥ í° ì¥ì ì€ í•´ë‹¹ í”„ë¡œâ€¦","fields":{"slug":"/package-structure/"},"frontmatter":{"date":"July 18, 2022","title":"ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°","tags":["íŒ¨í‚¤ì§€ êµ¬ì¡°"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë§¤íŠ¸](https://github.com/hyeonic)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°\r\n\r\nìš°ë¦¬ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì–´ë– í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ êµ¬ì„±í• ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤. ë³´í†µ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ë‚˜ëˆ„ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ìœ¼ë¡œ `ê³„ì¸µë³„`, `ê¸°ëŠ¥ë³„`ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.\r\n\r\n### ê³„ì¸µë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°\r\n\r\n```json\r\nâ””â”€â”€ src\r\n    â”œâ”€â”€ main\r\n    â”‚   â”œâ”€â”€ java\r\n    â”‚   â”‚   â””â”€â”€ com\r\n    â”‚   â”‚       â””â”€â”€ allog\r\n    â”‚   â”‚           â””â”€â”€ dallog\r\n    â”‚   â”‚               â”œâ”€â”€ application\r\n    â”‚   â”‚               â”œâ”€â”€ config\r\n    â”‚   â”‚               â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”œâ”€â”€ presentation\r\n    â”‚   â”‚               â””â”€â”€ DallogApplication.java\r\n    â”‚   â””â”€â”€ resources\r\n    â”‚       â””â”€â”€ application.yml\r\n```\r\n\r\nê³„ì¸µí˜• êµ¬ì¡°ëŠ” ê° ê³„ì¸µì„ ëŒ€í‘œí•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í•œë‹¤. ê³„ì¸µí˜• êµ¬ì¡°ì˜ ê°€ì¥ í° ì¥ì ì€ í•´ë‹¹ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ì•„ë„ ê° ê³„ì¸µì— ëŒ€í•œ ì—­í• ì„ ì¶©ë¶„íˆ ìˆ™ì§€í•˜ê³  ìˆë‹¤ë©´ ì „ì²´ì ì¸ êµ¬ì¡°ë¥¼ ë¹ ë¥´ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.\r\n\r\ní•˜ì§€ë§Œ ë‹¨ì ë„ ì¡´ì¬í•œë‹¤. í•˜ë‚˜ì˜ íŒ¨í‚¤ì§€ì— ëª¨ë“  í´ë˜ìŠ¤ë“¤ì´ ëª¨ì´ê²Œ ë˜ê¸° ë•Œë¬¸ì— ê·œëª¨ê°€ ì»¤ì§€ë©´ í´ë˜ìŠ¤ì˜ ê°œìˆ˜ê°€ ë§ì•„ì ¸ êµ¬ë¶„ì´ ì–´ë ¤ì›Œì§„ë‹¤. ì•„ë˜ëŠ” ì´ì „ì— ê³„ì¸µí˜• êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ í”„ë¡œì íŠ¸ì´ë‹¤.\r\n\r\n```json\r\nâ””â”€â”€ presentation\r\n    â”œâ”€â”€ ChampionController.java\r\n    â”œâ”€â”€ CommentController.java\r\n    â”œâ”€â”€ PlaylistController.java\r\n    â”œâ”€â”€ RankingController.java\r\n    â”œâ”€â”€ SearchController.java\r\n    â”œâ”€â”€ UserController.java\r\n    â”œâ”€â”€ WardController.java\r\n    â””â”€â”€ ...\r\n```\r\n\r\në¹„êµì  ì ì€ ì½”ë“œì˜ ì–‘ì´ì§€ë§Œ ê·œëª¨ê°€ ì»¤ì§ˆìˆ˜ë¡ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ presentation ê³„ì¸µì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ê°ì²´ê°€ í•´ë‹¹ íŒ¨í‚¤ì§€ì— ëª¨ì´ê²Œ ë  ê²ƒì´ë‹¤.\r\n\r\n### ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°\r\n\r\nê¸°ëŠ¥ë³„ë¡œ íŒ¨í‚¤ì§€ë¥¼ ë‚˜ëˆ  êµ¬ì„±í•œë‹¤. ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°ì˜ ì¥ì ì€ í•´ë‹¹ ë„ë©”ì¸ì— ê´€ë ¨ëœ ì½”ë“œë“¤ì´ ì‘ì§‘ë˜ì–´ ìˆë‹¤ëŠ” ì ì´ë‹¤. ë•ë¶„ì— `ì§€ì—­ì„±ì˜ ì›ì¹™`ë¥¼ ì˜ ì§€í‚¬ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.\r\n\r\n> ì»´í“¨í„° ê³¼í•™ì—ì„œ, ì°¸ì¡°ì˜ ì§€ì—­ì„±, ë˜ëŠ” ì§€ì—­ì„±ì˜ ì›ì¹™ì´ë€ í”„ë¡œì„¸ì„œê°€ ì§§ì€ ì‹œê°„ ë™ì•ˆ ë™ì¼í•œ ë©”ëª¨ë¦¬ ê³µê°„ì— ë°˜ë³µì ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ê²½í–¥ì„ ì˜ë¯¸í•œë‹¤. ì°¸ì¡° ì§€ì—­ì„±ì—” ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤. ë°”ë¡œ ì‹œê°„ì  ì§€ì—­ì„±ê³¼ ê³µê°„ì  ì§€ì—­ì„±ì´ë‹¤. ì‹œê°„ì  ì§€ì—­ì„±ì´ë€ íŠ¹ì • ë°ì´í„° ë˜ëŠ” ë¦¬ì†ŒìŠ¤ê°€ ì§§ì€ ì‹œê°„ ë‚´ì— ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤. ê³µê°„ì  ì§€ì—­ì„±ì´ë€ ìƒëŒ€ì ìœ¼ë¡œ ê°€ê¹Œìš´ ì €ì¥ ê³µê°„ì— ìˆëŠ” ë°ì´í„° ìš”ì†Œë“¤ì´ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤.\r\n\r\nê°œë°œì ì—­ì‹œ ë³µì¡í•˜ê³  ê±°ëŒ€í•œ í”„ë¡œì íŠ¸ì˜ ì „ì²´ êµ¬ì¡°ë¥¼ ëª¨ë‘ ì¸ì§€í•˜ëŠ” ê²ƒì€ í˜ë“ ì¼ì´ë‹¤. ìš°ì„  íŠ¹ì • ì§€ì—­ì˜ íë¦„ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤ë©´ í•´ë‹¹ íŒ¨í‚¤ì§€ì— ëŒ€í•´ì„œëŠ” ë§ˆì¹˜ ìºì‹œì— ì ì¬ëœ ë°ì´í„°ì— ì ‘ê·¼ í•˜ë“¯ ë¹ ë¥´ê²Œ ì¸ì§€ê°€ ê°€ëŠ¥í•˜ë‹¤.\r\n\r\n```json\r\nâ””â”€â”€ src\r\n    â”œâ”€â”€ main\r\n    â”‚   â”œâ”€â”€ java\r\n    â”‚   â”‚   â””â”€â”€ com\r\n    â”‚   â”‚       â””â”€â”€ allog\r\n    â”‚   â”‚           â””â”€â”€ dallog\r\n    â”‚   â”‚               â”œâ”€â”€ auth\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\r\n    |   |               |   â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\r\n    â”‚   â”‚               â”œâ”€â”€ category\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\r\n    |   |               |   â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\r\n    â”‚   â”‚               â”œâ”€â”€ schedule\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ application\r\n    |   |               |   â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚   â””â”€â”€ presentation\r\n    â”‚   â”‚               â”œâ”€â”€ global\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ config\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ error\r\n    â”‚   â”‚               â”‚   â””â”€â”€ exception\r\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\r\n    â”‚   â”‚               â”‚   â””â”€â”€ oauth\r\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\r\n    |   |\r\n    â”‚   â””â”€â”€ resources\r\n    â”‚       â””â”€â”€ application.yml\r\n```\r\n\r\ní•˜ì§€ë§Œ ê° ê³„ì¸µì´ ê¸°ëŠ¥ë³„ë¡œ ëª¨ì—¬ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ìœ¼ë©´ ì „ì²´ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.\r\n\r\n### ë” ë‚˜ì•„ê°€ê¸°\r\n\r\ní˜„ì¬ êµ¬ì¡°ì—ì„œëŠ” ë„ë©”ì¸ì— í•´ë‹¹í•˜ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì´ íŒ¨í‚¤ì§€ ì „ë°˜ì ìœ¼ë¡œ í¼ì ¸ ìˆë‹¤. ê°ê°ì˜ ë„ë©”ì¸ ê¸°ëŠ¥ì´ ë°€ì§‘ë˜ì–´ ìˆì§€ ì•Šì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.\r\n\r\n```json\r\nâ””â”€â”€ src\r\n    â”œâ”€â”€ main\r\n    â”‚   â”œâ”€â”€ java\r\n    â”‚   â”‚   â””â”€â”€ com\r\n    â”‚   â”‚       â””â”€â”€ allog\r\n    â”‚   â”‚           â””â”€â”€ dallog\r\n    â”‚   â”‚               â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ auth\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ application\r\n    |   |               â”‚   |   â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ presentation\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ category\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ application\r\n    |   |               â”‚   |   â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”‚   â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚   â”‚   â””â”€â”€ presentation\r\n    â”‚   â”‚               â”‚   â””â”€â”€ schedule\r\n    â”‚   â”‚               â”‚       â”œâ”€â”€ application\r\n    |   |               â”‚       â”œâ”€â”€ domain\r\n    â”‚   â”‚               â”‚       â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚       â”œâ”€â”€ exception\r\n    â”‚   â”‚               â”‚       â””â”€â”€ presentation\r\n    â”‚   â”‚               â”œâ”€â”€ global\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ config\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ dto\r\n    â”‚   â”‚               â”‚   â”œâ”€â”€ error\r\n    â”‚   â”‚               â”‚   â””â”€â”€ exception\r\n    â”‚   â”‚               â”œâ”€â”€ infrastructure\r\n    â”‚   â”‚               â”‚   â””â”€â”€ oauth\r\n    â”‚   â”‚               â””â”€â”€ AllogDallogApplication.java\r\n    |   |\r\n    â”‚   â””â”€â”€ resources\r\n    â”‚       â””â”€â”€ application.properties\r\n```\r\n\r\n### domain\r\n\r\nì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ì´ ë˜ëŠ” ë„ë©”ì¸ ë¡œì§ì´ ëª¨ì—¬ ìˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ëª¨ì—¬ ìˆê¸° ë•Œë¬¸ì— `ì™¸ë¶€ì™€ì˜ ì˜ì¡´ì„±ì„ ìµœì†Œí™”`í•´ì•¼ í•œë‹¤. ì¦‰ `ì™¸ë¶€ì˜ ë³€ê²½ì— ì˜í•´ ë„ë©”ì¸ ë‚´ë¶€ê°€ ë³€ê²½ë˜ëŠ” ê²ƒì„ ë§‰ì•„ì•¼ í•œë‹¤ëŠ” ê²ƒ`ì„ ì¸ì§€í•´ì•¼ í•œë‹¤.\r\n\r\n### global\r\n\r\n`global`ì€ í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë¡œ êµ¬ì„±í•œë‹¤. ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” dtoë‚˜ error, configì— ëŒ€í•œ ê²ƒë“¤ì´ ëª¨ì—¬ ìˆë‹¤.\r\n\r\n### infrastructure\r\n\r\n`infrasturcture`ëŠ” ì™¸ë¶€ì™€ì˜ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” ë¡œì§ë“¤ì´ ë‹´ê²¨ ìˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” OAuthë¥¼ í™œìš©í•œ íšŒì› ê´€ë¦¬ë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— googleì˜ ì¸ì¦ ì„œë²„ì™€ í†µì‹ ì´ í•„ìš”í•´ì§„ë‹¤. ì´ íŒ¨í‚¤ì§€ëŠ” ìš°ë¦¬ì˜ ì˜ì§€ì™€ ë‹¤ë¥´ê²Œ ì™¸ë¶€ì˜ ë³€í™”ì— ë”°ë¼ ë³€ê²½ë  ì—¬ì§€ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì¦‰ ë³€í™”ì— ë§¤ìš° ì·¨ì•½í•œ êµ¬ì¡°ì´ë©° ì™¸ë¶€ ì„œë²„ì— ì˜ì¡´ì  ì´ê¸° ë•Œë¬¸ì— í•­ì‹œ ë³€í™”ì— ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ ëŒ€ë¹„í•´ì•¼ í•œë‹¤. ì´ê²ƒì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” ê²°êµ­ `ë„ë©”ì¸ ê´€ë ¨ íŒ¨í‚¤ì§€ì—ì„œ infrastructureë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì˜ì¡´í•˜ëŠ” ê²ƒ`ì€ ë„ë©”ì¸ ë¡œì§ì„ ì•ˆì „í•˜ê²Œ ì§€í‚¬ ìˆ˜ ì—†ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ë‚´í¬í•œë‹¤.\r\n\r\n## ì •ë¦¬\r\n\r\nê°ê°ì˜ ë°©ë²•ì€ ì„œë¡œ ë‹¤ë¥¸ ì¥ë‹¨ì ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µì€ ì—†ë‹¤ê³  ìƒê°í•œë‹¤. í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ê·œëª¨ì™€ ìš”êµ¬ì‚¬í•­ì„ ê³ ë ¤í•˜ì—¬ ì„ íƒí•´ì•¼ í•œë‹¤. ë‹¤ë§Œ ì„ íƒí•œ íŒ¨í‚¤ì§€ êµ¬ì¡°ì— ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ê°€ì ¸ì•¼í•˜ê³ , ê°ì²´ì™€ íŒ¨í‚¤ì§€ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì— ëŒ€í•´ ì¶©ë¶„íˆ ê³ ë¯¼í•´ì•¼ í•œë‹¤.\r\n\r\në‹¬ë¡ì€ í˜„ì¬ ê¸°ëŠ¥ë³„ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¡œ ì§„í–‰ë˜ê³  ìˆë‹¤. ëª¨ë“  íŒ€ì›ë“¤ì´ ì²˜ìŒ ë¶€í„° ê¸°íšê³¼ ì„¤ê³„ì— ëŒ€í•œ ê³ ë¯¼ì„ ì§„í–‰í–ˆê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ì— ëŒ€í•´ ë¶„ì„ í•˜ëŠ” ì‹œê°„ì´ ë¶ˆí•„ìš”í–ˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ê°ê°ì˜ ê¸°ëŠ¥ë“¤ì´ ë‚œì¡í•˜ê²Œ í¼ì ¸ ìˆê¸° ë•Œë¬¸ì— [ë” ë‚˜ì•„ê°€ê¸°](#á„ƒá…¥-á„‚á…¡á„‹á…¡á„€á…¡á„€á…µ)ì—ì„œ ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ì¢€ ë” ë°€ì ‘í•œ ê¸°ëŠ¥ë“¤ì„ ëª¨ì•„ë‘˜ í•„ìš”ê°€ ìˆë‹¤ê³  íŒë‹¨í•œë‹¤. ì´ê²ƒì€ ì¶”í›„ íŒ€ì›ë“¤ê³¼ ì¶©ë¶„í•œ ë…¼ì˜ë¥¼ í†µí•´ ê°œì„ í•´ê°ˆ ì˜ˆì •ì´ë‹¤.\r\n\r\n## References.\r\n\r\n[Spring Guide - Directory](https://cheese10yun.github.io/spring-guide-directory)<br>\r\n[ì§€ì—­ì„±ì˜ ì›ì¹™ì„ ê³ ë ¤í•œ íŒ¨í‚¤ì§€ êµ¬ì¡°: ê¸°ëŠ¥ë³„ë¡œ ë‚˜ëˆ„ê¸°](https://ahnheejong.name/articles/package-structure-with-the-principal-of-locality-in-mind)\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë‚˜ì¸ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ğŸ¯ \"ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•´ë³´ì„¸ìš”!\" ì–´ë–»ê²Œ êµ¬í˜„í•˜ì‹¤ ê±´ê°€ìš”? ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì²˜ìŒ ë§ˆì£¼í–ˆì„ë•Œ ğŸ¤” ì €ëŠ” ì²˜ìŒ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í–ˆì–´ìš”. scroll event ì‚¬ìš©í•˜ê¸° ìš°í…Œì½” ë ˆë²¨1 ìœ íŠœë¸Œ ë¯¸ì…˜ ì²˜ìŒ ì œê°€ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í–ˆë˜ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë°”ë¡œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì™€ ofâ€¦","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"date":"July 18, 2022","title":"Reactì—ì„œ ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„í•˜ê¸°","tags":["react"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë‚˜ì¸](https://github.com/jhy979)ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\nğŸ¯ \"ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•´ë³´ì„¸ìš”!\"\r\n\r\nì–´ë–»ê²Œ êµ¬í˜„í•˜ì‹¤ ê±´ê°€ìš”?\r\n\r\n## ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì²˜ìŒ ë§ˆì£¼í–ˆì„ë•Œ\r\n\r\nğŸ¤” ì €ëŠ” ì²˜ìŒ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í–ˆì–´ìš”.\r\n\r\n```\r\n1. scroll ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•œë‹¤.\r\n\r\n2. í˜„ì¬ ìŠ¤í¬ë¡¤ ì˜ì—­ì˜ `ìœ„ì¹˜ë¥¼ ê³„ì‚°`í•œë‹¤.\r\n\r\n3. ì˜ì—­ ê³„ì‚°ì„ í†µí•´ í˜ì´ì§€ ì•„ë˜ì— ìœ„ì¹˜í•˜ë©´ API ìš”ì²­ì„ ì§„í–‰í•œë‹¤.\r\n\r\n4. ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì—¬ ë‹¤ì‹œ ë Œë”ë§í•œë‹¤.\r\n\r\n5. ë¬´í•œ ë°˜ë³µ\r\n```\r\n\r\n---\r\n\r\n## scroll event ì‚¬ìš©í•˜ê¸°\r\n\r\n[ìš°í…Œì½” ë ˆë²¨1 ìœ íŠœë¸Œ ë¯¸ì…˜](https://github.dev/jhy979/javascript-youtube-classroom/tree/jhy979-step2)\r\n\r\nì²˜ìŒ ì œê°€ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í–ˆë˜ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\r\n\r\në°”ë¡œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì™€ offsetì„ ì´ìš©í•œ ë°©ì‹ì´ì£ !\r\n\r\n```js\r\n  scrollToBottom(callback) {\r\n    const isScrollBottom =\r\n      this.$videoList.scrollHeight - this.$videoList.scrollTop <=\r\n      this.$videoList.offsetHeight + EVENT.SCROLL.OFFSET;\r\n\r\n    if (isScrollBottom) {\r\n      callback(this.$searchInput.value);\r\n    }\r\n  }\r\n```\r\n\r\në©”ì„œë“œ ë„¤ì´ë°ì„ í†µí•´ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´, í™”ë©´ í•˜ë‹¨ê¹Œì§€ ë‚´ë ¤ê°”ì„ ê²½ìš° (offset ì •ë„ë¥¼ ê°ì•ˆí•˜ì—¬) ì¸ìë¡œ ë°›ì€ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ì—ˆìŠµë‹ˆë‹¤.\r\n\r\nì•„ ë¬¼ë¡ , ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ëŠ” ì›Œë‚™ ë§ì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— throttleì„ ê±¸ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤. (ì´ê±´ í•„ìˆ˜ì£ )\r\n\r\nğŸ˜¢ í•˜ì§€ë§Œ, `documentElement.scrollTop`, `documentElement.scrollHeight`, `documentElement.offsetHeight`ëŠ” ë¦¬í”Œë¡œìš°(Reflow)ê°€ ë°œìƒí•©ë‹ˆë‹¤.\r\n\r\ní™•ì‹¤íˆ ë¹„íš¨ìœ¨ì ì´ê² ì£ !\r\n\r\n---\r\n\r\n## IntersectionObserver ì‚¬ìš©í•˜ê¸°\r\n\r\në‹¬ë¡ì—ì„œëŠ” ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•  ë•Œ [Intersection Observer](https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API)ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.\r\n\r\n> Intersection ObserverëŠ” ì‰½ê²Œ ë§í•´ ì§€ì •í•œ ëŒ€ìƒì´ í™”ë©´ì— ë³´ì´ëŠ”ì§€ ê°ì‹œí•˜ê³  íŒë‹¨í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.\r\n\r\në¸Œë¼ìš°ì € Viewportì™€ Targetìœ¼ë¡œ ì„¤ì •í•œ ìš”ì†Œì˜ êµì°¨ì ì„ ê´€ì°°í•˜ì—¬ ê·¸ Targetì´ Viewportì— í¬í•¨ë˜ëŠ”ì§€ êµ¬ë³„í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.\r\n\r\n<img src=\"https://velog.velcdn.com/images/jhy979/post/19500233-65fc-4ba9-b421-81516700c00b/image.png\" />\r\n\r\n### useIntersect ì»¤ìŠ¤í…€í›…\r\n\r\n> ê°€ì¥ ë¨¼ì € useIntersect ë¼ëŠ” ì»¤ìŠ¤í…€í›…ì„ ì œì‘í–ˆìŠµë‹ˆë‹¤.\r\n\r\nì´ ì»¤ìŠ¤í…€í›…ì€ `ì¸ìë¡œ intersectì‹œ ì‹¤í–‰í•  í•¨ìˆ˜`ë¥¼ ë°›ê³  `refë¥¼ ì œê³µ`í•˜ì—¬ ê´€ì°°í•  ëŒ€ìƒì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n\r\n```ts\r\ntype IntersectHandler = (\r\n  entry: IntersectionObserverEntry,\r\n  observer: IntersectionObserver\r\n) => void;\r\n\r\n// ì¸ìë¡œ onIntersectì™€ optionsë¥¼ ë°›ìŠµë‹ˆë‹¤.\r\n// onIntersectëŠ” intersect ë°œìƒ ì‹œ ì‹¤í–‰í•˜ê³  ì‹¶ì€ í•¨ìˆ˜ì…ë‹ˆë‹¤.\r\nfunction useIntersect(\r\n  onIntersect: IntersectHandler,\r\n  options?: IntersectionObserverInit\r\n) {\r\n  // ê´€ì°°í•˜ê³  ì‹¶ì€ ì¹œêµ¬ë¥¼ ì¡ê¸° ìœ„í•´ refë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”.\r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  // intersect ì‹œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤ì‹œë‹¤.\r\n  const callback = useCallback(\r\n    (entries: IntersectionObserverEntry[], observer: IntersectionObserver) => {\r\n      entries.forEach((entry) => {\r\n        if (entry.isIntersecting) {\r\n          onIntersect(entry, observer);\r\n        }\r\n      });\r\n    },\r\n    [onIntersect]\r\n  );\r\n\r\n  // ğŸ”¨ ì˜µì €ë²„ì—ê²Œ ì¼ì„ ì‹œì¼œë´…ì‹œë‹¤.\r\n  useEffect(() => {\r\n    // ìš°ë¦¬ê°€ ê´€ì°°í•˜ê³  ì‹¶ì€ ì¹œêµ¬ê°€ ì—†ìœ¼ë©´ ê·¸ëƒ¥ return í•´ë²„ë ¤ìš”.\r\n    if (!ref.current) {\r\n      return;\r\n    }\r\n\r\n    // ê´€ì°°í•  ëŒ€ìƒì´ ìˆìœ¼ë©´ ì˜µì €ë²„ ë°ê¼¬ ì™€ì•¼ì£ !\r\n    const observer = new IntersectionObserver(callback, options);\r\n\r\n    // ì´ ì˜µì €ë²„í•œí…Œ ê°ì‹œë¥¼ ì‹œí‚µì‹œë‹¤.\r\n    observer.observe(ref.current);\r\n\r\n    // í•  ì¼ ëë‚˜ë©´ ê³ ìƒí•œ ì˜µì €ë²„ë„ ì‰¬ê²Œ í•´ì¤ì‹œë‹¤!\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, [ref, options, callback]);\r\n\r\n  return ref;\r\n}\r\n\r\nexport default useIntersect;\r\n```\r\n\r\n### ì‹¤ì œ ì‚¬ìš©\r\n\r\nuseIntersect ì»¤ìŠ¤í…€í›…ì„ ì˜ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì´ì œ ì´ ì»¤ìŠ¤í…€í›…ì„ ë¬´í•œ ìŠ¤í¬ë¡¤ì— ì‚¬ìš©í•´ ë´…ì‹œë‹¤.\r\n\r\n![](https://velog.velcdn.com/images/jhy979/post/4643727c-852d-4f23-ab4f-44ce79e2e3b2/image.gif)\r\n\r\në‹¤ìŒì€ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ê³„ì† ë¶ˆëŸ¬ì™€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.\r\n\r\n```tsx\r\nfunction CategoryList({\r\n  categoryList,\r\n  getMoreCategories,\r\n  hasNextPage,\r\n}: CategoryListProps) {\r\n  // useIntersect ì»¤ìŠ¤í…€í›…ì˜ ì¸ìë¡œ (êµì°¨ ì‹œ) ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤ì‹œë‹¤.\r\n  const ref = useIntersect(() => {\r\n    hasNextPage && getMoreCategories();\r\n  });\r\n\r\n  return (\r\n    <div css={categoryTable}>\r\n      <div css={categoryTableHeader}>\r\n        <span> ìƒì„± ë‚ ì§œ </span>\r\n        <span> ì¹´í…Œê³ ë¦¬ ì´ë¦„ </span>\r\n      </div>\r\n      {categoryList.map((category) => (\r\n        <CategoryItem key={category.id} category={category} />\r\n      ))}\r\n      // í˜ì´ì§€ í•˜ë‹¨ê¹Œì§€ ë‚´ë¦¬ë©´ ì´ ì¹œêµ¬ê°€ ë“±ì¥í•˜ì—¬ ì˜µì €ë²„ì—ê²Œ ê°ì§€ë  ê±°ì˜ˆìš”.\r\n      <div ref={ref} css={intersectTarget}></div>\r\n    </div>\r\n  );\r\n}\r\n```\r\n\r\nğŸ’ª ë¬´í•œ ìŠ¤í¬ë¡¤í•¨ì— ë”°ë¼ propsë¡œ ë°›ì•„ì˜¤ëŠ” categoryListê°€ ê¸¸ì–´ì§€ê²Œ ë í…ë°ìš”, ë‹¤í–‰íˆ Reactì—ì„œëŠ” keyê°’ìœ¼ë¡œ ë³€ê²½ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ë¦¬ìŠ¤íŠ¸ë“¤ë§Œ ë¦¬ë Œë”ë§í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë§¤íŠ¸ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. Git-flow git ë¸Œëœì¹˜ ì „ëµ ì¤‘ í•˜ë‚˜ì´ë‹¤, ì´ê²ƒì€ ì–´ë– í•œ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë°©ë²•ë¡ ì´ë‹¤. ê°ê°ì˜ í”„ë¡œì íŠ¸ì™€ ê°œë°œ í™˜ê²½ì— ë”°ë¼ ì•Œë§ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ ê²Œì‹œê¸€ì€ gitì„ ì•Œê³  ì‚¬ìš©í•´ ë³¸ ê²½í—˜ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì „ì œë¡œ ì‘ì„±í•˜ì˜€ë‹¤. ë˜í•œ ì§ì ‘ í”„ë¡œì íŠ¸ì— ì ìš©í•˜ê³  ì—°ìŠµí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µâ€¦","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"date":"July 12, 2022","title":"ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤.","tags":["git","git-flow"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë§¤íŠ¸](https://github.com/hyeonic)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## Git-flow\r\n\r\ngit ë¸Œëœì¹˜ ì „ëµ ì¤‘ í•˜ë‚˜ì´ë‹¤, ì´ê²ƒì€ ì–´ë– í•œ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë°©ë²•ë¡ ì´ë‹¤. ê°ê°ì˜ í”„ë¡œì íŠ¸ì™€ ê°œë°œ í™˜ê²½ì— ë”°ë¼ ì•Œë§ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤.\r\n\r\nì´ ê²Œì‹œê¸€ì€ gitì„ ì•Œê³  ì‚¬ìš©í•´ ë³¸ ê²½í—˜ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì „ì œë¡œ ì‘ì„±í•˜ì˜€ë‹¤. ë˜í•œ ì§ì ‘ í”„ë¡œì íŠ¸ì— ì ìš©í•˜ê³  ì—°ìŠµí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µì´ ë  ìˆ˜ ì—†ê³ , ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•  ì˜ˆì •ì´ë‹¤.\r\n\r\n## Git Repository\r\n\r\ní”„ë¡œì íŠ¸ì— ì ìš©í•˜ê¸° ì•ì„œ ì–´ë– í•œ í˜•íƒœë¡œ Git Repositoryê°€ êµ¬ì„±ë˜ëŠ”ì§€ ì‚´í´ë³´ì•˜ë‹¤.\r\n\r\n![](./git-repository.png)\r\n\r\n### Upstream Remote Repository\r\n\r\nê°œë°œìê°€ ê³µìœ í•˜ëŠ” ì €ì¥ì†Œë¡œ ìµœì‹  ì†ŒìŠ¤ì½”ë“œê°€ ì €ì¥ë˜ì–´ ìˆëŠ” ì›ê²© ì €ì¥ì†Œì´ë‹¤.\r\n\r\n#### ì ìš©í•˜ê¸°\r\n\r\nì´ëŸ¬í•œ Remote Repository ìƒì„±ì„ ìœ„í•˜ì—¬ githubì— New organizationì„ ì‚¬ìš©íˆì˜€ë‹¤.\r\n\r\n![](./new-organization.png)\r\n\r\në‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” Teamê³¼ EnterpriceëŠ” ì›”ë§ˆë‹¤ ì¼ì • ê¸ˆì•¡ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ ì§„í–‰ì„ ìœ„í•´ ìƒì„±í•˜ì˜€ê¸° ë•Œë¬¸ì— Freeë§Œ ì‚¬ìš©í•˜ì—¬ë„ ì¶©ë¶„í•œ ì‹¤ìŠµê³¼ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.\r\n\r\n![](./fare.png)\r\n\r\norganizationì„ ìƒì„±í•˜ê²Œ ë˜ë©´ ì†Œì†ëœ repositoryë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ `Upstream Remote Repository`ë¡œ ì ìš©í•œë‹¤.\r\n\r\n### A's, B's, C's Origin Remote Repository\r\n\r\n`Upstream Repository`ë¥¼ Forkí•œ ì›ê²© ê°œì¸ ì €ì¥ì†Œì´ë‹¤. Upstream Repositoryë¥¼ ì§ì ‘ cloneí•˜ì—¬ ì‘ì—…í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°ê°ì˜ íŒ€ì›ë“¤ì´ `Fork`ë¥¼ í•˜ì—¬ ì›ê²© ì €ì¥ì†Œë¥¼ ìƒì„±í•˜ê³  ê·¸ê²ƒì„ cloneí•˜ì—¬ `Local Repository`ë¥¼ ìƒì„±í•˜ì—¬ ì‘ì—…í•œë‹¤.\r\n\r\nì´ë ‡ê²Œ ë‘ ê°œì˜ remote repositoryë¡œ ë‚˜ëˆˆ ì´ìœ ëŠ” Upstream repositoryì˜ ê²½ìš° `íŒ€ì›ì´ ê³µìœ `í•˜ê³  ìˆëŠ” Repositoryì´ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í•˜ê¸°ì— í° ìœ„í—˜ ë¶€ë‹´ì„ ê°€ì§€ê³  ìˆë‹¤. ê°ìì˜ ê°œì¸ repositoryì—ì„œ `ì‘ì—…ì„ ì‹œë„`í•œ í›„ ì ì ˆí•œ ê¸°ëŠ¥ merge í•˜ê¸° ìœ„í•´ `Pull Request`ë¥¼ ìš”ì²­í•œë‹¤.\r\n\r\n### ìš´ì˜ ë°©ì‹\r\n\r\ngit-flowëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 5ê°€ì§€ì˜ ë¸Œëœì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš´ì˜í•œë‹¤.\r\n\r\n- `main`: ì œí’ˆìœ¼ë¡œ ì¶œì‹œë  ìˆ˜ ìˆëŠ” ë¸Œëœì¹˜\r\n- `develop`: ë‹¤ìŒ ì¶œì‹œ ë²„ì „ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜\r\n- `feature`: ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜\r\n- `release`: ì´ë²ˆ ì¶œì‹œ ë²„ì „ì„ ì¤€ë¹„í•˜ëŠ” ë¸Œëœì¹˜\r\n- `hotfix`: ì¶œì‹œ ë²„ì „ì—ì„œ ë°œìƒí•œ ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ëŠ” ë¸Œëœì¹˜\r\n\r\n![](./git-flow-dev.png)\r\n\r\n`main`ê³¼ `develop` ë¸Œëœì¹˜ì´ë‹¤. ë‘ ë¸Œëœì¹˜ëŠ” í•­ì‹œ ìš´ì˜ë˜ì–´ì•¼ í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. `develop`ëŠ” ê°œë°œì„ ìœ„í•œ ë¸Œëœì¹˜ì´ê³ , `main`ì€ ì œí’ˆìœ¼ë¡œ ì¶œì‹œë  ìˆ˜ ìˆëŠ” ë¸Œëœì¹˜ ì´ê¸° ë•Œë¬¸ì— `í•­ì‹œ ë°°í¬ ê°€ëŠ¥í•œ ìƒíƒœ`ì´ì–´ì•¼ í•œë‹¤.\r\n\r\n`main`ê³¼ `develop`ì€ `Upstream remote repository`ì—ì„œ ìš´ì˜í•œë‹¤.\r\n\r\n![](./git-flow-feature.png)\r\n\r\n`feature` ë¸Œëœì¹˜ëŠ” ë‹¨ìœ„ ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ê¸°ëŠ¥ ê°œë°œì´ ì™„ë£Œë˜ë©´ `develop` ë¸Œëœì¹˜ì™€ `merge` ëœë‹¤.\r\n\r\n`develop`ì€ ëª¨ë“  íŒ€ì›ì´ `ê³µìœ `í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. featureëŠ” ê°ì ë§¡ì•„ ì‘ì„±í•œ ì½”ë“œë“¤ì´ ë“¤ì–´ ìˆëŠ” ë¸Œëœì¹˜ì´ë‹¤. merge ì‘ì—… ì „ì— íŒ€ì›ë“¤ ê°„ì˜ `ì§€ì†ì ì¸ ì½”ë“œ ë¦¬ë·°`ê°€ í•„ìš”í•˜ë‹¤.\r\n\r\nê·¸ë ‡ê¸° ë•Œë¬¸ì— `Pull Request`ë¥¼ ì‚¬ìš©í•˜ì—¬ `merge` ì‘ì—… ì „ ë¦¬ë·°ì–´ë“¤ì—ê²Œ ì½”ë“œ ë¦¬ë·°ë¥¼ ë°›ê³  ë°˜ì˜ ì‚¬í•­ì„ ìˆ˜ì •í•˜ì—¬ commit í›„ merge í•œë‹¤. ì´ ê³¼ì •ì€ `í˜‘ì—…ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„`ì´ë¼ê³  ìƒê°ëœë‹¤.\r\n\r\n![](./git-flow-release.png)\r\n\r\n`release` ë¸Œëœì¹˜ëŠ” ë°°í¬ë¥¼ í•˜ê¸° ì „ì— ì¶©ë¶„í•œ ê²€ì¦ì„ ìœ„í•´ ìƒì„±í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ë°°í¬ ê°€ëŠ¥í•œ ìƒíƒœê°€ ë˜ë©´ `main` ë¸Œëœì¹˜ë¡œ `merge` ì‘ì—…ì„ ê±°ì¹œë‹¤. ë˜í•œ `develop`ì—ë„ ë°˜ì˜ì‚¬í•­ì„ ëª¨ë‘ `merge` ì‹œì¼œì•¼ í•œë‹¤.\r\n\r\n![](./git-flow-hotfix.png)\r\n\r\n`hotifx` ë¸Œëœì¹˜ëŠ” ë°°í¬ ì¤‘ ë²„ê·¸ê°€ ìƒê²¨ ê¸´ê¸‰í•˜ê²Œ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ë°°í¬ ì´í›„ì— ì´ë£¨ì–´ì§€ëŠ” ë¸Œëœì¹˜ì´ê³ , ë°˜ì˜ ì‚¬í•­ì„ `main`ê³¼ `develop`ì— ëª¨ë‘ ì ìš© ì‹œì¼œì•¼ í•œë‹¤.\r\n\r\nì•ì„œ ë§í–ˆë“¯ì´ `main`ê³¼ `develop`ëŠ” í•­ì‹œ ìš´ì˜ë˜ëŠ” ë¸Œëœì¹˜ì´ë‹¤. ì´ ë‘˜ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¸Œëœì¹˜ ë“¤ì€ ì œ ì—­í• ì´ ë§ˆë¬´ë¦¬ ë˜ì–´ `merge` ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ë¸Œëœì¹˜ë¥¼ ì‚­ì œí•˜ì—¬ ì •ë¦¬í•œë‹¤.\r\n\r\n### ê°„ë‹¨íˆ ì ìš©í•´ë³´ê¸°\r\n\r\n`Upstream Remote Repository`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì›ê²© ê°œì¸ ì €ì¥ì†Œì— `Fork` í•´ì•¼ í•œë‹¤.\r\n\r\n![](./fork.png)\r\n\r\nOrganizationì— ìƒì„±í•œ repositoryì— Forkë¥¼ ëˆ„ë¥´ë©´ ì†ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤. Forkë¡œ ìƒì„±ëœ repositoryë¥¼ ê¸°ë°˜ìœ¼ë¡œ `Local Repository`ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤.\r\n\r\n```bash\r\ngit clone https://github.com/{ê°œì¸ github ì´ë¦„}/{repository ì´ë¦„}.git\r\n```\r\n\r\ngit cloneì„ ì‚¬ìš©í•˜ì—¬ ì›ê²© ì €ì¥ì†Œì— ìˆëŠ” repositoryë¥¼ ì†ì‰½ê²Œ cloneí•  ìˆ˜ ìˆë‹¤.\r\n\r\n```bash\r\n$ git remote -v\r\n\r\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (fetch)\r\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (push)\r\n```\r\n\r\nclone ë°›ì€ local repositoryë¥¼ git remote -vë¡œ í™•ì¸í•´ë³´ë©´ ì›ê²© ì €ì¥ì†Œê°€ ë“±ë¡ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ë§¤ë²ˆ ìµœì‹  ì½”ë“œë¥¼ `fetch` ë° `rebase` í•˜ê¸° ìœ„í•´ì„œëŠ” `Upstream`ì„ ë“±ë¡í•´ì•¼ í•œë‹¤.\r\n\r\n```bash\r\n$ git remote add upstream https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\r\n\r\n$ git remote -v\r\n\r\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (fetch)\r\norigin  https://github.com/{github ì‚¬ìš©ì ì´ë¦„}/{repository ì´ë¦„}.git (push)\r\nupstream        https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\r\nupstream        https://github.com/{organization ì´ë¦„}/{repository ì´ë¦„}.git\r\n```\r\n\r\n`git remote add upstream`ì„ í†µí•˜ì—¬ upstreamì„ ë“±ë¡í•œë‹¤. ì •ìƒì ìœ¼ë¡œ ë“±ë¡ ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ì œ ì‘ì—…í•  ë•Œ ë§ˆë‹¤ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ê³  ìµœì‹  ì½”ë“œë¥¼ pull ë°›ì•„ì•¼ í•œë‹¤.\r\n\r\nìš°ë¦¬ íŒ€ì›ì€ ê°ê° ê°œë°œí•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì„ github issueì— ë“±ë¡í•œ í›„ ë“±ë¡ ë²ˆí˜¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.\r\n\r\nìš°ì„  ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ìœ„í•˜ì—¬ ì´ìŠˆë¥¼ ë“±ë¡í•œë‹¤.\r\n\r\n![](./issue.png)\r\n\r\n3ë²ˆ ë²ˆí˜¸ê°€ ë¶€ì—¬ëœ ì´ìŠˆë¼ê³  ê°€ì •í•œë‹¤. í•´ë‹¹ ë²ˆí˜¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ `local repository`ì—ì„œ feature ë¸Œëœì¹˜ë¥¼ ìƒì„±í•œë‹¤.\r\n\r\n```bash\r\n$ git branch feature/3-init-setting\r\n$ git checkout feature/3-init-setting\r\n```\r\n\r\nì´ì œ Upstreamì— ìˆëŠ” remote repositoryì—ì„œ ìµœì‹  ì†ŒìŠ¤ì½”ë“œë¥¼ ë°›ì•„ ì™€ì•¼ í•œë‹¤.\r\n\r\n```bash\r\n$ git fetch upstream\r\n$ git rebase upstream/develop\r\n```\r\n\r\ngit pullì„ ì‚¬ìš©í•˜ì—¬ ë“±ë¡í•œ upstream developì—ì„œ commit ê¸°ë¡ì„ ë³‘í•©í•œë‹¤. ì´ì œ ì‹ ë‚˜ê²Œ ì‘ì—…ì„ ì§„í–‰í•˜ê³  ìì‹ ì˜ ì›ê²© ì €ì¥ì†Œì¸ `Origin remote repository`ì— pushí•œë‹¤.\r\n\r\n```bash\r\n$ git push origin feature/3-init-setting\r\n```\r\n\r\nê·¸ë ‡ê²Œ github repositoryë¥¼ ì‚´í´ë³´ë©´ `ë³€ê²½ì„ ê°ì§€`í•˜ê³  pull requestë¥¼ ìƒì„±í•  ê²ƒì¸ì§€ì— ëŒ€í•œ íƒ­ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\r\n\r\n![](./upstream-repository.png)\r\n\r\nì´ì œ forkí•œ ê°œì¸ ì›ê²© ì €ì¥ì†Œë¥¼ ì‚´í´ë³´ë©´ ìƒˆë¡­ê²Œ ì‘ì„±í•œ ë¸Œëœì¹˜ë¥¼ ê°ì§€í•˜ê³  pull request ì‘ì„±ì„ ìœ„í•œ ë²„íŠ¼ì´ ìƒì„±ëœë‹¤.\r\n\r\n![](./pull-request.png)\r\n\r\n`feature/3-init-setting` ë¸Œëœì¹˜ë¥¼ developì— mergeí•˜ê¸° ìœ„í•œ pull requestë¥¼ ì§„í–‰í•˜ëŠ” ì˜ˆì‹œì´ë‹¤. ì‘ì„±í•œ ì½”ë“œë¥¼ ë¦¬ë·°í•´ì¤„ íŒ€ì›ë“¤ì„ ì„ íƒí•˜ê³ , commití•œ ì½”ë“œì˜ ë‚´ìš©ì„ ê°„ë‹¨íˆ ìš”ì•½í•˜ì—¬ ì‘ì„±í•œë‹¤. ì´ì œ ìƒì„±í•œ PRì„ ê¸°ë°˜ìœ¼ë¡œ `ì½”ë“œë¦¬ë·°`ë¥¼ ì§„í–‰í•œë‹¤. ë³€ê²½ ì‚¬í•­ì´ ì ìš©ë˜ë©´ developì— ë°˜ì˜í•˜ê¸° ìœ„í•´ mergeí•œë‹¤.\r\n\r\n### ë‹¬ë¡ì— ë§ê²Œ ìˆ˜ì •í•˜ê¸°\r\n\r\ngit-flowëŠ” ë¹ ë¥´ê²Œ ê¸‰ë³€í•˜ëŠ” ì›¹ ì„œë¹„ìŠ¤ì—ëŠ” ë§ì§€ ì•Šì€ git ë¸Œëœì¹˜ ì „ëµì´ë‹¤. ê´€ë¦¬í•´ì•¼ í•  ë¸Œëœì¹˜ê°€ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ê°œë°œìë“¤ì´ ì‹ ê²½ì¨ì•¼ í•  í¬ì¸íŠ¸ê°€ ëŠ˜ì–´ë‚œë‹¤.\r\n\r\në¹ˆë²ˆí•œ ë°°í¬ë¡œ ì¸í•´ ê¸‰ì‘ìŠ¤ëŸ¬ìš´ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¦‰ ì˜ˆìƒì¹˜ ëª»í•œ ë¡¤ë°±ì´ ìì£¼ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤. ë˜í•œ ì›¹ ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±ìƒ ë‹¤ì–‘í•œ ë¦´ë¦¬ì¦ˆ ë²„ì „ì„ ìœ ì§€í•  í•„ìš”ê°€ ì—†ë‹¤. ì´ëŸ¬í•œ íŠ¹ì„±ë“¤ë¡œ ì¸í•´ ì›¹ ì„œë¹„ìŠ¤ì—ëŠ” ë‹¤ì†Œ ë³´ìˆ˜ì ì¸ git-flow ì „ëµì€ ë§ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.\r\n\r\nê·¸ëŸ¼ì—ë„ ìš°ë¦¬ ë‹¬ë¡íŒ€ì€ git-flowë¥¼ ì„ íƒí–ˆë‹¤. ìš°ë¦¬ëŠ” ì‹¤ì œ ìš´ì˜í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ë©° ë‹¤ì–‘í•œ ê²½í—˜ì„ ìŠµë“í•´ì•¼ í•œë‹¤. ë˜í•œ ëŒ€ë¶€ë¶„ì˜ íŒ€ì›ë“¤ì´ gitì— ìµìˆ™í•˜ì§€ ì•Šì•˜ìœ¼ë©° ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í†µí•´ ë¹ ë¥´ê²Œ í•™ìŠµí•´ì•¼ í•œë‹¤.\r\n\r\nëŒ€ì‹  git-flowë¥¼ ì •ì„ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  í•„ìš”í•œ ë¶€ë¶„ì„ ìˆ˜ì •í•˜ì—¬ ë°˜ì˜í•˜ë ¤ í•œë‹¤. í˜„ì¬ ìˆ˜ì¤€ì—ì„œ `develop`ì—ì„œ ëŒ€ë¶€ë¶„ì˜ ë¹Œë“œë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— `release` ë¸Œëœì¹˜ì˜ í•„ìš”ì„±ì´ ë‹¤ì†Œ ì˜…ì–´ì¡Œë‹¤. ê²°êµ­ `release`ë¥¼ ì œì™¸í•œ `main`, `develop`, `feature`, `hotfix`ë§Œ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ë‹¤.\r\n\r\n### ë‹¬ë¡ì´ ì§‘ì¤‘í•œ ê²ƒ\r\n\r\në‹¬ë¡ì˜ íŒ€ ê° êµ¬ì„±ì›ë“¤ì€ ë§¡ì€ ì´ìŠˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•œ ë’¤ ì‘ì—…ì„ ì§„í–‰í•  ê²ƒì´ë‹¤. ê²°êµ­ ë‹¤ìˆ˜ì˜ ë¸Œëœì¹˜ê°€ ì•„ë˜ì™€ ê°™ì´ ë³‘ë ¬ì ìœ¼ë¡œ ì»¤ë°‹ì´ ìŒ“ì´ê²Œ ëœë‹¤.\r\n\r\n![](./force-push.png)\r\n\r\në§Œì•½ íŒ€ì› ì¤‘ í•œëª…ì´ ì‘ì—…ì„ ëë‚´ì„œ PRì´ mergeëœ ìƒí™©ì´ë¼ê³  ê°€ì •í•˜ì. develop ë¸Œëœì¹˜ì˜ ì»¤ë°‹ ë² ì´ìŠ¤ëŠ” ë³€ê²½ë¬ìœ¼ë©° ì´ì „ì— ì‘ì—…ì„ ì§„í–‰í•˜ë˜ ë¸Œëœì¹˜ë“¤ì€ ì‹œì‘ì ì´ ë’¤ë¡œ ë°€ë ¤ë‚˜ê²Œ ëœë‹¤.\r\n\r\nì—¬ëŸ¬ ì‚¬ëŒì´ í•˜ë‚˜ì˜ ì €ì¥ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê³µê°„ì˜ ì½”ë“œë“¤ì€ ì¶©ëŒì„ ì•¼ê¸°í•  ê°€ëŠ¥ì„±ì´ í¬ë‹¤. ì¦‰ ì§€ì†ì ì¸ `fetch` + `rebase`ë¥¼ í†µí•´ ì‚¬ì „ì— ì¶©ëŒì— ëŒ€ë¹„í•˜ë©° í•­ìƒ `develop` ë¸Œëœì¹˜ì™€ ì»¤ë°‹ ì‹±í¬ë¥¼ ë§ì¶˜ë‹¤.\r\n\r\nì •ë¦¬í•˜ë©´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ í•­ì‹œ develop ë¸Œëœì¹˜ì˜ ë ë‹¨ì—ì„œ ì‹œì‘í•´ì•¼ í•œë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì€ ì½”ë“œì˜ ì¶©ëŒì„ ìµœì†Œí™”í•  ìˆ˜ ìˆìœ¼ë©° ìˆœì°¨ì ì¸ git ì»¤ë°‹ ëª©ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ ì‰½ê²Œ ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.\r\n\r\n## ì •ë¦¬\r\n\r\nì§€ê¸ˆê¹Œì§€ ê°„ë‹¨íˆ `git-flowì˜ íë¦„`ê³¼ ì´ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ `ë‹¬ë¡ì— ì ìš©í•œ ê³¼ì •`ë“¤ì„ ì•Œì•„ë³´ì•˜ë‹¤. git-flowëŠ” ì–¸ê¸‰í•œ ê²ƒ ì²˜ëŸ¼ ë¶€ê°€ì ì¸ ë¸Œëœì¹˜ë¡œ ì¸í•´ `ê´€ë¦¬ì— ëŒ€í•œ ë¶€ë‹´ê°`ì„ ëŠë‚„ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ `upstream`ê³¼ `origin`ì„ ë¶„ë¦¬í•œ í™˜ê²½ì€ ì¢€ ë” ë„ì „ì ì¸ ê³¼ì œë“¤ì„ ì ìš©í•˜ê¸°ì— ë§¤ìš° ì¢‹ì€ í™˜ê²½ì„ êµ¬ì„±í•´ì¤€ë‹¤. ë˜í•œ `pull request`ë¥¼ í†µí•œ ì½”ë“œ ë¦¬ë·°ë¥¼ í†µí•´ ë³´ë‹¤ ë” ì–‘ì§ˆì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì— í˜ì“¸ ìˆ˜ ìˆë‹¤.\r\n\r\n## References.\r\n\r\n[git flow; í™˜ìƒê³¼ í˜„ì‹¤ ê·¸ ì‚¬ì´ì— ì„œë¹„ìŠ¤](https://vallista.kr/git-flow;-%ED%99%98%EC%83%81%EA%B3%BC-%ED%98%84%EC%8B%A4-%EA%B7%B8-%EC%82%AC%EC%9D%B4%EC%97%90-%EC%84%9C%EB%B9%84%EC%8A%A4/)<br>\r\n[ìš°ë¦° Git-flowë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”](https://woowabros.github.io/experience/2017/10/30/baemin-mobile-git-branch-strategy.html)<br>\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ í›„ë””ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë°°ê²½ ìš°í…Œì½” ë ˆë²¨3 ë‹¬ë¡ íŒ€ì—ì„œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ëŠ” ë°˜ë“œì‹œ  í‚¤ì›Œë“œë¥¼ ë¶™ì´ë„ë¡ ì»¨ë²¤ì…˜ì„ ì •í–ˆìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì¼ë°˜ì ìœ¼ë¡œ ê°€ë³€ì ì¸ ë³€ìˆ˜ëŠ” í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë”°ë¼ì„œ ë³€ìˆ˜ë¥¼ ê°€ë³€ì ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ìë°”ì—ì„œëŠ” ë³€ìˆ˜ì˜ ì¬í• ë‹¹ì„ ë§‰ê¸° ìœ„í•´  í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¬¼ë¡ â€¦","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"date":"July 12, 2022","title":"IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œí•œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì— final í‚¤ì›Œë“œ ìë™ ì¶”ê°€í•˜ê¸°","tags":["intellij"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [í›„ë””](https://github.com/devHudi)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## ë°°ê²½\r\n\r\nìš°í…Œì½” ë ˆë²¨3 ë‹¬ë¡ íŒ€ì—ì„œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ëŠ” ë°˜ë“œì‹œ `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ë„ë¡ ì»¨ë²¤ì…˜ì„ ì •í–ˆìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì¼ë°˜ì ìœ¼ë¡œ ê°€ë³€ì ì¸ ë³€ìˆ˜ëŠ” í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë”°ë¼ì„œ ë³€ìˆ˜ë¥¼ ê°€ë³€ì ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ìë°”ì—ì„œëŠ” ë³€ìˆ˜ì˜ ì¬í• ë‹¹ì„ ë§‰ê¸° ìœ„í•´ `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¬¼ë¡  `final` í‚¤ì›Œë“œ í•˜ë‚˜ë§Œìœ¼ë¡œ ì™„ì „í•œ ë¶ˆë³€ì„ ë³´ì¥í•˜ë„ë¡ ë§Œë“¤ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì–´ëŠì •ë„ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ë§Œë“œëŠ”ë°ì—ëŠ” ë„ì›€ì´ ë©ë‹ˆë‹¤.\r\n\r\nì´ëŠ” ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì—ë„ ì ìš©ë©ë‹ˆë‹¤. ì•„ë˜ì˜ ì½”ë“œëŠ” `Memo` ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ìƒì„±ìì…ë‹ˆë‹¤. `value` ë¼ëŠ” String ê°’ì„ ì „ë‹¬ë°›ì•„ ê°ì²´ í•„ë“œì— í• ë‹¹í•©ë‹ˆë‹¤.\r\n\r\n```java\r\npublic Memo(String value) {\r\n    validateLength(value);\r\n\r\n    value = \"hello\"; // ì˜ˆìƒì¹˜ ëª»í•œ ì½”ë“œ\r\n\r\n    this.value = value;\r\n}\r\n```\r\n\r\ní•˜ì§€ë§Œ ìœ„ì²˜ëŸ¼ ì˜ˆìƒì¹˜ ëª»í•œ ì½”ë“œê°€ ì¶”ê°€ë˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? `value` í•„ë“œì—ëŠ” ê°œë°œìê°€ ì˜ë„í•˜ì§€ ëª»í•œ ê°’ì´ í• ë‹¹ë  ê²ƒ ì…ë‹ˆë‹¤.\r\n\r\n```java\r\npublic Memo(final String value) {\r\n    validateLength(value);\r\n\r\n    value = 1; // error: final parameter value may not be assigned\r\n\r\n    this.value = value;\r\n}\r\n```\r\n\r\nì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ì„œ ìœ„ì²˜ëŸ¼ ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ë©´, ì¬í• ë‹¹ ì‹œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ì„ ì‚¬ì „ì— ë°©ì§€í•  ìˆ˜ ìˆì„ ê²ƒ ì…ë‹ˆë‹¤.\r\n\r\n## IntelliJ ì„¤ì •í•˜ê¸°\r\n\r\ní•˜ì§€ë§Œ, ì €í¬ëŠ” ì•„ì§ ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— `final` í‚¤ì›Œë“œë¥¼ ë¶™ì´ëŠ” ìŠµê´€ì´ ë“¤ì–´ìˆì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ IDEì˜ ë„ì›€ì´ í•„ìš”í•œë°ìš”, ë‹¤í–‰íˆë„ IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œ ë¦¬íŒ©í† ë§ì„ í•  ë•Œ ìƒì„±ë˜ëŠ” ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì— ìë™ìœ¼ë¡œ `final` í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ì£¼ëŠ” ì˜µì…˜ì„ ë°œê²¬í•˜ì˜€ìŠµë‹ˆë‹¤.\r\n\r\n![IntelliJ ì„¤ì • í™”ë©´](./intellij.png)\r\n\r\në§¥ ê¸°ì¤€ìœ¼ë¡œ Preferences â†’ Editor â†’ Code Style â†’ Java í˜ì´ì§€ì—ì„œ Code Generation íƒ­ì„ í´ë¦­í•©ë‹ˆë‹¤. í•´ë‹¹ íƒ­ì˜ í•˜ë‹¨ì— â€˜Final Modifierâ€™ ì—ì„œ â€˜Make generated parameters finalâ€™ ì„ ì²´í¬í•´ì¤ë‹ˆë‹¤. ìœ„ì™€ ê°™ì´ ì˜µì…˜ì„ ë³€ê²½í•˜ë©´ ë©”ì†Œë“œ ì¶”ì¶œ ì‹œ íŒŒë¼ë¯¸í„°ì— ìë™ìœ¼ë¡œ `final` í‚¤ì›Œë“œê°€ ìƒì„±ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ˜Š\r\n"},{"excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë¦¬ë²„ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. JPA ë“±ì¥ë°°ê²½ 1990ë…„ëŒ€ ì¸í„°ë„·ì´ ë³´ê¸‰ë˜ë©´ì„œ ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ê°€ í™œì„±í™” ë˜ì—ˆë‹¤.\nìì—°ìŠ¤ëŸ½ê²Œ, ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ì—ì„œ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ë•Œ ì‚¬ìš©í•  Connection Connectorì— ëŒ€í•œ ë‹ˆì¦ˆê°€ ë†’ì•„ì¡Œë‹¤.\nê·¸ë˜ì„œ ê° ì–¸ì–´ë“¤ì—ì„œ DB Connectionì„ ì§€ì›í•˜ëŠ” API ê¸°ìˆ ë“¤ì´ ë“±ì¥í•˜ì˜€ë‹¤. ì´â€¦","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"date":"July 07, 2022","title":"JPA ë“±ì¥ë°°ê²½","tags":["JPA"]},"rawMarkdownBody":"\r\n> ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ [ë¦¬ë²„](https://github.com/gudonghee2000)ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\r\n\r\n## JPA ë“±ì¥ë°°ê²½\r\n\r\n1990ë…„ëŒ€ ì¸í„°ë„·ì´ ë³´ê¸‰ë˜ë©´ì„œ ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ê°€ í™œì„±í™” ë˜ì—ˆë‹¤.\r\nìì—°ìŠ¤ëŸ½ê²Œ, ì˜¨ë¼ì¸ ë¹„ì§€ë‹ˆìŠ¤ì—ì„œ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê°€ì ¸ì˜¬ë•Œ ì‚¬ìš©í•  Connection Connectorì— ëŒ€í•œ ë‹ˆì¦ˆê°€ ë†’ì•„ì¡Œë‹¤.\r\nê·¸ë˜ì„œ ê° ì–¸ì–´ë“¤ì—ì„œ DB Connectionì„ ì§€ì›í•˜ëŠ” API ê¸°ìˆ ë“¤ì´ ë“±ì¥í•˜ì˜€ë‹¤. ì´í›„ì— Springì—ì„œëŠ” DB Connectionì„ ì¢€ ë” ì‰½ê²Œ ê´€ë¦¬í•˜ëŠ” Spring JDBC APIë¥¼ ë§Œë“¤ê³  ì§€ì›í•˜ì˜€ë‹¤. (ì´ì™¸ì—ë„ Queryë¬¸ì„ XMLíŒŒì¼ì„ í†µí•´ ê´€ë¦¬í•˜ê²Œë” ë„ì™€ì£¼ëŠ” Mybatisë„ ë“±ì¥í•˜ì˜€ìŒ)\r\ní•˜ì§€ë§Œ, ì—¬ì „íˆ ì¿¼ë¦¬ë¬¸ì„ ê°œë°œìê°€ ì§ì ‘ ì‘ì„±í•´ì•¼í•˜ëŠ” ë“± ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ê°€ì§€ê³  ìˆì—ˆë‹¤.\r\nê·¸ë˜ì„œ JAVA ì§„ì˜ì—ì„œëŠ” ê°œë°œìê°€ ì¿¼ë¦¬ë¬¸ì„ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ í”„ë ˆì„ì›Œí¬ ë‚´ë¶€ì—ì„œ ì§€ì›í•´ì£¼ëŠ” ORM(Object Relational Model)ê¸°ìˆ ì¸ JPAê°€ ë“±ì¥í•˜ì˜€ë‹¤.\r\nê·¸ë ‡ë‹¤ë©´, JPA ì´ì „ì— ê°œë°œìë“¤ì´ ì§ì ‘ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ë˜ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë‹¨ì ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?\r\nì•„ë˜ì—ì„œ ì‚´í´ë³´ì.\r\n\r\n## SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë‹¨ì \r\n\r\n#### 1. ì¿¼ë¦¬ë¬¸ ë¬´í•œ ë°˜ë³µê³¼ ì§€ë£¨í•œ ì½”ë”©\r\n\r\nJDBC APIëŠ” ì¿¼ë¦¬ë¬¸ì„ ê°œë°œìë“¤ì´ ì§ì ‘ ì‘ì„± í•´ì•¼í•œë‹¤.\r\nê·¸ë˜ì„œ ê°œë°œìë“¤ì€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ëŠ” ì§€ë£¨í•œ ì‘ì—…ì„ ê°œë°œ ê³¼ì •ì—ì„œ ë¬´í•œë°˜ë³µí•´ì•¼í•œë‹¤.\r\n\r\n#### 2. ê°ì²´ì˜ í•„ë“œê°€ ì¶”ê°€ë˜ë©´ ëª¨ë“  ì¿¼ë¦¬ë¬¸ì„ ìˆ˜ì •í•´ì•¼í•œë‹¤.\r\n\r\n![](https://velog.velcdn.com/images/gudonghee2000/post/488a7899-d55b-4447-aafc-bada8d840192/image.jpg)\r\nìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì—ì„œëŠ” ê°ì²´ì˜ í•„ë“œê°€ ë³€ê²½ë˜ë©´ í•´ë‹¹í•˜ëŠ” ëª¨ë“  ì¿¼ë¦¬ë¬¸ì„ ì°¾ì•„ ê°œë°œìê°€ ìˆ˜ì •í•´ì•¼í•œë‹¤.\r\n\r\n#### 3. ê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜\r\n\r\nê°ì²´ë¼ê³  í•˜ë©´ ë– ì˜¤ë¥´ëŠ” í‚¤ì›Œë“œëŠ” ë¬´ì—‡ì´ ìˆì„ê¹Œ?\r\nìº¡ìŠí™”, í˜‘ë ¥, ì˜ì¡´, ìƒì†, ì°¸ì¡° ë“±ì˜ ê¸°ìˆ ì´ ìˆë‹¤. ê·¸ëŸ°ë°, DBì—ì„œëŠ” ì´ëŸ¬í•œ ê¸°ìˆ ë“¤ì´ ì—†ë‹¤.\r\nì ìš©ë˜ëŠ” ê¸°ìˆ ë“¤ì˜ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ë¡œ ì¸í•´ ê°œë°œìë“¤ì€ SQL ì§€í–¥ì ì¸ ê°œë°œì„ í•  ìˆ˜ ë°–ì— ì—†ë‹¤.\r\nì•„ë˜ì—ì„œ ìì„¸íˆ ì‚´í´ë³´ì.\r\n\r\n## ê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ ì°¨ì´\r\n\r\nê°ì²´ì™€ ê´€ê³„í˜• DBëŠ” ì—°ê´€ê´€ê³„ë¥¼ í†µí•´ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ëŠ” ê³µí†µì ì„ ê°€ì§„ë‹¤.\r\ní•˜ì§€ë§Œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¥¼ ê°€ì§„ë‹¤.\r\n\r\nê°ì²´ëŠ” ìƒì†, ì°¸ì¡°ë¥¼ í†µí•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.\r\në°˜ë©´ ê´€ê³„í˜• DBëŠ” PK, FKë¥¼ í†µí•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.\r\nì´ë•Œ, ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ë°©ì‹ì˜ ì°¨ì´ë¡œ ë°œìƒí•˜ëŠ” ë¬¸ì œì ì„ ì½”ë“œì™€ í•¨ê»˜ ì‚´í´ë³´ì.\r\n\r\n```java\r\npublic class Crew {\r\n   private Long id;\r\n    private String name;\r\n    private String nickName;\r\n    private Team team;\r\n}\r\n\r\npublic class Team {\r\n   private Long id;\r\n    private String team_name;\r\n}\r\n```\r\n\r\nìœ„ì™€ ê°™ì´ `Crew` ê°ì²´ê°€ `Team` ê°ì²´ë¥¼ í•„ë“œë¡œ ê°€ì§€ê³  ì°¸ì¡°í•œë‹¤ê³  í•˜ì.\r\nê°ì²´ì§€í–¥ì ì¸ ê´€ì ì—ì„œ, `Crew`ì™€ `Team`ì˜ ê´€ê³„ë¥¼ ìœ„ì™€ ê°™ì´ í‘œí˜„í•˜ëŠ”ê²ƒì€ ìì—°ìŠ¤ëŸ½ë‹¤.\r\n\r\ní•˜ì§€ë§Œ, DBì—ì„œëŠ” `Crew`ê°€ `Team`ì„ ì°¸ì¡°í•œë‹¤ëŠ” ê°œë…ì´ ì—†ë‹¤.\r\nê·¸ë˜ì„œ ìœ„ ê°ì²´ë“¤ì„ ê°€ì§€ê³  DBì˜ `Crew`í…Œì´ë¸”ê³¼ `Team`í…Œì´ë¸”ì˜ ê´€ê³„ë¥¼ ë§ºì„ë•Œ, ì•„ë˜ì™€ ê°™ì´ `PK` ê°’ì¸ idë¥¼ `FK`ë¡œ ê°€ì§€ë„ë¡ êµ¬í˜„ í•˜ì—¬ì•¼í•œë‹¤.\r\n![ERD](./erd.png)\r\n\r\nì—°ê´€ê´€ê³„ì— ëŒ€í•´ì„œ ê°ì²´ì˜ êµ¬ì¡°ì™€ DBì˜ êµ¬ì¡°ê°€ ë‹¬ë¼ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤.\r\n\r\nê·¸ë ‡ë‹¤ë©´ ê°ì²´ì§€í–¥ì ì¸ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§„ ê°ì²´ë“¤ì„ DBì— ì €ì¥ í•  ë•Œ,\r\nDBì˜ ì—°ê´€ê´€ê³„ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì™œ ë¬¸ì œê°€ ë ê¹Œ?\r\n\r\n## ê°ì²´ì™€ RDBì˜ ì—°ê´€ê´€ê³„ ì°¨ì´ê°€ ê°€ì ¸ì˜¤ëŠ” ë¬¸ì œ\r\n\r\nìœ„ì—ì„œ ë´¤ë˜ `Crew`ì™€ `Team`ì˜ ê°ì²´ ëª¨ë¸ë§ì„ ë‹¤ì‹œí•œë²ˆ ì‚´í´ë³´ì.\r\n\r\n```java\r\npublic class Crew {\r\n   private Long id;\r\n    private String name;\r\n    private String nickName;\r\n    private Team team;\r\n}\r\n\r\npublic class Team {\r\n   private Long id;\r\n    private String team_name;\r\n}\r\n```\r\n\r\nìœ„ì™€ ê°™ì´ ëª¨ë¸ë§ëœ `Crew`ì™€ `Team`ì„ DBì— ì €ì¥í•œë‹¤ê³  í•œë‹¤ë©´ ë‹¤ìŒì˜ ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.\r\nDBì— ì ‘ê·¼í•˜ê³ ì í•˜ëŠ” Dao ê°ì²´ëŠ” `Crew`ê°ì²´ë¥¼ ë¶„í•´í•˜ê³  ê°ì `Crew` í…Œì´ë¸”ê³¼ `Team` í…Œì´ë¸”ì— ëŒ€í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤. ë‹¨ìˆœíˆ `Crew`ì˜ ê°ì²´ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ”ë° 3ê°€ì§€ ê³¼ì •ì„ ê±°ì³ì•¼í•œë‹¤.\r\n\r\nì´ëŸ¬í•œ ë³µì¡í•œ ê³¼ì •ì„ í”¼í•˜ëŠ” ë°©ë²•ì€ ì—†ì„ê¹Œ?\r\nì•„ë˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì.\r\n\r\n```java\r\npublic class Crew {\r\n   private Long id;\r\n    private String name;\r\n    private String nickName;\r\n    private Long team_id;\r\n}\r\n\r\npublic class Team {\r\n   private Long id;\r\n    private String team_name;\r\n}\r\n```\r\n\r\nìœ„ì™€ ê°™ì´ DB í…Œì´ë¸” êµ¬ì¡°ì— ë§ì¶”ì–´ `Crew`ì™€ `Team` ê°ì²´ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì´ìˆë‹¤.\r\nì´ëŸ¬í•œ ê°ì²´ ëª¨ë¸ë§ì€ Dao ê°ì²´ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ DBì— ì €ì¥ í•  ë•Œ, `Crew` ê°ì²´ë¥¼ ë¶„í•´í•˜ëŠ” ê³¼ì •ì„ ì‚­ì œ í•  ìˆ˜ ìˆë‹¤.\r\nê°ì²´ê°€ DB êµ¬ì¡°ì— ë§ì¶”ì–´ ì„¤ê³„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.\r\n\r\n**í•˜ì§€ë§Œ, ê°ì²´ ëª¨ë¸ë§ì„ í•  ë•Œ ê°ì²´ê°€ ì„œë¡œ ì°¸ì¡°í•˜ëŠ” ê°ì²´ì§€í–¥ì ì¸ ê°œë°œì´ ì•„ë‹Œ\r\nDB í…Œì´ë¸”êµ¬ì¡°ì— ë§ì¶”ì–´ ê°œë°œí•˜ëŠ” SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì„ í•˜ê²Œ ëœë‹¤ëŠ” ë¬¸ì œë¥¼ ê°€ì§„ë‹¤.**\r\n\r\nê°ì²´ì™€ ê´€ê³„í˜• DBì˜ ì—°ê´€ê´€ê³„ì˜ íŒ¨ëŸ¬ë‹¤ì„ ì°¨ì´ëŠ” ê°ì²´ë¥¼ ê°ì²´ë‹µì§€ ëª»í•˜ê²Œ ë§Œë“ ë‹¤ëŠ” ê²ƒì´ë‹¤.\r\nê·¸ë ‡ë‹¤ë©´, íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ì—†ì„ê¹Œ?\r\n\r\n## JPA\r\n\r\nê°ì²´ì™€ ê´€ê³„í˜• DBì˜ íŒ¨ëŸ¬ë‹¤ì„ì˜ ì°¨ì´ë¡œ ì¸í•´ ìš°ë¦¬ëŠ” ê°ì²´ì§€í–¥ì ì¸ í”„ë¡œê·¸ë˜ë°ì„ í•˜ì§€ëª»í•˜ê³  DBì— ì¢…ì†ì ì¸ ê°œë°œì„ í•˜ê²Œëœë‹¤.\r\nì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ JAVAì§„ì˜ì—ì„œëŠ” JPAë¥¼ ì œê³µí•œë‹¤.\r\n\r\nJPAë¥¼ í†µí•´ ê°œë°œìëŠ” ë”ì´ìƒ ì¿¼ë¦¬ë¬¸ì„ ë°˜ë³µì ìœ¼ë¡œ ì‘ì„±í•˜ê±°ë‚˜ ìœ ì§€ë³´ìˆ˜í•˜ëŠ” ê²ƒì„ ì‹ ê²½ì“°ì§€ ì•Šì•„ë„ ëœë‹¤.\r\nì™œëƒí•˜ë©´ JPAê°€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.\r\nê·¸ë¦¬ê³  SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì—ì„œ ë²—ì–´ë‚˜ ê°ì²´ì§€í–¥ì ì¸ ê°œë°œì„ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.\r\nì™œëƒí•˜ë©´ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ë¥¼ JPAê°€ ë‚´ë¶€ì ìœ¼ë¡œ ë§µí•‘í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.\r\n\r\në‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” JPAì˜ ì‘ë™ ë©”ì»¤ë‹ˆì¦˜ì„ ìì„¸íˆ ì‚´í´ë³´ì.\r\n"}]}},"pageContext":{}},"staticQueryHashes":[]}
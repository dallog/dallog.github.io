{"componentChunkName":"component---src-templates-post-jsx","path":"/query-invalidation/","result":{"data":{"site":{"siteMetadata":{"title":"dal.log"}},"markdownRemark":{"id":"1e93cfc2-f4ae-5ffb-b7d6-1980189ab0b2","excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë‚˜ì¸ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. React-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. Stale ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. react queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ â€¦","html":"<blockquote>\n<p>ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ <a href=\"https://github.com/jhy979\">ë‚˜ì¸</a>ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>React-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>\n<h2>Stale</h2>\n<blockquote>\n<p>ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.</p>\n</blockquote>\n<p>react queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ë³¼ ìˆ˜ ìˆê² ì£ ?)</p>\n<h3>staleTime</h3>\n<blockquote>\n<p>ë°ì´í„°ê°€ freshí•œ ìƒíƒœì—ì„œ staleí•œ ìƒíƒœë¡œ ë³€í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<ul>\n<li>fresh ìƒíƒœì¼ë•ŒëŠ” ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒˆë¡­ê²Œ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. </li>\n<li>ë°ì´í„°ê°€ fetch ë˜ê³  ë‚˜ì„œ staleTimeì´ ì§€ë‚˜ì§€ ì•Šì•˜ë‹¤ë©´ unmount í›„ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>\n</ul>\n<h3>cacheTime</h3>\n<blockquote>\n<p>ë°ì´í„°ê°€ inactive ìƒíƒœì¼ ë•Œ ìºì‹±ëœ ìƒíƒœë¡œ ë‚¨ì•„ìˆëŠ” ì‹œê°„ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<ul>\n<li>ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ unmount ë˜ë©´ ë°ì´í„°ëŠ” inactive ìƒíƒœë¡œ ë³€ê²½ë˜ë©°, ìºì‹œëŠ” cacheTimeë§Œí¼ ìœ ì§€ë©ë‹ˆë‹¤.</li>\n<li>cacheTimeì€ staleTimeê³¼ ê´€ê³„ì—†ì´, ë¬´ì¡°ê±´ <code class=\"language-text\">inactiveëœ ì‹œì </code>ì„ ê¸°ì¤€ìœ¼ë¡œ ìºì‹±ì„ ê²°ì •í•©ë‹ˆë‹¤.</li>\n</ul>\n<hr>\n<h2>ë‹¬ë¡ì—ì„œì˜ ë°ì´í„° ìµœì‹ í™”</h2>\n<blockquote>\n<p>ë‹¬ë¡ì€ ì¼ì •, ì¹´í…Œê³ ë¦¬, êµ¬ë… ë“±ì˜ ì‘ì—…ìœ¼ë¡œ ì¸í•´ ë°ì´í„°ì˜ ë³€í™”ê°€ ì¦ì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ íŒ€ì€ staleTimeì„ ì§€ì •í•´ì£¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>ê·¸ë ‡ë‹¤ë©´ staleí•œ ë°ì´í„°ëŠ” ëŠ˜ ìµœì‹ í™”ê°€ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ê·¸ë˜ì„œ ì €ëŠ” ë§¤ë²ˆ ìƒˆë¡œìš´ ë°ì´í„°ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ <code class=\"language-text\">useQueryì˜ refetch</code>ë¥¼ ê°•ì œì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ë°©ì‹ì„ ìƒê°í–ˆì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ì˜ˆë¥¼ ë“¤ë©´ ì¼ì •ì„ ì¶”ê°€(post)í•œ í›„ì— ì¼ì •ì„ ë‹¤ì‹œ ì¡°íšŒ(get)í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ê²ë‹ˆë‹¤.</p>\n<p><img src=\"https://velog.velcdn.com/images/jhy979/post/287f66a2-8b7e-49c8-b623-c05a491db600/image.png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// refetch í•¨ìˆ˜ë¥¼ ë¶€ëª¨ë¡œ ë¶€í„° ì£¼ì… ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">ScheduleAddModal</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> closeModal<span class=\"token punctuation\">,</span> refetch <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> ScheduleAddModalProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onSuccessPostSchedule</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">refetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ğŸ˜¢ í•˜ì§€ë§Œ ì´ ë°©ì‹ì´ ìš°ì•„í•˜ì§€ëŠ” ì•Šë”ë¼êµ¬ìš”. </p>\n<p>ë§Œì•½ ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ propsì „ë‹¬ì´ ì•„ë‹ˆë¼ ì¡°ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ props ì „ë‹¬ì´ë¼ë©´ ì–´ë–¨ê¹Œìš”? ë²Œì¨ ë¨¸ë¦¬ê°€ ì•„íŒŒì˜µë‹ˆë‹¤. (props hell)</p>\n<h2>Query Invalidation ë„ì…</h2>\n<p>ğŸ¤” ë‹¤ë¥¸ ë°©ë²•ì´ ìˆì„í…ë°.. ì–´ë–¤ ë°©ë²•ì´ ìˆì„ê¹Œ? ê³ ë¯¼í•˜ë©° ê³µì‹ë¬¸ì„œë¥¼ ì½ë˜ ë„ì¤‘ <code class=\"language-text\">Query Invalidation</code>ì„ ë°œê²¬í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Invalidate every query in the cache</span>\nqueryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Invalidate every query with a key that starts with `todos`</span>\nqueryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'todos'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>The QueryClient has an invalidateQueries method that lets you intelligently mark queries as stale and potentially refetch them too!</p>\n</blockquote>\n<p>â— ìºì‹±í‚¤ë¡œ ê´€ë ¨ëœ stale ì¿¼ë¦¬ë“¤ì„ ì²´í¬í•˜ê³  refetchí•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">ScheduleAddModal</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> closeModal <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> ScheduleAddModalProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> queryClient <span class=\"token operator\">=</span> <span class=\"token function\">useQueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onSuccessPostSchedule</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ì¼ì • post ì„±ê³µ ì‹œ ë°ì´í„° ìµœì‹ í™”ë¥¼ invalidateQueriesë©”ì„œë“œë¥¼ í†µí•´ ìˆ˜í–‰í•©ë‹ˆë‹¤.</span>\n    queryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_KEY</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SCHEDULES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ğŸ’ª ì´ë¡œì¨ useQueryì˜ refetchí•¨ìˆ˜ë¥¼ ë„˜ê²¨ì¤„ í•„ìš”ì—†ì´ ì–´ë””ì„œë“  ìºì‹±í‚¤ë¡œ freshí•œ ë°ì´í„°ë¥¼ ë³´ì¥í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<h4>ì°¸ê³ ìë£Œ</h4>\n<p><a href=\"https://tanstack.com/query/v4/docs/guides/query-invalidation\">https://tanstack.com/query/v4/docs/guides/query-invalidation</a></p>","frontmatter":{"title":"React-Queryì—ì„œì˜ ë°ì´í„° ìµœì‹ í™” (Query Invalidation)","date":"August 01, 2022","update":null,"tags":["react","react-query"],"series":null},"fields":{"slug":"/query-invalidation/","readingTime":{"minutes":1.66}}},"seriesList":{"edges":[{"node":{"id":"76f78cb8-db6c-5554-981a-6aea792bd3da","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"title":"JPA ë“±ì¥ë°°ê²½"}}},{"node":{"id":"c1266cda-3c7d-585d-8f24-ac46ae0d2c3c","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"title":"IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œí•œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì— final í‚¤ì›Œë“œ ìë™ ì¶”ê°€í•˜ê¸°"}}},{"node":{"id":"b07b4858-95f4-5939-8940-aa1250687abd","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"title":"ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤."}}},{"node":{"id":"332ae3b0-7133-54e9-ba46-d24f2a02fe6e","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"title":"Reactì—ì„œ ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„í•˜ê¸°"}}},{"node":{"id":"f0db7de2-e0b0-5446-b8a5-279c030cb6a8","fields":{"slug":"/package-structure/"},"frontmatter":{"title":"ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°"}}},{"node":{"id":"901c4725-fcf0-5869-a936-7abd5c299552","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"title":"Spring Data JPAì˜ Slice & Page"}}},{"node":{"id":"76b463c4-bb51-5a29-82df-deae0a989406","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"title":"Spring Data JPAì˜ Auditing"}}},{"node":{"id":"1e0b47dd-2623-5427-a3e9-30357be3be2f","fields":{"slug":"/separated-interface/"},"frontmatter":{"title":"ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°"}}},{"node":{"id":"f5b486f2-7f2e-5907-9380-8646b727011b","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"title":"MockMvcë¥¼ ì‚¬ìš©í•œ Spring RestDocs"}}},{"node":{"id":"6c7a3b90-ff64-58fd-8199-cb65a649efc4","fields":{"slug":"/properties-to-object/"},"frontmatter":{"title":"properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°"}}},{"node":{"id":"bc4c1cf5-0f26-5035-b972-2e958c20d98d","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"title":"í…ŒìŠ¤íŠ¸ì—ì„œ Entity ê°ì²´ë¥¼ ìƒìˆ˜ë¡œ ë‘ë©´ ì•ˆ ë˜ëŠ” ì´ìœ "}}},{"node":{"id":"ba61f03e-dcc7-58a5-b6bb-77eff9c36918","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"title":"NGINX ë€?"}}},{"node":{"id":"5a7c6740-32e0-5d7e-b91c-37ca4ae42fc7","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"title":"SSLì„ í†µí•œ HTTPSí†µì‹  ê³¼ì •"}}},{"node":{"id":"76099a1d-7977-5447-9e88-4036bd793e33","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"}}},{"node":{"id":"1e93cfc2-f4ae-5ffb-b7d6-1980189ab0b2","fields":{"slug":"/query-invalidation/"},"frontmatter":{"title":"React-Queryì—ì„œì˜ ë°ì´í„° ìµœì‹ í™” (Query Invalidation)"}}},{"node":{"id":"03f33659-afb8-5c11-adfa-2c2e9811166f","fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ ê¸°ì¤€"}}}]},"previous":{"fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"}},"next":{"fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ ê¸°ì¤€"}}},"pageContext":{"id":"1e93cfc2-f4ae-5ffb-b7d6-1980189ab0b2","series":null,"previousPostId":"76099a1d-7977-5447-9e88-4036bd793e33","nextPostId":"03f33659-afb8-5c11-adfa-2c2e9811166f"}},"staticQueryHashes":[]}
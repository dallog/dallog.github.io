{"componentChunkName":"component---src-templates-post-jsx","path":"/query-invalidation/","result":{"data":{"site":{"siteMetadata":{"title":"dal.log"}},"markdownRemark":{"id":"d8c66823-bb05-5e83-a6a1-2fd9af450b6f","excerpt":"ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ ë‚˜ì¸ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. React-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. Stale ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. react queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ â€¦","html":"<blockquote>\n<p>ì´ ê¸€ì€ ìš°í…Œì½” ë‹¬ë¡íŒ€ í¬ë£¨ <a href=\"https://github.com/jhy979\">ë‚˜ì¸</a>ì´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>React-Queryì˜ ìºì‹±ê°œë…ì€ staleê³¼ cacheTimeì„ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>\n<h2>Stale</h2>\n<blockquote>\n<p>ì‚¬ì „ì  ì˜ë¯¸ë¡œ 'ì‹ ì„ í•˜ì§€ ì•Šì€' ì…ë‹ˆë‹¤. react queryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹±ëœ ë°ì´í„°ë¥¼ staleí•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.</p>\n</blockquote>\n<p>react queryì—ì„œëŠ” stale timeì˜ defaultì´ 0ì…ë‹ˆë‹¤. (ì¦‰, ìºì‹±ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ë³¼ ìˆ˜ ìˆê² ì£ ?)</p>\n<h3>staleTime</h3>\n<blockquote>\n<p>ë°ì´í„°ê°€ freshí•œ ìƒíƒœì—ì„œ staleí•œ ìƒíƒœë¡œ ë³€í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<ul>\n<li>fresh ìƒíƒœì¼ë•ŒëŠ” ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒˆë¡­ê²Œ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. </li>\n<li>ë°ì´í„°ê°€ fetch ë˜ê³  ë‚˜ì„œ staleTimeì´ ì§€ë‚˜ì§€ ì•Šì•˜ë‹¤ë©´ unmount í›„ mount ë˜ì–´ë„ fetchê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>\n</ul>\n<h3>cacheTime</h3>\n<blockquote>\n<p>ë°ì´í„°ê°€ inactive ìƒíƒœì¼ ë•Œ ìºì‹±ëœ ìƒíƒœë¡œ ë‚¨ì•„ìˆëŠ” ì‹œê°„ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<ul>\n<li>ì¿¼ë¦¬ ì¸ìŠ¤í„´ìŠ¤ê°€ unmount ë˜ë©´ ë°ì´í„°ëŠ” inactive ìƒíƒœë¡œ ë³€ê²½ë˜ë©°, ìºì‹œëŠ” cacheTimeë§Œí¼ ìœ ì§€ë©ë‹ˆë‹¤.</li>\n<li>cacheTimeì€ staleTimeê³¼ ê´€ê³„ì—†ì´, ë¬´ì¡°ê±´ <code class=\"language-text\">inactiveëœ ì‹œì </code>ì„ ê¸°ì¤€ìœ¼ë¡œ ìºì‹±ì„ ê²°ì •í•©ë‹ˆë‹¤.</li>\n</ul>\n<hr>\n<h2>ë‹¬ë¡ì—ì„œì˜ ë°ì´í„° ìµœì‹ í™”</h2>\n<blockquote>\n<p>ë‹¬ë¡ì€ ì¼ì •, ì¹´í…Œê³ ë¦¬, êµ¬ë… ë“±ì˜ ì‘ì—…ìœ¼ë¡œ ì¸í•´ ë°ì´í„°ì˜ ë³€í™”ê°€ ì¦ì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ íŒ€ì€ staleTimeì„ ì§€ì •í•´ì£¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>ê·¸ë ‡ë‹¤ë©´ staleí•œ ë°ì´í„°ëŠ” ëŠ˜ ìµœì‹ í™”ê°€ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ê·¸ë˜ì„œ ì €ëŠ” ë§¤ë²ˆ ìƒˆë¡œìš´ ë°ì´í„°ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ <code class=\"language-text\">useQueryì˜ refetch</code>ë¥¼ ê°•ì œì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ë°©ì‹ì„ ìƒê°í–ˆì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ì˜ˆë¥¼ ë“¤ë©´ ì¼ì •ì„ ì¶”ê°€(post)í•œ í›„ì— ì¼ì •ì„ ë‹¤ì‹œ ì¡°íšŒ(get)í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ê²ë‹ˆë‹¤.</p>\n<p><img src=\"https://velog.velcdn.com/images/jhy979/post/287f66a2-8b7e-49c8-b623-c05a491db600/image.png\"></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// refetch í•¨ìˆ˜ë¥¼ ë¶€ëª¨ë¡œ ë¶€í„° ì£¼ì… ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">ScheduleAddModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> closeModal<span class=\"token punctuation\">,</span> refetch <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> ScheduleAddModalProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onSuccessPostSchedule</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">refetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ğŸ˜¢ í•˜ì§€ë§Œ ì´ ë°©ì‹ì´ ìš°ì•„í•˜ì§€ëŠ” ì•Šë”ë¼êµ¬ìš”. </p>\n<p>ë§Œì•½ ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ propsì „ë‹¬ì´ ì•„ë‹ˆë¼ ì¡°ë¶€ëª¨ì™€ ìì‹ ê°„ì˜ props ì „ë‹¬ì´ë¼ë©´ ì–´ë–¨ê¹Œìš”? ë²Œì¨ ë¨¸ë¦¬ê°€ ì•„íŒŒì˜µë‹ˆë‹¤. (props hell)</p>\n<h2>Query Invalidation ë„ì…</h2>\n<p>ğŸ¤” ë‹¤ë¥¸ ë°©ë²•ì´ ìˆì„í…ë°.. ì–´ë–¤ ë°©ë²•ì´ ìˆì„ê¹Œ? ê³ ë¯¼í•˜ë©° ê³µì‹ë¬¸ì„œë¥¼ ì½ë˜ ë„ì¤‘ <code class=\"language-text\">Query Invalidation</code>ì„ ë°œê²¬í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Invalidate every query in the cache</span>\nqueryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Invalidate every query with a key that starts with `todos`</span>\nqueryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'todos'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>The QueryClient has an invalidateQueries method that lets you intelligently mark queries as stale and potentially refetch them too!</p>\n</blockquote>\n<p>â— ìºì‹±í‚¤ë¡œ ê´€ë ¨ëœ stale ì¿¼ë¦¬ë“¤ì„ ì²´í¬í•˜ê³  refetchí•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">ScheduleAddModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> closeModal <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> ScheduleAddModalProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> queryClient <span class=\"token operator\">=</span> <span class=\"token function\">useQueryClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onSuccessPostSchedule</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ì¼ì • post ì„±ê³µ ì‹œ ë°ì´í„° ìµœì‹ í™”ë¥¼ invalidateQueriesë©”ì„œë“œë¥¼ í†µí•´ ìˆ˜í–‰í•©ë‹ˆë‹¤.</span>\n    queryClient<span class=\"token punctuation\">.</span><span class=\"token function\">invalidateQueries</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CACHE_KEY</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SCHEDULES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ğŸ’ª ì´ë¡œì¨ useQueryì˜ refetchí•¨ìˆ˜ë¥¼ ë„˜ê²¨ì¤„ í•„ìš”ì—†ì´ ì–´ë””ì„œë“  ìºì‹±í‚¤ë¡œ freshí•œ ë°ì´í„°ë¥¼ ë³´ì¥í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<h4>ì°¸ê³ ìë£Œ</h4>\n<p><a href=\"https://tanstack.com/query/v4/docs/guides/query-invalidation\">https://tanstack.com/query/v4/docs/guides/query-invalidation</a></p>","frontmatter":{"title":"React-Queryì—ì„œì˜ ë°ì´í„° ìµœì‹ í™” (Query Invalidation)","date":"August 01, 2022","update":null,"tags":["react","react-query"],"series":null},"fields":{"slug":"/query-invalidation/","readingTime":{"minutes":3.835}}},"seriesList":{"edges":[{"node":{"id":"a621dc7b-8590-5ec6-9b52-3d9e5182486d","fields":{"slug":"/appearance-background-of-jpa/"},"frontmatter":{"title":"JPA ë“±ì¥ë°°ê²½"}}},{"node":{"id":"9d2a87b6-2b9c-5b87-b790-3426d17c2d8e","fields":{"slug":"/intellij-final-keyword/"},"frontmatter":{"title":"IntelliJì—ì„œ ë©”ì†Œë“œ ì¶”ì¶œí•œ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì— final í‚¤ì›Œë“œ ìë™ ì¶”ê°€í•˜ê¸°"}}},{"node":{"id":"251e9767-1c92-5cf5-9cef-2c4a42c10df2","fields":{"slug":"/git-branch-strategy/"},"frontmatter":{"title":"ë‹¬ë¡íŒ€ì˜ git ë¸Œëœì¹˜ ì „ëµì„ ì†Œê°œí•©ë‹ˆë‹¤."}}},{"node":{"id":"5090cce3-0c1f-5376-badc-1d25e44c1bd9","fields":{"slug":"/infinite-scroll/"},"frontmatter":{"title":"Reactì—ì„œ ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„í•˜ê¸°"}}},{"node":{"id":"bcb53ba5-0286-5d10-96c2-fdcb88e2cc60","fields":{"slug":"/package-structure/"},"frontmatter":{"title":"ë‹¬ë¡ì— ì ì ˆí•œ íŒ¨í‚¤ì§€ êµ¬ì¡° ê³ ë¯¼í•˜ê¸°"}}},{"node":{"id":"a7fc89de-f37c-596e-a81d-3d4fe5a795b8","fields":{"slug":"/data-jpa-slice-page/"},"frontmatter":{"title":"Spring Data JPAì˜ Slice & Page"}}},{"node":{"id":"e1ba92ee-0cf0-50c8-80bd-5da5075df8d1","fields":{"slug":"/data-jpa-auditing/"},"frontmatter":{"title":"Spring Data JPAì˜ Auditing"}}},{"node":{"id":"3e036508-c916-504e-9e8d-89f69332471e","fields":{"slug":"/separated-interface/"},"frontmatter":{"title":"ì™¸ë¶€ì™€ ì˜ì¡´ì„± ë¶„ë¦¬í•˜ê¸°"}}},{"node":{"id":"cade544a-16ef-58a3-b97c-824986a8395f","fields":{"slug":"/apply-rest-docs/"},"frontmatter":{"title":"MockMvcë¥¼ ì‚¬ìš©í•œ Spring RestDocs"}}},{"node":{"id":"87649d54-d59e-58a6-afd5-8491eb4113a8","fields":{"slug":"/properties-to-object/"},"frontmatter":{"title":"properties ê°ì²´ë¡œ ë‹¤ë£¨ê¸°"}}},{"node":{"id":"eb380f6d-5a00-5a9e-a916-003fb292cc8a","fields":{"slug":"/test-fixture-constant/"},"frontmatter":{"title":"í…ŒìŠ¤íŠ¸ì—ì„œ Entity ê°ì²´ë¥¼ ìƒìˆ˜ë¡œ ë‘ë©´ ì•ˆ ë˜ëŠ” ì´ìœ "}}},{"node":{"id":"9734e30a-b430-5922-919d-f53808a56eb9","fields":{"slug":"/what_is_nginx/"},"frontmatter":{"title":"NGINX ë€?"}}},{"node":{"id":"9ebc6e21-2a76-5d42-be33-c2dae8c849b2","fields":{"slug":"/ssl_protocol/"},"frontmatter":{"title":"SSLì„ í†µí•œ HTTPSí†µì‹  ê³¼ì •"}}},{"node":{"id":"fa5ad595-1f81-5a20-a884-2da69adee3c5","fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"}}},{"node":{"id":"d8c66823-bb05-5e83-a6a1-2fd9af450b6f","fields":{"slug":"/query-invalidation/"},"frontmatter":{"title":"React-Queryì—ì„œì˜ ë°ì´í„° ìµœì‹ í™” (Query Invalidation)"}}},{"node":{"id":"f5187517-342f-52a1-9092-d12c1a80d132","fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ ê¸°ì¤€"}}},{"node":{"id":"d6249c8b-bea6-5c91-8477-d3dd15ad9b39","fields":{"slug":"/test-isolation/"},"frontmatter":{"title":"í…ŒìŠ¤íŠ¸ ê²©ë¦¬"}}},{"node":{"id":"98e390ef-fb19-5d01-a3ef-d14bc0e65176","fields":{"slug":"/dallog-jacoco/"},"frontmatter":{"title":"ë‹¬ë¡ì˜ Jacoco ì ìš©ê¸° (feat. Gradle)"}}},{"node":{"id":"33d19946-de0c-5b41-bfa0-d7c3fd80f10b","fields":{"slug":"/google-refresh-token/"},"frontmatter":{"title":"Googleì€ Refresh Tokenì„ ì‰½ê²Œ ë‚´ì£¼ì§€ ì•ŠëŠ”ë‹¤."}}},{"node":{"id":"8168857d-a82c-5608-bd40-cea4b917d17d","fields":{"slug":"/submodule/"},"frontmatter":{"title":"ë‹¬ë¡ ì„œë¸Œëª¨ë“ˆ ë„ì…ê¸°"}}},{"node":{"id":"836fc724-7e2f-5c7a-a42b-c0cc9163167a","fields":{"slug":"/dallog-flyway/"},"frontmatter":{"title":"ë‹¬ë¡ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìœ„í•œ Flyway ì ìš©ê¸°"}}},{"node":{"id":"7a3bde6d-746b-56fd-8d91-0d8059ebf1f8","fields":{"slug":"/json-property-json-naming/"},"frontmatter":{"title":"@JsonProperty, @JsonNaming"}}},{"node":{"id":"50673f5c-f835-5982-b70c-b77e5a352a2c","fields":{"slug":"/servlet-life-cycle/"},"frontmatter":{"title":"ì„œë¸”ë¦¿ ìƒëª…ì£¼ê¸°ì™€ ì§ì ‘ë§Œë“  í†°ìº£ì„ í†µí•œ ì˜ë¬¸ì "}}},{"node":{"id":"61e7f4d1-7b3a-5968-bfe8-c3f6efb88748","fields":{"slug":"/preparing-for-performance-test/"},"frontmatter":{"title":"í†°ìº£ íŠœë‹ì„ ìœ„í•œ ë‹¬ë¡ì˜ ì„œë²„ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ê³¼ì •"}}},{"node":{"id":"9272061d-68c6-5f82-a961-0e2efe0fd6be","fields":{"slug":"/cyclic-dependency/"},"frontmatter":{"title":"cyclic dependency"}}},{"node":{"id":"6e779308-f266-58af-bfcc-e9fee6d39a98","fields":{"slug":"/multi-datasource-issue-with-osiv/"},"frontmatter":{"title":"ëŒ€ì²´ ì™œ DataSource ë¼ìš°íŒ…ì´ ì•ˆë˜ëŠ”ê±°ì•¼!? (feat. OSIV)"}}},{"node":{"id":"c7bea043-345c-5f78-ae53-796a83812961","fields":{"slug":"/react-query-useMutation-trouble-shooting/"},"frontmatter":{"title":"react-query useMutation onSuccess ì•ˆ ë˜ëŠ”ì¤„ ì•Œì•˜ë˜ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…"}}},{"node":{"id":"cf403487-1c48-5ca7-b5c2-ef0d8fefe3c4","fields":{"slug":"/jenkins-distributed-build-architecture/"},"frontmatter":{"title":"ì  í‚¨ìŠ¤ ë¶„ì‚° ë¹Œë“œ ì•„í‚¤í…ì²˜ êµ¬ì¶•"}}},{"node":{"id":"24c152c7-4e94-5b84-aaea-a5a9a8357693","fields":{"slug":"/zero-downtime-deployment/"},"frontmatter":{"title":"ë‹¬ë¡ ë¬´ì¤‘ë‹¨ ë°°í¬ ë„ì…ê¸°"}}},{"node":{"id":"623f9105-974d-51b9-84c7-f6298a8d1c19","fields":{"slug":"/get-valid-accessToken/"},"frontmatter":{"title":"refreshTokenìœ¼ë¡œ accessToken ì¬ë°œê¸‰í•˜ê¸°"}}},{"node":{"id":"d34299f0-eb49-5aef-a38f-963200d5fd6d","fields":{"slug":"/test-readability/"},"frontmatter":{"title":"ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°€ë…ì„±ì„ ê°œì„ í•  ìˆ˜ ìˆì„ê¹Œ??"}}}]},"previous":{"fields":{"slug":"/integration-test-slice-test/"},"frontmatter":{"title":"í†µí•© í…ŒìŠ¤íŠ¸ì™€ ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸"}},"next":{"fields":{"slug":"/seperate-components/"},"frontmatter":{"title":"ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ ê¸°ì¤€"}}},"pageContext":{"id":"d8c66823-bb05-5e83-a6a1-2fd9af450b6f","series":null,"previousPostId":"fa5ad595-1f81-5a20-a884-2da69adee3c5","nextPostId":"f5187517-342f-52a1-9092-d12c1a80d132"}},"staticQueryHashes":[]}